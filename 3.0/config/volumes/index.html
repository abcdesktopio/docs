
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://www.abcdesktop.io/3.0/config/volumes/">
      
      
        <link rel="prev" href="../desktop.pod/">
      
      
        <link rel="next" href="../desktop/">
      
      
      <link rel="icon" href="/img/abcdesktop128x128.ico">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.3">
    
    
      
        <title>Persistent Volumes - www.abcdesktop.io</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0e669242.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-TN9YC7J01Z"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-TN9YC7J01Z",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-TN9YC7J01Z",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#define-volumes-to-retain-users-home-directory-files" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="www.abcdesktop.io" class="md-header__button md-logo" aria-label="www.abcdesktop.io" data-md-component="logo">
      
  <img src="/img/abcdesktop.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            www.abcdesktop.io
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Persistent Volumes
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/abcdesktopio/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    abcdesktopio/docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="www.abcdesktop.io" class="md-nav__button md-logo" aria-label="www.abcdesktop.io" data-md-component="logo">
      
  <img src="/img/abcdesktop.svg" alt="logo">

    </a>
    www.abcdesktop.io
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/abcdesktopio/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    abcdesktopio/docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/opensource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open source
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/authors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/gnu-gpl-v2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Licence
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../adopters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopters
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Requirements
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GUI apps on Docker
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            GUI apps on Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../guiappsoddocker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VDI with containers, other related projets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../1.0/setup/vnc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hands-on with VNC client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../1.0/setup/novnc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hands-on with no-VNC HTML5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/play_sound_in_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Play sound from a container to a web browser
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/pyos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pyos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mongodb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/memcached/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memcached
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/speedtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Speedtest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/ocuser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../services/spawner-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spawner-service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../services/file-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File-service
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Setup guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Setup guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Release 3.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            Release 3.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notes and Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Requirements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_3" >
        
          <label class="md-nav__link" for="__nav_9_1_3" id="__nav_9_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kubernetes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_3">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/k8slinuxinstallation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Kubernetes on GNU/Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/kubernetesmode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup Kubernetes for GNU/Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/kubernetes_abcdesktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup abcdesktop for Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/kubernetes_abcdesktop_applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup applications for abcdesktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/kubernetes_abcdesktop_applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup LoadBalacing service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/uninstall_kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uninstall abcdesktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_3_7" >
        
          <label class="md-nav__link" for="__nav_9_1_3_7" id="__nav_9_1_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kubernetes add-ons
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_1_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_3_7">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes add-ons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../setup/kubernetes_networkpolicies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup Network policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../setup/kubernetes_flexvolume/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup CIFS Volume
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Applications Containers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Applications Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../applications/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List of all applications ready to use
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Release 3.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            Release 3.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../applicationsformat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application image format
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../buildapplicationsgnulinux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build your own abcdesktop GNU/Linux Image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../buildapplications.wine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build your own abcdesktop MsWindows Image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/non-free-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build non free applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../application/createsampleapplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a sample application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/3.0/createcontainerisedapplicationdebug/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create an application from scratch for troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../application/applicationruntime_ephemeralcontainer_pod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run application as a ephemeral container or as a pod
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Configuration Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" checked>
        
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Release 3.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            Release 3.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../editconfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Edit your configuration file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_2" >
        
          <label class="md-nav__link" for="__nav_11_1_2" id="__nav_11_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cloud Provider
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_2">
            <span class="md-nav__icon md-icon"></span>
            Cloud Provider
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../cloudprovider.loadbalancing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure LoadBalancing service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="./" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Persistent Volumes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_3" >
        
          <label class="md-nav__link" for="__nav_11_1_3" id="__nav_11_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Authentification
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_3">
            <span class="md-nav__icon md-icon"></span>
            Authentification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authentification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_3_2" >
        
          <label class="md-nav__link" for="__nav_11_1_3_2" id="__nav_11_1_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    explicit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_11_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            explicit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authexplicit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Directory services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authexplicit-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authexplicit-activedirectory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authimplicit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    implicit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authexternal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    external
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../authentification-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rules
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../desktop.pod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pod User
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Persistent Volumes
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Persistent Volumes
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolume-using-hostpath" class="md-nav__link">
    Define persistentVolume using hostPath
  </a>
  
    <nav class="md-nav" aria-label="Define persistentVolume using hostPath">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-of-all-template-values" class="md-nav__link">
    list of all template values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolumeclaim-using-storageclassname" class="md-nav__link">
    Define persistentVolumeClaim using storageClassName
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolumeclaim-using-csi-driver-nfs" class="md-nav__link">
    Define persistentVolumeClaim using csi-driver-nfs
  </a>
  
    <nav class="md-nav" aria-label="Define persistentVolumeClaim using csi-driver-nfs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-the-nfs-server" class="md-nav__link">
    On the nfs server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-csi-driver-nfs" class="md-nav__link">
    Install the csi-driver-nfs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-odconfig-file" class="md-nav__link">
    Update the od.config file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#login-to-your-abcdesktop-service" class="md-nav__link">
    Login to your abcdesktop service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-the-persistentvolume-and-persistentvolumeclaim" class="md-nav__link">
    List the PersistentVolume and PersistentVolumeClaim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-quota-for-user-homedir" class="md-nav__link">
    Set quota for user homedir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#login-to-your-abcdesktop-service_1" class="md-nav__link">
    Login to your abcdesktop service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolumeclaim-using-k8s-csi-s3" class="md-nav__link">
    Define persistentVolumeClaim using k8s-csi-s3
  </a>
  
    <nav class="md-nav" aria-label="Define persistentVolumeClaim using k8s-csi-s3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-storageclassyaml-file" class="md-nav__link">
    Update storageclass.yaml file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-odconfig" class="md-nav__link">
    Update od.config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#init-command-options-has-no-file-permissions-support" class="md-nav__link">
    init command options has no file permissions support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../desktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../frontjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Front
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Languages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_9" >
        
          <label class="md-nav__link" for="__nav_11_1_9" id="__nav_11_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Logging
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_9">
            <span class="md-nav__icon md-icon"></span>
            Logging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../syslog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syslog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_10" >
        
          <label class="md-nav__link" for="__nav_11_1_10" id="__nav_11_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Network Policy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_10">
            <span class="md-nav__icon md-icon"></span>
            Network Policy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../networkpolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Policy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_11" >
        
          <label class="md-nav__link" for="__nav_11_1_11" id="__nav_11_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Controllers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_11">
            <span class="md-nav__icon md-icon"></span>
            Controllers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manager
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_12" >
        
          <label class="md-nav__link" for="__nav_11_1_12" id="__nav_11_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    WebRTC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_12">
            <span class="md-nav__icon md-icon"></span>
            WebRTC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../webrtc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pulseaudio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1_13" >
        
          <label class="md-nav__link" for="__nav_11_1_13" id="__nav_11_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Issue tracking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1_13">
            <span class="md-nav__icon md-icon"></span>
            Issue tracking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../jira/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jira
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/abcdesktopio/conf/issues" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Issue
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How-to
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            How-to
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_1" >
        
          <label class="md-nav__link" for="__nav_14_1" id="__nav_14_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Release 1.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_14_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14_1">
            <span class="md-nav__icon md-icon"></span>
            Release 1.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/1.0/update_frontend_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update and custom frontend image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/1.0/userdatapersistence.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User data persistence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/1.0/abcdesktop.bastion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use abcdesktop as a bastion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../1.0/config/sudo-kubernetes.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get a root access inside a container
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../1.0/setup/retrieve_all_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get all docker application image for abcdesktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/1.0/docker_macvlan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bind a specific docker network for an application
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_2" >
        
          <label class="md-nav__link" for="__nav_14_2" id="__nav_14_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Release 3.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_14_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14_2">
            <span class="md-nav__icon md-icon"></span>
            Release 3.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/3.0/createcontainerisedapplicationdebug/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create an application from scratch for troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/3.0/update_frontend_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update and custom frontend image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/3.0/mount_nfs_tag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mount a nfs resource inside a user desktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/3.0/multiplegroupsfeature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 2307 multiple groups and user securityContext on pod
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/debug_application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debug you own application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/acl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Define access control for an application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/upload_and_download_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upload and from files with your desktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/firefox-extension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sync clipboard with Mozilla Firefox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/custom-wallpaper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom default desktop wallpaper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/flash-firefox-esr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run Adobe Flash player with Mozilla Firefox-esr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/shm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test POSIX and System V shared memory
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolume-using-hostpath" class="md-nav__link">
    Define persistentVolume using hostPath
  </a>
  
    <nav class="md-nav" aria-label="Define persistentVolume using hostPath">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-of-all-template-values" class="md-nav__link">
    list of all template values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolumeclaim-using-storageclassname" class="md-nav__link">
    Define persistentVolumeClaim using storageClassName
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolumeclaim-using-csi-driver-nfs" class="md-nav__link">
    Define persistentVolumeClaim using csi-driver-nfs
  </a>
  
    <nav class="md-nav" aria-label="Define persistentVolumeClaim using csi-driver-nfs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-the-nfs-server" class="md-nav__link">
    On the nfs server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-csi-driver-nfs" class="md-nav__link">
    Install the csi-driver-nfs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-odconfig-file" class="md-nav__link">
    Update the od.config file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#login-to-your-abcdesktop-service" class="md-nav__link">
    Login to your abcdesktop service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-the-persistentvolume-and-persistentvolumeclaim" class="md-nav__link">
    List the PersistentVolume and PersistentVolumeClaim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-quota-for-user-homedir" class="md-nav__link">
    Set quota for user homedir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#login-to-your-abcdesktop-service_1" class="md-nav__link">
    Login to your abcdesktop service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-persistentvolumeclaim-using-k8s-csi-s3" class="md-nav__link">
    Define persistentVolumeClaim using k8s-csi-s3
  </a>
  
    <nav class="md-nav" aria-label="Define persistentVolumeClaim using k8s-csi-s3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-storageclassyaml-file" class="md-nav__link">
    Update storageclass.yaml file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-odconfig" class="md-nav__link">
    Update od.config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#init-command-options-has-no-file-permissions-support" class="md-nav__link">
    init command options has no file permissions support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/abcdesktopio/docs/edit/main/opsdocs/docs/3.0/config/volumes.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="define-volumes-to-retain-users-home-directory-files">Define volumes to retain user's home directory files</h1>
<p>To retain user's home directory files, you can define </p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">PersistentVolume</a> using <code>hostPath</code>. The <code>hostPath</code> can also be a mount point.</li>
<li><a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">PersistentVolumeClaim</a> using <code>storageClassName</code> parameter. Two examples are described one using <code>nfs</code>, the second one using <code>s3</code>.</li>
</ul>
<h2 id="define-persistentvolume-using-hostpath">Define persistentVolume using <code>hostPath</code></h2>
<p>In your od.config file, define the new entries <code>desktop.homedirectorytype</code> <code>desktop.persistentvolumespec</code> <code>desktop.persistentvolumeclaimspec</code></p>
<ul>
<li><code>desktop.homedirectorytype</code>: 'persistentVolumeClaim'</li>
<li><code>desktop.persistentvolumespec</code>: create a new volume for the user's homeDir, for persistentVolume hostPath.</li>
<li><code>desktop.persistentvolumeclaimspec</code>: create a new volume claim for the user's homeDir</li>
</ul>
<pre><code class="language-json"># set to persistentVolumeClaim
desktop.homedirectorytype: 'persistentVolumeClaim'

# define how to create persistentvolume
desktop.persistentvolumespec: {
            'storageClassName': '',
            'capacity': { 'storage': '1Gi' },
            'accessModes': [ 'ReadWriteOnce' ], 
            'hostPath': { 'path': '/mnt/abcdesktop_volumes/{{ provider }}/{{ userid }}' } }

# define how to create persistentvolumeclaim
desktop.persistentvolumeclaimspec: {
            'storageClassName': '',
            'resources': { 
              'requests': { 
                'storage': '1Gi'
              } 
            },
            'accessModes': [ 'ReadWriteOnce' ] }
</code></pre>
<p>desktop.persistentvolumespec support template values. For example <code>'/mnt/abcdesktop_volumes/{{ provider }}/{{ userid }}'</code>. </p>
<ul>
<li><code>{{ provider }}</code> is the provider's name templated value. </li>
<li><code>{{ userid }}</code> is the user's id templated value.</li>
</ul>
<p><em>The list of all template values can be read at the end of this chapter</em></p>
<p>The user's home directory inside the pod is located on host to <code>/mnt/abcdesktop_volumes/{{ provider }}/{{ userid }}</code>. The directory is created automatically by kubernetes.</p>
<p>The <code>/mnt/abcdesktop_volumes/</code> content lists the provider name.</p>
<p>On the host, the new directory is created, where each home directory is located.</p>
<p>Read the new path for 'hostPath' persistent volumes</p>
<pre><code class="language-bash">ls -la /mnt/abcdesktop_volumes/
total 20
drwxr-xr-x   5 root root 4096 mai   12 12:40 .
drwxr-xr-x 106 root root 4096 mai   11 11:34 ..
drwxr-xr-x   3 root root 4096 mai   12 12:40 anonymous
drwxr-xr-x   3 root root 4096 mai   12 12:39 github
drwxr-xr-x   5 root root 4096 mai   12 12:40 google
</code></pre>
<p>For provider <code>google</code>, all users are listed.</p>
<pre><code class="language-bash">ls -la /mnt/abcdesktop_volumes/google/
total 20
drwxr-xr-x  5 root root 4096 mai   12 12:40 .
drwxr-xr-x  5 root root 4096 mai   12 12:40 ..
drwxr-x--- 16 2048 2048 4096 mai   12 12:39 103464335761332102620
drwxr-x--- 16 2048 2048 4096 mai   12 12:40 112026272437223559761
drwxr-x--- 16 2048 2048 4096 mai   12 12:39 114102844260599245242
</code></pre>
<p>For provider <code>google</code>, list the user home directory for the user <code>103464335761332102620</code></p>
<pre><code class="language-bash">ls -la /mnt/abcdesktop_volumes/google/103464335761332102620/
total 76
drwxr-x--- 16 2048 2048 4096 mai   12 12:39 .
drwxr-xr-x  5 root root 4096 mai   12 12:40 ..
-rw-------  1 2048 2048   71 mai   12 12:39 .Xauthority
-rw-rw-r--  1 2048 2048   12 janv. 27 18:36 .Xresources
drwxr-x---  3 2048 2048 4096 mai   12 12:39 .cache
drwxr-x---  6 2048 2048 4096 mai   12 12:39 .config
drwxrwxr-x  3 2048 2048 4096 janv. 27 18:36 .gconf
-rw-r-----  1 2048 2048    0 mai   12 12:39 .gtk-bookmarks
-rw-rw-r--  1 2048 2048  564 janv. 27 18:36 .gtkrc-2.0
drwxr-x---  3 2048 2048 4096 mai   12 12:39 .local
drwxr-x---  2 2048 2048 4096 mai   12 12:39 .store
drwxr-x---  2 2048 2048 4096 mai   12 12:39 .wallpapers
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Desktop
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Documents
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Downloads
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Music
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Pictures
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Public
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Templates
drwxr-x---  2 2048 2048 4096 mai   12 12:39 Videos
</code></pre>
<h3 id="list-of-all-template-values">list of all template values</h3>
<p>The template values can be one of them :</p>
<table>
<thead>
<tr>
<th style="text-align: right;">var</th>
<th style="text-align: right;">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">cn</td>
<td style="text-align: right;">Common Name</td>
</tr>
<tr>
<td style="text-align: right;">uid</td>
<td style="text-align: right;">user id</td>
</tr>
<tr>
<td style="text-align: right;">gid</td>
<td style="text-align: right;">group id</td>
</tr>
<tr>
<td style="text-align: right;">uidNumber</td>
<td style="text-align: right;">user id number</td>
</tr>
<tr>
<td style="text-align: right;">gidNumber</td>
<td style="text-align: right;">group id number</td>
</tr>
<tr>
<td style="text-align: right;">homeDirectory</td>
<td style="text-align: right;">homeDirectory</td>
</tr>
<tr>
<td style="text-align: right;">loginShell</td>
<td style="text-align: right;">loginShell</td>
</tr>
<tr>
<td style="text-align: right;">description</td>
<td style="text-align: right;">description</td>
</tr>
<tr>
<td style="text-align: right;">groups</td>
<td style="text-align: right;">groups</td>
</tr>
<tr>
<td style="text-align: right;">gecos</td>
<td style="text-align: right;">gecos</td>
</tr>
<tr>
<td style="text-align: right;">provider</td>
<td style="text-align: right;">provider</td>
</tr>
<tr>
<td style="text-align: right;">protocol</td>
<td style="text-align: right;">protocol</td>
</tr>
<tr>
<td style="text-align: right;">providertype</td>
<td style="text-align: right;">providertype</td>
</tr>
<tr>
<td style="text-align: right;">name</td>
<td style="text-align: right;">user name</td>
</tr>
<tr>
<td style="text-align: right;">userid</td>
<td style="text-align: right;">user id</td>
</tr>
<tr>
<td style="text-align: right;">locale</td>
<td style="text-align: right;">user's locale</td>
</tr>
<tr>
<td style="text-align: right;"><em>template tag value</em></td>
<td style="text-align: right;">tag value set by auth rules</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: <code>hostPath</code> supports file permissions and the pod's init commands <code>chown</code> or <code>chmod</code> can be used. The <code>hostPath</code> can also be a mount point, using nfs. </p>
</blockquote>
<h2 id="define-persistentvolumeclaim-using-storageclassname">Define persistentVolumeClaim using <code>storageClassName</code></h2>
<p>To define a <code>persistentVolumeClaim</code>, update the od.config file and set</p>
<pre><code class="language-json">desktop.homedirectorytype: 'persistentVolumeClaim'
desktop.persistentvolumespec: None
desktop.persistentvolumeclaimspec: &lt;YOUR_PERSISTENT_VOLULME_CLAIM_SPEC&gt;
</code></pre>
<p><code>desktop.persistentvolumeclaimspec</code> is a dictionary. Get more information about <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">PersistentVolume and PersistentVolumeClaim.</a></p>
<p>For example</p>
<pre><code class="language-json"># set to persistentVolumeClaim
desktop.homedirectorytype: 'persistentVolumeClaim'
desktop.persistentvolumespec: None
desktop.persistentvolumeclaimspec: {
            'storageClassName': 'mystorageclass',
            'resources': { 
              'requests': { 
                'storage': '1Gi'
              } 
            },
            'accessModes': [ 'ReadWriteOnce' ] }
</code></pre>
<p>Replace <code>mystorageclass</code> by storageclass of your cloud provider</p>
<pre><code class="language-bash">kubectl get storageclass
</code></pre>
<p>The example output is as follows on the cloud provider <a href="https://aws.amazon.com/">aws</a>.</p>
<pre><code>NAME            PROVISIONER             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
gp2 (default)   kubernetes.io/aws-ebs   Delete          WaitForFirstConsumer   false 
</code></pre>
<p>The example output is as follows on the cloud provider <a href="https://www.digitalocean.com/">digitalocean</a>.</p>
<pre><code>NAME                          PROVISIONER                    RECLAIMPOLICY          Immediate           false                  3h22m
do-block-storage (default)    dobs.csi.digitalocean.com      Delete          Immediate           true                   2d7h
do-block-storage-retain       dobs.csi.digitalocean.com      Retain          Immediate           true                   2d7h
do-block-storage-xfs          dobs.csi.digitalocean.com      Delete          Immediate           true                   2d7h
do-block-storage-xfs-retain   dobs.csi.digitalocean.com      Retain          Immediate           true                   2d7h
</code></pre>
<h2 id="define-persistentvolumeclaim-using-csi-driver-nfs">Define persistentVolumeClaim using <code>csi-driver-nfs</code></h2>
<p>In this example, we use nfs to share user home directory with each worker node</p>
<p>Use the <code>https://github.com/kubernetes-csi/csi-driver-nfs</code> as a <code>csi-driver-nfs</code> with a nfs server as backend. </p>
<h3 id="on-the-nfs-server">On the nfs server</h3>
<p>On the nfs server, create an export with the <code>no_root_squash</code> option</p>
<p>For example export <code>/volume1/pods</code></p>
<pre><code>/volume1/pods        192.168.7.0/24(rw,async,no_wdelay,crossmnt,insecure,no_root_squash,insecure_locks,anonuid=1025,anongid=100)
</code></pre>
<h3 id="install-the-csi-driver-nfs">Install the <code>csi-driver-nfs</code></h3>
<p>Run the install <code>install-driver.sh</code> command from <a href="https://github.com/kubernetes-csi/csi-driver-nfs">kubernetes-csi/csi-driver-nfs</a> GitHub repository.</p>
<pre><code>curl -skSL https://raw.githubusercontent.com/kubernetes-csi/csi-driver-nfs/v4.4.0/deploy/install-driver.sh | bash -s v4.4.0 --
</code></pre>
<p>Create a storage class file nfs-csi-sc-ds01.yaml,</p>
<ul>
<li>replace server: <code>192.168.7.101</code> by your own nfs server ip address</li>
<li>replace share: <code>/volume1/pods</code> by your own share</li>
</ul>
<p>Content of the default <code>nfs-csi-sc-ds01.yaml</code></p>
<pre><code class="language-yaml">apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: nfs-csi-sc-ds01
provisioner: nfs.csi.k8s.io
parameters:
  server: 192.168.7.101
  share: /volume1/pods
  mountPermissions: &quot;0755&quot;
  # csi.storage.k8s.io/provisioner-secret is only needed for providing mountOptions in DeleteVolume
  # csi.storage.k8s.io/provisioner-secret-name: &quot;mount-options&quot;
  # csi.storage.k8s.io/provisioner-secret-namespace: &quot;default&quot;
reclaimPolicy: Delete
volumeBindingMode: Immediate
mountOptions:
  - nfsvers=3
</code></pre>
<pre><code class="language-bash">kubectl apply -f nfs-csi-sc-ds01.yaml
</code></pre>
<p>You read the response on stdout</p>
<pre><code>storageclass.storage.k8s.io/nfs-csi-sc-ds01 created
</code></pre>
<p>Check the storage class <code>nfs-csi-sc-ds01</code></p>
<pre><code>kubectl get sc
NAME                 PROVISIONER      RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
nfs-csi-sc-ds01      nfs.csi.k8s.io   Delete          Immediate           false                  18m
</code></pre>
<h3 id="update-the-odconfig-file">Update the <code>od.config</code> file</h3>
<p>In your od.config file, define the entry <code>desktop.persistentvolumeclaimspec</code></p>
<ul>
<li><code>desktop.homedirectorytype</code>: 'persistentVolumeClaim' to use the persistentVolumeClaim features.</li>
<li><code>desktop.persistentvolumespec</code>: None to skip the persistent volume provisioning.</li>
<li><code>desktop.persistentvolumeclaimspec</code> create a new volume claim for the user's homeDir, the storageClassName <code>nfs-csi-sc-ds01</code></li>
</ul>
<p>The PersistentVolume and PersistentVolumeClaim are created by abcdesktop. Abcdesktop defines a binding between that specific PV and PVC</p>
<pre><code class="language-json"># set to persistentVolumeClaim
desktop.homedirectorytype: 'persistentVolumeClaim'
desktop.persistentvolumespec: None
desktop.persistentvolumeclaimspec: {
            'storageClassName': 'nfs-csi-sc-ds01',
            'resources': { 
              'requests': { 
                'storage': '500Mi'
              } 
            },
            'accessModes': [ 'ReadWriteOnce' ] }
</code></pre>
<p>Update the new config file and restart <code>pyos</code> pod</p>
<pre><code class="language-bash">kubectl delete configmap abcdesktop-config -n abcdesktop
kubectl create configmap abcdesktop-config --from-file=od.config -n abcdesktop
kubectl delete pods -l run=pyos-od -n abcdesktop
</code></pre>
<h3 id="login-to-your-abcdesktop-service">Login to your abcdesktop service</h3>
<p>Login as user (<code>Philip J. Fry</code>, <code>fry</code>)</p>
<p><img alt="Login to your abcdesktop service as fry" src="../img/storageclass-nfs-login-fry.png" /></p>
<p>The new desktop for <code>Philip J. Fry</code> is created.</p>
<p>Start the web shell command using the search bar </p>
<p><img alt="desktop as fry" src="../img/storageclass-nfs-desktop.png" /></p>
<p>Using the web shell application start the df command </p>
<p><img alt="df as fry" src="../img/storageclass-nfs-df.png" /></p>
<p>The fry home dir is mounted on <code>192.168.7.101:/volume1/pods/pvc-b8317d7b-dc35-4fc3-88e9-ad894ab11d32</code></p>
<h3 id="list-the-persistentvolume-and-persistentvolumeclaim">List the PersistentVolume and PersistentVolumeClaim</h3>
<p>List the new PersistentVolume</p>
<pre><code class="language-bash">kubectl get pv 
NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                         STORAGECLASS      REASON   AGE
pvc-b8317d7b-dc35-4fc3-88e9-ad894ab11d32   25Mi       RWO            Delete           Bound    abcdesktop/planet-fry-9372f   nfs-csi-sc-ds01            3m
</code></pre>
<p>List the new PersistentVolumeClaim</p>
<pre><code class="language-bash">kubectl get pvc -n abcdesktop 
NAME               STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE
planet-fry-9372f   Bound    pvc-b8317d7b-dc35-4fc3-88e9-ad894ab11d32   25Mi       RWO            nfs-csi-sc-ds01   5m7s
</code></pre>
<p>Get the PersistentVolumeClaim's description</p>
<pre><code class="language-bash">kubectl describe pvc planet-fry-9372f -n abcdesktop 
Name:          planet-fry-9372f
Namespace:     abcdesktop
StorageClass:  nfs-csi-sc-ds01
Status:        Bound
Volume:        pvc-b8317d7b-dc35-4fc3-88e9-ad894ab11d32
Labels:        access_provider=planet
               access_providertype=ldap
               access_userid=fry
Annotations:   pv.kubernetes.io/bind-completed: yes
               pv.kubernetes.io/bound-by-controller: yes
               volume.beta.kubernetes.io/storage-provisioner: nfs.csi.k8s.io
               volume.kubernetes.io/storage-provisioner: nfs.csi.k8s.io
Finalizers:    [kubernetes.io/pvc-protection]
Capacity:      25Mi
Access Modes:  RWO
VolumeMode:    Filesystem
Used By:       fry-87066
Events:
  Type    Reason                 Age              From                                                        Message
  ----    ------                 ----             ----                                                        -------
  Normal  ExternalProvisioning   7m (x2 over 7m)  persistentvolume-controller                                 Waiting for a volume to be created either by the external provisioner 'nfs.csi.k8s.io' or manually by the system administrator. If volume creation is delayed, please verify that the provisioner is running and correctly registered.
  Normal  Provisioning           7m               nfs.csi.k8s.io_kadmin_1c28f3c9-91ee-4aa0-b991-8c17c46133d3  External provisioner is provisioning volume for claim &quot;abcdesktop/planet-fry-9372f&quot;
  Normal  ProvisioningSucceeded  7m               nfs.csi.k8s.io_kadmin_1c28f3c9-91ee-4aa0-b991-8c17c46133d3  Successfully provisioned volume pvc-b8317d7b-dc35-4fc3-88e9-ad894ab11d32
</code></pre>
<h3 id="set-quota-for-user-homedir">Set quota for user homedir</h3>
<p>Steps :
- Define posixAccount in the ldap directory service
- Define quota on the nfs server </p>
<p>The user <code>fry</code> has a posixAccount description in the embedded directory service <code>cn=Philip J. Fry,ou=people,dc=planetexpress,dc=com</code></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>objectClass</td>
<td>inetOrgPerson</td>
</tr>
<tr>
<td>cn</td>
<td>Philip J. Fry</td>
</tr>
<tr>
<td>sn</td>
<td>Fry</td>
</tr>
<tr>
<td>description</td>
<td>Human</td>
</tr>
<tr>
<td>displayName</td>
<td>Fry</td>
</tr>
<tr>
<td>employeeType</td>
<td>Delivery boy</td>
</tr>
<tr>
<td>givenName</td>
<td>Philip</td>
</tr>
<tr>
<td>jpegPhoto</td>
<td>JPEG-Photo (429x350 Pixel, 22132 Bytes)</td>
</tr>
<tr>
<td>mail</td>
<td>fry@planetexpress.com</td>
</tr>
<tr>
<td>ou</td>
<td>Delivering Crew</td>
</tr>
<tr>
<td>uid</td>
<td>fry</td>
</tr>
<tr>
<td>userPassword</td>
<td>fry</td>
</tr>
<tr>
<td>uidNumber</td>
<td>1049</td>
</tr>
<tr>
<td>gidNumber</td>
<td>2049</td>
</tr>
<tr>
<td>homeDirectory:</td>
<td>/home/fry</td>
</tr>
</tbody>
</table>
<p>On the nfs server, define a quota for uid <code>fry</code>. In this case, I use <a href="https://www.truenas.com/">truenas</a> as nfs server.</p>
<p>Create the <code>fry</code> user with the same attribute and value.</p>
<p>On the <code>Storage |Pools |User Quotas</code>, define a quota for the user <code>fry</code></p>
<p><img alt="storageclass-nfs-quota-fry-quota-create" src="../img/storageclass-nfs-quota-fry-quota-create.png" /></p>
<p>Set the quota value for <code>fry</code></p>
<p><img alt="storageclass-nfs-quota-fry" src="../img/storageclass-nfs-quota-fry.png" /></p>
<h3 id="login-to-your-abcdesktop-service_1">Login to your abcdesktop service</h3>
<p>Delete previous <code>pvc</code> and <code>pv</code> for the <code>fry</code> user, if need.</p>
<p>Login as user (<code>Philip J. Fry</code>, <code>fry</code>)</p>
<p><img alt="Login to your abcdesktop service as fry" src="../img/storageclass-nfs-login-fry.png" /></p>
<p>The new desktop for <code>Philip J. Fry</code> is created.</p>
<p>Start the web shell command using the search bar </p>
<p><img alt="desktop as fry" src="../img/storageclass-nfs-desktop.png" /></p>
<p>Using the web shell application start the dd commands </p>
<p><img alt="df as fry" src="../img/storageclass-nfs-quota-fry-over.png" /></p>
<p>Run a <code>dd</code> command to reach the quota value (50 MiB is this case).</p>
<pre><code>dd if=/dev/urandom of=quota-test-file
dd: writing to 'quota-test-file': Disk quota exceeded
1127945+0 records in
1127944+0 records out
577507328 bytes (578 MB, 551 MiB) copied, 14.6404 s, 39.4 MB/s
</code></pre>
<p>You should get the error <code>Disk quota exceeded</code>. 
The size of quota-test-file is over a the quota limit.</p>
<blockquote>
<p>50 MB is 52,428,800 Bytes</p>
</blockquote>
<pre><code>ls -la quota-test-file 
-rw-r----- 1 fry fry 58720256 Aug 25 15:16 quota-test-file
</code></pre>
<p>The user should not be able to create new file </p>
<pre><code>dd if=/dev/zero of=quota-test-file2
dd: failed to open 'quota-test-file2': Disk quota exceeded
</code></pre>
<p>The nfs server has returned an error if the user tries to create more than 50 MiB. </p>
<h2 id="define-persistentvolumeclaim-using-k8s-csi-s3">Define persistentVolumeClaim using <code>k8s-csi-s3</code></h2>
<p>In this example, we use s3 to share user home directory with each worker node</p>
<p>Use the <code>https://github.com/yandex-cloud/k8s-csi-s3</code> as a <code>CSI for S3</code> with <a href="https://min.io/">minio</a> as backend. </p>
<p>Follow <code>https://github.com/yandex-cloud/k8s-csi-s3</code> setup guide and test with the sample pod to make sure that fuse mounts the S3 file system.  </p>
<h3 id="update-storageclassyaml-file">Update storageclass.yaml file</h3>
<pre><code>---
kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: csi-s3
provisioner: ru.yandex.s3.csi
parameters:
  mounter: geesefs 
  # you can set mount options here, for example limit memory cache size (recommended)
  options: &quot;--memory-limit 1000 --dir-mode 0777 --file-mode 0666 --setuid 0&quot;
  # to use an existing bucket, specify it here:
  # bucket: abcdesktop
  csi.storage.k8s.io/provisioner-secret-name: csi-s3-secret
  csi.storage.k8s.io/provisioner-secret-namespace: kube-system
  csi.storage.k8s.io/controller-publish-secret-name: csi-s3-secret
  csi.storage.k8s.io/controller-publish-secret-namespace: kube-system
  csi.storage.k8s.io/node-stage-secret-name: csi-s3-secret
  csi.storage.k8s.io/node-stage-secret-namespace: kube-system
  csi.storage.k8s.io/node-publish-secret-name: csi-s3-secret
  csi.storage.k8s.io/node-publish-secret-namespace: kube-system
</code></pre>
<p>Update the <code>csi-s3</code> storage class to add <code>--setuid 0</code> as options</p>
<pre><code class="language-bash">kubectl delete sc csi-s3
kubectl create -f storageclass.yaml
</code></pre>
<h3 id="update-odconfig">Update <code>od.config</code></h3>
<p>In your od.config file, define the entry <code>desktop.persistentvolumeclaimspec</code></p>
<ul>
<li><code>desktop.homedirectorytype</code>: 'persistentVolumeClaim' to use the persistentVolumeClaim features.</li>
<li><code>desktop.persistentvolumespec</code>: None to skip the persistent volume provisioning.</li>
<li><code>desktop.persistentvolumeclaimspec</code> create a new volume claim for the user's homeDir, the storageClassName <code>csi-s3</code></li>
</ul>
<pre><code class="language-json"># set to persistentVolumeClaim
desktop.homedirectorytype: 'persistentVolumeClaim'
desktop.persistentvolumespec: None
desktop.persistentvolumeclaimspec: {
            'storageClassName': 'csi-s3',
            'resources': { 
              'requests': { 
                'storage': '1Gi'
              } 
            },
            'accessModes': [ 'ReadWriteOnce' ] }
</code></pre>
<h3 id="init-command-options-has-no-file-permissions-support">init command options has no file permissions support</h3>
<p>By default the storageclass use <code>mounter: geesefs</code>. <code>geesefs</code> does not store file permissions and the init commands <code>chown</code> or <code>chmod</code> exit with no zero value, then the pod does not start.
All files belongs to <code>root</code>, but with correct permissions <code>options: "--memory-limit 1000 --dir-mode 0777 --file-mode 0666 --setuid 0"</code>. </p>
<p>Update the 'init' in <code>desktop.pod</code> dict </p>
<pre><code class="language-json">'init': { 
    'image': 'busybox',
    'enable': True,
    'pullpolicy':  'IfNotPresent',
    'securityContext': {
        'runAsUser':   0,
        'runAsGroup':  0 
    },
    'acl':  { 'permit': [ 'all' ] },
    'command':  [ 'sh', '-c',  'chown {{ uidNumber }}:{{ gidNumber }} ~ || true &amp;&amp; chmod 750 ~ || true' ] 
  }
</code></pre>
<p>Apply the new configuration file and restart pyos pods</p>
<pre><code class="language-bash">kubectl delete configmap abcdesktop-config -n abcdesktop
kubectl create configmap abcdesktop-config --from-file=od.config -n abcdesktop
kubectl delete pods -l run=pyos-od -n abcdesktop
</code></pre>
<p>Login to abcdestkop service using your web browser.</p>
<p>List the persistent volumes</p>
<pre><code>kubectl get pv
NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                             STORAGECLASS               REASON   AGE
pvc-81a65ed9-b98e-462c-86c6-36c89c3d4f1b   1Gi        RWO            Delete           Bound    abcdesktop/github-12896316-96cb5                  csi-s3                              2m46s
</code></pre>
<p>List the persistent volume claims </p>
<pre><code># kubectl get pvc -n abcdesktop
NAME                                   STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS               AGE
github-12896316-96cb5                  Bound    pvc-81a65ed9-b98e-462c-86c6-36c89c3d4f1b   1Gi        RWO            csi-s3                     2m21s
</code></pre>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.action.edit", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>