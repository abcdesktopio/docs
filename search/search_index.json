{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"abcdesktop.io is a desktopless system","text":"<p>abcdesktop.io is a cloud native desktopless system and a complete work environment accessible from a simple HTML 5 web browser, without any installation. Like serverless does, desktopless computing allocates desktop resources on demand.  Each user\u2019s application runs as a container to reduce attack surface.</p>  <p>abcdeskop.io is an open source and free solution that offer seamless access to secure desktops and applications on any device, follow the https://github.com/abcdesktopio links.</p> <p>This flexible working environment simplifies usage like</p> <ul> <li>Telecommuting</li> <li>Remote virtual desktop </li> <li>Give temporary access to other contractors or guests</li> <li>Training  </li> <li>BYOD, Bring Your Own Device</li> <li>Desktop On Demand, Desktop as a service</li> </ul>"},{"location":"#quick-online-preview","title":"Quick online preview","text":"<p>You can discover abcdesktop.io desktopless services on the demo website. https://demo.abcdesktop.io instance is a quick example to illustrate how the abcdesktop.io project works. Your desktopless is ready to run for 10 minutes, and will be terminated by the garbage collector after 10 minutes. It requires an OpenID Connect provider to sign-in like (Google, Facebook, Github). The security policy for Internet network prevents requests from your abcdesktop being allowed. Printer service (using cups) and sound service (using pulseaudio) inside the kubernetes pods are enabled.</p> <p>To reach the demo website, follow the link https://demo.abcdesktop.io</p>"},{"location":"#abcdesktopio-a-docker-vdi-service","title":"abcdesktop.io:\u00a0a docker VDI service","text":"<p>abcdesktop.io provides a way to run graphics software securely isolated in a docker container, and use a web browser HTML5 as display device. Because docker containers are lightweight and run without the extra load of an operating system, you can run many graphical applications on a single kernel or even on a kubernetes cluster.</p>"},{"location":"#quick-installation-for-kubernetes","title":"Quick installation for kubernetes","text":"<p>You can watch the youtube video sample. This video describes the Quick installation process.</p>   <p>Download and extract the latest release automatically (Linux or macOS) or read the step by step installation process abcdesktop for kubernetes</p> <pre><code>curl -sL https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/install.sh | sh -\n</code></pre>"},{"location":"#quick-installation-for-docker-personal-use-non-cluster-mode","title":"Quick installation for docker (personal use, Non-cluster mode)","text":"<p>You can watch the youtube video sample. This video describes the Quick installation process.</p>   <p>Download and extract the latest release automatically (Linux or macOS) or read the step by step installation process abcdesktop for docker</p> <pre><code>curl -L https://raw.githubusercontent.com/abcdesktopio/conf/main/docker/install.sh | sh -\n</code></pre>"},{"location":"#features","title":"Features","text":"<ul> <li>Complete native cloud desktop, workspace environment</li> <li>Authentification OAuth 2.0, LDAP, LDAPS, Active Directory, Kerberos</li> <li>Access to the user home directory (homeDirectory support in Active Directory)</li> <li>Legacy CIFS FlexVolume using kubernetes driver </li> <li>All applications run inside an isolated docker container</li> <li>Local and remote printing support </li> <li>Off-line sessions are maintained</li> <li>No need to install applications any more</li> <li>Application update, run latest docker image</li> <li>Accounting and reporting (Graylog, Prometheus Grafana)</li> <li>Clipboard syncing</li> <li>Sound support with Janus WebRTC Gateway and RTP stream</li> </ul>"},{"location":"#applications","title":"Applications","text":"<ul> <li>Native support GNU/Linux console native support</li> <li>Native support GNU/Linux X11 applications native support</li> <li>Support Microsoft Windows applications using wine</li> </ul>"},{"location":"#supported-web-browser-html","title":"Supported web browser HTML","text":"<p>abcdesktop.io uses many modern web technologies. However these are the minimum versions we are currently aware of:</p> <ul> <li>Chrome 49, </li> <li>Firefox 58, </li> <li>Safari 11, </li> <li>Opera 36,  </li> <li>Microsoft Edge (based on Chromium)</li> </ul>"},{"location":"#copy-and-paste-features","title":"copy and paste features","text":"<p>To fully use <code>copy and paste</code> features, from your local device to your abcdesktop (and vice versa), choose <code>Chrome</code>, Chromium or  Microsoft Edge Chromium. The <code>copy and paste</code> feature is also supported on Firefox with a dedicated abcdesktop extension.</p>    Web browser Clipboard sync     Chrome Yes, built in support   Chromium Yes, built in support   Microsoft Edge Chromium Yes, built in support   Firefox Yes, install the dedicated abcdesktop extension   Safari No, the clipboard access is not allowed by the user agent or the platform in the current context, possibly because the user denied permission"},{"location":"#not-supported-web-browser","title":"Not supported web browser","text":"<p>abcdesktop.io does NOT support Microsoft Internet Explorer from version 1.x to 11.x. If you need a Microsoft web browser use Microsoft Edge. Edge is based on the Chromium open-source project. Chromium forms the basis of Google Chrome, so the new Edge feels very similar to Google Chrome.</p>"},{"location":"#release-history","title":"Release history","text":"Release Status Date Requirements Applications \u00a0Documentation     1.1 stable 09/15/2021 dockerd for personnal use and kubernetes An application is a docker container Ready   2.9 Release candidate 9 29/08/2022 require kubernetes &lt; 1.24 and dockerd as container engine An application is a pod or a docker container Started   3.0 Beta 09/03/2022 kubernetes &gt;= 1.24, all container engine An application is a pod or an ephemeral container Started"},{"location":"#github-repositories","title":"Github repositories","text":"<p>abcdesktop has 36 repositories available. Follow the code on GitHub https://github.com/abcdesktopio to get the source code.</p>"},{"location":"applicationsformat/","title":"Application image format","text":"<p>abcdesktop.io uses OCI container image format and add some labels to describe the application. Labels add metadata to the container image.</p>"},{"location":"applicationsformat/#requirements","title":"Requirements","text":"<ul> <li>A running container enegine (like dockerd) </li> <li>An access to the docker public registry</li> </ul>"},{"location":"applicationsformat/#labels","title":"Labels","text":"<p>Docker images applications for abcdesktop use docker's LABELS as metadata. To select only abcdesktop applications from standard docker images, all abcdesktop's applications must have a label 'oc.type' set to the value 'app'.</p> <pre><code>LABEL oc.type=app\n</code></pre>"},{"location":"applicationsformat/#label-descriptions","title":"Label descriptions","text":"Label name Type Description Sample     <code>oc.icon</code> string icon filename use by the web interface for the application, MUST suffix in .svg format writer.svg   <code>oc.icondata</code> string icon file SVG data uuencoded PD94b...C9zdmc+Cg==   <code>oc.keyword</code> string keywords use by the web application search engine separated by comma(,) firefox,mozilla,web,internet   <code>oc.desktopfile</code> string .desktop gnome file name /usr/share/applications/firefox.desktop   <code>oc.cat</code> string category use by the web application store, choose one value of the default list <code>[ 'office', 'games', 'graphics', 'development', 'utilities', 'education'  ]</code> office   <code>oc.launch</code> string X11 Windows Class name. It MUST be unique use the command 'wmctrl -lx' to can the right name    <code>oc.template</code> string Template name to use FROM in the DockerFile oc.template.gtk.firefox   <code>oc.path</code> string Path to the application binary /usr/bin/firefox   <code>oc.args</code> string arguments added to the command --open   <code>oc.name</code> string Name of the application Firefox   <code>oc.displayname</code> string Display Name show by Web interface Firefox   <code>oc.type</code> string Always set to the value 'app' app   <code>oc.mimetype</code> string MimeType supported by the application separated by semicolon(;) text/html;text/xml;application/xml;application/rss+xml;video/webm   <code>oc.showinview</code> string Set to the dock to add this app in dock dock   <code>oc.fileextensions</code> string Supported extensions file, separated by semicolon(;) htm;html;xml;gif   <code>oc.legacyfileextensions</code> string Legacy file extensions, separated by semicolon(;) htm;html;xml   <code>oc.host_config</code> dict dictionary of resources (see resources details) { 'shm_size': '1g' }    <p>Example for Firefox application</p> <pre><code>LABEL oc.icon=\"firefox.svg\"\nLABEL oc.keyword=\"firefox,mozilla,internet\"\nLABEL oc.cat=\"office\"\nLABEL oc.launch=\"Navigator.Firefox\"\nLABEL oc.template=\"oc.template.gtk.firefox\"\nLABEL oc.name=\"Firefox\"\nLABEL oc.displayname=\"Firefox\"\nLABEL oc.path=\"/usr/bin/firefox\"\nLABEL oc.type=app\nLABEL oc.showinview=\"dock\"\nLABEL oc.mimetype=\"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml\"\nLABEL oc.fileextensions=\"html;xml;gif\"\nLABEL oc.legacyfileextensions=\"html;xml\"\n</code></pre>"},{"location":"applicationsformat/#host_config-resource-description","title":"host_config resource description","text":"<p><code>host_config</code> resource description allows to change the running context for docker application. <code>host_config</code> is a dictionary and uses the same format in <code>applist.json</code> file and <code>od.config</code> file.</p> <p>For example you can set low cpu and memory values to an application like the great X11 xeyes.</p> <pre><code>{   \n    \"mem_limit\":  \"32M\", \n    \"cpu_period\":  50000, \n    \"cpu_quota\":   50000, \n    \"pid_mode\":   false, \n    \"network_mode\": \"none\" \n}\n</code></pre> <p>Read the dedicated chapter for resource description, to get more informations on host_config</p>"},{"location":"applicationsformat/#inspect-an-abcdesktop-docker-images","title":"Inspect an abcdesktop docker images","text":"<p>To download an abcdesktop docker image, run the command</p> <pre><code>docker pull abcdesktopio/firefox.d\n</code></pre> <p>To inspect the labels in the docker image, run docker inspect</p> <pre><code>docker inspect abcdesktopio/firefox.d:latest\n</code></pre> <p>Read the labels section :</p> <pre><code>\"Labels\": {\n                \"architecture\": \"x86_64\",\n                \"oc.cat\": \"office\",\n                \"oc.desktopfile\": \"firefox.desktop\",\n                \"oc.displayname\": \"Firefox\",\n                \"oc.fileextensions\": \"htm;html;xml;gif\",\n                \"oc.icon\": \"firefox.svg\",\n                \"oc.icondata\": \"PD94b.. CUT HERE ...C9zdmc+Cg==\",\n                \"oc.keyword\": \"firefox,mozilla,web,internet\",\n                \"oc.launch\": \"Navigator.Firefox\",\n                \"oc.legacyfileextensions\": \"htm;html;xml\",\n                \"oc.mimetype\": \"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;x-scheme-handler/http;x-scheme-handler/https;x-scheme-handler/ftp;video/webm;application/x-xpinstall;\",\n                \"oc.name\": \"Firefox\",\n                \"oc.path\": \"/usr/bin/firefox\",\n                \"oc.showinview\": \"dock\",\n                \"oc.template\": \"oc.template.gtk.firefox\",\n                \"oc.type\": \"app\",\n                \"oc.usedefaultapplication\": \"true\",\n                \"release\": \"5\",\n                \"vcs-ref\": \"master\",\n                \"vcs-type\": \"git\",\n                \"version\": \"1.2\"\n }\n</code></pre>"},{"location":"applicationsformat/#the-inheritance-of-the-images","title":"The inheritance of the images","text":"<p>All abcdesktop applications use by default the oc.template.gtk images name. </p>"},{"location":"applicationsformat/#the-inheritance-of-the-classes","title":"The inheritance of the classes.","text":"<p>By default, <code>oc.templace.gtk</code> is the main image for all applications.  For example <code>oc.template.gtk.firefox</code> use the <code>oc.template.gtk</code> image. <code>oc.template.gtk.firefox.acme</code> use the <code>oc.template.gtk.firefox</code>.  </p> <ul> <li>The <code>oc.template.gtk.firefox</code> contains the Mozilla Firefox application.</li> <li>The <code>oc.template.gtk.firefox.acme</code> may contain custom set for Mozilla Firefox application, like Root CA, proxy values or policy.json files for the acme.</li> </ul> <pre><code>+------------------------------+\n|oc.template.gtk.firefox.acme  |\n+---------------+--------------+\n                |\n                |\n+---------------+--------------+\n|oc.template.gtk.firefox       |\n+---------------+--------------+\n                |\n                |\n+---------------+--------------+\n|oc.template.gtk               |\n+---------------+--------------+\n</code></pre>"},{"location":"architecture/","title":"Architecture in docker mode","text":""},{"location":"architecture/#abcdesktop-workflow-with-ldap-auth","title":"abcdesktop workflow (with LDAP Auth)","text":"<ol> <li>User login, get a user JWT</li> <li>Create a user POD (or a container) and retrieve a Desktop JWT</li> <li> <p>Run, the user is connected to his own POD (or container)</p> <ul> <li>All JWT are signed with RSA keys. </li> <li>All JWT payload are encrypted with RSA keys</li> </ul> </li> </ol>"},{"location":"architecture/#services-infrastructure","title":"Services Infrastructure","text":"<p>The service infrastructure is based on :</p> <ul> <li>WebServer Nginx container</li> <li>Database service MongoDB</li> <li>Memcached service Memcached</li> <li>Pyos Core service (abcdesktop engine) Pyos</li> </ul> <p>The user creates a pod user</p>"},{"location":"architecture/#roles-summary","title":"Roles summary","text":""},{"location":"architecture/#pyos","title":"pyos","text":"<p><code>pyos</code> is the core abcdesktop service act as a control plane. Pyos is a stateless services, Pyos's roles are :</p> <ul> <li>Authenticate user on authenticate providers</li> <li>OAuth 2.0 Provider : Google, Facebook, Orange</li> <li>LDAP and LDAPS</li> <li>Active Directory</li> <li>Start/Stop user container in docker mode and Pod in Kubernetes mode </li> <li>Start/Stop application container</li> </ul> <p>When a new user is authenticated, a dedicated user container is created.  When the user starts an application (like LibreOffice for example) a dedicated application container is created.</p>"},{"location":"architecture/#nginx","title":"nginx","text":"<p><code>nginx</code> container act as web server and websocket reverse proxy. </p>"},{"location":"architecture/#mongo","title":"mongo","text":"<p><code>mongo</code> is used by pyos to store user profil informations.  The profil informations are :</p> <ul> <li>Login history</li> <li>Dock configuration</li> <li>Image and background colors configuration </li> </ul>"},{"location":"architecture/#memcached","title":"memcached","text":"<p><code>memcache</code> is use to store progress text message information during login process. <code>memcache</code> datas are set and get only by the control plane.</p>"},{"location":"architecture/#ocuser","title":"oc.user","text":"<p><code>oc.user</code> is the name of the user's container image. <code>oc.user</code> runs the X11 graphical service. <code>oc.user</code> is based on ubuntu distribution. </p> <ul> <li>The <code>abcdesktopio/oc.user.18.04</code> is based on ubuntu distribution <code>18.04</code></li> <li>The <code>abcdesktopio/oc.user.20.04</code> is based on ubuntu distribution <code>20.04</code></li> </ul>"},{"location":"architecture/#applications","title":"applications","text":"<p>All applications are containers or pods, and share a graphical socket with the user's container </p>"},{"location":"buildapplications.wine/","title":"Build abcdesktop docker image for Microsoft Windows using Wine","text":""},{"location":"buildapplications.wine/#requirements","title":"Requirements","text":"<ul> <li>Read the chapter Edit your configuration file in docker mode is mandatory</li> <li>Read the chapter Build abcdesktop docker image is mandatory.</li> <li>A running dockerd last version </li> <li>An access to the docker public registry</li> <li>An access to the ubuntu repository</li> <li>Nodejs installed on your host.</li> </ul> <p>abcdesktop can run Microsoft Windows applications using Wine.</p>"},{"location":"buildapplications.wine/#wine-embedded-in-octemplategtkwine-image","title":"wine embedded in <code>oc.template.gtk.wine</code> image","text":"<p>To run Windows applications abcdesktop use wine. A dedicated image template source is ready to use as source of others Windows applications. This template is named <code>abcdesktopio/oc.template.gtk.wine.</code></p> <p>Start pulling this template image, if you don't have already done in the previous exercice : </p> <pre><code>docker pull abcdesktopio/oc.template.gtk.wine\n</code></pre> <p>This image embeded the architecture format <code>win32</code> <code>win64</code>. By default the <code>WINEARCH</code> is set to <code>win32</code>. The <code>playonlinux</code> package is all ready installed.</p>"},{"location":"buildapplications.wine/#change-the-odconfig-configuration-file","title":"Change the od.config configuration file","text":""},{"location":"buildapplications.wine/#the-homedirectorytype-option","title":"The <code>homedirectorytype</code> option","text":"<p>To share the home directory <code>/home/balloon</code>volume data between containers, set the <code>desktop.homedirectorytype</code> to <code>'volume'</code> in your od.config file.</p> <p>Edit your own <code>od.config</code> file as described in the chapter Edit your configuration file in docker mode, and make sure that <code>desktop.homedirectorytype</code> is set to <code>'volume'</code></p> <pre><code>desktop.homedirectorytype: 'volume' \n</code></pre> <p>If need, run the <code>docker-compose restart</code> command in your abcdesktop directory where the <code>od.config</code> and the <code>docker-compose.yml</code> are located. </p> <pre><code>docker-compose restart\n</code></pre>"},{"location":"buildapplications.wine/#build-a-new-windows-putty-inside-a-docker-container","title":"Build a new windows putty inside a docker container","text":"<p>In this exercice we are going to install and run putty.exe for Windows inside a docker container for abcdesktop.</p>  <p>PuTTY is an SSH and telnet client, developed originally by Simon Tatham for the Microsoft Windows platform. </p> <p>Start an abcdesktop session. You can use an authenticated session using an authentication provider <code>external</code> or <code>explicit</code>, or you can do this exercice using Anonymous Authentification also know as the authentication provider <code>implicit</code>.</p>  <p>In this exercice we choose an Anonymous authentification, DO NOT CLOSE YOUR WEB BROWSER, you should not be able de reconnect with the same user context, and have to restart this exercice again.</p>   <p>Login using the <code>Anonymous</code> authentification provider.</p>  <p>Click on the menu and choose settings options</p>  <p>On the <code>Settings</code> dialog box, choose <code>System</code> option</p>  <p>Choose the <code>User container</code> tabs, and select the <code>hostname</code> value. </p>  <p>Copy this value into your clipboard. The hostname use the docker <code>containerid</code> value.</p> <p>Keep your web browser open, and open a terminal shell on your server, to run docker shell commmand. </p> <p>Run the <code>docker inspect -f \"{{ .HostConfig.Binds }}\"</code> and add your <code>CONTAINER ID</code> as parameter.</p> <pre><code>CONTAINER_ID=5719b77d3f2a\ndocker inspect -f \"{{ .HostConfig.Binds }}\" $CONTAINER_ID\n</code></pre> <p>where CONTAINER_ID is your own <code>containerid</code> value.</p> <p>For example</p> <pre><code>docker inspect -f \"{{ .HostConfig.Binds }}\" 5719b77d3f2a\n</code></pre> <p>You should read the volume name starting by the prefix <code>tmp-</code> with your uuid value, and a second volume name starting by the prefix <code>home-</code> with your uuid:</p> <pre><code>[tmp-57be1e5b-0b14-4c05-ae79-75e9a03c77be:/tmp home-57be1e5b-0b14-4c05-ae79-75e9a03c77be:/home/balloon]\n</code></pre> <p>We are using the <code>/tmp</code> volume and the <code>/home/balloon</code> volume of your container.</p>  <p>If your are using an anonymous authentification, the name of your container id is formated as an uuid, for example <code>a32deda7-324f-4ee4-9e51-51c1aaf66bcf</code>. The name of the <code>tmp</code> volume is  <code>tmp-a32deda7-324f-4ee4-9e51-51c1aaf66bcf</code> and the name of <code>tmp</code> volume is  <code>home-a32deda7-324f-4ee4-9e51-51c1aaf66bcf</code> </p> <p>If your are using an LDAP authentification, the name of your container id is a string equal to the username, for example <code>hermes</code>. The name of the <code>tmp</code> volume is  <code>tmp-hermes</code>  and the name of <code>tmp</code> volume is  <code>home-hermes</code>.</p>  <p>Replace in the command the string <code>TMP_VOLUMENAME</code> by your own tmp volume name. </p> <p>Replace in the command the string <code>HOME_VOLUMENAME</code> by your own home volume name. </p> <pre><code>docker run -it -v TMP_VOLUMENAME:/tmp  -v HOME_VOLUMENAME:/home/balloon --user balloon abcdesktopio/oc.template.gtk.wine bash\n</code></pre> <p>For example with an anonymous user:</p> <pre><code>docker run -it -v tmp-a32deda7-324f-4ee4-9e51-51c1aaf66bcf:/tmp -v home-a32deda7-324f-4ee4-9e51-51c1aaf66bcf:/home/balloon --user balloon abcdesktopio/oc.template.gtk.wine bash \n</code></pre> <p>Great, you have started a new docker container. The oc.user container and your new container is sharing the same volume mounted as <code>/tmp</code>. You get a prompt inside the new docker container.</p> <pre><code>To run a command as administrator (user \"root\"), use \"sudo &lt;command&gt;\".\nSee \"man sudo_root\" for details.\n\nballoon@721263d5dece:~$ \n</code></pre> <p>Init the wine directory </p> <pre><code>wineboot --init\n</code></pre> <p>After few seconds you should read on the standard error</p> <pre><code>0014:err:ole:marshal_object couldn't get IPSFactory buffer for interface {00000131-0000-0000-c000-000000000046}\n0014:err:ole:marshal_object couldn't get IPSFactory buffer for interface {6d5140c1-7436-11ce-8034-00aa006009fa}\n0014:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hres=0x80004002\n0014:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, 80004002\n0014:err:ole:get_local_server_stream Failed: 80004002\n0012:err:ole:marshal_object couldn't get IPSFactory buffer for interface {00000131-0000-0000-c000-000000000046}\n0012:err:ole:marshal_object couldn't get IPSFactory buffer for interface {6d5140c1-7436-11ce-8034-00aa006009fa}\n0012:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hres=0x80004002\n0012:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, 80004002\n0012:err:ole:get_local_server_stream Failed: 80004002\nCould not find Wine Gecko. HTML rendering will be disabled.\nCould not find Wine Gecko. HTML rendering will be disabled.\nwine: configuration in L\"/composer/.wine\" has been updated.\n</code></pre> <p>And now download putty.exe from the web site https://www.putty.org/. </p>  <p>In this example, we use the 64 bits binary format</p>  <pre><code>balloon@8e48719ae72f:~$ wget https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe\n</code></pre> <p>Start the <code>putty.exe</code> with wine, with the command <code>wine putty.exe</code></p> <pre><code>balloon@5719b77d3f2a:~$ wine putty.exe\n</code></pre> <p>After few seconds you should read on the standard error</p> <pre><code>0009:err:winediag:SECUR32_initNTLMSP ntlm_auth was not found or is outdated. Make sure that ntlm_auth &gt;= 3.0.25 is in your path. Usually, you can find it in the winbind package of your distribution.\n</code></pre> <p>The wine prefix is <code>WINEPREFIX=/composer/.wine</code>, all files used by wine are stored in <code>/composer/.wine</code> directory.</p> <p>On abcdesktop display, wine is starting the application putty, after few seconds, Putty is running :</p>  <p>You can use this Putty Windows application to connect to another host using <code>ssh</code> or <code>telnet</code> protocol. </p> <p>The application Putty is opened and is running in the background.  At the right corner, write in the search bar the keyword <code>shell</code> Click on the <code>Web Shell</code> icon, a new Terminal WebShell is now opened :</p>  <p>Run the command to list each X11 windows and get the WMClass name.</p> <pre><code>wmctrl -lx \n</code></pre>  <p>Read the WM_CLASS of the Putty Wine application: <code>putty.exe.Wine</code></p> <p>Then exit the <code>web shell</code> and quit on the Putty application.  Wine has created a configuration directory in the default directory <code>/composer/.wine</code>. </p>"},{"location":"buildapplications.wine/#build-the-new-puttyd-image-for-abcdesktop","title":"Build the new putty.d image for abcdesktop","text":"<p>In this chapter we are going to build a new docker image for abcdesktop</p>  <p>The new image is the putty. </p> <p>Create a directory named <code>build</code>, and create a directory <code>icons</code> inside build</p> <pre><code>mkdir build\nmkdir build/icons\ncd build\n</code></pre> <p>To build your own json file.</p> <p>Create a json file named <code>applist.json</code>, inside build directory, and add the content to the json file.</p> <pre><code>[\n{\n    \"template\": \"abcdesktopio/oc.template.gtk.wine\",\n    \"preruncommands\": [ \n        \"ENV WINEARCH=win64\",\n        \"USER $BUSER\",\n        \"RUN wineboot --init\",\n        \"RUN wget -O /composer/bin/putty.exe https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe\",\n        \"RUN echo disable &gt; $WINEPREFIX/.update-timestamp\" ],\n    \"args\": \"/composer/bin/putty.exe\",\n    \"cat\": \"utilities\",\n    \"debpackage\": \"\",\n    \"icon\": \"putty.svg\",\n    \"keyword\": \"putty,ssh,terminal\",\n    \"launch\": \"putty.exe.Wine\",\n    \"name\": \"putty-wine\",\n    \"displayname\": \"Putty Wine\",\n    \"path\": \"/usr/bin/wine\"\n}\n]\n</code></pre> <p>To fill the data inside the json file :</p>    name Type Data     <code>cat</code> string utilities   <code>icon</code> string putty.svg   <code>keyword</code> string putty,ssh,terminal   <code>launch</code> string putty.exe.Wine   <code>name</code> string putty   <code>path</code> string /usr/bin/wine   <code>args</code> string /composer/bin/putty.exe   <code>template</code> string abcdesktopio/oc.template.gtk.wine    <p>You can read the following help lines.</p> <ul> <li><code>cat</code> is the category, choose the most appropriate value in the list :             <code>[ 'office', 'games', 'graphics', 'development', 'utilities', 'education' ]</code></li> <li><code>icon</code> is the name of the icon. abcdesktop support only <code>svg</code> icon file format. To get the icon file, look at the link https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/icons/putty.svg</li> <li><code>keyword</code> is a list of the keywords to find the application. Set the value to <code>putty,ssh,terminal</code>.</li> <li><code>launch</code>  is the X11 Class name of the window. To get this value, we need to run the application on GNU/Linux (read the dedicated chapter below). </li> <li><code>name</code> is the name of the application. Set the value to putty.</li> <li><code>path</code> is the binary path to run the application.   </li> <li><code>template</code> is the name of the parent image. The default image parent for wine is <code>abcdesktopio/oc.template.gtk.wine</code>. </li> </ul> <p>Save the putty icon file on SVG format to the icons directory. </p> <pre><code>wget -O icons/putty.svg https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/icons/putty.svg\n</code></pre>"},{"location":"buildapplications.wine/#build-putty-your-from-applistjson","title":"Build putty your from <code>applist.json</code>","text":"<p>To build your new image, download the make.js script file. <code>make.js</code> is located in the <code>oc.apps</code> repository. Look at https://github.com/abcdesktopio/oc.apps if you can not download this file.</p> <p>Save <code>make.js</code> it to you build directory. <code>make.js</code> is a nodejs JavaScript file. Node.js\u00ae is a JavaScript runtime built on Chrome's V8 JavaScript.</p>  <p>If you don't have already nodejs installed on your system, go to the website nodejs download website and follow the instructions to install nodejs.</p>  <pre><code>wget https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/make.js\n</code></pre> <p>In the build directory, you should have </p> <pre><code>drwxr-xr-x   5 devuser  staff   160 Mar 11 15:15 .\ndrwxr-xr-x+ 31 devuser  staff   992 Mar 11 15:15 ..\n-rw-r--r--   1 devuser  staff   497 Mar 11 15:15 applist.json\ndrwxr-xr-x   3 devuser  staff    96 Mar 11 15:02 icons\n-rw-r--r--   1 devuser  staff  6112 Mar 11 15:12 make.js\n\n./icons:\ntotal 8\ndrwxr-xr-x  3 devuser  staff    96 Mar 11 15:02 .\ndrwxr-xr-x  5 devuser  staff   160 Mar 11 15:15 ..\n-rw-r--r--  1 devuser  staff  1909 Oct 31  2015 putty.svg\n</code></pre> <p>Run the command make.js</p> <pre><code>node make.js\n</code></pre> <p><code>make.js</code> build a new DockerFile for <code>putty</code> application. Remember, all application images use container images. </p> <p>You should get the output </p> <pre><code>{\n  template: 'abcdesktopio/oc.template.gtk.wine',\n  preruncommands: [\n    'ENV WINEARCH=win64',\n    'USER $BUSER',\n    'RUN wineboot --init',\n    'RUN echo disable &gt; $WINEPREFIX/.update-timestamp', \n    'RUN wget -O /composer/bin/putty.exe https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe'\n  ],\n  args: '/composer/bin/putty.exe',\n  cat: 'utilities',\n  debpackage: '',\n  icon: 'putty.svg',\n  keyword: 'putty,ssh,terminal',\n  launch: 'putty.exe.Wine',\n  name: 'putty-wine',\n  displayname: 'Putty Wine',\n  path: '/usr/bin/wine'\n}\n</code></pre> <p>The new files <code>putty-wine.d</code> has been generated :</p> <ul> <li><code>putty-wine.d</code> is the Dockerfile for your putty abcdesktop application</li> </ul> <p>Read the content of the Dockerfile <code>putty-wine.d</code>. List all labels, and confirm that the icon file is uuencoded format. Uuencoding is a form of binary-to-text encoding.</p> <p>Now it's time to build your putty app. Run the command <code>docker build</code> command.</p> <pre><code>docker build  --build-arg TAG=latest -f putty-wine.d -t putty-wine.d .\n</code></pre> <p>You should read on the standard ouput</p> <pre><code>[+] Building 21.6s (10/10) FINISHED                                                                                      \n =&gt; [internal] load build definition from putty-wine.d                                                              0.0s\n =&gt; =&gt; transferring dockerfile: 12.46kB                                                                             0.0s\n =&gt; [internal] load .dockerignore                                                                                   0.0s\n =&gt; =&gt; transferring context: 2B                                                                                     0.0s\n =&gt; [internal] load metadata for docker.io/abcdesktopio/oc.template.gtk.wine:dev                                    0.0s\n =&gt; CACHED [1/6] FROM docker.io/abcdesktopio/oc.template.gtk.wine:dev                                               0.0s\n =&gt; [2/6] RUN wineboot --init                                                                                      10.9s\n =&gt; [3/6] RUN wget -O /composer/bin/putty.exe https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe             0.6s \n =&gt; [4/6] RUN  if [ -d /usr/share/icons ];   then cd /usr/share/icons;    /composer/safelinks.sh; fi                9.2s \n =&gt; [5/6] RUN  if [ -d /usr/share/pixmaps ]; then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi                0.4s \n =&gt; [6/6] WORKDIR /home/balloon                                                                                     0.0s \n =&gt; exporting to image                                                                                              0.4s \n =&gt; =&gt; exporting layers                                                                                             0.3s \n =&gt; =&gt; writing image sha256:2cbe019726e67ecb83af74e944ff932705086e632ab4a57dec719be5e7e654cd                        0.0s \n =&gt; =&gt; naming to docker.io/library/putty-wine.d                                                                     0.0s\n</code></pre> <p>Now, your new image is ready to run.</p>"},{"location":"buildapplications.wine/#run-your-putty-for-abcdesktop","title":"Run your putty for abcdesktop","text":"<p>The API server does not know that you have built your new 2048 application. You have to send a message to the API server, to update the API Server images cache list.</p> <p>Using your web browser or a curl command, call a http request to notify the API Server</p> <pre><code>http://localhost/API/manager/buildapplist\n</code></pre> <p>This http request return a json object, with all docker images details :</p>  <p>Reloead your web browser connected on the abcdesktop website, and log your again as anonymous.</p> <p>In the search area, type <code>putty</code>. Click on the <code>Putty</code> Application.</p>  <p>Wine is starting your <code>Putty</code> application :</p>  <p>Great, you have build a abcdesktop image for <code>Putty</code>, build the application image <code>Putty</code>. You can push this image to your own private docker registry.</p>"},{"location":"buildapplications.wine/#optional-add-a-persistant-userreg-and-systemreg-windows-registry-files","title":"Optional add a persistant <code>user.reg</code> and <code>system.reg</code> windows registry files","text":"<p>This is a quick and dirty solution, but it works fine  </p>  <p>Your wine configuration is stored in <code>/composer/.wine</code>, and by default <code>user.reg</code> and <code>system.reg</code> are located in the <code>WINEPREFIX</code> directory. The <code>user.reg</code> and <code>system.reg</code> files build when wine starts. </p> <p>To make a copy of fresh running <code>putty-wine.d</code> image.  Start your <code>putty-wine.d</code> image and using a shell located the new <code>user.reg</code> and <code>system.reg</code> files</p> <pre><code>docker ps -a | grep putty-wine\n65d95f4e7717   putty-wine.d:latest                               \"/composer/appli-doc\u2026\"   16 seconds ago   Up 15 seconds                                                                                                    anonymous-putty-wine-7877d100de0b4363ad24240d67032c8c\n</code></pre> <p>Then copy files using the <code>docker cp</code> command</p> <pre><code>CONTAINERID=65d95f4e7717\ndocker cp $CONTAINERID:/composer/.wine/user.reg .\ndocker cp $CONTAINERID:/composer/.wine/system.reg .\n</code></pre> <p>Add them to your default <code>putty-wine.d</code> image using applist.json file :</p> <pre><code>[\n{\n    \"template\": \"abcdesktopio/oc.template.gtk.wine\",\n    \"preruncommands\": [ \n        \"ENV WINEARCH=win64\",\n        \"USER $BUSER\",\n        \"RUN wineboot --init\",\n        \"RUN wget -O /composer/bin/putty.exe https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe\",\n        \"RUN echo disable &gt; $WINEPREFIX/.update-timestamp\",\n        \"COPY --chown=$BUSER:$BUSER user.reg system.reg /composer/.wine\" ],\n    \"args\": \"/composer/bin/putty.exe\",\n    \"cat\": \"utilities\",\n    \"debpackage\": \"\",\n    \"icon\": \"putty.svg\",\n    \"keyword\": \"putty,ssh,terminal\",\n    \"launch\": \"putty.exe.Wine\",\n    \"name\": \"putty-wine\",\n    \"displayname\": \"Putty Wine\",\n    \"path\": \"/usr/bin/wine\"\n}\n]\n</code></pre> <p>Rebuild your Dockerfile</p> <pre><code>node make.js\n</code></pre> <pre><code>{\n  template: 'abcdesktopio/oc.template.gtk.wine',\n  preruncommands: [\n    'ENV WINEARCH=win64',\n    'USER $BUSER',\n    'RUN wineboot --init',\n    'RUN wget -O /composer/bin/putty.exe https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe',\n    'RUN echo disable &gt; $WINEPREFIX/.update-timestamp',\n    'COPY --chown=$BUSER:$BUSER user.reg system.reg /composer/.wine'\n  ],\n  args: '/composer/bin/putty.exe',\n  cat: 'utilities',\n  debpackage: '',\n  icon: 'putty.svg',\n  keyword: 'putty,ssh,terminal',\n  launch: 'putty.exe.Wine',\n  name: 'putty-wine',\n  displayname: 'Putty Wine',\n  path: '/usr/bin/wine'\n}\nBuilding putty.exe.Wine\n</code></pre> <p>Run the command <code>docker build</code> command.</p> <pre><code>docker build  --build-arg TAG=latest -f putty-wine.d -t putty-wine.d .\n</code></pre> <p>Now your wine keep your registry's updates.</p>"},{"location":"buildapplicationsgnulinux/","title":"Build your own application image","text":"<p>abcdesktop use docker image format with some labels to describe the application.</p>"},{"location":"buildapplicationsgnulinux/#requirements","title":"Requirements","text":"<ul> <li>A running dockerd last version </li> <li>An access to the docker public registry</li> <li>An access to the ubuntu repository</li> <li>Nodejs installed on your host.  </li> <li>The root password of the oc.user docker image. The default password is <code>lmdpocpetit</code>, but this value may have been changed.</li> </ul>"},{"location":"buildapplicationsgnulinux/#build-your-own-application-image_1","title":"Build your own application image","text":"<p>In this chapter we are going to build a new docker image for abcdesktop</p>  <p>The new image is the game 2048. </p> <p>Create a directory named <code>build</code>, and create a directory <code>icons</code> inside build</p> <pre><code>mkdir build\nmkdir build/icons\ncd build\n</code></pre> <p>To build your own image create first a json file.</p> <p>Create a json file named <code>applist.json</code>, inside build directory, and add the content to the json file.</p> <pre><code>[\n  {\n    \"cat\": \"games\",\n    \"debpackage\": \"2048-qt\",\n    \"icon\": \"2048_logo.svg\",\n    \"keyword\": \"2048\",\n    \"launch\": \"2048-qt.2048-qt\",\n    \"name\": \"2048\",\n    \"displayname\": \"2048\",\n    \"path\": \"/usr/games/2048-qt\",\n    \"template\": \"abcdesktopio/oc.template.gtk\"\n  }\n]\n</code></pre> <p>To fill the data inside the json file :</p>    name Type Data     <code>cat</code> string games   <code>debpackage</code> string 2048-qt   <code>icon</code> string 2048_logo.svg   <code>keyword</code> string 2048   <code>launch</code> string 2048-qt.2048-qt   <code>name</code> string 2048   <code>path</code> string /usr/games/2048-qt   <code>template</code> string abcdesktopio/oc.template.gtk    <p>You can read the following help lines, or fill the json missing value by yourself.</p> <ul> <li><code>cat</code> is the category, choose the most appropriate value in the list :             [ 'office', 'games', 'graphics', 'development', 'utilities', 'education' ]</li> <li><code>debpackage</code> is the name of the 2048 ubuntu package. To find the package name, look at the link 2048 Ubuntu Package.</li> <li><code>icon</code> is the name of the icon. abcdesktop support only <code>svg</code> icon file format. To get the icon file, look at the link https://upload.wikimedia.org/wikipedia/commons/1/18/2048_logo.svg</li> <li><code>keyword</code> is a list of the keywords to find the application. Set the value to 2048.</li> <li><code>launch</code>  is the X11 Class name of the window. To get this value, we need to run the application on GNU/Linux (read the dedicated chapter below). </li> <li><code>name</code> is the name of the application. Set the value to 2048.</li> <li><code>path</code> is the binary path to run the application.   </li> <li><code>template</code> is the name of the parent image. The default image parent is <code>abcdesktopio/oc.template.gtk</code>. You will learn how to customize your own template image, in next chapter. </li> </ul> <p>Save the 2048 icon file on SVG format to the icons directory.  You should have this file in the icons directory as the output of the <code>ls icons</code> command :</p> <pre><code>2048_logo.svg\n</code></pre>"},{"location":"buildapplicationsgnulinux/#build-your-new-image-2048","title":"Build your new image 2048","text":"<p>To build your new image, download the make.js script file. <code>make.js</code> is located in the <code>oc.apps</code> repository. Look at https://github.com/abcdesktopio/oc.apps if you can not download this file.</p> <p>Save <code>make.js</code> it to you build directory. <code>make.js</code> is a nodejs JavaScript file. Node.js\u00ae is a JavaScript runtime built on Chrome's V8 JavaScript.</p>  <p>If you don't have already nodejs installed on your system, go to the website nodejs download website and follow the instructions to install nodejs.</p>  <p>In the build directory, you should have </p> <pre><code>drwxr-xr-x   5 devuser  staff   160 Mar 11 15:15 .\ndrwxr-xr-x+ 31 devuser  staff   992 Mar 11 15:15 ..\n-rw-r--r--   1 devuser  staff   265 Mar 11 15:15 applist.json\ndrwxr-xr-x   3 devuser  staff    96 Mar 11 15:02 img\n-rw-r--r--   1 devuser  staff  8036 Mar 11 15:12 make.js\n\n./img:\ntotal 8\ndrwxr-xr-x  3 devuser  staff    96 Mar 11 15:02 .\ndrwxr-xr-x  5 devuser  staff   160 Mar 11 15:15 ..\n-rw-r--r--  1 devuser  staff  1909 Oct 31  2015 2048_logo.svg\n</code></pre> <p>Run the command make.js</p> <pre><code>node make.js\n</code></pre> <p><code>make.js</code> build a new DockerFile for the 2048 application. Remember, all application images use container images. </p> <p>You should get the output </p> <pre><code>{\n  cat: 'games',\n  debpackage: '2048-qt',\n  icon: '2048_logo.svg',\n  keyword: '2048',\n  launch: '2048-qt.2048-qt',\n  name: '2048',\n  displayname: '2048',\n  path: '/usr/games/2048-qt',\n  template: 'abcdesktopio/oc.template.gtk'\n}\nBuilding 2048-qt.2048-qt\n{\n  cat: 'games',\n  debpackage: '2048-qt',\n  icon: '2048_logo.svg',\n  keyword: '2048',\n  launch: '2048-qt.2048-qt',\n  name: '2048',\n  displayname: '2048',\n  path: '/usr/games/2048-qt',\n  template: 'abcdesktopio/oc.template.gtk'\n}\nBuilding documentation 2048-qt.2048-qt\n        - '2048'   : '2048.md'\n</code></pre> <p>The new files <code>2048.d</code> and <code>2048.md</code> have been generated :</p> <ul> <li><code>2048.d</code> is the Dockerfile for your 2048 abcdesktop application</li> <li><code>2048.md</code> is the documentation file for your 2048 abcdesktop application</li> </ul> <p>Read the content of the Dockerfile <code>2048.d</code>. List all labels, and confirm that the icon file is uuencoded format. Uuencoding is a form of binary-to-text encoding.</p> <p>Now it's time to build your 2048 app. Run the command <code>docker build</code> command.</p> <pre><code>docker build  --build-arg TAG=latest -f 2048.d -t 2048.d .\n</code></pre> <p>You should read the output : </p> <pre><code>[+] Building 32.0s (10/10) FINISHED                                                                                                                                                                 \n =&gt; [internal] load build definition from 2048.d                                                                                                                                               0.0s\n =&gt; =&gt; transferring dockerfile: 33B                                                                                                                                                            0.0s\n =&gt; [internal] load .dockerignore                                                                                                                                                              0.0s\n =&gt; =&gt; transferring context: 2B                                                                                                                                                                0.0s\n =&gt; [internal] load metadata for docker.io/abcdesktopio/oc.template.gtk:latest                                                                                                                 1.4s\n =&gt; [1/6] FROM docker.io/abcdesktopio/oc.template.gtk:latest@sha256:f3c98362fb80f5edde423b895422fc183e2728257de1d4352c4f70c7b43835fb                                                           0.4s\n =&gt; =&gt; resolve docker.io/abcdesktopio/oc.template.gtk:latest@sha256:f3c98362fb80f5edde423b895422fc183e2728257de1d4352c4f70c7b43835fb                                                           0.0s\n =&gt; =&gt; sha256:f3c98362fb80f5edde423b895422fc183e2728257de1d4352c4f70c7b43835fb 4.50kB / 4.50kB                                                                                                 0.0s\n =&gt; =&gt; sha256:f3c3f03bd0b5cda9f56703a4ba1b9d96d5ff2be3c03bee1831ce30dc98bb3b62 8.93kB / 8.93kB                                                                                                 0.0s\n =&gt; [2/6] RUN DEBIAN_FRONTEND=noninteractive apt-get update &amp;&amp; apt-get install -y  --no-install-recommends 2048-qt &amp;&amp; apt-get clean                                                           27.5s\n =&gt; [3/6] RUN echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections                                                                                                   0.5s\n =&gt; [4/6] RUN  if [ -d /usr/share/icons ];   then cd /usr/share/icons;    /composer/safelinks.sh; fi                                                                                           0.5s \n =&gt; [5/6] RUN  if [ -d /usr/share/pixmaps ]; then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi                                                                                           0.4s \n =&gt; [6/6] WORKDIR /home/balloon                                                                                                                                                                0.0s \n =&gt; exporting to image                                                                                                                                                                         1.1s \n =&gt; =&gt; exporting layers                                                                                                                                                                        1.1s \n =&gt; =&gt; writing image sha256:a861af06b7f0dfa19fcde19ee8848bfee65807f852b082d9314e68676966895a                                                                                                   0.0s\n =&gt; =&gt; naming to docker.io/library/2048.d\n</code></pre> <p>Check that your image is ready on your system:</p> <p>Run the docker images command </p> <pre><code>docker images\n</code></pre> <p>You should read on the stdout more lines, only 2048.d is listed here :</p> <pre><code>REPOSITORY                           TAG                                                     IMAGE ID       CREATED              SIZE\n2048.d                               latest                                                  a861af06b7f0   About a minute ago   1.17GB\n</code></pre> <p>The total image size of 2048.d is 1.17GB.</p> <p>The 2048.d does not use 1.17GB, but only the difference between the 2048 image and the source image <code>abcdesktopio/oc.template.gtk</code>.</p>"},{"location":"buildapplicationsgnulinux/#update-the-cache-application-list","title":"Update the cache application list","text":"<p>The API server receives a new image event from docker. To run the new applications just refresh you web browser page.</p>"},{"location":"buildapplicationsgnulinux/#run-your-new-application","title":"Run your new application","text":"<p>Return to your abcdesktop website <code>http://localhost</code> and log in as Anonymous.</p> <p>At the right corner, write in the search bar the keyword <code>2048</code></p>  <p>Click on the <code>2048</code> icon, and start your first abcdesktop application :</p>  <p>Great it's a good job, you have build your own abcdesktop 2048 application. </p> <p>Now you can spent a lot of time to reach the 2048 score. Have fun !</p>"},{"location":"buildapplicationsgnulinux/#get-launch-and-path-values","title":"Get <code>launch</code> and <code>path</code> values","text":"<p>To get the X11 class name of the 2048 game, we need to install it on a Linux host. You can use abcdesktop as a Linux host or choose your own.</p> <p>If you want to use abcdesktop as a GNU/Linux host </p> <p>Open the url http://localhost, in your web browser, to start a simple abcdesktop container. You will use this container to install the 2048 application and fill the missing values <code>launch</code> and <code>path</code>.</p> <pre><code>http://localhost\n</code></pre> <p>You should see the abcdesktop.io home page.</p>  <p>Press the <code>Connect with Anonymous access, have look</code></p>  <p>At the right corner, write in the search bar the keyword <code>shell</code></p>  <p>Click on the <code>Web Shell</code> icon, a new Terminal WebShell is now opened :</p>  <p>Run the command </p> <pre><code>sudo apt-get update \n</code></pre>  <p>The default password is <code>lmdpocpetit</code> ( if your admin did not change it, otherwise ask to the administrator )</p>  <p>Run the installation command </p> <pre><code>sudo apt-get install -y 2048-qt \n</code></pre>  <p>You should read the output, during the installation process</p>  <p>On Ubuntu, the games are installed in a dedicated directory <code>/usr/games</code>.</p> <p>Read the file list of the 2048-qt Ubuntu package</p> <pre><code>/usr/games/2048-qt\n/usr/share/applications/2048-qt.desktop\n/usr/share/doc/2048-qt/changelog.Debian.gz\n/usr/share/doc/2048-qt/copyright\n/usr/share/man/man6/2048-qt.6.gz\n/usr/share/menu/2048-qt\n/usr/share/pixmaps/2048-qt.xpm\n</code></pre> <p>Start the 2048 game binary <code>2048-qt</code> in background.</p> <pre><code>/usr/games/2048-qt &amp; \n</code></pre>  <p>The new 2048 window is opening in the background. You can minimise the shell window to play to the 2048 game, but this is not the goal of this chapter. To show the shell window again, click on the shell icon on the upper right corner.</p> <p>Run the command to list each X11 windows and get the WMClass name.</p> <pre><code>wmctrl -lx \n</code></pre> <p><code>wmctrl</code> is a command that can be used to interact with an X Window manager, and can query the window manager for information, and it can request that certain window management actions be taken. </p> <ul> <li><code>-l</code> list the windows being managed by the window manager. </li> <li><code>-x</code> include WM_CLASS in the window list</li> </ul>  <p>Great, look at the third value, this is what we are looking for :</p> <ul> <li>The <code>launch</code> is <code>2048-qt.2048-qt</code></li> <li>The <code>path</code> is <code>/usr/games/2048-qt</code></li> </ul> <p>You can now close your web browser and fill your json file, by yourself</p>"},{"location":"buildapplicationsgnulinux/#gimp","title":"GIMP","text":"<p>The applist.json is a array of application object. Add a new application object in the array, and fill the value for the new application.</p> <p>By yourself, you have to run this exercice again, for the Gimp application. Gimp is Gnu Image Manipulation Program.</p> <p>New applist.json data, and build your own Gimp abcdesktop.io application.</p> <pre><code>[\n  {\n    \"cat\": \"games\",\n    \"debpackage\": \"2048-qt\",\n    \"icon\": \"2048_logo.svg\",\n    \"keyword\": \"2048\",\n    \"launch\": \"2048-qt.2048-qt\",\n    \"name\": \"2048\",\n    \"displayname\": \"2048\",\n    \"path\": \"/usr/games/2048-qt\",\n    \"template\": \"abcdesktopio/oc.template.gtk\"\n  },\n  {\n    \"cat\": \"\",\n    \"debpackage\": \"\",\n    \"icon\": \"\",\n    \"keyword\": \"\",\n    \"launch\": \"t\",\n    \"name\": \"\",\n    \"displayname\": \"\",\n    \"path\": \"\",\n    \"template\": \"\"\n  }\n\n]\n</code></pre> <p>You should get data entries like:</p> <ul> <li>The GIMP icon SVG file is avalaible on wikipedia website The_GIMP_icon_-_gnome.svg</li> <li>The wmctrl show the WM_CLASS <code>gimp.Gimp</code></li> <li>The path is <code>/usr/bin/gimp</code></li> </ul> <pre><code>[\n  {\n    \"cat\": \"games\",\n    \"debpackage\": \"2048-qt\",\n    \"icon\": \"2048_logo.svg\",\n    \"keyword\": \"2048\",\n    \"launch\": \"2048-qt.2048-qt\",\n    \"name\": \"2048\",\n    \"displayname\": \"2048\",\n    \"path\": \"/usr/games/2048-qt\",\n    \"template\": \"abcdesktopio/oc.template.gtk\"\n  },\n  {\n    \"cat\": \"graphics\",\n    \"debpackage\": \"gimp\",\n    \"icon\": \"gimp.svg\",\n    \"keyword\": \"gimp,image,gif,tiff,png,jpeg,bmp,tga,pcx,bitmap,jpg,pixmap\",\n    \"launch\": \"gimp.Gimp\",\n    \"name\": \"Gimp\",\n    \"path\": \"/usr/bin/gimp\",\n    \"template\": \"abcdesktopio/oc.template.gtk\"\n  }\n\n]\n</code></pre>"},{"location":"buildapplicationsgnulinux/#add-mimetype-fileextensions-and-desktopfile-entries","title":"Add MimeType, FileExtensions and desktopfile entries","text":"<p>abcdesktop support MimeType, File Extensions and Desktop Entry Specification entries from Gnome.</p> <pre><code>    \"mimetype\": \"image/bmp;image/g3fax;image/gif;image/x-fits;image/x-pcx;image/x-portable-anymap;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-psd;image/x-sgi;image/x-tga;image/x-xbitmap;image/x-xwindowdump;image/x-xcf;image/x-compressed-xcf;image/x-gimp-gbr;image/x-gimp-pat;image/x-gimp-gih;image/jpeg;image/x-psp;image/png;image/x-icon;image/x-xpixmap;image/x-wmf;image/jp2;image/jpeg2000;image/jpx;image/x-xcursor;\",\n    \"fileextensions\": \"dds\",\n    \"legacyfileextensions\":\"dds\",\n    \"desktopfile\":\"/usr/share/applications/gimp.desktop\"\n</code></pre> <p>These entries allow user to use the file manager choice <code>Open with</code> and <code>Open with Other Application</code></p>  <p>and list <code>Recommended Applications</code></p>  <p>The Gimp Json data shows</p> <pre><code>{\n    \"cat\": \"graphics\",\n    \"debpackage\": \"gimp\",\n    \"icon\": \"gimp.svg\",\n    \"keyword\": \"gimp,image,gif,tiff,png,jpeg,bmp,tga,pcx,bitmap,jpg,pixmap\",\n    \"launch\": \"gimp.Gimp\",\n    \"name\": \"Gimp\",\n    \"path\": \"/usr/bin/gimp\",\n    \"template\": \"abcdesktopio/oc.template.gtk\",\n    \"mimetype\": \"image/bmp;image/g3fax;image/gif;image/x-fits;image/x-pcx;image/x-portable-anymap;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-psd;image/x-sgi;image/x-tga;image/x-xbitmap;image/x-xwindowdump;image/x-xcf;image/x-compressed-xcf;image/x-gimp-gbr;image/x-gimp-pat;image/x-gimp-gih;image/jpeg;image/x-psp;image/png;image/x-icon;image/x-xpixmap;image/x-wmf;image/jp2;image/jpeg2000;image/jpx;image/x-xcursor;\",\n    \"fileextensions\": \"dds\",\n    \"legacyfileextensions\":\"dds\",\n    \"desktopfile\":\"/usr/share/applications/gimp.desktop\"\n}\n</code></pre> <p>Have a look to the complete applist.json file. abcdesktop applist.json contains description to build all default abcdesktop applications. </p>"},{"location":"guiappsoddocker/","title":"GUI application with containers","text":""},{"location":"guiappsoddocker/#other-related-projets-about-vdi-and-containers","title":"Other related projets about VDI and containers","text":"<p>A lot of different projets already exists using containers as a VDI. I just write list of projets, you can explore them :</p> <ul> <li> <p>https://github.com/mviereck/x11docker x11docker allows to run graphical desktop applications (and entire desktops) in Docker Linux containers.</p> </li> <li> <p>https://www.digitalocean.com/community/tutorials/how-to-remotely-access-gui-applications-using-docker-and-caddy-on-ubuntu-18-04 By using noVNC and TigerVNC, you can run native applications inside a Docker container and access them remotely using a web browser. </p> </li> <li> <p>HW accelerated GUI apps on Docker Describe How to containerizing a GUI app. Really easy to understand, a good article.</p> </li> <li> <p>https://github.com/fcwu/docker-ubuntu-vnc-desktop docker-ubuntu-vnc-desktop is a Docker image to provide web VNC interface to access Ubuntu LXDE/LxQT desktop environment.</p> </li> <li> <p>Dockerize GUI app This project dockerize typical GUI app so that you can visit it in browser. Really good technical solutions.</p> </li> <li> <p>https://www.kasmweb.com Streaming containerized apps and desktops.</p> </li> <li> <p>Docker and Wine Docker image that includes Wine and Winetricks for running Windows applications on Linux and macOS </p> </li> <li>n.eko This app uses Web RTC to stream a desktop inside of a docker container (doesn't use VNC) </li> </ul>"},{"location":"guiappsoddocker/#x11-window-system-architecture","title":"X11 window system architecture","text":"<p>In a *nix system a GUI application has the role of \u201cX client\u201d. Each time it redraws its content a sequence of graphics commands is encoded into the X protocol using a library (usually Xlib) and transmitted into the X11 socket. At the other end an X server reads such commands from the socket and renders them onto a display. [ source HW accelerated GUI apps on Docker] </p>"},{"location":"guiappsoddocker/#containerizing-a-gui-app","title":"Containerizing a GUI app","text":"<p>Taking a look at the X window system architecture it\u2019s clear that in order to make our containerized GUI apps capable of drawing on a screen we need to give it write access to the X11 socket, and we need an X server to consume and render the graphics commands onto a display.</p> <p>We can approach this problem from three angles:</p>"},{"location":"guiappsoddocker/#all-in-one-container","title":"All in one container","text":"<ul> <li>we can bundle X11 server with our container image. All process run inside the same container.</li> </ul>"},{"location":"guiappsoddocker/#separated-container","title":"Separated container","text":"<ul> <li> <p>we can share the X11 server socket with the X11 client container as unix file socket on an external shared volume. Applications and X11 server run in dedicated containers.</p> </li> <li> <p>we can share the X11 server socket with the container using TCP. X11 uses TCP as its transport protocol. Applications and X11 server run in dedicated containers.</p> </li> </ul>"},{"location":"guiappsoddocker/#abcdesktop-choices","title":"abcdesktop choices","text":"<p>To guarantee isolation, abcdesktop/io.io run X11 server and X11 client in separated container. X11 server and X11 client share the socket as unix file socket on a dedicated external shared volume.</p> <ul> <li> <p>The unix file socket reduce the network tcp overhead.</p> </li> <li> <p>The unix file socket garantes no latency troubleshooting. X11 uses a chatty protocol so that the network latency has a large impact when using X11</p> </li> </ul> <p>Local is best, thus server and application need to run on the same node, if it can.</p>"},{"location":"guiappsoddocker/#html5-web-browser-as-remote-display","title":"HTML5 Web Browser as remote <code>DISPLAY</code>","text":"<p>The Web Browser does not support X11 protocol. We need a graphical desktop system to paint the virtual <code>DISPLAY</code> in a <code>&lt;canvas&gt;</code> HTML element.</p>"},{"location":"guiappsoddocker/#replace-x11-server-from-xorg-by-a-xvnc","title":"Replace X11 Server from X.org, by a Xvnc.","text":"<p>Xvnc is the X VNC (Virtual Network Computing) server. It is based on a standard X server, but it has a <code>virtual screen</code> rather than a physical one. X applications display themselves on it as if they were using a normal X display, but they can only be accessed via a VNC. So Xvnc is really two servers in one. To the applications it is an X server, and to the remote VNC users it is a VNC server.</p>"},{"location":"guiappsoddocker/#convert-vnc-tcp-socket-in-to-a-websocket","title":"Convert VNC TCP socket in to a WebSocket","text":"<p>The web browser does not support VNC (RFB Protocol) and the TCP socket natively. We need to translate TCP socket, into a WebSocket. This can be done using :</p> <ul> <li> <p>websockify Websockify just translates WebSockets traffic to normal socket traffic. Websockify accepts the WebSockets handshake, parses it, and then begins forwarding traffic between the client and the target in both directions.</p> </li> <li> <p>ws-tcp-bridge A websocket to tcp proxy server, using nodejs which bridges websockets and tcp servers in either direction.</p> </li> </ul>"},{"location":"guiappsoddocker/#use-a-vnc-javascript-client","title":"Use a VNC Javascript client","text":"<p>The web browser receives the RFB protocol in the WebSocket and then paints the data into a canvas.</p> <ul> <li>noVNC is VNC client JavaScript library. noVNC follows the standard VNC protocol, but unlike other VNC clients it requires WebSockets support.</li> </ul>"},{"location":"overview/","title":"abcdesktop overview","text":"<p>abcdesktop is based on kubernets, from the abcdesktop infrastructure to the user applications. At the login page, the user chooses a login provider and authenticates himself, then abcdesktop engine creates a user pod.</p>"},{"location":"overview/#abcdesktop-design","title":"abcdesktop design","text":""},{"location":"overview/#abcdesktop-services","title":"abcdesktop services","text":"<ul> <li>nginx : container act as static web server and reverse proxy router</li> <li>pyos  : container abcdesktop core control plane</li> <li>memcached : container cache service</li> <li>mongo     : container database service to store user profil information</li> </ul>"},{"location":"overview/#abcdesktop-pod-user","title":"abcdesktop pod user","text":"<ul> <li>user: pod user, one pod per connected user</li> <li>applications : each graphical application runs inside a dedicated container. You need to create an container image for each application</li> </ul>"},{"location":"overview/#applications","title":"applications","text":"<ul> <li>An application can run as ephemeral container or as pod, it MUST be a container.</li> <li>An application can ask to start another container, like application helper for a web browser. By example, Firefox container can ask to start videolan application. Then Firefox is running inside a container, Videolan is running inside another separated container. abcdesktop manages a mimetype database for each user. The mimetype database is updated on the fly then new application is added.</li> <li>Application resource limit is supported (CPU, memory).</li> <li>The share memory (shm) between X.org and application is supported with the ephemral container.</li> <li>An application can use GPU if need.</li> <li>Application support ACL (Access Control List). Access to an application can be allowed for a user and denied for another one, using group membership for example.</li> <li>Volumes can be mounted for an application or not for security reason.</li> <li>Application can bind a dedicated network such as VLAN.</li> </ul>"},{"location":"rdgp/","title":"Rdgp","text":"<p>Privacy Notice: protecting your personal data</p> <p>The changes to the French and European regulation on the protection of personal data come into force on 25 May 2018.</p> <p>If you want to interact with abcdesktop via www.abcdesktop.io and other corporate sites, personal data will be collected about you in order to process your request and/or send you the desired information.</p> <p>In this case, abcdesktop is committed to the protection, confidentiality and security of personal data.</p> <p>This Privacy Notice provides information on how abcdesktop, and its potential subcontractors or partners, process your personal data in this context.</p> <p>This document may be supplemented by specific information in the case of a specific service where appropriate (e.g. shareholders club) or in a commercial context. If you are an abcdesktop customer, you will also find a dedicated personal data protection policy on the website demo.abcdesktop.io.</p> <p>Why does abcdesktop process your personal data collected on abcdesktop.io and on its corporate websites? On demo.abcdesktop.io, you can ask a question or receive specific abcdesktop information (for example a press release). abcdesktop processes the personal data collected via the contact forms in place for these purposes. Some websites may require additional information which is processed specifically to enable access to a private or dedicated space, such as shareholders club.</p> <p>We only process your personal data once we have your consent in the context of you request. </p> <p>Your data is only kept for the length of time needed to fulfil your request. This takes into account your unsubscription to certain newsletters or sending out press releases.</p> <p>What types of data are processed? abcdesktop may be required to process your personal data which we collect directly via the online form. It includes identity data, such as your name, surname, email address and sometimes your telephone number and postal address if necessary. </p> <p>Who can see your data? Data collected about you is intended for abcdesktop\u2019s internal services and if any, service providers. In the case of a legal procedure, processed data may also be communicated to the relevant authorities.</p> <p>Is your data processed outside the European Union? The data collected may be processed outside the European Union if deemed necessary and according to the nature of your request. In this case, abcdesktop will take all necessary steps to protect your data. </p> <p>What are your rights? You have the right to withdraw your consent and stop any future use of your data. You can exercise your right to obtain information and access to the data, to rectify them in case of inaccurate data related to you and to delete the data when conditions are fulfilled.</p> <p>How can you contact the Data Protection Officer? If you wish to exercise your rights over your data, you can write to the following address along with proof of identity:</p> <p>Orange Sa Attention: Data Protection Officer (DPO) 78 rue Olivier de Serres 75505 Paris Cedex 15</p> <p>Possibility to make a request to the Data protection authority, the CNIL in France: If your interaction with abcdesktop is not satisfactory, you can also lodge a complaint with the Commission Nationale de l\u2019Informatique et des Libert\u00e9s (CNIL), which is the regulatory authority in charge of personal data protection in France.</p> <p>How is your data secured? Orange ensures your data remains secure and confidential, including certain processing carried out by subprocessor.</p> <p>For this purpose, the appropriate technical and organisational measures are in place to prevent the loss, misuse, alteration and deletion of your personal data. These measures are adapted according to the level of sensitivity of this processed data and the level of risk that the processing or implementation of it presents.</p> <p>Modification of the personal data protection notice This Privacy Notice is subject to change. </p>"},{"location":"requirements/","title":"Requirements","text":""},{"location":"requirements/#prerequisites-for-setup-abcdesktop","title":"Prerequisites for setup abcdesktop","text":"<ul> <li>Architecture <code>x86-64</code> ( <code>arm-64</code> is not yet available)</li> <li>15 GB of free space to store sample applications ( gimp, libreoffice writer, libreoffice calc, libreoffice math, libreoffice impress, firefox ) and core image services</li> </ul>"},{"location":"requirements/#release-10","title":"Release 1.0","text":"<ul> <li>docker instance (version 18 and above). abcdesktop.io 1.0 need a dockerd socket access.</li> <li>Kubernetes release less or equal than 1.23.7-00 ( if you use kubernetes release 1.24 or above, you must use abcdesktop.io release 3.0  )</li> </ul>"},{"location":"requirements/#release-20","title":"Release 2.0","text":"<ul> <li>docker instance (version 18 and above). abcdesktop.io 2.0 need a dockerd socket access.  </li> <li>Kubernetes release less or equal than 1.23.7-00 ( if you use kubernetes release 1.24 or above, you must use abcdesktop.io release 3.0  )</li> <li>an application runs as docker container or as kubernetes pod</li> </ul>"},{"location":"requirements/#release-30","title":"Release 3.0","text":"<ul> <li>Kubernetes release greater or equal to 1.24</li> <li>No depend to docker, an application runs as pod or as an ephermeral container</li> </ul>"},{"location":"requirements/#supported-architectures","title":"Supported Architectures","text":"<p>Our images support only architectures <code>x86-64</code>. The architectures supported by this image is:</p>    Architecture Tag     x86-64 amd64-latest"},{"location":"requirements/#gnulinux","title":"GNU/Linux","text":"<p>The recommended distrubution is Ubuntu 20.04 LTS (Focal Fossa)</p>"},{"location":"requirements/#macosx","title":"MacOS/X","text":"<p>Docker For Mac embeds a hypervisor (based on xhyve), a Linux distribution which runs on LinuxKit and filesystem &amp; network sharing that is much more Mac native. Docker For Mac is a Mac native application in /Applications. </p> <p>At installation time, it creates symlinks in /usr/local/bin for docker and docker-compose, to the commands in the application bundle, in /Applications/Docker.app/Contents/Resources/bin.</p> <p>To install dockerd on MacOS/X, use Docker for Desktop. Get Docker for MacOS on the docker website  docker-for-mac</p> <p>To get a shell to the <code>LinuxKit docker-desktop</code>, run the docker command </p> <pre><code>docker run -it --rm --privileged --pid=host justincormack/nsenter1\n</code></pre>  <p>more info: https://github.com/justincormack/nsenter1</p>"},{"location":"requirements/#microsoft-windows","title":"Microsoft Windows","text":"<p>When you install Docker Desktop on Windows, it requires and automatically enables Hyper-V, a hypervisor from Microsoft. Hyper-V replaces your Windows OS as the host on the computer, and your Windows OS becomes a virtual machine. </p>"},{"location":"requirements/#system-requirements","title":"System Requirements","text":"<ul> <li>Windows 10 64-bit: Pro, Enterprise, or Education (Build 15063 or later).</li> <li>Hyper-V and Containers Windows features must be enabled.</li> <li>64 bit processor with Second Level Address Translation (SLAT)</li> <li>4GB system RAM</li> <li>BIOS-level hardware virtualization support must be enabled in the BIOS settings.</li> </ul> <p>To install dockerd on Microsoft windows, use Docker for Desktop. Get Docker for Windows on the docker website  docker-for-windows</p> <p>You need to configure your Docker Desktop on Windows to use Linux containers.  abcdesktop.io does NOT support Windows container. </p> <p>You can switch the Docker Desktop on Windows to use Linux containers, using  the docker window tray icon. Switch to Linux containers</p>"},{"location":"runapplications.wine/","title":"Run docker image for Windows using Wine","text":""},{"location":"runapplications.wine/#requirements","title":"Requirements","text":"<ul> <li>Read the previous chapter Build abcdesktop docker image</li> <li>Read the Chapter Authentification explicit for LDAP Directory Services is recommended but not mandatory.</li> </ul>"},{"location":"runapplications.wine/#winehq","title":"WineHQ","text":"<p>Wine (originally an acronym for \"Wine Is Not an Emulator\") is a compatibility layer capable of running Windows applications on several POSIX-compliant operating systems, such as Linux, macOS, &amp; BSD. Instead of simulating internal Windows logic like a virtual machine or emulator, Wine translates Windows API calls into POSIX calls on-the-fly, eliminating the performance and memory penalties of other methods and allowing you to cleanly integrate Windows applications into your desktop.</p> <p>To run Windows applications abcdesktop.io use WineHQ. A dedicated image template source is ready to use as source of others Windows applications. This image template is named <code>abcdesktopio/oc.template.gtk.wine.50</code></p> <p>Start pulling this template image :</p> <pre><code>docker pull abcdesktopio/oc.template.gtk.wine\n</code></pre> <p>Look at the Dockerfile to build the <code>abcdesktopio/oc.template.gtk.wine</code> on the https://hub.docker.com/ web site.</p> <p>For a better support, we are using the 32 bits library, as i386 libs on GNU/Linux.  Your can read in the Dockerfile, how the <code>abcdesktopio/oc.template.gtk.wine</code> is created.</p>  <p>Dockerfile information :</p> <p><code>dpkg --add-architecture i386</code> <code>aptitude install -y wine</code></p>"},{"location":"runapplications.wine/#run-notepadexe-for-windows-in-a-docker-container","title":"Run notepad.exe for Windows in a Docker container","text":"<p>In this chapter we are going to run <code>notepad.exe</code> for Windows inside a docker container for abcdesktop.io.</p>  <p>Start an abcdesktop session. You can use an authenticated session using an authentication provider <code>external</code> or <code>explicit</code>, or you can do this exercice using Anonymous Authentification also know as the authentication provider <code>implicit</code>.</p>  <p>In this chapter we choose an Anonymous, DO NOT CLOSE YOUR WEB BROWSER, you should not be able de reconnect with the same user context, and have to restart this exercice at the begining, else you can choose to configure abcdesktop with ldap authentification.</p>   <p>Login using the <code>Anonymous</code> authentification provider.</p>  <p>Keep your web browser open, then on your host, open a terminal shell window and run the command </p> <pre><code>docker ps --filter ancestor=abcdesktopio/oc.user.18.04\n</code></pre> <p>The option <code>--filter ancestor=abcdesktopio/oc.user.18.04</code> ask to filter only container with the image <code>ancestor</code> set with value <code>abcdesktopio/oc.user.18.04</code> You should read the container with the image named abcdesktopio/oc.user.18.04 </p> <pre><code>docker ps --filter ancestor=abcdesktopio/oc.user.18.04\nCONTAINER ID   IMAGE                        COMMAND                  CREATED         STATUS         PORTS                                                            NAMES\n86df3ff126ac   abcdesktopio/oc.user.18.04   \"/composer/docker-en\u2026\"   3 minutes ago   Up 3 minutes   4714/tcp, 6081/tcp, 29780-29781/tcp, 29783-29784/tcp, 29786/tcp  g-5f4300d2-7c8e-43c6-89ab-f85bd8b68138\n</code></pre> <p>Read the values <code>CONTAINER ID</code> and <code>NAMES</code></p> <p>In this example, the CONTAINER ID is <code>86df3ff126ac</code> and the NAME is <code>g-5f4300d2-7c8e-43c6-89ab-f85bd8b68138</code>.</p> <p>We are using the <code>/tmp</code> volume of this <code>CONTAINER ID</code> 86df3ff126ac</p> <p>Using an anonymous authnetification, the name of your container id is an UUID, for example <code>57be1e5b-0b14-4c05-ae79-75e9a03c77be</code>. The name of the <code>tmp</code> volume is  <code>tmp-57be1e5b-0b14-4c05-ae79-75e9a03c77be</code></p> <p>Run a <code>docker inspect -f \"{{ .HostConfig.Binds }}\"</code> and add your <code>CONTAINER ID</code> as parameter.</p> <pre><code>docker inspect -f \"{{ .HostConfig.Binds }}\" CONTAINER_ID\n</code></pre> <p>For example</p> <pre><code>docker inspect -f \"{{ .HostConfig.Binds }}\" 86df3ff126ac\n</code></pre> <p>You should read the volume name starting by <code>tmp-</code> with your uuid concatened</p> <pre><code>[tmp-5f4300d2-7c8e-43c6-89ab-f85bd8b68138:/tmp home-5f4300d2-7c8e-43c6-89ab-f85bd8b68138:/home/balloon]\n</code></pre>  <p>Note: if your are using an LDAP authentification, the name of your container id is the username, for example <code>hermes</code>. The name of the <code>tmp</code> volume is  <code>tmp-hermes</code></p>  <p>Now, start a new docker container with the same HostConfig.Bings as your oc.user container. The <code>-v</code> parameter is the first entry of the result in the previous command <code>docker inspect -f \"{{ .HostConfig.Binds }}\"</code></p> <pre><code>docker run -it -v TMP_VOLUMENAME:/tmp  --user balloon abcdesktopio/oc.template.gtk.wine bash\n</code></pre> <p>For example with an <code>Anonymous</code> user:</p> <pre><code>docker run -it -v  tmp-5f4300d2-7c8e-43c6-89ab-f85bd8b68138:/tmp --user balloon abcdesktopio/oc.template.gtk.wine bash \n</code></pre> <p>Great, you have started a new docker container. The oc.user containter and your new container are sharing the same volume mounted as <code>/tmp</code>. You get a prompt inside the new docker container.</p> <pre><code>To run a command as administrator (user \"root\"), use \"sudo &lt;command&gt;\".\nSee \"man sudo_root\" for details.\n\nballoon@8684ae888f74:~$\n</code></pre> <p>And now start the <code>notepad.exe</code> with wine</p> <pre><code>balloon@8684ae888f74:/$ wine notepad\n</code></pre> <p>After few seconds you should read on the standard error</p> <pre><code>balloon@8684ae888f74:/$  wine notepad\n0015:err:clipboard:convert_selection Timed out waiting for SelectionNotify event\n0014:err:ole:marshal_object couldn't get IPSFactory buffer for interface {00000131-0000-0000-c000-000000000046}\n0014:err:ole:marshal_object couldn't get IPSFactory buffer for interface {6d5140c1-7436-11ce-8034-00aa006009fa}\n0014:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hres=0x80004002\n0014:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, 80004002\n0014:err:ole:get_local_server_stream Failed: 80004002\n0012:err:ole:marshal_object couldn't get IPSFactory buffer for interface {00000131-0000-0000-c000-000000000046}\n0012:err:ole:marshal_object couldn't get IPSFactory buffer for interface {6d5140c1-7436-11ce-8034-00aa006009fa}\n0012:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hres=0x80004002\n0012:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, 80004002\n0012:err:ole:get_local_server_stream Failed: 80004002\nCould not find Wine Gecko. HTML rendering will be disabled.\nwine: configuration in L\"/composer/.wine\" has been updated.\n</code></pre> <p>And the notepad window should be open inside your Web browser</p>  <p>This Windows application is running inside a docker container on abcdesktop.io desktop.</p> <p>In the Terminal shell press <code>CTRL+C</code> to stop the <code>wine notepad</code> process, then type <code>exit</code> to quit your shell in container.</p> <pre><code>^C0032:fixme:console:CONSOLE_DefaultHandler Terminating process 8 on event 0\nballoon@4c4d806557dc:~$ exit\nexit\n</code></pre> <p>It's time to build your own abcdesktop application image. Read the next chapter Build abcdesktop.io docker image for Windows using Wine.</p>"},{"location":"1.0/features/","title":"abcdesktop release 1.0","text":"<p>The abcdesktop release 1.0 has started in May 2015</p> <ul> <li>docker instance version 18 and above.</li> <li>abcdesktop 1.0 (pyos) need a dockerd socket access.</li> <li>Kubernetes release less or equal than 1.23.7-00 (if you use kubernetes release 1.24 or above, you must use abcdesktop release 3.0)</li> <li>abcdesktop release 1.0 is deprecated</li> </ul>"},{"location":"1.0/config/authentification-rules/","title":"Authentification rules configuration","text":"<p>All auth providers support rules configuration</p> <p>A rule take some parameters and set label to the auth user. All labels are stored inside the JWT Auth token. The labels are use to define a container execution context. For example to set a dedicated network for firefox application ( read the how-to ) </p>"},{"location":"1.0/config/authentification-rules/#the-rule-object","title":"The rule object","text":"<p>A rule is a dictionary object with :</p> <ul> <li>a name (the entry of the rules)</li> <li>one or more conditions</li> <li>and expected boolean value True or False</li> <li>a label to set if the conditions are equal to the expected boolean value</li> </ul> <p>Example :</p> <p>To test if the user source IP address is equal to <code>8.8.8.1/32</code></p> <pre><code>'rule-home': { \n    'conditions' : [   { 'network': '8.8.8.1/32', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'homeipsource' }\n</code></pre>"},{"location":"1.0/config/authentification-rules/#the-conditions-object","title":"The conditions object","text":"<p><code>conditions</code> is a list of condition. All condition are always tested, as a logical <code>AND</code>. The result must be equal to the <code>expected</code> value.</p>"},{"location":"1.0/config/authentification-rules/#examples","title":"Examples:","text":""},{"location":"1.0/config/authentification-rules/#example-true-and-true-expected-true","title":"Example (TRUE and TRUE) expected TRUE:","text":"<p>To test if the user source IP address is in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'shipcrewandnet80', if the 'expected' value is <code>True</code></p>"},{"location":"1.0/config/authentification-rules/#example-true-and-true-expected-false","title":"Example (TRUE and TRUE) expected FALSE:","text":"<p>To test if the user source IP address is <code>NOT</code> in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is  <code>NOT</code> a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : False,\n    'label': 'noshipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'noshipcrewandnonet80', if the 'expected' value is <code>False</code></p>"},{"location":"1.0/config/authentification-rules/#example-true-and-false-expected-true","title":"Example (TRUE and FALSE) expected TRUE:","text":"<p>To test if the user source IP address is in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is  <code>NOT</code> a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : False } ], \n    'expected' : True,\n    'label': 'noshipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'noshipcrewandnet80', if the 'expected' value is <code>True</code></p>"},{"location":"1.0/config/authentification-rules/#example-false-and-true-expected-true","title":"Example (FALSE and TRUE) expected TRUE:","text":"<p>To test if the user source IP address is <code>NOT</code> in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is   a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : False },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewandnonet80'\n}\n</code></pre> <p>Add the labels 'shipcrewandnonet80', if the 'expected' value is <code>True</code></p>"},{"location":"1.0/config/authentification-rules/#the-condition-value","title":"The condition value","text":"name description example     boolean always true or false 'boolean' : 'true'   httpheader test a HTTP header value 'httpheader':   memberOf test if the LDAP user object is member of group 'memberOf': [ 'cn=ship_crew,ou=people,dc=planetexpress,dc=com']   network test if the client user IP Address is in a network subnet 'network': [ '1.2.3.4/24']   primarygroupid test if the LDAP user object has a attibute primaryGroupID and is equal to value 'primarygroupid': '513'"},{"location":"1.0/config/authentification-rules/#condition-boolean","title":"condition boolean","text":"<p>This condition is a dummy condition; Only use to force a label or to disable a test.</p> <pre><code>'boolean': boolean\n</code></pre> <p>The commun usage is </p> <pre><code>'rule-dummy': { 'conditions':  [  { 'boolean': True, 'expected' : True  } ],\n                   'expected' : True,\n                 'label': 'dummy'\n}\n</code></pre> <p>or alway False</p> <pre><code>'rule-dummy': { 'conditions':  [  { 'boolean': True, 'expected' : True  } ],\n                   'expected' : False,\n                 'label': 'dummy'\n}\n</code></pre>"},{"location":"1.0/config/authentification-rules/#condition-httpheader","title":"condition httpheader","text":"<p>This condition is test if a HTTP Header value is equal to a string. </p> <pre><code>'httpheader': dict\n</code></pre> <p>example : if the 'User-Agent' is equal to <code>'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36' then add the label 'chromemaxosx112'</code></p> <pre><code>\n 'rule-httpheader': { \n        'conditions' : [ \n            {   'httpheader': { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36' }, \n                'expected' : True  } ],\n        'expected' : True,\n        'label': 'chromemaxosx112' }\n\n</code></pre>"},{"location":"1.0/config/authentification-rules/#condition-network","title":"condition network","text":"<p>This condition is test if the client source ip address is in a subnet. IPv4 and IPv6 are supported.</p> <pre><code>'network': string\n</code></pre> <p>example</p> <p>To test if the user source IP address is equal to <code>8.8.8.1/32</code></p> <pre><code>'rule-home': { \n    'conditions' : [   { 'network': '8.8.8.1/32', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'homeipsource' }\n</code></pre> <p>To test if the user source IP address is in the subnet <code>10.0.0.0/8</code></p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '10.0.0.0/8', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'localnet' }\n</code></pre> <p>To test if the user source IP address is NOT in the subnet <code>192.168.0.0/24</code></p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '192.168.0.0/24', 'expected' : False } ],\n                         'expected' : True,\n                         'label': 'no192168net' }\n</code></pre> <p>same as </p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '192.168.0.0/24', 'expected' : True } ],\n                         'expected' : False,\n                         'label': 'no192168net' }\n</code></pre>"},{"location":"1.0/config/authentification-rules/#ipv4-and-ipv6-subnets-support","title":"IPv4 and IPv6 subnets support","text":"<p>To support private ip addresses subnet in the rfc 1918 and rfc 3927, write separated rules. Both IPv6 and IPv4 addresses are supported.  You can share the same label <code>privatenetwork</code> a separated rule. </p> <pre><code>'policies': {\n    'acl' : {},\n    'rules' : { \n          'rule-privatenetwork-10': {   'conditions' : [ { 'network': '10.0.0.0/8', 'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'rule-privatenetwork-172': {'conditions' : [ { 'network': '172.16.0.0/12', 'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'Rule-privatenetwork-192': {'conditions' : [ { 'network': '192.168.0.0/16',     'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'Rule-privatenetwork-169': {'conditions' : [ { 'network': '169.254.0.0/16',     'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'rule-privatenetwork-fe80':{  'conditions' : [ { 'network': 'fe80::/10',     'expected' : True } ], \n                                                'expected'   : True, \n                                                'label': 'privatenetwork' }\n    }\n}                       \n</code></pre>"},{"location":"1.0/config/authentification-rules/#condition-memberof","title":"condition memberof","text":"<p>This condition test if the user is a member of a LDAP Distinguished Name. </p> <pre><code>'memberOf': string\n</code></pre> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewgrp'\n}\n</code></pre>"},{"location":"1.0/config/authentification-rules/#condition-primarygroupid","title":"condition primarygroupid","text":"<p>This test is only used with Microsoft Active Directory. primarygroupid test if the user attibute primaryGroupID is equal to a string.</p> <pre><code>'primarygroupid': string\n</code></pre> <p>To check is a user is memberof a <code>DOMAIN\\USER</code> the primary group id is <code>513</code></p> <pre><code>'rule-domainuser': {    'conditions':  [ { 'primarygroupid': '513', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'domainuser'\n}\n</code></pre> <p>However, if the user needed to be seen as a <code>Domain Admin for POSIX</code>, the <code>PrimaryGroupID</code> is <code>512</code>, the RID for that group. </p> <pre><code>'rule-posixdomainadmin': {  'conditions':  [ { 'primarygroupid': '519', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'posixdomainadmin'\n}\n</code></pre> <p>The <code>Enterprise Admins group</code>, <code>519</code>, is also used to grant this level in POSIX.</p> <pre><code>'rule-enterpriseadmin': {   'conditions':  [ { 'primarygroupid': '519', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'enterpriseadmin'\n}\n</code></pre>"},{"location":"1.0/config/authentification/","title":"Authentification","text":""},{"location":"1.0/config/authentification/#configuration-file","title":"Configuration file","text":"<p>The authentification configuration is set in the <code>od.config</code> file. In this chapter you will need to update the od.config configuration file.  This update differs depending on the configuration docker mode or kubernetes mode. </p> <p>Read the  Update your configuration file and apply the new configuration file section to make change in od.config file for docker, or edit the abcdesktop.yaml file for kubernetes cluster.</p>"},{"location":"1.0/config/authentification/#the-dictionary-authmanagers","title":"The dictionary authmanagers","text":"<p>The authmanagers is defined as a dictionnary object :</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { }\n}\n</code></pre> <p>The od.config defines 3 kinds of entries in the <code>authmanagers</code> object :</p> <ul> <li><code>external</code>: use for OAuth 2.0 Authentification</li> <li><code>explicit</code>: use for LDAP, LDAPS and ActiveDirectory Authentification</li> <li><code>implicit</code>: use for Anonymous Authentification</li> </ul>"},{"location":"1.0/config/authentification/#related-authmanagers","title":"Related authmanagers","text":"authmanagers type Description     <code>external</code> OAuth 2.0 Authentification   <code>explicit</code> LDAP, LDAPS and Active Directory Authentification   <code>implicit</code> Anonymous Authentification"},{"location":"1.0/config/authentification/#hands-on","title":"Hands-on","text":""},{"location":"1.0/config/authentification/#requirements","title":"Requirements","text":"<p>You should have read the hands-on :</p> <ul> <li>Edit your configuration file in docker mode</li> </ul>"},{"location":"1.0/config/authentification/#change-authmanagers-configuration","title":"Change authmanagers configuration","text":"<p>Edit your od.config pyos configuration file, and set the value to the authmanagers dictionnay with empty values for <code>implicit</code>, <code>explicit</code>, and <code>external</code>, as describe :</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { }\n}\n</code></pre> <p>Save your new od.config file.</p>  <p>The config file <code>od.config</code> has changed and od.py running inside the container should restart. If it doesn't, restart your docker-compose to ake sure that the od.py the your new od.config file.</p> <p><code>docker-compose restart</code> </p>  <p>Start your web browser and open the URL <code>http://localhost</code></p>  <p>The Web home page should only show the title abcdesktop.io. There is no <code>authmanagers</code> available.</p> <p>Great you can now add some value to authenticate your users.</p>"},{"location":"1.0/config/authentification/#authmanagers-implicit","title":"authmanagers <code>implicit</code>:","text":"<p><code>implicit</code> is the easyest configuration mode, and is used as 'Anonymous' authentification.  Read the authmanagers implicit Section.</p>"},{"location":"1.0/config/authentification/#authmanagers-explicit","title":"authmanagers <code>explicit</code>:","text":"<p><code>explicit</code> is the easyest configuration mode, and is used as 'Anonymous' authentification.  Read the authmanagers explicit Section.</p>"},{"location":"1.0/config/authentification/#authmanagers-external","title":"authmanagers <code>external</code>:","text":"<p><code>external</code> is the easyest configuration mode, and is used as 'Anonymous' authentification.  Read the authmanagers external Section.</p>"},{"location":"1.0/config/authentification/#authmanagers-configuration-sample","title":"Authmanagers configuration sample","text":"<p>In the authmanagers implicit section, authmanagers explicit section, and authmanagers external section, you have learned how to defined the providers. You can set a complete <code>authmanagers</code> dictionnary as described for example :</p> <pre><code>authmanagers: {\n  'external': {\n    'providers': {\n      'facebook': { \n        'displayname': 'Facebook', \n        'enabled': True,\n        'client_id':     'XXXXXXX', \n        'client_secret': 'YYYYYYY', \n        'dialog_url': 'https://www.facebook.com/dialog/oauth?client_id={client_id}&amp;redirect_uri={callback_url}&amp;response_type=code',\n        'auth_url': 'https://graph.facebook.com/v2.3/oauth/access_token?code={code}&amp;redirect_uri={callback_url}&amp;client_id={client_id}&amp;client_secret={client_secret}',\n        'userinfo_url': 'https://graph.facebook.com/v2.6/me?access_token={access_token}&amp;fields=picture.width(400),name',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}',\n        'userinfomap': {\n            '*': '*',\n            'picture': 'picture.data.url'\n        }\n      },\n      'orange': {       \n        'displayname': 'Orange', \n        'enabled': True,\n        'basic_auth': True,\n        'userinfo_auth': True,\n        'client_id':      'AAAAAAAA', \n        'client_secret':  'BBBBBBBB',\n        'dialog_url': 'https://api.orange.com/oauth/v2/authorize?client_id={client_id}&amp;redirect_uri={callback_url}&amp;scope=openid+profile+offline_access&amp;response_type=code&amp;prompt=login+consent&amp;state={callba\nck_url}',\n        'auth_url': 'https://api.orange.com/openidconnect/fr/v1/token?code={code}&amp;redirect_uri={callback_url}&amp;grant_type=authorization_code', \n        'userinfo_url': 'https://api.orange.com/openidconnect/v1/userinfo',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      },\n      'mobileorange': { \n        'displayname': 'Mobile Connect', \n        'enabled': False,\n        'client_id':     'CCCCCCCC', \n        'client_secret': 'DDDDDDDD',\n        'basic_auth': True,\n        'dialog_url': 'https://api.orange.com/oauth/v2/authorize?client_id={client_id}&amp;redirect_uri={callback_url}&amp;scope=openid+profile&amp;response_type=code&amp;prompt=login+consent&amp;state=&amp;state={callback_url}'\n,\n        'auth_url': 'https://api.orange.com/oauth/v2/token?code={code}&amp;redirect_uri={callback_url}&amp;grant_type=authorization_code', \n        'userinfo_url': 'https://api.orange.com/oauth/v2/authorize',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      },\n      'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id':     'EEEEEEEE.apps.googleusercontent.com', \n        'client_secret': 'FFFFFFFF',\n        'scope': 'https://www.googleapis.com/auth/userinfo.email',\n        'dialog_url': 'https://accounts.google.com/o/oauth2/v2/auth?client_id={client_id}&amp;redirect_uri={callback_url}&amp;response_type=code&amp;scope={scope}',\n        'auth_url': 'https://oauth2.googleapis.com/token?code={code}&amp;grant_type=authorization_code&amp;redirect_uri={callback_url}&amp;scope={scope}&amp;client_id={client_id}&amp;client_secret={client_secret}',\n        'userinfo_url': 'https://openidconnect.googleapis.com/v1/userinfo?access_token={access_token}',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      }\n    }\n  },\n  'explicit': {\n    'show_domains': True,\n    'default_domain': 'AD',\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n    }\n  },\n  'implicit': {\n    'providers': {\n      'anonymous': {\n        'displayname': 'Anonymous',\n        'caption': 'Have a look !',\n        'userid': 'anonymous',\n        'username': 'Anonymous'\n      }     \n    }\n  }}\n\n\nadconfig : { 'AD': {    'default'       : True, \n                        'ldap_timeout'  : 15,\n                        'ldap_protocol' : 'ldap',\n                        'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                        'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                        'domain'        : 'AD',\n                        'domain_fqdn': 'AD.DOMAIN.LOCAL',\n                             'servers'  : [ '192.168.1.12', '192.168.1.13'  ],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL',\n                             'query_dcs'    : True\n}}\n</code></pre>"},{"location":"1.0/config/authexplicit-activedirectory/","title":"Authentification <code>explicit</code> for Microsoft Active Directory services","text":""},{"location":"1.0/config/authexplicit-activedirectory/#authmanagers-explicit-object","title":"authmanagers <code>explicit</code> object","text":"<p>The <code>explicit</code> authentification configuration is defined as a dictionnary object and contains an <code>explicit</code> provider. </p> <p>For example :</p> <pre><code>'explicit': {\n    'show_domains': True,\n    'default_domain': 'AD',\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n}\n</code></pre>    Variable name Type Description     <code>show_domains</code> boolean Permit the domain name to be listed in API getclientdata, the default value is False   <code>default_domain</code> string Default domain name prefix if the user format does not containthe domain prefix like DOMAIN\\USER. If the user login value is USER, the login is prefixed with the  default_domain\\USER   <code>providers</code> dictionnary <code>{ 'AD': {  'config_ref': 'adconfig',  'enabled': True  }}</code>"},{"location":"1.0/config/authexplicit-activedirectory/#providers-configuration","title":"providers configuration","text":"<p>The <code>provider</code> authentification configuration is defined as a dictionnary object and must contain a key name. The key name must be set as the <code>USERDOMAIN</code> and defined in the <code>config_ref</code> with the exact same value.</p> <p>Providers :</p> <p>The provider is formated as a dictionnary </p> <p><code>{ 'AD': {               'config_ref': 'adconfig',               'enabled': True           }  }</code></p>    Variable name Type Description     config_ref string For increased legibility, the <code>USERDOMAIN</code> configuration is defined in a dedicated dictionnary used the key:value <code>'config_ref': 'adconfig'</code>, where <code>key</code> is <code>config_ref</code> and <code>value</code> is the dictionnay variable name.   enable boolean enable or disable the domain entry    <p>The adconfig is a dictionnary. For example :</p> <pre><code>adconfig : { 'AD': {   'default'       : True, \n                       'ldap_timeout'  : 15,\n                       'ldap_protocol' : 'ldap',\n                       'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                       'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                       'domain'        : 'AD',\n                       'domain_fqdn': 'AD.DOMAIN.LOCAL',\n                       'servers'    : [ '192.168.7.12' ],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL',\n                        'query_dcs' : True,\n                        'wins_servers'  : [ '192.168.1.12' ],\n                        'serviceaccount': { 'login': 'SVCACCOUNT', 'password': 'SVCACCOUNTPASSWORD' }\n     }\n}\n</code></pre> <p>If this example, the Microsoft Active Directory value are set to :</p>    Variable name Value for example     <code>USERDOMAIN</code> <code>AD</code>   <code>USERDNSDOMAIN</code> <code>AD.DOMAIN.LOCAL</code>    <p>For Active Directory authmanagers, replace the variable name with your own value.</p>    Variable name Type Description Example     <code>default</code> boolean Use this domain as default domain True   <code>ldap_basedn</code> string LDAP Base Distinguished Names <code>DC=ad,DC=domain,DC=local</code>   <code>ldap_fqdn</code> string _ldap._tcp.Domain_Name <code>_ldap._tcp.ad.domain.local</code>   <code>domain_fqdn</code> string domain FQDN (also know as Domain_Name) <code>AD.DOMAIN.LOCAL</code>   <code>servers</code> list of string list of the Active Director servers <code>[ '192.168.1.12', '192.168.1.13' ]</code>   <code>kerberos_realm</code> string Replace kerberos_realm wih your kerberos realm (in UPPER CASE) <code>AD.DOMAIN.LOCAL</code>    <p>The <code>explicit</code> authentification is support <code>LDAP</code> and <code>LDAPS</code> bind.</p> <p>The Microsoft Active Directory value are set to :</p>    Variable name Value     <code>USERDOMAIN</code> <code>AD</code>   <code>USERDNSDOMAIN</code> <code>AD.DOMAIN.LOCAL</code>    <p>For Active Directory authmanagers, replace the variable name with your own value.</p>    Variable name Description Example     <code>ldap_basedn</code> Replace ldap_basedn with your LDAP Base Distinguished Names <code>DC=ad,DC=domain,DC=local</code>   <code>ldap_fqdn</code> Replace ldap_fqdn with the _ldap._tcp fqdn <code>_ldap._tcp.ad.domain.local</code>   <code>domain_fqdn</code> Replace domain_fqdn with domain FQDN value <code>AD.DOMAIN.LOCAL</code>   <code>servers</code> Replace servers with list of the Active Director servers <code>[ '192.168.1.12', '192.168.1.13' ]</code>   <code>kerberos_realm</code> Replace kerberos_realm wih your kerberos realm (in UPPER CASE) <code>AD.DOMAIN.LOCAL</code>"},{"location":"1.0/config/authexplicit-activedirectory/#service-account","title":"Service Account","text":"<p>The service account is use when od.py starts. It runs query to the Active Directory service to read the subnet and location from the sites in 'CN=Subnets,CN=Sites,CN=Configuration,' + BASE_DN , (for example CN=Subnets,CN=Sites,CN=Configuration,DC=example,DC=com)</p>"},{"location":"1.0/config/authexplicit-activedirectory/#site","title":"Site","text":"<p>This features is only available if a service account is defined. Site is used to locate a user from his ip adress. The attributs location and subnet are cached in memory.</p>    Variable name Type Defautl value     <code>site_subnetdn</code> string <code>CN=Subnets,CN=Sites,CN=Configuration, + config.get('basedn') )</code>   <code>site_scope</code> ldap python <code>ldap.SCOPE_SUBTREE</code> read Python ldap reference for more details   <code>site_filter</code> string <code>(objectClass=subnet)</code>   <code>site_attrs</code> list <code>['cn', 'siteObject', 'location']</code>"},{"location":"1.0/config/authexplicit-activedirectory/#printers","title":"Printers","text":"<p>This features is only available if a service account is defined. Printers are used to list printer available in the current user's site. The site is identified using the user's ip address. <code>location</code> is the join key to match local printer for the user.</p>    Variable name Type Defautl value     <code>printer_printerdn</code> string <code>OU=Applications + config.get('basedn')</code>   <code>printer_scope</code> ldap python <code>ldap.SCOPE_SUBTREE</code> read Python ldap reference for more details   <code>site_filter</code> string <code>(objectClass=printQueue)</code>   <code>site_attrs</code> list <code>[ 'cn', 'uNCName', 'location', 'driverName', 'driverVersion', 'name',  'portName', 'printColor', 'printerName', 'printLanguage', 'printSharename', 'serverName', 'shortServerName', 'url', 'printMediaReady', 'printBinNames',  'printMediaSupported',  'printOrientationsSupported' ]</code>    <p>Great, you have check how the explicit Authentification configuration works.</p>"},{"location":"1.0/config/authexplicit-ldap/","title":"Authentification <code>explicit</code> for LDAP Directory Services","text":""},{"location":"1.0/config/authexplicit-ldap/#authmanagers-explicit-object","title":"authmanagers <code>explicit</code> object","text":"<p><code>explicit</code> authentification use a directory service. The bind operation is used to authenticate clients to the directory server, to establish an authorization identity that will be used for subsequent operations processed on that connection.</p> <p>The <code>explicit</code> authentification configuration is defined as a dictionnary object and contains an <code>explicit</code> provider. </p> <p>For example :</p> <pre><code>'explicit': {\n    'show_domains': True,\n    'providers': {\n      'LDAP': { \n        'config_ref': 'ldapconfig', \n        'enabled': True\n       }\n}\n</code></pre> <p>In this example, <code>ldapconfig</code> dict must have a key <code>LDAP</code></p>    Variable name Type Description     <code>show_domains</code> boolean Permit the domain name to be listed in API getclientdata, the default value is False   <code>default_domain</code> string not used by ldap, only used by Active Directory   <code>providers</code> dictionnary <code>{ 'LDAP': {  'config_ref': 'ldapconfig',  'enabled': True  }}</code>"},{"location":"1.0/config/authexplicit-ldap/#providers-configuration","title":"providers configuration","text":"<p>The <code>provider</code> authentification configuration is defined as a dictionnary object and must contain a key name. The key name must be set with the same value in providers configuration and <code>config_ref</code>.</p> <p>Providers :</p> <p>The provider is formated as a dictionnary </p> <p><code>{ 'planet': {               'config_ref': 'ldapconfig',               'enabled': True           }  }</code></p>    Variable name Type Description     config_ref string For increased legibility, the <code>USERDOMAIN</code> configuration is defined in a dedicated dictionnary used the key:value <code>'config_ref': 'adconfig'</code>, where <code>key</code> is <code>config_ref</code> and <code>value</code> is the dictionnay variable name.   enable boolean enable or disable the domain entry    <p>The ldapconfig is a dictionnary. </p> <p>For example :</p> <pre><code>ldapconfig : { 'planet': {    'default'       : True, \n                        'ldap_timeout'  : 15,\n                        'ldap_protocol' : 'ldap',\n                        'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n                        'servers'       : [ '192.168.8.195' ],\n                        'secure'        : False,\n                        'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' }\n           }}\n\n}\n</code></pre>"},{"location":"1.0/config/authexplicit-ldap/#ldap-configuration-reference","title":"ldap configuration reference","text":"Variable name Type Description Example     <code>default</code> boolean Use this domain as default domain True   <code>ldap_protocol</code> string protocol type. <code>ldap</code> or <code>ldaps</code> for LDAP directory services <code>ldap</code>   <code>tls_require_cert</code> boolean The default value is False. <code>tls_require_cert</code>  apply only if <code>ldap_protocol</code> is set to <code>ldaps</code>. Allow LDAPS connection if the ldaps server hostname does not match CommonName peer certificate. In production, set this value to <code>True</code> This will disable the ldap option call : <code>ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER)</code> False   <code>basedn</code> string LDAP Base Distinguished Names <code>ou=people,dc=planetexpress,dc=com</code>   <code>servers</code> list of string list of LDAP servers (IP Adress or FQDN), if entry does not respond, the next one is used. <code>[ '192.168.1.12', '192.168.1.13' ]</code> IP  Address or FQDN values   <code>scope</code> LDAP Perform an LDAP search operation, with base as the DN of the entry at which to start the search, <code>scope</code> being one of <code>SCOPE_BASE</code> (to search the object itself), <code>SCOPE_ONELEVEL</code> (to search the object\u2019s immediate children), or <code>SCOPE_SUBTREE</code> (to search the object and all its descendants). <code>ldap.SCOPE_SUBTREE</code>   <code>timeout</code> integer ldap time out in second 10   <code>exec_timeout</code> integer execute time out in seconds, to obtain ntlm_auth credentials, or cntlm auth credentials, or kerberos auth credentials. the exec timeout is used to run external command line. 10   <code>users_ou</code> string Users Organisation Unit <code>ou=people,dc=planetexpress,dc=com</code>   <code>attrs</code> list list of default attributs to read in user object. read the Definition of the inetOrgPerson LDAP Object Class     <code>filter</code> string LDAP filter to find user object <code>(&amp;(objectClass=inetOrgPerson)(cn=%s))</code>   <code>group_filter</code> string LDAP filter to find group object <code>(&amp;(objectClass=Group)(cn=%s))</code>   <code>group_attrs</code> string LDAP filter to find group object <code>(&amp;(objectClass=Group)(cn=%s))</code>"},{"location":"1.0/config/authexplicit-ldap/#hands-on-configure-auth-using-an-openldap-for-docker","title":"Hands-on : Configure Auth using  an OpenLDAP for Docker","text":""},{"location":"1.0/config/authexplicit-ldap/#requirements","title":"Requirements","text":"<p>You should have all read and done the hands-on :</p> <ul> <li>Setup abcdesktop.io in docker mode</li> <li>Edit your configuration file in docker mode</li> </ul>"},{"location":"1.0/config/authexplicit-ldap/#openldap-docker-image-for-testing","title":"OpenLDAP Docker Image for testing","text":"<p>To configure abcdesktop.io to use an explicit authentification, we need a directory service. We use an OpenLDAP Docker Image for testing with provioned values.</p> <p>Read the OpenLDAP Docker Image for testing documentation on the url abcdesktop OpenLDAP Docker Image for testing</p>"},{"location":"1.0/config/authexplicit-ldap/#update-the-docker-composeyml-file","title":"Update the docker-compose.yml file","text":"<p>Update the <code>docker-compose.yml</code> file to add an ldap as directory server </p> <p>The specific <code>openldap</code> section is describe as a service. The new complete <code>docker-compose.yml</code> file is now :</p> <pre><code>version: '3'\nservices:\n  pyos:\n    depends_on:\n      - memcached\n      - mongodb\n    image: 'abcdesktopio/oc.pyos'\n    networks:\n      - netback\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - /Users/alexandredevely/src/abcdesktop/od.config:/var/pyos/od.config\n  speedtest:\n    image: 'abcdesktopio/oc.speedtest'\n    networks:\n      - netuser\n  nginx:\n    depends_on:\n      - memcached\n      - pyos\n    image: 'abcdesktopio/oc.nginx'\n    ports:\n      - '80:80'\n      - '443:443'\n    networks:\n      - netuser\n      - netback\n  memcached:\n    image: memcached\n    networks:\n      - netback\n  mongodb:\n    image: mongo\n    networks:\n      - netback\n  openldap:\n    image: abcdesktopio/oc.openldap\n    networks:\n      - netback\nnetworks:\n  netuser:\n    driver: bridge\n  netback:\n    internal: true\n</code></pre>"},{"location":"1.0/config/authexplicit-ldap/#update-the-odconfig-configuration-file","title":"Update the <code>od.config</code> configuration file","text":"<p>Update the <code>od.config</code> configuration file.</p> <p>Add the <code>explicit</code> entry to the dictionary <code>authmanagers</code>.</p> <pre><code>authmanagers: {\n  'external': {\n  },\n  'explicit': {\n    'show_domains': True,\n    'providers': {\n      'planet': { \n        'config_ref': 'ldapconfig', \n        'enabled': True\n       }\n    }\n  },\n  'implicit': {\n  }}\n\n\n</code></pre>  <p>Note: the  <code>config_ref</code> is <code>ldapconfig</code>. </p>  <p>Add a new dictionnary object named <code>ldapconfig</code> to the configuration file. These values come from the LDAP structure of OpenLDAP Docker Image for testing</p> <pre><code>ldapconfig : { 'planet': {    'default'       : True, \n                        'ldap_timeout'  : 15,\n                        'ldap_protocol' : 'ldap',\n                        'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n                        'servers'       : [ 'openldap' ],\n                        'secure'        : False,\n                        'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' }\n           }}\n</code></pre>  <p>Note: the server name is the name of the service entry</p>  <p>Save your new od.config file.</p>  <p>The config file <code>od.config</code> has changed and od.py running inside the container should restart.  If it doesn't, restart your docker-compose to make sure that the od.py the your new od.config file.</p> <p><code>docker-compose restart</code> </p>  <p>Open the URL:<code>http://localhost</code></p> <p>The authmanagers <code>explicit</code> is enabled. The Web home page insert the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p>"},{"location":"1.0/config/authexplicit-ldap/#the-ldap-structure-of-openldap-docker-image-for-testing","title":"The LDAP structure of OpenLDAP Docker Image for testing","text":""},{"location":"1.0/config/authexplicit-ldap/#basedn","title":"BaseDN","text":"<p>The <code>basedn</code> is <code>dc=planetexpress,dc=com</code></p>"},{"location":"1.0/config/authexplicit-ldap/#admin-account","title":"admin account","text":"<p>The admin account is described as</p>    Admin Secret     cn=admin,dc=planetexpress,dc=com GoodNewsEveryone"},{"location":"1.0/config/authexplicit-ldap/#ou-users","title":"OU Users","text":"<ul> <li>The User Orgnanistation Unit is <code>ou=people,dc=planetexpress,dc=com</code></li> </ul>"},{"location":"1.0/config/authexplicit-ldap/#users","title":"Users","text":""},{"location":"1.0/config/authexplicit-ldap/#cnhubert-j-farnsworthoupeopledcplanetexpressdccom","title":"cn=Hubert J. Farnsworth,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Hubert J. Farnsworth   sn Farnsworth   description Human   displayName Professor Farnsworth   employeeType Owner   employeeType Founder   givenName Hubert   jpegPhoto JPEG-Photo (630x507 Pixel, 26780 Bytes)   mail professor@planetexpress.com   mail hubert@planetexpress.com   ou Office Management   title Professor   uid professor   userPassword professor"},{"location":"1.0/config/authexplicit-ldap/#cnphilip-j-fryoupeopledcplanetexpressdccom","title":"cn=Philip J. Fry,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Philip J. Fry   sn Fry   description Human   displayName Fry   employeeType Delivery boy   givenName Philip   jpegPhoto JPEG-Photo (429x350 Pixel, 22132 Bytes)   mail fry@planetexpress.com   ou Delivering Crew   uid fry   userPassword fry"},{"location":"1.0/config/authexplicit-ldap/#cnjohn-a-zoidbergoupeopledcplanetexpressdccom","title":"cn=John A. Zoidberg,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn John A. Zoidberg   sn Zoidberg   description Decapodian   displayName Zoidberg   employeeType Doctor   givenName John   jpegPhoto JPEG-Photo (343x280 Pixel, 26438 Bytes)   mail zoidberg@planetexpress.com   ou Staff   title Ph. D.   uid zoidberg   userPassword zoidberg"},{"location":"1.0/config/authexplicit-ldap/#cnhermes-conradoupeopledcplanetexpressdccom","title":"cn=Hermes Conrad,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Hermes Conrad   sn Conrad   description Human   employeeType Bureaucrat   employeeType Accountant   givenName Hermes   mail hermes@planetexpress.com   ou Office Management   uid hermes   userPassword hermes"},{"location":"1.0/config/authexplicit-ldap/#cnturanga-leelaoupeopledcplanetexpressdccom","title":"cn=Turanga Leela,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Turanga Leela   sn Turanga   description Mutant   employeeType Captain   employeeType Pilot   givenName Leela   jpegPhoto JPEG-Photo (429x350 Pixel, 26526 Bytes)   mail leela@planetexpress.com   ou Delivering Crew   uid leela   userPassword leela"},{"location":"1.0/config/authexplicit-ldap/#groups","title":"Groups","text":""},{"location":"1.0/config/authexplicit-ldap/#cnadmin_staffoupeopledcplanetexpressdccom","title":"cn=admin_staff,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass Group   cn admin_staff   member cn=Hubert J. Farnsworth,ou=people,dc=planetexpress,dc=com   member cn=Hermes Conrad,ou=people,dc=planetexpress,dc=com"},{"location":"1.0/config/authexplicit-ldap/#cnship_crewoupeopledcplanetexpressdccom","title":"cn=ship_crew,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass Group   cn ship_crew   member cn=Turanga Leela,ou=people,dc=planetexpress,dc=com   member cn=Philip J. Fry,ou=people,dc=planetexpress,dc=com   member cn=Bender Bending Rodr\u00edguez,ou=people,dc=planetexpress,dc=com"},{"location":"1.0/config/authexplicit-ldap/#insert-the-user-credentials","title":"Insert the user credentials","text":"<p>Start your web browser and open the URL <code>http://localhost</code></p> <p>The Web home page contains the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p> <p>You can use for example on user of the list above.</p>    Credentials Value     Login Turanga Leela   Password leela     <p>Insert the login credentials :</p> <p><code>Turanga Leela</code> as login and <code>leela</code> as password, then click on the <code>Sign in</code> button.</p>  <p>Look at the top of the sreen. The user name is <code>Turanga Leela</code>:  </p>"},{"location":"1.0/config/authexplicit-ldap/#applications-remainted","title":"Applications remainted","text":"<p>Start LibreOffice Writer, and start a new file for your instructor.  Type few words for example :</p> <pre><code>I like this amazing project abcdesktop.io\n</code></pre> <p>Do not save your file and just close your web browser.</p> <p>Start your web browser again, and open the same URL <code>http://localhost</code>, and log in with the same account: <code>Turanga Leela</code> as login and <code>leela</code> as password, then click on the <code>Sign in</code> button.</p> <p>The application LibreOffice Writer is still running and the greeting message <code>I like this amazing project abcdesktop.io</code></p>   <p>All applications are maintained. </p>  <p>Great, you have check how the explicit Authentification configuration works, install an openldap directory service, and check that all sessions are maintained. </p>"},{"location":"1.0/config/authexplicit/","title":"Authentification <code>explicit</code>","text":""},{"location":"1.0/config/authexplicit/#authmanagers-explicit","title":"authmanagers <code>explicit</code>:","text":"<p><code>explicit</code> authentification use a directory service. The bind operation is used to authenticate clients to the directory server, to establish an authorization identity that will be used for subsequent operations processed on that connection.</p> <p>The <code>explicit</code> authentification configuration is defined as a dictionnary object and contains an <code>explicit</code> provider. </p> <p>The <code>explicit</code> authentification support the directory services <code>ldap</code>, <code>ldaps</code>, and <code>Microsoft Active Directory</code>.</p> <p>Configuration sample for <code>Microsoft Active Directory</code></p> <p>For example :</p> <pre><code>'explicit': {\n    'show_domains': True,\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n}\n</code></pre> <pre><code>adconfig : { 'AD': {   'default'       : True, \n                       'ldap_timeout'  : 15,\n                       'ldap_protocol' : 'ldap',\n                       'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                       'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                       'domain'        : 'AD',\n                       'domain_fqdn': 'AD.DOMAIN.LOCAL',\n                       'servers'    : [ '192.168.7.12' ],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL',\n                        'query_dcs' : True,\n                        'wins_servers'  : [ '192.168.1.12' ],\n                        'serviceaccount': { 'login': 'SVCACCOUNT', 'password': 'SVCACCOUNTPASSWORD' }\n     }\n}\n</code></pre>"},{"location":"1.0/config/authexplicit/#home-page-authentification","title":"Home page authentification","text":"<p>If the authmanagers <code>explicit</code> is enabled. The Web home page insert the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p>"},{"location":"1.0/config/authexplicit/#ldap-authmanagers","title":"LDAP authmanagers :","text":"<p>Read the specific chapter on LDAP LDAP and LDAPS explicit authmanagers</p>"},{"location":"1.0/config/authexplicit/#microsoft-active-directory-authmanagers","title":"Microsoft Active Directory authmanagers :","text":"<p>Microsoft Active Directory is implemented as a LDAP Server, start reading the chapter on LDAP LDAP and LDAPS explicit authmanagers, then read the specific chapter for Microsoft Active Director Microsoft Active Directory explicit authmanagers</p> <p>Great, you have check how the explicit Authentification configuration works.</p>"},{"location":"1.0/config/authexternal/","title":"Authentification <code>external</code>","text":""},{"location":"1.0/config/authexternal/#requirements","title":"Requirements","text":"<p>To use <code>external</code> Authentification OAuth 1.0 and or OAuth 2.0, you need an internet FQDN and a secured web site with https.</p>"},{"location":"1.0/config/authexternal/#library","title":"Library","text":"<p>abcdesktop uses requests_oauthlib python module. Requests-OAuthlib uses the Python Requests and OAuthlib libraries for building OAuth1 and OAuth2 clients.</p>"},{"location":"1.0/config/authexternal/#authmanagers-external","title":"authmanagers <code>external</code>:","text":"<p><code>external</code> authentification use OAuth 2.0 authenticaton.</p> <p>The <code>external</code> authentification configuration is defined as a dictionary object and contains a list of <code>external</code> provider. </p> <p>Sample providers entry using the Google OAuth 2.0 authentification service. </p> <pre><code>'external': {\n    'providers': {\n    'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id': 'XXX-YYY.apps.googleusercontent.com', \n        'client_secret': 'XXX',\n        'userinfo_auth': True,\n        'scope': [ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ],\n        'userinfo_url': 'https://www.googleapis.com/oauth2/v1/userinfo',\n        'redirect_uri_prefix' : 'https://host.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=google',\n        'authorization_base_url': 'https://accounts.google.com/o/oauth2/v2/auth',\n        'token_url': 'https://oauth2.googleapis.com/token'\n    }\n}\n</code></pre> <p>The variable values <code>client_id</code> and <code>client_secret</code> have been set to obfuscate value 'XXX'. The FQDN is refered to the public server FQDN. </p>    Variable name Type Description Sample     <code>displayname</code> string Display Name show in Web front <code>Google</code>   <code>enabled</code> boolean LDAP Base Distinguished Names <code>True</code>   <code>client_id</code> string client id <code>XXX-YYY.apps.googleusercontent.com</code>   <code>client_secret</code> string client secret <code>XXX</code>   <code>scope</code> list of string scope <code>[ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ]</code>   <code>userinfo_url</code> string dialog URL `https://www.googleapis.com/oauth2/v1/userinfo'   <code>redirect_uri_prefix</code> string redirect URL <code>https://hostname.domain.local/API/auth/oauth</code>   <code>redirect_uri_querystring</code> string URL query string <code>manager=external&amp;provider=google</code>   <code>authorization_base_url</code> string callback URL <code>https://accounts.google.com/o/oauth2/v2/auth</code>   <code>token_url</code> string token URL <code>https://oauth2.googleapis.com/token</code>    <p>The complete redirect url concats the two values <code>redirect_uri_prefix</code> and <code>redirect_uri_querystring</code>.</p>"},{"location":"1.0/config/authexternal/#orange-oauth-20","title":"Orange OAuth 2.0","text":"<p>Orange's OAuth is supported for authentication. This API is based on OpenID Connect, which combines end-user authentication with OAuth2 authorisation. </p>"},{"location":"1.0/config/authexternal/#orange-application","title":"Orange Application","text":"<p>Create your Orange Application here https://developer.orange.com/apis and set credentials for Orange Authentification API in the section </p> <pre><code>'orange': {       \n        'displayname': 'Orange', \n        'enabled': True,\n        'basic_auth': True,\n        'userinfo_auth': True,\n        'scope' : [ 'openid', 'form_filling' ],\n        'client_id': 'XXX',\n        'client_secret': 'YYY',\n        'redirect_uri_prefix' : 'https://hostname.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=orange',\n        'authorization_base_url': 'https://api.orange.com/openidconnect/fr/v1/authorize',\n        'token_url': 'https://api.orange.com/openidconnect/fr/v1/token', \n        'userinfo_url': 'https://api.orange.com/formfilling/fr/v1/userinfo',\n      }\n</code></pre>"},{"location":"1.0/config/authexternal/#facebook-oauth-20","title":"Facebook OAuth 2.0","text":"<p>Facebook's OAuth is supported for authentication. </p>"},{"location":"1.0/config/authexternal/#facebook-application","title":"Facebook Application","text":"<p>Create your Facebook Application credentials here : https://developers.facebook.com/apps/ and set the credentials for Facebook Authentification API  </p> <pre><code>'facebook': { \n        'displayname': 'Facebook', \n        'enabled': True,\n        'userinfo_auth': True,\n        'client_id': 'XXX', \n        'client_secret': 'YYY', \n        'redirect_uri_prefix' : 'https://hostname.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=facebook',\n        'authorization_base_url': 'https://www.facebook.com/dialog/oauth',\n        'userinfo_url': 'https://graph.facebook.com/v2.6/me?fields=picture.width(400),name',\n        'token_url': 'https://graph.facebook.com/v2.3/oauth/access_token',\n        'userinfomap': {\n            '*': '*',\n            'picture': 'picture.data.url'\n        }\n</code></pre>"},{"location":"1.0/config/authexternal/#google-oauth-20","title":"Google OAuth 2.0","text":"<p>Google's OAuth is supported for authentication. The client_id is the google's OAuth client ID, and the client_secret is the OAuth client secret. </p>"},{"location":"1.0/config/authexternal/#google-application","title":"Google Application","text":"<p>Create your Google credentials here : https://console.developers.google.com/apis/ and set the correct credentials for Google Authentification API in the section [gauth]</p> <pre><code>'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id': 'XXX-YYY.apps.googleusercontent.com', \n        'client_secret': 'XXX',\n        'userinfo_auth': True,\n        'scope': [ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ],\n        'userinfo_url': 'https://www.googleapis.com/oauth2/v1/userinfo',\n        'redirect_uri_prefix' : 'https://host.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=google',\n        'authorization_base_url': 'https://accounts.google.com/o/oauth2/v2/auth',\n        'token_url': 'https://oauth2.googleapis.com/token'\n    }\n</code></pre> <p>Great, you have check how the implicit Authentification configuration works.</p>"},{"location":"1.0/config/authimplicit/","title":"Authentification <code>implicit</code>","text":""},{"location":"1.0/config/authimplicit/#authmanagers-implicit","title":"authmanagers <code>implicit</code>:","text":"<p><code>implicit</code> is the easyest configuration mode, and is used as 'Anonymous' authentification. </p> <p>The provider is defined as a dictionnary object and contains an <code>anononymous</code> provider.</p> <p><code>anononymous</code> provider always permit authentification, and create a uuid as userid. <code>anononymous</code> provider is used to skip the authentification  process in a demonstration mode.</p> <pre><code>'implicit': {\n    'providers': {\n      'anonymous': {\n        'displayname': 'Anonymous',\n        'caption': 'Have a look !',\n        'userid': 'anonymous',\n        'username': 'Anonymous'\n      }     \n    }\n</code></pre> <p><code>anononymous</code> provider always permit authentification, and create a uuid as userid. </p> <p>Set in your configuration file the authmanagers dictionnary as described</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { \n     'providers': {\n         'anonymous': {\n           'displayname': 'Anonymous',\n           'caption': 'Anonymous',\n           'userid': 'anonymous',\n           'username': 'Anonymous'\n      } \n   }\n}\n</code></pre> <p>Update your configuration file and apply the new configuration file</p> <p>Open a new Web Browser and go to your abcdesktop URL. You should see the login HTML page with the Anonymous button :</p>  <p>Press the <code>Sign-In Anonymously</code> button.</p> <p>Then, choose the <code>settings</code> in the menu at the upper right corner </p>  <p>Choose the <code>System</code> in the settings control panel.</p>  <p>Then choose <code>User containers</code></p>  <p>This screen show you the <code>hostname</code>. </p> <p>You can read the hostname. In the example the hostname is <code>f097ab7aac57</code>, from the container id.</p> <p>Using a shell, run the command docker ps -a  </p> <pre><code>docker ps -a\n</code></pre> <p>Find a running container with the containerid previously  identified.</p> <p>In this example the containerid is <code>f097ab7aac57</code></p> <pre><code>f097ab7aac57   abcdesktopio/oc.user.18.04   \"/composer/docker-en\u2026\"   8 minutes ago    Up 8 minutes               4714/tcp, 6081/tcp, 29780-29781/tcp, 29783-29784/tcp, 29786/tcp, 55556-55557/tcp   g-06b686a5-c98d-4889-b73d-3455f692e6c2\n</code></pre> <p>Run the command <code>docker inspect CONTAINERID</code>, replace the string CONTAINERID with your container id value.</p>  <p>For example <code>docker inspect f097ab7aac57</code></p>  <pre><code>docker inspect f097ab7aac57\n</code></pre> <p>Locate the <code>Mounts</code> description. User's containers created with an implicit provider anonymous have only one volume type. Anonymous home directory DO NOT USE persistant volume data. Explicit and </p> <pre><code> \"Mounts\": [\n            {\n                \"Type\": \"volume\",\n                \"Name\": \"tmp-06b686a5-c98d-4889-b73d-3455f692e6c2\",\n                \"Source\": \"/var/lib/docker/volumes/tmp-06b686a5-c98d-4889-b73d-3455f692e6c2/_data\",\n                \"Destination\": \"/tmp\",\n                \"Driver\": \"local\",\n                \"Mode\": \"z\",\n                \"RW\": true,\n                \"Propagation\": \"\"\n            },\n            {\n                \"Type\": \"volume\",\n                \"Name\": \"home-06b686a5-c98d-4889-b73d-3455f692e6c2\",\n                \"Source\": \"/var/lib/docker/volumes/home-06b686a5-c98d-4889-b73d-3455f692e6c2/_data\",\n                \"Destination\": \"/home/balloon\",\n                \"Driver\": \"local\",\n                \"Mode\": \"z\",\n                \"RW\": true,\n                \"Propagation\": \"\"\n            }\n        ],\n\n</code></pre> <p>When the anonymous container is removed, the anonymous home directory is deleted.</p> <p>Great, you have check how the implicit Authentification configuration works.</p>"},{"location":"1.0/config/balloon/","title":"balloon user entry in od.config","text":"<p><code>balloon</code> is the default generic user.</p> <p>The <code>balloon</code> user is created inside the oc.user container</p> <p>The default values are </p>    balloon Default Values     <code>name</code> <code>balloon</code>   <code>uid</code> <code>4096</code>   <code>gid</code> <code>4096</code>   <code>homedirectory</code> <code>/home/balloon</code>    <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre>"},{"location":"1.0/config/controllers/","title":"Controllers","text":""},{"location":"1.0/config/controllers/#controllers_1","title":"Controllers","text":"<p>abcdesktop.io use a Model\u2013view\u2013controller (usually known as MVC) is a software design pattern commonly used for developing user interfaces which divides the related program logic into three interconnected elements. This is done to separate internal representations of information from the ways information is presented to and accepted from the user.</p>    Controller Description     <code>AccountingController</code> accounting data json and ebnf format   <code>AuthController</code> authenticate user   <code>ComposerController</code> CRUD main services (like createDesktop, runApplication)   <code>CoreController</code> get configuration and user message info   <code>ManagerController</code> manage pyos   <code>PrinterController</code> CRUD printer object   <code>StoreController</code> CRUD key value data   <code>UserController</code> retrieve user information"},{"location":"1.0/config/controllers/#access-permission","title":"Access Permission","text":"<p>The <code>AccountingController</code> and <code>ManagerController</code> access is protected with a source ip address filter. The access control filter is defined in a dictionary. Each dictionary entry use the <code>controller</code> name and with an entry <code>permitip</code>. The <code>permitip</code> is a list of subnet, for example <code>[ '10.0.0.0/8', '172.16.0.0/12' ]</code>. If <code>permitip</code> is not set or the <code>controller</code> name is not set, all ip source address are allowed the send a request to the controller.</p> <p>The <code>controllers</code> dictionnary is defined in the <code>od.config</code> file.  By default the configuration permit private network defined in rfc1918 and rfc4193. Get more information about the private network.</p> <p>By default others controllers access is enabled, without ip restriction.</p> <pre><code>    controllers : { \n        'AccountingController': \n            { \n                'permitip': [ '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', 'fd00::/8', '169.254.0.0/16', '127.0.0.0/8' ] \n            },\n        'AuthController' :      { 'permitip': None },\n        'ComposerController' :  { 'permitip': None },\n        'CoreController' :      { 'permitip': None },\n        'ManagerController': \n            { \n                'permitip': [ '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', 'fd00::/8', '169.254.0.0/16', '127.0.0.0/8' ] \n            },\n        'PrinterController' :   { 'permitip': None },\n        'StoreController' :     { 'permitip': None },\n        'UserController' :      { 'permitip': None }\n    } \n</code></pre> <p>If the source ip address is not allowed, the response is a HTTP status <code>code 403 Forbidden</code></p> <pre><code>{\"status\": 403, \"status_message\": \"403 Forbidden\", \"message\": \"Request forbidden -- authorization will not help\"} \n</code></pre>"},{"location":"1.0/config/desktop/","title":"desktop options in od.config","text":"<p>The od.config contains options to describe how the oc.user and applications containers have to be created. Options differ if abcdesktop.io is running in <code>docker mode</code> or in <code>kubernetes mode</code>.</p>"},{"location":"1.0/config/desktop/#desktopoptions","title":"desktop.options","text":"<p>All desktop options are defined in od.config file. Desktop options start with the prefix <code>desktop.</code>, then add the name of the option.</p>    Option name Type Sample     <code>desktop.usex11unixsocket</code> boolean True   <code>desktop.defaultbackgroundcolors</code> list [ '#6EC6F0', '#333333',  '#666666', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]   <code>desktop.homedirectorytype</code> string 'volume'   <code>desktop.remotehomedirectorytype</code> list []   <code>desktop.persistentvolumeclaim</code> string None   <code>desktop.allowPrivilegeEscalation</code> boolean False   <code>desktop.securityopt</code> list [ 'no-new-privileges', 'seccomp=unconfined' ]   <code>desktop.imagePullSecret</code> string None   <code>desktop.image</code> string 'abcdesktopio/oc.user.18.04:latest'   <code>desktop.imageprinter</code> string 'abcdesktopio/oc.cupsd.18.04:latest'   <code>desktop.useprintercontainer</code> boolean False   <code>desktop.soundimage</code> string 'abcdesktopio/oc.pulseaudio.18.04'   <code>desktop.usesoundcontainer</code> boolean False   <code>desktop.usecontainerimage</code> boolean False   <code>desktop.initcontainerimage</code> string 'abcdesktopio/oc.busybox'   <code>desktop.envlocal</code> dictionary <code>{ 'DISPLAY': ':0.0', 'USER': 'balloon', 'LIBOVERLAY_SCROLLBAR': '0', 'UBUNTU_MENUPROXY': '0', 'HOME': '/home/balloon', 'LOGNAME': 'balloon' }</code>   <code>desktop.nodeselector</code> dictionary <code>{}</code>   <code>desktop.username</code> string 'balloon'   <code>desktop.userid</code> integer 4096   <code>desktop.groupid</code> integer 4096   <code>desktop.userhomedirectory</code> string <code>'/home/balloon'</code>   <code>desktop.useinternalfqdn</code> boolean False   <code>desktop.uselocaltime</code> boolean False   <code>desktop.host_config</code> dictionary <code>{  'auto_remove'   : True, 'ipc_mode'      : 'shareable', 'network_mode'  : 'container', 'shm_size'      : '128M', 'mem_limit'     : '512M', 'cpu_period'    : 100000, 'cpu_quota'     : 150000, 'security_opt'  : [ 'seccomp=unconfined' ] }</code>   <code>desktop.application_config</code> dictionary <code>{  'auto_remove'   : True, 'ipc_mode'      : 'shareable', 'pid_mode'      : True, 'network_mode'  : 'container', 'shm_size'      : '512M', 'mem_limit'     : '2G', 'cpu_period'    : 200000, 'cpu_quota'     : 150000, 'security_opt'  : [ 'seccomp=unconfined' ] }</code>   <code>desktop.policies</code> dictionary <code>{ 'rules':{}, 'max_app_counter':5 }</code>   <code>desktop.webhookdict</code> dictionary <code>{ 'firewall': '192.168.7.1' }</code>"},{"location":"1.0/config/desktop/#desktopusex11unixsocket","title":"desktop.usex11unixsocket","text":"<p>The <code>desktop.usex11unixsocket</code> force the X11 server to use local unix socket. The name of the X11 unix socket is <code>/tmp/.X11-unix/X0</code></p> <ul> <li> <p>If this feature is enable: A container application need a the DISPLAY. The DISPLAY is in this case <code>:0.0</code>. The container application and the oc.user container share the same volume <code>/tmp</code>, and share the X11 unix socket is <code>/tmp/.X11-unix/X0</code>.</p> </li> <li> <p>If this feature is disable: A container application need a DISPLAY. The DISPLAY is <code>:0.0</code> (don't think at <code>IPADDRESS_OF_X11_SERVER:0.0</code> to protect X11 access control). The two containers share the same network stack by default. The X11 server NEED to listen to a TCP or UDP port.</p> </li> </ul> <p>You can disable this features, but you have to replace the default  TigerVNC by another X11 Server and a VNC Server. You can choose (x.org + x11vnc) for example, but you need more CPU ressource than TigerVNC.  </p> <p>TigerVNC does not support to listen on TCP Port. TigerVNC is a X11 and a VNC Server.</p> <p>Set the <code>desktop.usex11unixsocket</code> value to <code>True</code> in most case, and this should not be changed.</p>"},{"location":"1.0/config/desktop/#desktopshareipcnamespace","title":"desktop.shareipcnamespace","text":"<p>The type of desktop.shareipcnamespace is a string. The default value is 'shareable' This option permit user contain to share the ipc namespace with application</p>    Value Description     <code>''</code> Use daemon\u2019s default.   <code>'none'</code> Own private IPC namespace, with /dev/shm not mounted.   <code>'private'</code> Own private IPC namespace.   <code>'shareable'</code> Own private IPC namespace, with a possibility to share it with other containers.   <code>'host'</code> Use the host system\u2019s IPC namespace.    <p>If not specified, daemon default is used, which can either be <code>'private'</code> or <code>'shareable'</code>, depending on the daemon version and configuration. IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments, semaphores and message queues. </p> <p>Shared memory segments are used to accelerate inter-process communication at memory speed, rather than through pipes or through the network stack. Shared memory is commonly used by databases and custom-built (typically C/OpenMPI, C++/using boost libraries) high performance applications for scientific computing and financial services industries. </p> <p>If these types of applications are broken into multiple containers, you might need to share the IPC mechanisms of the containers, using \"shareable\" mode for the main (i.e. \u201cdonor\u201d) container, and containers can access \"container:\". <p>Default value <code>desktop.shareipcnamespace : 'shareable'</code></p>"},{"location":"1.0/config/desktop/#desktophomedirectory","title":"desktop.homedirectory","text":"<p>This option describes how the default home directory for user user ballon should be created :</p> <ul> <li><code>None</code>: no dedicated volume is created, the oc.user container use a directory inside the container. All user data will be removed at logout.</li> <li><code>'volume'</code>: This value is only recommended in docker mode. <code>'volume'</code>option create a dedicated volume, the oc.user container and applications may share this volume. User home data are persistent.</li> <li><code>'persistentVolumeClaim'</code>: This value is only avalaible in kubernetes. PersistentVolumeClaim option use a persistentVolumeClaim to create the user home directory. The persistentVolumeClaim can be mapped to differents storage data (like NFS, iSCSI, RBD...). Read more about persistentVolumeClaim on the kubernetes.io website. You need the set the value of <code>desktop.persistentvolumeclaim</code> or create a default Persistent Volume Claim named <code>'abcdesktop-pvc'</code></li> </ul>"},{"location":"1.0/config/desktop/#desktoppersistentvolumeclaim","title":"desktop.persistentvolumeclaim","text":"<p>This value is only avalaible in kubernetes mode.</p> <p><code>desktop.persistentvolumeclaim</code> is the name of the Persistent Volume Claim if the <code>desktop.homedirectory</code> is set to <code>'persistentVolumeClaim'</code>. The PVC (Persistent Volume Claim) must exist.</p> <p>Run the <code>kubectl get pvc command</code> to list the persistent volume claim</p> <pre><code>NAME                                   STATUS   VOLUME                     CAPACITY   ACCESS MODES   STORAGECLASS           AGE\nabcdesktop-pvc                        Bound    abcdesktop-pv             5Gi        RWO            abcdesktop-standard   170d\n</code></pre>"},{"location":"1.0/config/desktop/#desktopremotehomedirectorytype","title":"desktop.remotehomedirectorytype","text":"<p>desktop.remotehomedirectorytype is a list of string. Each string describe if the remount access to a directory is allowed. example [ 'cifs', 'webdav' ]</p> <p>For each entry in the desktop.remotehomedirectorytype list, abcdesktop.io try to mount the remote file system using data from the implicit auth provider.</p> <p>If <code>desktop.remotehomedirectorytype</code> contains 'cifs' and if the authentification provider get <code>homeDrive</code> and <code>homeDirectory</code> attributs then abcdesktop request the kubernetes abcdesktop/CIFS Driver to mount the remote filesystem. The user find a mount point named <code>homeDrive</code> value, and mounted to <code>homeDirectory</code>.</p>"},{"location":"1.0/config/desktop/#desktopallowprivilegeescalation","title":"desktop.allowPrivilegeEscalation","text":"<p>The <code>desktop.allowPrivilegeEscalation</code> option allow a user to run a sudo command. The execve system call can grant a newly-started program privileges that its parent did not have, such as the setuid or setgid Linux flags.</p> <p>The default value is <code>False</code>  You should only set <code>desktop.allowPrivilegeEscalation</code> to run <code>sudo</code> command.</p> <p>In production this value MUST be set to <code>False</code></p>"},{"location":"1.0/config/desktop/#desktopdefaultbackgroundcolors","title":"desktop.defaultbackgroundcolors","text":"<p>The <code>desktop.defaultbackgroundcolors</code> allow you to change the default background color.</p> <p>The default value is a list of string <code>[ '#6EC6F0', '#333333',  '#666666', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]</code></p> <p>The <code>desktop.defaultbackgroundcolors</code> length can contain up to 8 entries. To see the color </p> <p>Open the url http://localhost, in your web browser, to start a simple abcdesktop.io container. </p> <pre><code>http://localhost\n</code></pre> <p>You should see the abcdesktop.io home page.</p> <p>Press the <code>Connect with Anonymous access, have look</code></p> <p>At the right top corner, click on the menu and choose <code>Settings</code>, then click on <code>Screen Colors</code></p> <p>You should see the default background colors, for example : </p>"},{"location":"1.0/config/desktop/#desktopimagepullsecret","title":"desktop.imagePullSecret","text":"<p>The <code>desktop.imagePullSecret</code> is the name of the secret used by Kubernetes to access to the private registry. The type of <code>desktop.imagePullSecret</code> is a string. This option is only available in Kubernetes mode, and anly used if you need to store the abcdesktop docker image on a private registry. </p> <ul> <li>Example to build a registry Kubernetes secret named abcdesktopregistrysecret with the docker hub.</li> </ul> <pre><code>kubectl create secret docker-registry abcdesktopregistrysecret --docker-server=https://index.docker.io/v1/ --docker-username=XXXXXXX --docker-password=YYYYYYYU\n</code></pre> <ul> <li>Example to build a registry Kubernetes secret named abcdesktopregistrysecret with your own privateregistry</li> </ul> <pre><code>kubectl create secret docker-registry abcdesktopregistrysecret --docker-server=registry.mydomain.local:443 --docker-username=XXXXXXX --docker-password=YYYYYYYU\n</code></pre>"},{"location":"1.0/config/desktop/#desktopimage","title":"desktop.image","text":"<p>The <code>desktop.image</code> is the name of the X11 server container The default value is <code>abcdesktopio/oc.user.18.04</code></p>"},{"location":"1.0/config/desktop/#desktopprinterimage","title":"desktop.printerimage","text":"<p>The <code>desktop.printerimage</code> is the name of the  printer container The default value is <code>abcdesktopio.oc.cupds.18.04</code></p>"},{"location":"1.0/config/desktop/#desktopuseprintercontainer","title":"desktop.useprintercontainer","text":"<p>The <code>desktop.useprintercontainer</code> is boolean, to use printer <code>cupsd</code> service as an separated container. This value is only available in kubernetes mode.  The default value is <code>False</code>.</p>"},{"location":"1.0/config/desktop/#desktopsoundimage","title":"desktop.soundimage","text":"<p>The <code>desktop.soundimage</code> is the name of the sound container image The default value is <code>abcdesktopio/oc.pulseaudio.18.04</code></p>"},{"location":"1.0/config/desktop/#desktopusesoundcontainer","title":"desktop.usesoundcontainer","text":"<p>The <code>desktop.usesoundcontainer</code> is boolean, to use pulseaudio service as a separated container. This value is only available in kubernetes mode. The default value is <code>False</code>.</p>"},{"location":"1.0/config/desktop/#desktopuseinitcontainer","title":"desktop.useinitcontainer","text":"<p>The <code>desktop.useinitcontainer</code> is boolean, to use init container. The default value is <code>False</code>. The code call the <code>desktop.initcontainercommand</code> list .</p> <p>The initcontainerimage is a busybox shell, for example to make sure that the home directory belongs to user balloon. </p>  <p><code>/home/balloon</code> must belong to <code>balloon</code> default user and <code>balloon</code> default group.</p>"},{"location":"1.0/config/desktop/#desktopinitcontainercommand","title":"desktop.initcontainercommand","text":"<p>The <code>desktop.initcontainercommand</code> runs the command at init container. The default value is <code>None</code>, the default type is <code>list</code>.</p> <p>desktop.initcontainercommand example :</p> <pre><code>desktop.initcontainercommand : [ 'sh', '-c', 'chown 4096:4096 /home/balloon' ]\n</code></pre> <p>This option is used when presistent volume data mount a nfs storage. The uid and gid of /home/balloon must be set to the default value of <code>(balloon:balloon) (4096:4096)</code>. </p>"},{"location":"1.0/config/desktop/#desktopinitcontainerimage","title":"desktop.initcontainerimage","text":"<p>The <code>desktop.initcontainerimage</code> is the name of the init container image. The default value is <code>busybox</code>. </p>"},{"location":"1.0/config/desktop/#desktopenvlocal","title":"desktop.envlocal","text":"<p><code>desktop.envlocal</code> is a dictionary. <code>desktop.envlocal</code> contains a (key,value) added as environment variables to oc.user.</p> <p>The default value is :</p> <pre><code>{ \n        'DISPLAY': ':0.0', \n        'USER': 'balloon', \n        'LIBOVERLAY_SCROLLBAR': '0',\n        'WINEARCH': 'win32',\n        'UBUNTU_MENUPROXY': '0',\n        'HOME': '/home/balloon',\n        'LOGNAME': 'balloon',\n        'PULSE_SERVER: '/tmp/.pulse.sock', \n        'CUPS_SERVER': '/tmp/.cups.sock' \n}\n</code></pre>  <p>Add <code>'CUPS_SERVER: '/tmp/.cups.sock'</code>  only if <code>desktop.useprintercontainer</code> is True. Add <code>'PULSE_SERVER: '/tmp/.pulse.sock'</code> only if <code>desktop.usesoundcontainer</code> is True.</p>"},{"location":"1.0/config/desktop/#desktopnodeselector","title":"desktop.nodeselector","text":"<p><code>desktop.nodeselector</code> is a dictionary. This option permits to assign user pods to nodes. It specifies a map of key-value pairs. For the pod to be eligible to run on a node, the node must have each of the indicated key-value pairs as labels (it can have additional labels as well).  The most common usage is one key-value pair. </p> <pre><code>{ 'disktype': 'ssd' }\n</code></pre>"},{"location":"1.0/config/desktop/#desktopusername","title":"desktop.username","text":"<p><code>desktop.username</code> describes the balloon user created inside the oc.user container. The type of desktop.username is string. The default value is 'balloon'.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"1.0/config/desktop/#desktopuserid","title":"desktop.userid","text":"<p><code>desktop.userid</code> describes the <code>uid</code> of the user created inside the oc.user container.     The type of desktop.userid is integer. The default value is 4096.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"1.0/config/desktop/#desktopgroupid","title":"desktop.groupid","text":"<p><code>desktop.groupid</code> describes the <code>gid</code> of the user created inside the oc.user container. The type of desktop.userid is integer. The default value is 4096.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>RUN groupadd --gid 4096 $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"1.0/config/desktop/#desktopuserhomedirectory","title":"desktop.userhomedirectory","text":"<p><code>desktop.userhomedirectory</code> describes the <code>homedirectory</code> of the user created inside the oc.user container. The type of <code>desktop.userhomedirectory</code> is string. The default value is <code>/home/balloon</code>.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"1.0/config/desktop/#desktopuselocaltime","title":"desktop.uselocaltime","text":"<p>The <code>desktop.uselocaltime</code> is boolean, to use host value of <code>/etc/localtime</code>. The default value is <code>False</code>. If <code>desktop.uselocaltime</code> is True, this add a volume mapping from host file  <code>/etc/localtime</code> to container file <code>/etc/localtime</code>.</p>"},{"location":"1.0/config/desktop/#desktoppolicies","title":"desktop.policies","text":"<p>The <code>desktop.policies</code> is a dictionary.</p>    Entry Description     <code>max_app_counter</code> limit applications counter, without checking the docker container status   <code>rules</code> rules dictionary <code>'rules': { 'volumes': { 'domainuser':  { 'type': 'cifs', 'name': 'homedirectory', 'volumename': 'homedir' } }</code>   <code>acl</code> allow or denied desktop creation    <p>Example</p> <pre><code>desktop.policies: { 'rules':\n    { 'volumes': \n        { 'domainuser':  \n            { 'type': 'cifs', 'name': 'homedirectory', 'volumename': 'homedir' },\n            'Mygroupteam':  { 'type': 'cifs', 'name': 'toto', 'unc': '//192.168.7.101/team', 'volumename': 'team' } \n            } \n        },\n      'acls' : {},\n      'max_app_counter' : 4  }\n</code></pre>"},{"location":"1.0/config/desktop/#desktopapplication_config","title":"desktop.application_config","text":"<p>Default application host_config dictionary, maps the dictionary as arguments from docker API  create_host_config</p> <p>Define how the application can be run, read host_config  description page to get more informations</p>"},{"location":"1.0/config/desktop/#desktophost_config","title":"desktop.host_config","text":"<p>Default desktop oc.user host_config dictionary, maps the dictionary as arguments from docker API  create_host_config</p> <p>Define how the oc.user container can be run, read host_config description page to get more informations</p>"},{"location":"1.0/config/desktop/#desktopwebhookdict","title":"desktop.webhookdict","text":"<p>desktop.webhookdict is a dictionary to add key/value to the command <code>create</code> and <code>destroy</code> in rules objects.</p>"},{"location":"1.0/config/desktop/#experimental-features","title":"Experimental features","text":""},{"location":"1.0/config/desktop/#desktopdesktopuseinternalfqdn","title":"desktop.desktopuseinternalfqdn","text":"<p>WARNING <code>desktop.desktopuseinternalfqdn</code> is an experimental feature, keep this value to False in production</p> <p><code>desktop.desktopuseinternalfqdn</code> describes the content of the payload data in the JWT Desktop Token. The default value is <code>False</code>. </p> <p>Nginx front end act as a reverse proxy. This reverse proxy use the FQDN of the user's pod to route http request. If this value is set to <code>False</code> the payload data in the JWT Desktop Token contains the IP Address of the user Pod. If this value is set to <code>True</code> the payload data in the JWT Desktop Token contains the FQDN of the user Pod.</p> <p>If you CAN NOT add <code>endpoint_pod_names</code> in the coredns configuration, you MUST set <code>desktop.desktopuseinternalfqdn</code> to <code>False</code>. This choice is less secure.</p> <p>To set <code>desktop.desktopuseinternalfqdn</code> to <code>True</code> value, you have to update the <code>coredns</code> ConfigMap.</p> <pre><code>kind: ConfigMap\napiVersion: v1\nmetadata:\n  name: coredns\n  namespace: kube-system\ndata:\n  Corefile: |\n    .:53 {\n        log\n        errors\n        health\n        ready\n        kubernetes cluster.local in-addr.arpa ip6.arpa {\n           endpoint_pod_names\n           pods insecure\n           fallthrough in-addr.arpa ip6.arpa\n           transfer to * \n           ttl 30\n        }\n        prometheus :9153\n        forward . /etc/resolv.conf\n        cache 30\n        loop\n        reload\n        loadbalance\n    }\n</code></pre>"},{"location":"1.0/config/editconfig/","title":"Edit pyos core service configuration file","text":"<p>Update the Pyos core service configuration file depends, if your are running abcdesktop.io on native Docker (Non-Cluster Host) or in Kubernetes mode.</p> <ul> <li> <p>In Kubenetes Mode: Read the setup guide, to make change in the abcdesktop yaml file. Setup and configuration guide for kubernetes abcdesktop</p> </li> <li> <p>In Docker Mode : Read the following chapter</p> </li> </ul> <p>This chapter 'Edit Pyos configuration file', apply only for native Docker (Non-Cluster Host), read the dedicated chapter if you are running abcdesktop.io with a kubernetes cluster.</p>"},{"location":"1.0/config/editconfig/#edit-pyos-code-service-configuration-file-in-docker-mode","title":"Edit Pyos code service configuration file in docker mode","text":""},{"location":"1.0/config/editconfig/#requirements","title":"Requirements","text":"<ul> <li>A running dockerd last version </li> <li>An access to the docker public registry</li> <li>The <code>docker-compose</code> command ready to run</li> </ul>"},{"location":"1.0/config/editconfig/#download-sample-configuration-file","title":"Download sample configuration file","text":"<p>Create a directotry named <code>abcdesktop</code> in your home directory.</p> <pre><code>cd\nmkdir -p abcdesktop\n</code></pre> <p>To edit you configuration file in abcdesktop.io docker mode, download the sample configuration file and save it as <code>od.config</code> where docker-compose.yml file is located.</p> <p>Download sample configuration file od.config then rename the <code>od.config.reference</code> file as <code>od.config</code></p>"},{"location":"1.0/config/editconfig/#stop-your-docker-compose","title":"Stop your docker-compose","text":"<pre><code> docker-compose down\n</code></pre> <p>You should read on the standart output</p> <pre><code>Removing open_nginx_1     ... done\nRemoving open_pyos_1      ... done\nRemoving open_memcached_1 ... done\nRemoving open_speedtest_1 ... done\nRemoving open_mongodb_1   ... done\nNetwork netuser is external, skipping\nNetwork netback is external, skipping\n</code></pre>"},{"location":"1.0/config/editconfig/#edit-your-docker-composeyml","title":"Edit your <code>docker-compose.yml</code>","text":"<p>Edit your <code>docker-compose.yml</code> to add a volumes entry to pyos services</p>  <p>Example : My working directory is <code>/home/alex/abcdesktop</code></p>  <p>Add the new entry in volumes    </p> <pre><code> volumes:\n      - /home/alex/abcdesktop/od.config:/var/pyos/od.config\n</code></pre> <p>For example, the <code>docker-compose.yml</code> contains</p> <pre><code>version: '3'\nservices:\n  pyos:\n    depends_on:\n      - memcached\n      - mongodb\n    image: 'abcdesktopio/oc.pyos'\n    networks:\n      - netback\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - /home/alex/abcdesktop/od.config:/var/pyos/od.config\n  speedtest:\n    image: 'abcdesktopio/oc.speedtest'\n    networks:\n      - netuser\n  nginx:\n    depends_on:\n      - memcached\n      - pyos\n    image: 'abcdesktopio/oc.nginx'\n    ports:\n      - '80:80'\n      - '443:443'\n    networks:\n      - netuser\n      - netback\n  memcached:\n    image: memcached\n    networks:\n      - netback\n  mongodb:\n    image: mongo\n    networks:\n      - netback\nnetworks:\n  netuser:\n    driver: bridge\n  netback:\n    internal: true\n</code></pre>"},{"location":"1.0/config/editconfig/#edit-your-configuration-file","title":"Edit your configuration file","text":"<p>Now, it's time to make a change in your od.config file.</p> <p>Download the od.config file and save it to your abcdesktop local directory.</p> <p>To make change, edit your own <code>od.config</code> file</p> <pre><code>vim od.config \n</code></pre> <p>Change the defaultbackgroundcolors in the desktop options.</p> <p>Locate the line <code>desktop.defaultbackgroundcolors</code> and update the first entries with the values <code>'#FF0000', '#FFFFFF',  '#0000FF'</code></p> <pre><code>desktop.defaultbackgroundcolors : [ '#FF0000', '#FFFFFF',  '#0000FF', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]\n</code></pre> <p>Save your local oc.config file.</p> <p>Run your docker-compose</p> <p>To restart your docker-compose, run the command</p> <pre><code> docker-compose up\n</code></pre>  <p>When the od.config change, od.py reload this configuration file automatically. </p>  <p>You should read at the standard ouput of docker-compose</p> <pre><code>Starting abcdesktop_speedtest_1 ... done\nStarting abcdesktop_mongodb_1   ... done\nStarting abcdesktop_memcached_1 ... done\nStarting abcdesktop_openldap_1  ... done\nStarting abcdesktop_pyos_1      ... done\nStarting abcdesktop_nginx_1     ... done\n[ lines cut here ]\n</code></pre>"},{"location":"1.0/config/editconfig/#check-that-the-new-colors-are-painted-in-front","title":"Check that the new colors are painted in front :","text":"<p>Open the url http://localhost, in your web browser, to start a simple abcdesktop.io container. </p> <pre><code>http://localhost\n</code></pre> <p>You should see the abcdesktop.io home page.</p> <p>Press the <code>Sign-in Anonymously, have look</code></p> <p>At the right top corner, click on the menu and choose <code>Settings</code>, then click on <code>Screen Colors</code></p> <p>Choose your colors and you should have it as background color :</p>  <p>Great, you can easily update your configuration file od.config. We will make some changes during the next exercices.</p>"},{"location":"1.0/config/frontjs/","title":"dock configuration in od.config","text":""},{"location":"1.0/config/frontjs/#menu-setting","title":"Menu Setting","text":"<p>The menu can be changed using the dictionnary object <code>menuconfig</code></p> <pre><code>menuconfig : {\n    'settings'  : True, \n    'appstore'  : True, \n    'screenshot'    : True, \n    'download'  : True, \n    'logout'        : True, \n    'disconnect'    : True \n}\n</code></pre>"},{"location":"1.0/config/frontjs/#default-dock-config","title":"default dock config","text":"<p>The dock session in od.config file describe the default docker in abcdesktop.io. The default dock value contains the default applications. The <code>dock</code> option is a dictionnary read by the front web as a json object.</p>    docker entry Descriptions     <code>filemanager</code> FileManager application   <code>terminal</code> Terminal application   <code>webshell</code> HTML 5, terminal application based on xterm.js   <code>webshorcut</code> Web browser url launch inside the container    <pre><code>dock : {       \n    'filemanager':  {       'args': None,\n                            'showinview': u'dock',\n                            'name': u'FileManager',\n                            'keyword': u'files,file manager',\n                            'launch': u'nautilus.Nautilus',\n                            'displayname': u'FileManager',\n                            'execmode': u'builtin',\n                            'cat': u'utilities,office',\n                            'id': u'filemanager.d',\n                            'icon': u'pantheon-files-icons.svg' },\n    'terminal':     {       'args': '',\n                            'name': u'TerminalBuiltin',\n                            'keyword': u'terminal,shell,bash,builtin,pantheon',\n                            'launch': u'qterminal.qterminal',\n                            'displayname': u'Terminal Builtin',\n                            'execmode': u'builtin',\n                            'cat': u'utilities,development',\n                            'id': u'terminalbuiltin.d',\n                            'hideindock': True,\n                            'icon': u'pantheon-terminal-builtin-icons.svg' },\n\n    'webshell':     {       'name': u'WebShell',\n                            'keyword': u'terminal,shell,webshell,bash',\n                            'launch': u'frontendjs.webshell',\n                            'displayname': u'Web Shell',\n                            'execmode': u'frontendjs',\n                            'cat': u'utilities,development',\n                            'id': u'webshell.d',\n                            'icon': u'webshell.svg' }\n}\n</code></pre>"},{"location":"1.0/config/frontjs/#additional-applications","title":"Additional applications","text":"<p>This feature is deprecated. To run embeded application inside the oc.user image container, with specific attribut <code>{ 'execmode': 'builtin' }</code> add </p> <pre><code>'webshortcut':  {   'name': u'xlogo',\n                    'showinview': u'dock',\n                    'keyword': u'xlogo',\n                    'execmode': u'builtin',\n                    'launch': u'/usr/bin/xlogo',\n                    'displayname': u'xlogo',\n                    'execmode': u'builtin',\n                    'cat': u'utilities',\n                    'id': u'xlogo.d',\n                    'icon': u'xlogo.svg',\n                    'hideindock': False,\n                    'args': '' \n}\n</code></pre>"},{"location":"1.0/config/host_config/","title":"host_config resource description","text":"<p><code>host_config</code> resource description allows to change the running context for docker application. <code>host_config</code> is a dictionary and uses the same format in <code>applist.json</code> file and <code>od.config</code> file.</p> <p>The same <code>host_config</code> format is reused in a multiple configuration files. <code>host_config</code> is present in <code>applist.json</code> file to build application image, and in <code>od.config</code> to set default running values in desktop and in application.</p> <p>For example you can set low cpu and memory values to an application like the great X11 xeyes.</p> <pre><code>{   \n    \"mem_limit\":  \"32M\", \n    \"shm_size\":   \"OM\", \n    \"cpu_period\":  50000, \n    \"cpu_quota\":   50000, \n    \"pid_mode\":   false, \n    \"network_mode\": \"none\" \n}\n</code></pre>"},{"location":"1.0/config/host_config/#host_config-entries","title":"host_config entries","text":"Key name Type Description     <code>auto_remove</code> bool enable auto removal of the container on daemon side when the container\u2019s process exits.   <code>cpu_period</code> int The length of a CPU period in microseconds.   <code>cpu_quota</code> int Microseconds of CPU time that the container can get in a CPU period.   <code>cpu_shares</code> int CPU shares relative weight.   <code>cpuset_cpus</code> str CPUs in which to allow execution 0 3 0 1 .   <code>cpuset_mems</code> str Memory nodes    MEMs in which to allow execution 0 3 0 1. Only effective on NUMA systems.   <code>device_cgroup_rules</code> list A list of cgroup rules to apply to the container.   <code>device_read_bps</code> bytes per second Limit read rate from a device in the form of: [{\u201cPath\u201d: \u201cdevice_path\u201d \u201cRate\u201d: rate}]   <code>device_read_iops</code> IO per second Limit read rate from a device.   <code>device_write_bps</code> bytes per second Limit write rate from a device.   <code>device_write_iops</code> IO per second Limit write rate from a device.   <code>devices</code> list Expose host devices to the container as a list of strings in the form ::. For example /dev/sda:/dev/xvda:rwm allows the container to have read write access to the host\u2019s /dev/sda via a node named /dev/xvda inside the container.   <code>device_requests</code> list Expose host resources such as GPUs to the container as a list of docker.types.DeviceRequest instances.   <code>ipc_mode</code> str Set the IPC mode for the container.   <code>mem_limit</code> float or str Memory limit. Accepts float values which represent the memory limit of the created container in bytes or a string with a units identification char 100000b 1000k 128m 1g.   <code>mem_reservation</code> float or str Memory soft limit   <code>mem_swappiness</code> int Tune a container s memory swappiness behavior. Accepts number between 0 and 100.   <code>memswap_limit</code> str or int Maximum amount of memory + swap a container is allowed to consume.   <code>oom_kill_disable</code> bool Whether to disable OOM killer.   <code>oom_score_adj</code> int An integer value containing the score given to the container in order to tune OOM killer preferences.   <code>shm_size</code> str or int Size of /dev/shm e.g. 1G.   <code>cap_add</code> list of str Add kernel capabilities.  <code>{ 'add': [ 'SYS_ADMIN', 'SYS_PTRACE' ]}</code>for example to permit the call ptrace: <code>SYS_PTRACE</code>, trace arbitrary processes using ptrace, and <code>SYS_ADMIN</code>, perform a range of system administration operations. Read the docker run command informations https://docs.docker.com/engine/reference/run/ chapter Runtime privilege and Linux capabilities   <code>cap_drop</code> list of str Drop kernel capabilities.   <code>dns</code> list Set custom DNS servers.   <code>dns_opt</code> list Additional options to be added to the container\u2019s resolv.conf file   <code>dns_search</code> list DNS search domains.   <code>extra_hosts</code> dict Additional hostnames to resolve inside the container as a mapping of hostname to IP address.   <code>group_add</code> list List of additional group names and/or IDs that the container process will run as.   <code>isolation</code> str Isolation technology to use. Default: None.   <code>pid_mode</code> str  or bool If set to hostuse the host PID namespace inside the container. If set to host, use the host PID namespace inside the container.   <code>pids_limit</code> int Tune a container\u2019s pids limit. Set -1 for unlimited.   <code>privileged</code> bool Give extended privileges to this container.   <code>security_opt</code> list A list of string values to customize labels for MLS systems such as SELinux.   <code>storage_opt</code> dict Storage driver options per container as a key value mapping.   <code>sysctls</code> dict Kernel parameters to set in the container.   <code>ulimits</code> list Ulimits to set inside the container as a list of docker.types.Ulimit instances.   <code>userns_mode</code> str Sets the user namespace mode for the container when user namespace remapping option is enabled. Supported values are: host   <code>uts_mode</code> str Sets the UTS namespace mode for the container. Supported values are: host   <code>runtime</code> str Runtime to use with this container.   <code>network_mode</code> str One of: bridge Create a new network stack for the container on the bridge network. none No networking for this container. container: Reuse another container\u2019s network stack. host Use the host network stack. This mode is incompatible with port_bindings."},{"location":"1.0/config/host_config/#main-host_config-entries-descriptions","title":"Main host_config entries descriptions","text":""},{"location":"1.0/config/host_config/#auto_remove","title":"<code>auto_remove</code>","text":"<p>The <code>auto_remove</code> is use to remove or not remove an abcdesktop container application or desktop.</p>  <p>For example, when an application container is exited,  do we need to remove the container, by running the <code>docker rm</code> command ?</p>  <p>By default the auto_remove is <code>True</code>. But if you need to keep your application container to post-mortem debugging or to get some value, set this value to <code>False</code>. Set this value to <code>False</code> only to troubleshoot an application. </p> <p>In production this value MUST be set to <code>True</code></p>"},{"location":"1.0/config/host_config/#cpu_period-cpu_quota","title":"<code>cpu_period</code> <code>cpu_quota</code>","text":"<p><code>cpu_period</code> Specify the CPU CFS scheduler period, which is used alongside --cpu-quota. Defaults to 100000 microseconds (100 milliseconds). Most users do not change this from the default. </p> <p><code>cpu-quota</code> impose a CPU CFS quota on the container. The number of microseconds per --cpu-period that the container is limited to before throttled. As such acting as the effective ceiling. </p>"},{"location":"1.0/config/host_config/#privileged","title":"<code>privileged</code>","text":"<p>The <code>privileged</code> option runs a user container in <code>privileged</code> mode. When the operator executes docker run privileged, docker will enable access to all devices on the host as well as set some configuration in AppArmor or SELinux to allow the container nearly all the same access to the host as processes running outside containers on the host.allow a user to run a sudo command. The default value is <code>False</code>. You should only set privilege to True for troobleshooting. In production this value MUST be set to False.</p>"},{"location":"1.0/config/host_config/#ipc_mode","title":"<code>ipc_mode</code>","text":"<p>The <code>ipc_mode</code> value is a string, the default value is <code>'shareable'</code>. This option permits user's container to share the ipc namespace with application This option is used by pulseaudio service by default. </p>    value description     <code>''</code> Use daemon default.   <code>'none'</code> Own private IPC namespace.   <code>'private'</code> Own private IPC namespace.   <code>'shareable'</code> Own private IPC namespace, with a possibility to share it with other containers.   <code>'host'</code> Use the host system IPC namespace.    <p>If not specified, daemon default is used, which can either be \"private\" or \"shareable\", depending on the daemon version and configuration. IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments, semaphores and message queues. Shared memory segments are used to accelerate inter-process communication at memory speed, rather than through pipes or through the network stack. Shared memory is commonly used by databases and custom-built.  If these types of applications are broken into multiple containers, you might need to share the IPC mechanisms of the containers, using shareable mode for the main (i.e. donor) container, and container: for other containers."},{"location":"1.0/config/host_config/#security_opt","title":"<code>security_opt</code>","text":"<p>The <code>securityopt</code> option allow to set the <code>security_opt</code> default value for a docker application container. <code>security_opt</code> is the docker parameter.</p> <ul> <li>To run without the default seccomp profile <code>seccomp=unconfined</code></li> <li>To disable sudo command add <code>no-new-privileges</code> to the list. For example: <code>[ 'no-new-privileges', 'seccomp=unconfined' ]</code></li> </ul> <p>Docker's default seccomp profile is a whitelist which specifies the calls that are allowed. The table below lists the significant (but not all) syscalls that are effectively blocked because they are not on the whitelist. The table includes the reason each syscall is blocked rather than white-listed.</p>    Syscall Description     <code>acct</code> Accounting syscall which could let containers disable their own resource limits or process accounting. Also gated by <code>CAP_SYS_PACCT</code>.   <code>add_key</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>bpf</code> Deny loading potentially persistent bpf programs into kernel, already gated by <code>CAP_SYS_ADMIN</code>.   <code>clock_adjtime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>clock_settime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>clone</code> Deny cloning new namespaces. Also gated by <code>CAP_SYS_ADMIN</code> for CLONE_* flags, except <code>CLONE_USERNS</code>.   <code>create_module</code> Deny manipulation and functions on kernel modules. Obsolete. Also gated by <code>CAP_SYS_MODULE</code>.   <code>delete_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>finit_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>get_kernel_syms</code> Deny retrieval of exported kernel and module symbols. Obsolete.   <code>get_mempolicy</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>init_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>ioperm</code> Prevent containers from modifying kernel I/O privilege levels. Already gated by <code>CAP_SYS_RAWIO</code>.   <code>iopl</code> Prevent containers from modifying kernel I/O privilege levels. Already gated by <code>CAP_SYS_RAWIO</code>.   <code>kcmp</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>kexec_file_load</code> Sister syscall of <code>kexec_load</code> that does the same thing, slightly different arguments. Also gated by <code>CAP_SYS_BOOT</code>.   <code>kexec_load</code> Deny loading a new kernel for later execution. Also gated by <code>CAP_SYS_BOOT</code>.   <code>keyctl</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>lookup_dcookie</code> Tracing/profiling syscall, which could leak a lot of information on the host. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>mbind</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>mount</code> Deny mounting, already gated by <code>CAP_SYS_ADMIN</code>.   <code>move_pages</code> Syscall that modifies kernel memory and NUMA settings.   <code>name_to_handle_at</code> Sister syscall to <code>open_by_handle_at</code>. Already gated by <code>CAP_DAC_READ_SEARCH</code>.   <code>nfsservctl</code> Deny interaction with the kernel nfs daemon. Obsolete since Linux 3.1.   <code>open_by_handle_at</code> Cause of an old container breakout. Also gated by <code>CAP_DAC_READ_SEARCH</code>.   <code>perf_event_open</code> Tracing/profiling syscall, which could leak a lot of information on the host.   <code>personality</code> Prevent container from enabling BSD emulation. Not inherently dangerous, but poorly tested, potential for a lot of kernel vulns.   <code>pivot_root</code> Deny <code>pivot_root</code>, should be privileged operation.   <code>process_vm_readv</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>process_vm_writev</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>ptrace</code> Tracing/profiling syscall. Blocked in Linux kernel versions before 4.8 to avoid seccomp bypass. Tracing/profiling arbitrary processes is already blocked by dropping <code>CAP_SYS_PTRACE</code>, because it could leak a lot of information on the host.   <code>query_module</code> Deny manipulation and functions on kernel modules. Obsolete.   <code>quotactl</code> Quota syscall which could let containers disable their own resource limits or process accounting. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>reboot</code> Don't let containers reboot the host. Also gated by <code>CAP_SYS_BOOT</code>.   <code>request_key</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>set_mempolicy</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>setns</code> Deny associating a thread with a namespace. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>settimeofday</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>stime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>swapon</code> Deny start/stop swapping to file/device. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>swapoff</code> Deny start/stop swapping to file/device. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>sysfs</code> Obsolete syscall.   <code>_sysctl</code> Obsolete, replaced by /proc/sys.   <code>umount</code> Should be a privileged operation. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>umount2</code> Should be a privileged operation. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>unshare</code> Deny cloning new namespaces for processes. Also gated by <code>CAP_SYS_ADMIN</code>, with the exception of <code>unshare --user</code>.   <code>uselib</code> Older syscall related to shared libraries, unused for a long time.   <code>userfaultfd</code> Userspace page fault handling, largely needed for process migration.   <code>ustat</code> Obsolete syscall.   <code>vm86</code> In kernel x86 real mode virtual machine. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>vm86old</code> In kernel x86 real mode virtual machine. Also gated by <code>CAP_SYS_ADMIN</code>.    <p>Read security_opt from the docker website.</p>"},{"location":"1.0/config/host_config/#capabilities-cap_add-cap_drop","title":"capabilities <code>cap_add</code> <code>cap_drop</code>","text":"<p>This value is added to the oc.user docker container, or as securityContext attribut in kubernetes mode :</p> <pre><code>securityContext:\n      capabilities:\n        desktop.capabilities\n</code></pre> <p>For example </p> <pre><code>    { \n        'add': [ \"SYS_ADMIN\", \"SYS_PTRACE\" ]\n    }\n</code></pre> <p>Permit a container  to call ptrace:</p> <ul> <li>\"SYS_PTRACE\": Trace arbitrary processes using ptrace</li> <li>\"SYS_ADMIN\": Perform a range of system administration operations.</li> </ul> <p>Read the docker run command informations Docker run reference </p> <p>By default, Docker has a default list of capabilities that are kept. The following table lists the Linux capability options which can be added or dropped.</p>    Capability Key Capability Description     SETPCAP Modify process capabilities.   SYS_MODULE Load and unload kernel modules.   SYS_RAWIO Perform I/O port operations (iopl(2) and ioperm(2)).   SYS_PACCT Use acct(2), switch process accounting on or off.   SYS_ADMIN Perform a range of system administration operations.   SYS_NICE Raise process nice value (nice(2), setpriority(2)) and change the nice value for arbitrary processes.   SYS_RESOURCE Override resource Limits.   SYS_TIME Set system clock (settimeofday(2), stime(2), adjtimex(2)); set real-time (hardware) clock.   SYS_TTY_CONFIG Use vhangup(2); employ various privileged ioctl(2) operations on virtual terminals.   MKNOD Create special files using mknod(2).   AUDIT_WRITE Write records to kernel auditing log.   AUDIT_CONTROL Enable and disable kernel auditing; change auditing filter rules; retrieve auditing status and filtering rules.   MAC_OVERRIDE Allow MAC configuration or state changes. Implemented for the Smack LSM.   MAC_ADMIN Override Mandatory Access Control (MAC). Implemented for the Smack Linux Security Module (LSM).   NET_ADMIN Perform various network-related operations.   SYSLOG Perform privileged syslog(2) operations.   CHOWN Make arbitrary changes to file UIDs and GIDs (see chown(2)).   NET_RAW Use RAW and PACKET sockets.   DAC_OVERRIDE Bypass file read, write, and execute permission checks.   FOWNER Bypass permission checks on operations that normally require the file system UID of the process to match the UID of the file.   DAC_READ_SEARCH Bypass file read permission checks and directory read and execute permission checks.   FSETID Don't clear set-user-ID and set-group-ID permission bits when a file is modified.   KILL Bypass permission checks for sending signals.   SETGID Make arbitrary manipulations of process GIDs and supplementary GID list.   SETUID Make arbitrary manipulations of process UIDs.   LINUX_IMMUTABLE Set the FS_APPEND_FL and FS_IMMUTABLE_FL i-node flags.   NET_BIND_SERVICE Bind a socket to internet domain privileged ports (port numbers less than 1024).   NET_BROADCAST Make socket broadcasts, and listen to multicasts.   IPC_LOCK Lock memory (mlock(2), mlockall(2), mmap(2), shmctl(2)).   IPC_OWNER Bypass permission checks for operations on System V IPC objects.   SYS_CHROOT Use chroot(2), change root directory.   SYS_PTRACE Trace arbitrary processes using ptrace(2).   SYS_BOOT Use reboot(2) and kexec_load(2), reboot and load a new kernel for later execution.   LEASE Establish leases on arbitrary files (see fcntl(2)).   SETFCAP Set file capabilities.   WAKE_ALARM Trigger something that will wake up the system.   BLOCK_SUSPEND Employ features that can block system suspend.    <p>Further reference information is available on the capabilities(7) - Linux man page</p>  <p>Set this value only to troubleshoot an application. </p>  <p>In production this value MUST be set to an empty dict <code>{}</code></p>"},{"location":"1.0/config/jira/","title":"JIRA configuration","text":"<p>abcdesktop.io support JIRA </p>"},{"location":"1.0/config/jira/#jira-option","title":"JIRA option","text":"<p>In <code>od.config</code> add the <code>jira</code> option. <code>jira</code> option is a dictionary with the entries :</p>    entry sample value               \u00a0\u00a0     url https://domainexample.atlassian.net/   project_id ABCD   username account@domain.local   apikey XXXXXXXXXXXXXXXXXXXX    <p>And fill the dictionary </p> <pre><code>jira : { \n            'url':          'https://domainexample.atlassian.net/',\n            'project_id':   'ABCD',\n            'username':     'account@domain.local',\n            'apikey' :      'XXXXXXXXXXXXXXXXXXXX' }\n</code></pre> <p>Then apply the new configuration file <code>od.config</code> by retrasting the daemon.</p> <p>When <code>jira</code> option is set, a new icon <code>issue</code> appears at the top.</p>  <p>Click on the <code>issue</code> icon, a new window is appear.</p>  <p>Fill <code>Summary</code> and <code>Your Report</code> values</p>  <p>Then press the <code>Send</code> button. A notification message appears on the left top corner.</p>  <p>Log into your jira server, and check your backlog </p>  <p>Great you added a new issue tracking.</p>"},{"location":"1.0/config/language/","title":"Language entry in od.config","text":"<p>The language option is a list of string. Each string is formatted as a locale variable. The locale is simply the language/country combination <code>en + US = en_US</code></p>"},{"location":"1.0/config/language/#language-in-abcdesktopio-ocuser","title":"Language in abcdesktop.io oc.user","text":"<p>The language list must match with the oc.user local packages all ready installed.</p> <p>If the language is not found, the default value is set to <code>en_US</code></p> <p>The oc.user.18.04 is built-in with the default language package :</p> <ul> <li><code>language-pack-en</code> </li> <li><code>language-pack-fr</code></li> </ul> <pre><code>apt-get install -y \\\n    language-pack-en \\\n    language-pack-fr \\\n    &amp;&amp; locale-gen    \\\n    &amp;&amp; apt-get clean\n</code></pre> <p>The full supported language list is set by default </p> <pre><code>language : [  'af_ZA', 'am_ET', 'an_ES', 'ar_AE', 'ar_BH', 'ar_DZ', 'ar_EG', 'ar_IN', 'ar_IQ', 'ar_JO', 'ar_KW','ar_LB', 'ar_LY', 'ar_MA', 'ar_OM', 'ar_QA', 'ar_SA', 'ar_SD', 'ar_SY', 'ar_TN', 'ar_YE', 'as_IN', 'ast_ES', 'az_AZ', 'be_BY', 'bg_BG', 'bn_BD', 'bn_IN', 'bo_CN', 'bo_IN', 'br_FR', 'bs_BA', 'ca_AD', 'ca_ES', 'ca_FR', 'ca_IT', 'crh_UA', 'cs_CZ', 'cy_GB', 'da_DK', 'de_AT', 'de_BE', 'de_CH', 'de_DE', 'de_LI', 'de_LU', 'dz_BT', 'el_CY', 'el_GR', 'en_AG', 'en_AU', 'en_BW', 'en_CA', 'en_DK', 'en_GB', 'en_HK', 'en_IE', 'en_IN', 'en_NG', 'en_NZ', 'en_PH', 'en_SG', 'en_US', 'en_ZA', 'en_ZM', 'en_ZW', 'eo', 'eo_US', 'es_AR', 'es_BO', 'es_CL', 'es_CO', 'es_CR', 'es_CU', 'es_DO', 'es_EC', 'es_ES', 'es_GT', 'es_HN', 'es_MX', 'es_NI', 'es_PA', 'es_PE', 'es_PR', 'es_PY', 'es_SV', 'es_US', 'es_UY', 'es_VE', 'et_EE', 'eu_ES', 'eu_FR', 'fa_IR', 'fi_FI', 'fr_BE', 'fr_CA', 'fr_CH', 'fr_FR', 'fr_LU', 'ga_IE', 'gd_GB', 'gl_ES', 'gu_IN', 'he_IL', 'hi_IN', 'hr_HR', 'hu_HU', 'id_ID', 'is_IS', 'it_CH', 'it_IT', 'ja_JP', 'ka_GE', 'kk_KZ', 'km_KH', 'kn_IN', 'ko_KR', 'ku_TR', 'lt_LT', 'lv_LV', 'mai_IN', 'mk_MK', 'ml_IN', 'mn_MN', 'mr_IN', 'ms_MY', 'my_MM', 'nb_NO', 'nds_DE', 'nds_NL', 'ne_NP', 'nl_AW', 'nl_BE', 'nl_NL', 'nn_NO', 'oc_FR', 'or_IN', 'pa_IN', 'pa_PK', 'pl_PL', 'pt_BR', 'pt_PT', 'ro_RO', 'ru_RU', 'ru_UA', 'si_LK', 'sk_SK', 'sl_SI', 'sq_AL', 'sq_MK', 'sr_ME', 'sr_RS', 'sv_FI', 'sv_SE', 'ta_IN', 'ta_LK', 'te_IN', 'tg_TJ', 'th_TH', 'tr_CY', 'tr_TR', 'ug_CN', 'uk_UA', 'uz_UZ', 'vi_VN', 'xh_ZA', 'zh_CN', 'zh_HK', 'zh_SG', 'zh_TW' ]\n</code></pre> <p>This list must match with the <code>Accept-Language</code> request HTTP header.</p>"},{"location":"1.0/config/language/#language-in-abcdesktopio-applications","title":"Language in abcdesktop.io Applications","text":"<p>abcdesktop.io use the web browser language property to set the application's language. This list must match with the <code>Accept-Language</code> request HTTP header. If the language is not found, the default value is set to <code>en_US</code>.</p>  <p>Hands-on: </p> <p>Change your web browser language, and run LibreOffice applications. The language setting use the web browser value. During this exercice you can keep the same abcdesktop.io users session. </p>"},{"location":"1.0/config/language/#set-the-web-browsers-default-language-to-en_us","title":"Set the web browser's default language to <code>en_US</code> :","text":"<p> The launch LibreOffice Writer. The menu is set to <code>en_US</code>  LibreOffice Writer use English/US <code>en_US</code> language.</p>"},{"location":"1.0/config/language/#set-the-web-browsers-default-language-to-fr_fr","title":"Set the web browser's default language to <code>fr_FR</code> :","text":"<p>You can keep the same abcdesktop.io users session, you do not need to logout.</p>  <p>The launch LibreOffice Writer. The menu is set to <code>fr_FR</code>  LibreOffice Writer use French <code>fr_FR</code>language.</p> <p>Great you have change the language settings of applications running inside an abcdesktop docker container</p>"},{"location":"1.0/config/linux_syslog_config/","title":"Linux syslog config","text":""},{"location":"1.0/config/linux_syslog_config/#modify-etcrsyslogconf","title":"Modify /etc/rsyslog.conf","text":"<p>By default syslog program is configured to log messages received over unix socket files. rsyslog configuration file need to be modified to accept messages over UDP.</p> <p>Edit /etc/rsyslog.conf file with your prefered linux text editor as sudo ou root:</p> <pre><code>sudo vi /etc/rsyslog.conf\n</code></pre>  <p>Uncomment the following lines and save file :</p> <pre><code>module(load=\"imudp\")\ninput(type=\"imudp\" port=\"514\")\n</code></pre>"},{"location":"1.0/config/linux_syslog_config/#restart-rsyslog","title":"Restart rsyslog","text":"<p>Now we have enabled rsyslog over UDP on 514 port in config file, we have to restart rsyslog to take new parameters into account. Execute the following command as sudo:</p> <pre><code>sudo systemctl restart rsyslog\n</code></pre>"},{"location":"1.0/config/logging/","title":"Logging configuration in od.config","text":"<p>The <code>logging</code> configuration is a dictionnary object. The logging configuration describes where and how log message information have to been send.</p> <p><code>logging</code> dict use the python logging module logging module</p> <p>The <code>syslog</code> and <code>graylog</code> protocol messaging are supported too.</p> <p>The default features for each handlers are : </p>    handler Features     <code>console</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>ext://sys.stdout</code> formated as standard   <code>cherrypy_console</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>ext://sys.stdout</code> formatted as access   <code>cherrypy_access</code> log message using a <code>logging.StreamHandler</code> to the file stream <code>logs/access.log</code> formatted as access   <code>cherrypy_trace</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>logs/trace.log</code> formatted as standard    <p>Sub modules used by od.py can log information too. </p>    Sub module Default Values     <code>docker.utils.config</code> <code>{ 'level': 'INFO' },</code>   <code>urllib3.connectionpool</code> <code>{ 'level': 'ERROR'},</code>    <p>The <code>logging</code> sample configuration :</p> <pre><code>#              \n# logging configuration \n# come from https://docs.python.org/3.8/library/logging.config.html\n# need double %% to escape %\n# \n# graylog https://github.com/severb/graypy\n# use handler class name as\n# graypy.GELFUDPHandler - UDP log forwarding\n# graypy.GELFTCPHandler - TCP log forwarding\n# graypy.GELFTLSHandler - TCP log forwarding with TLS support\n# graypy.GELFHTTPHandler - HTTP log forwarding\n# graypy.GELFRabbitHandler - RabbitMQ log forwarding\n\nlogging: {\n  'version': 1,\n  'disable_existing_loggers': False,\n  'formatters': {\n    'access': {\n      'format': '%%(message)s - user: %%(userid)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'standard': {\n      'format': '%%(asctime)s %%(module)s [%%(levelname)-7s] %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'syslog': {\n      'format': '%%(asctime)s %%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'graylog': {\n      'format': '%%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s'      \n    }\n  },\n  'filters': {\n    'odcontext': {\n      '()': 'oc.logging.OdContextFilter'\n    }\n  },\n  'handlers': {\n    'console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_access': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'filename': 'logs/access.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8'\n    },\n    'cherrypy_trace': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'filename': 'logs/trace.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8',\n      'mode': 'w'\n    }\n  },\n  'loggers': {\n    '': {\n      'handlers': [ 'console', 'cherrypy_trace'  ],\n      'level': 'DEBUG'\n    },\n    'docker.utils.config': {\n      'level': 'INFO'\n    },\n    'urllib3.connectionpool': {\n      'level': 'ERROR'\n    },\n    'cherrypy.access': {\n      'handlers': [ 'cherrypy_access' ],\n      'level': 'INFO',\n      'propagate': False\n    },\n    'cherrypy.error': {\n      'handlers': [ 'console', 'cherrypy_trace' ],\n      'level': 'ERROR',\n      'propagate': False\n    }\n  } }\n</code></pre>"},{"location":"1.0/config/stack/","title":"stack entry in od.config","text":""},{"location":"1.0/config/stack/#stackmode","title":"stack.mode","text":"<p><code>stack.mode</code> describes how abcdesktop.io can manage user's containers and application. </p> <ul> <li>If you run a docker only daemon, set the value to <code>standalone</code>.</li> <li>If you run a kubernetes cluster, set the value to <code>kubernetes</code>.</li> </ul>    stack.mode Description     <code>standalone</code> Use a dockerd only, this is for personal usage   <code>kubernetes</code> Use a kubernetes services"},{"location":"1.0/config/stack/#stackkubernetesdefaultdomain","title":"stack.kubernetesdefaultdomain","text":"<p><code>stack.kubernetesdefaultdomain</code> is the default domain name configured in kubernetes cluster. This value is type is string and only read if stack.mode is <code>kubernetes</code>.</p> <p>The default value is <code>abcdesktop.svc.cluster.local</code> </p> <p>If option value <code>mongodb</code> or <code>memcached</code> are set, the values are NOT overridden, and keep unchanged.</p> <p>If option value <code>mongodb</code> or <code>memcached</code> are set to <code>None</code> (by default), then <code>stack.kubernetesdefaultdomain</code> is used to complete the FQDN of <code>mongodb</code> and <code>memcached</code> servers name. This value is concatenated to the server hostname.</p>    Hostname FQDN     <code>mongodb</code> <code>mongodb.abcdesktop.svc.cluster.local</code>   <code>memcached</code> <code>memcached.abcdesktop.svc.cluster.local</code>    <p>The dns resolution need a running <code>core-dns</code>is the namespace <code>kube-system</code></p> <p><code>stack.kubernetesdefaultdomain</code> is used also if <code>desktop.desktopuseinternalfqdn: True</code></p> <p>The pod name FQDN is built using the <code>$podid</code>.desktop.<code>$stack.kubernetesdefaultdomain</code></p> <p>For example, by default :</p> <p><code>c8c7d38f-7621-40bb-a777-83f41b32733e.desktop.abcdesktop.svc.cluster.local</code></p>"},{"location":"1.0/config/sudo-kubernetes/","title":"Get a root access inside a container","text":""},{"location":"1.0/config/sudo-kubernetes/#how-to-get-a-root-access-inside-a-container-running-kubernetes-abcdesktop","title":"How to get a root access inside a container running kubernetes abcdesktop ?","text":"<p>run the sudo command inside the user kubernetes pods</p>   <pre><code>balloon@43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e:~$ sudo bash\nsudo: effective uid is not 0, is /usr/bin/sudo on a file system with the 'nosuid' option set or an NFS file system without root privileges?\n</code></pre> <ol> <li>Download the default abcdesktop.yaml</li> <li>Update the od.config file inside the <code>configmap/abcdesktop-config</code></li> <li>Allow in the od.config section, update the option desktop.allowPrivilegeEscalation value to True </li> </ol> <pre><code>    # desktop.allowPrivilegeEscalation\n    # value True or False\n    # This value is only avalaible in kubernetes mode,\n    # The desktop.allowPrivilegeEscalation allow a user to run a sudo command.\n    # This option set the runtime privilege and Linux capabilities\n    # The execve system call can grant a newly-started program privileges that its parent did not have,\n    # such as the setuid or setgid Linux flags.\n    # The default value is False\n    # You should only set desktop.allowPrivilegeEscalation to run sudo command.\n    # In production this value MUST be set to False\n\n    desktop.allowPrivilegeEscalation: True \n\n</code></pre> <ol> <li>Update the kubernetes config with the new abcdesktop.yaml  </li> </ol> <pre><code>% kubectl apply -f abcdesktop.yaml\n  configmap/abcdesktop-config configured\n</code></pre> <ol> <li>Restart the pyos pod </li> </ol> <p>List all pods </p> <pre><code>% kubectl get pods -n abcdesktop\nNAME                                   READY   STATUS    RESTARTS   AGE\n43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e   3/3     Running   0          17m\ndaemonset-nginx-bbbvj                  1/1     Running   0          37m\ndaemonset-pyos-ckqx6                   1/1     Running   0          39h\nmemcached-od-5bf65bf745-l62jr          1/1     Running   0          39h\nmongodb-od-656d85c49f-jx2zj            1/1     Running   0          39h\nopenldap-od-5945946767-82qh4           1/1     Running   0          39h\nspeedtest-od-58b9847b4b-gllrt          1/1     Running   0          39h\n</code></pre> <p>Delete the pyos pod</p> <pre><code>% kubectl delete pods daemonset-pyos-ckqx6  -n abcdesktop\npod \"daemonset-pyos-ckqx6\" deleted\n</code></pre> <p>Kubenestes restart the new pyos pod</p> <pre><code>kubectl get pods -n abcdesktop                         \nNAME                                   READY   STATUS    RESTARTS   AGE\n43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e   3/3     Running   0          18m\ndaemonset-nginx-bbbvj                  1/1     Running   0          38m\ndaemonset-pyos-fhbx5                   1/1     Running   0          3s\nmemcached-od-5bf65bf745-l62jr          1/1     Running   0          39h\nmongodb-od-656d85c49f-jx2zj            1/1     Running   0          39h\nopenldap-od-5945946767-82qh4           1/1     Running   0          39h\nspeedtest-od-58b9847b4b-gllrt          1/1     Running   0          39h\n</code></pre> <ol> <li>Make sure that your user has done a logoff his pod, then login again and run terminal web shell </li> </ol> <p>The default balloon password is <code>lmdpocpetit</code></p> <pre><code>balloon@c182dc39-6a00-4869-8b01-2039f37c1eab:~$ sudo bash\n[sudo] password for balloon: \nroot@c182dc39-6a00-4869-8b01-2039f37c1eab:~# id\nuid=0(root) gid=0(root) groups=0(root),105(lpadmin)\nroot@c182dc39-6a00-4869-8b01-2039f37c1eab:~#  \n</code></pre> <p>After the sudo command, you get a root level inside the shell of the users's pod</p>   <p>In production this value should be set to False</p>"},{"location":"1.0/config/syslog/","title":"Syslog configuration in od.config","text":""},{"location":"1.0/config/syslog/#add-syslog-server-support","title":"Add syslog server support","text":"<pre><code>   'filters': [ 'odcontext' ],\n</code></pre> <p>syslog is a protocol for tracking and logging system messages in Linux. Applications use syslog to export all their error and status messages to the files in the /var/log directory.</p> <p>syslog uses the client-server model; a client transmits a text message to the server (receiver). The server is commonly called syslogd, syslog daemon, or syslog server. syslog uses the User Datagram Protocol (UDP) port 514 for communication. </p>"},{"location":"1.0/config/syslog/#start-syslog-container","title":"Start syslog container","text":"<p>Those running linux can simply modify their syslog configuration file following linux syslog config steps</p> <p>For others (Windows/Mac) or those that don't want to modify their syslog config, you can simply run the following command :</p> <pre><code>docker run -it -p 514:514/udp --name syslog-ng balabit/syslog-ng:latest -edv\n</code></pre> <pre><code>[2020-04-07T12:29:39.485318] Accepting connections; addr='AF_INET(0.0.0.0:514)'\n[2020-04-07T12:29:39.485752] You have a TLS enabled source without a X.509 keypair. Make sure you have tls(key-file() and cert-file()) options, TLS handshake to this source will fail; location='/etc/syslog-ng/syslog-ng.conf:21:2'\n[2020-04-07T12:29:39.485964] Accepting connections; addr='AF_INET(0.0.0.0:6514)'\n[2020-04-07T12:29:39.486179] Accepting connections; addr='AF_INET(0.0.0.0:601)'\n[2020-04-07T12:29:39.486600] Running application hooks; hook='1'\n[2020-04-07T12:29:39.486621] Running application hooks; hook='6'\n[2020-04-07T12:29:39.486674] syslog-ng starting up; version='3.26.1'\n[2020-04-07T12:29:39.486850] Running application hooks; hook='2'\n[2020-04-07T12:39:39.587220] Log statistics; processed='global(payload_reallocs)=0', processed='global(sdata_updates)=0', queued='global(scratch_buffers_bytes)=0', processed='src.internal(s_local#0)=0', stamp='src.internal(s_local#0)=0', processed='destination(d_local)=0', processed='source(s_local)=0', processed='source(s_network)=0', processed='global(msg_clones)=0', processed='center(received)=0', queued='global(scratch_buffers_count)=0', processed='center(queued)=0'\n</code></pre>"},{"location":"1.0/config/syslog/#modify-logging-entry","title":"Modify logging entry","text":"<p>To let abcdesktop log events in syslog trought UDP, we will have to modify abcdesktop configuration file to add  an handler and 'syslog' entry in general logger and cherrypy.error logger. (syslog formatter is already in sample file)</p>"},{"location":"1.0/config/syslog/#add-syslog-handler","title":"Add Syslog Handler","text":"<p>In handlers entry add the following lines:</p> <pre><code>        ,\n        'syslog': {\n          'class': 'logging.handlers.SysLogHandler',\n          'filters': [ 'odcontext' ],\n          'formatter': 'syslog',\n          'socktype': 2,\n          'address' : [ '192.168.0.52', 514 ]\n        }\n</code></pre> <p>Replace 192.168.0.52 ip address by your local IP Addresse.</p> <p>You can get your local IP address using the following command:</p> <pre><code>hostname -I | cut -d ' ' -f1\n</code></pre>"},{"location":"1.0/config/syslog/#add-loggers-handlers-entries","title":"Add loggers handlers entries","text":"<p>In general loggers (key '' in loggers entry) and 'cherrypy.error' add <code>syslog'</code> handler in handlers list:</p> <pre><code>        '': {\n          'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n          'level': 'INFO'\n        }\n\n       'cherrypy.error': {\n          'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n          'level': 'ERROR',\n          'propagate': False\n        }\n</code></pre>"},{"location":"1.0/config/syslog/#resulting-modified-sample-configuration-file","title":"Resulting Modified sample configuration file","text":"<pre><code>#              \n# logging configuration \n# come from https://docs.python.org/3.8/library/logging.config.html\n# need double %% to escape %\n# \n# graylog https://github.com/severb/graypy\n# use handler class name as\n# graypy.GELFUDPHandler - UDP log forwarding\n# graypy.GELFTCPHandler - TCP log forwarding\n# graypy.GELFTLSHandler - TCP log forwarding with TLS support\n# graypy.GELFHTTPHandler - HTTP log forwarding\n# graypy.GELFRabbitHandler - RabbitMQ log forwarding\n\nlogging: {\n  'version': 1,\n  'disable_existing_loggers': False,\n  'formatters': {\n    'access': {\n      'format': '%%(message)s - user: %%(userid)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'standard': {\n      'format': '%%(asctime)s %%(module)s [%%(levelname)-7s] %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'syslog': {\n      'format': '%%(asctime)s %%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'graylog': {\n      'format': '%%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s'      \n    }\n  },\n  'filters': {\n    'odcontext': {\n      '()': 'oc.logging.OdContextFilter'\n    }\n  },\n  'handlers': {\n    'console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_access': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'filename': 'logs/access.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8'\n    },\n    'cherrypy_trace': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'filename': 'logs/trace.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8',\n      'mode': 'w'\n    },\n    'syslog': {\n       'class': 'logging.handlers.SysLogHandler',\n       'filters': [ 'odcontext' ],\n       'formatter': 'syslog',\n       'socktype': 2,\n       'address' : [ '192.168.0.52', 514 ]\n    }\n  },\n  'loggers': {\n    '': {\n      'handlers': [ 'console', 'cherrypy_trace', 'syslog'  ],\n      'level': 'DEBUG'\n    },\n    'docker.utils.config': {\n      'level': 'INFO'\n    },\n    'urllib3.connectionpool': {\n      'level': 'ERROR'\n    },\n    'cherrypy.access': {\n      'handlers': [ 'cherrypy_access' ],\n      'level': 'INFO',\n      'propagate': False\n    },\n    'cherrypy.error': {\n      'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n      'level': 'ERROR',\n      'propagate': False\n    }\n  } }\n</code></pre>"},{"location":"1.0/config/syslog/#restart-pods","title":"Restart Pods","text":"<p>To restart Pods, we will delete and recreate all pods</p>"},{"location":"1.0/config/syslog/#delete-pods","title":"Delete pods","text":"<p>To delete pods, execute the following command:</p> <pre><code>kubectl delete -f abcdesktop.yaml\n</code></pre>"},{"location":"1.0/config/syslog/#create-pods","title":"Create pods","text":"<p>To create pods, execute the following command:</p> <pre><code>kubectl create -f abcdesktop.yaml\n</code></pre>"},{"location":"1.0/config/syslog/#verify-syslogs","title":"Verify syslogs","text":"<p>At this state, new abcdesktop logging configuration should be applied. We can now verify syslog logs:</p> <pre><code>tail /var/log/syslog\n</code></pre>  <p>If you see some lines with 'INFO' Level, you probably see abcdesktop logs in syslog ! If not try to do actions in abcdesktop (open session, launch new application, close session) and apply the tail command again.</p>"},{"location":"1.0/config/webrtc/","title":"Sound server configuration","text":"<p>By default abcdesktop use the <code>module-http-protocol-tcp</code> from pulseaudio sound server to send wav data to the web browser</p>"},{"location":"1.0/config/webrtc/#pulseaudio-http-stream-by-default","title":"pulseaudio http stream (by default)","text":"<p>By default, abcdesktop uses the pulseaudio http stream and play wave data (poor sound quality but works in https only)</p>  <p>In terminal webshell run the command :</p> <pre><code>pactl -s /tmp/.pulse.sock list short modules\n</code></pre> <pre><code>balloon@bac345323f37:/var/log/desktop$ pactl -s /tmp/.pulse.sock list short modules\n0 module-augment-properties\n1 module-null-sink sink_name=u8_1_11025 format=u8 channels=1 rate=11025 sink_properties=\"device.description='default format=u8 c=1 rate=11025'\"\n2 module-null-sink sink_name=s16_1_22050 format=s16be channels=1 rate=22050 sink_properties=\"device.description='default format=s16be c=1 rate=22050'\"\n3 module-null-sink sink_name=s16_1_44100 format=s16be channels=1 rate=44100 sink_properties=\"device.description='default format=s16be c=1 rate=44100'\"\n4 module-null-sink sink_name=ulaw8_1_8000 format=ulaw channels=1 rate=8000 sink_properties=\"device.description='default format=ulaw c=1 rate=8000'\"\n5 module-null-sink sink_name=rtp format=alaw channels=1 rate=8000 sink_properties=\"device.description='RTP Multicast Sink'\"\n6 module-native-protocol-unix auth-group=balloon socket=/tmp/.pulse.sock\n7 module-http-protocol-tcp listen=172.21.0.5\n8 module-always-sink\n</code></pre>"},{"location":"1.0/config/webrtc/#webrtc-gateway-enable","title":"webrtc gateway enable","text":"<p>To get a better sound quality, you can use a webrtc gateway and send a rtp stream to the webrtc gateway. abcdesktop plays sound using the web browser webrtc stack (good sound quality)</p>  <p>abcdesktop update the pulseaudio configuration, and add <code>module-rtp-send</code>. The <code>module-rtp-send</code> pusleaudio send to the destination_ip (in this example 1.2.3.4) </p> <pre><code>pactl -s /tmp/.pulse.sock list short modules\n</code></pre> <pre><code>balloon@414e3db9-60d8-4f92-a356-a3a74833990c:~$ pactl -s /tmp/.pulse.sock list short modules\n0       module-augment-properties\n1       module-null-sink        sink_name=rtp  format=alaw channels=1 rate=8000 sink_properties=\"device.description='RTP Multicast Sink'\"\n2       module-native-protocol-unix     auth-group=balloon socket=/tmp/.pulse.sock\n3       module-always-sink\n4       module-rtp-send source=rtp.monitor destination_ip=1.2.3.4 port=5119 channels=1 format=alaw\n</code></pre> <p>The <code>sink_name</code> is rtp, and the <code>source</code> for the <code>module-rtp-send</code> is rtp.monitor.</p> <p>The default source is <code>rtp.monitor</code></p> <pre><code>Source #\n        State: RUNNING\n        Name: rtp.monitor\n        Description: Monitor of RTP Multicast Sink\n        Driver: module-null-sink.c\n        Sample Specification: aLaw 1ch 8000Hz\n        Channel Map: mono\n        Owner Module: 5\n        Mute: no\n        Volume: mono: 65536 / 100% / 0.00 dB\n                balance 0.00\n        Base Volume: 65536 / 100% / 0.00 dB\n        Monitor of Sink: rtp\n        Latency: 0 usec, configured 160000 usec\n        Flags: DECIBEL_VOLUME LATENCY \n        Properties:\n                device.description = \"Monitor of RTP Multicast Sink\"\n                device.class = \"monitor\"\n                device.icon_name = \"audio-input-microphone\"\n        Formats:\n                pcm\n</code></pre> <p>The default output is </p> <pre><code>\nSource Output #0\n        Driver: module-rtp-send.c\n        Owner Module: 9\n        Client: n/a\n        Source: 4\n        Sample Specification: aLaw 1ch 8000Hz\n        Channel Map: mono\n        Format: pcm, format.sample_format = \"\\\"aLaw\\\"\"  format.rate = \"8000\"  format.channels = \"1\"  format.channel_map = \"\\\"mono\\\"\"\n        Corked: no\n        Mute: no\n        Volume: mono: 65536 / 100% / 0.00 dB\n                balance 0.00\n        Buffer Latency: 0 usec\n        Source Latency: 0 usec\n        Resample method: n/a\n        Properties:\n                media.name = \"RTP Monitor Stream\"\n                rtp.source = \"0.0.0.0\"\n                rtp.destination = \"1.2.3.4\"\n                rtp.mtu = \"1280\"\n                rtp.port = \"5119\"\n                rtp.ttl = \"1\"\n</code></pre> <p>By default, the format is <code>pcm</code></p> <pre><code>Format: pcm, format.sample_format = \"\\\"aLaw\\\"\"  format.rate = \"8000\"  format.channels = \"1\"  format.channel_map = \"\\\"mono\\\"\"\n</code></pre> <p>To change the default format update the values in od.config file.</p> <pre><code> 'audiopt': 8,\n 'audiortpmap': 'PCMA/8000',\n</code></pre> <p>To get the 'audiopt' and 'audiortpmap' values, read the web pages</p> <ul> <li>meetecho streaming plugin documentation</li> <li>RTP payload formats</li> </ul>"},{"location":"1.0/config/webrtc/#requirements","title":"Requirements","text":"<ul> <li>a janus server  </li> <li>add webrtc configuration in od.config file</li> </ul>"},{"location":"1.0/config/webrtc/#install-a-janus-server","title":"Install a janus server","text":""},{"location":"1.0/config/webrtc/#install-janus","title":"Install janus","text":"<p>Install a janus service from meetecho.com on a server </p> <pre><code>apt-get install janus\n</code></pre>"},{"location":"1.0/config/webrtc/#add-x509-certificats","title":"Add X509 certificats","text":"<p>Add X509 certificats in your janus.jcfg configuration. Certificate and key to use for DTLS (and passphrase if needed). If missing, Janus will autogenerate a self-signed certificate to use. Notice that self-signed certificates are fine for the purpose of WebRTC DTLS connectivity, for the time being, at least until Identity Providers are standardized and implemented in browsers.</p> <pre><code>certificates: {\n    cert_pem = \"/etc/ssl/certs/ssl-cert-snakeoil.pem\"\n    cert_key = \"/etc/ssl/private/ssl-cert-snakeoil.key\"\n    cert_pwd = \"secretpassphrase\"\n}\n</code></pre>"},{"location":"1.0/config/webrtc/#add-the-webrtc-entry-in-odconfig","title":"add the webrtc entry in od.config","text":"<p>Update the od.config file, for example :</p> <pre><code># WebRTC Janus config\nwebrtc.enable : True\nwebrtc.server : {   'janus.domain.local' : { 'schema' : 'http',\n                                          'host': 'janus.domain.local',\n                                          'hostip': '1.2.3.4',\n                                          'port': 8088,\n                                          'audiopt': 8,\n                                          'audiortpmap': 'PCMA/8000',\n                                          'apisecret': 'janusrocks',\n                                          'adminkey': 'supersecret',\n                                          'startport': 5100 } }\n</code></pre>"},{"location":"1.0/config/webrtc/#webrtcenable","title":"webrtc.enable","text":"<p><code>webrtc.enable</code> is a boolean. The default value is <code>False</code>. Set this value to <code>True</code> to enable webrtc services for <code>pulseaudio</code>.</p>"},{"location":"1.0/config/webrtc/#webrtcserver","title":"webrtc.server","text":"<p><code>webrtc.server</code> is a dict. The default value is <code>None</code>.  Set all dictionnary values to enable webrtc access for <code>pulseaudio</code> and for the web browser client.</p> <p>The <code>hostip</code> value, is used by pluse audio to configure the rtp stream. This value must be an ip address (do not set the fqdn). This can be an internal ip address, and is only to configure pulseaudio module and describe how to send stream data to reach the webrtc gateway.</p> <pre><code>'hostip': '1.2.3.4'\n</code></pre> <p>The <code>host</code> value, is used by the browser to reach the webrtc gateway and get the rtp stream. This value must(should) be a <code>fqdn</code>. This <code>fqdn</code> is used by the web browser.</p> <pre><code>webrtc.server : {   'janus.domain.local' : { 'schema' : 'http',\n                                          'host': 'janus.domain.local',\n                                          'hostip': '1.2.3.4',\n                                          'port': 8088,\n                                          'audiopt': 8,\n                                          'audiortpmap': 'PCMA/8000',\n                                          'apisecret': 'janusrocks',\n                                          'adminkey': 'supersecret',\n                                          'startport': 5100 } }\n</code></pre>"},{"location":"1.0/config/controllers/manager/","title":"ManagerController","text":""},{"location":"1.0/config/controllers/manager/#http-request","title":"HTTP Request","text":"<p>The http request path is <code>/API/manager</code></p>    Path Params Response type     <code>/API/manager/buildapplist</code> None Json object   <code>/API/manager/updateactivedirectorysite</code> None Json object   <code>/API/manager/garbagecollector</code> expirein=, force=False Json object"},{"location":"1.0/config/controllers/manager/#buildapplist","title":"buildapplist","text":"<p><code>buildapplist</code> ask pyos to list all abcdesktop.io docker image. Each docker image must have the specified label <code>type=apps</code>. abcdesktop.io </p>    Params Type Description     None None None    <p>example :</p> <pre><code>curl http://localhost/API/manager/buildapplist\n</code></pre> <p>Return the complete array if json images objects ready to run.</p> <pre><code>{\"abcdesktopio/writer.d:latest\": {\"id\": \"abcdesktopio/writer.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-writer\", \"name\": \"Writer\", \"icon\": \"libreoffice-writer.svg\", \"keyword\": \"libre office writer,office,writer\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--writer\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Writer\", \"mimetype\": [\"application/vnd.oasis.opendocument.text\", \"application/vnd.oasis.opendocument.text-template\", \"application/vnd.oasis.opendocument.text-web\", \"application/vnd.oasis.opendocument.text-master\", \"application/vnd.oasis.opendocument.text-master-template\", \"application/vnd.sun.xml.writer\", \"application/vnd.sun.xml.writer.template\", \"application/vnd.sun.xml.writer.global\", \"application/msword\", \"application/vnd.ms-word\", \"application/x-doc\", \"application/x-hwp\", \"application/rtf\", \"text/rtf\", \"application/vnd.wordperfect\", \"application/wordperfect\", \"application/vnd.lotus-wordpro\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", \"application/vnd.ms-word.document.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.template\", \"application/vnd.ms-word.template.macroenabled.12\", \"application/vnd.stardivision.writer-global\", \"application/x-extension-txt\", \"application/x-t602\", \"application/vnd.oasis.opendocument.text-flat-xml\", \"application/x-fictionbook+xml\", \"application/macwriteii\", \"application/x-aportisdoc\", \"application/prs.plucker\", \"application/vnd.palm\", \"application/clarisworks\", \"application/x-sony-bbeb\", \"application/x-abiword\", \"application/x-iwork-pages-sffpages\", \"application/x-mswrite\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-writer.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"sxw\", \"stw\", \"doc\", \"dot\", \"wps\", \"rtf\", \"602\", \"wpd\", \"docx\", \"docm\", \"dotx\", \"dotm\", \"abw\", \"zabw\", \"pages\", \"dummy\", \"lrf\", \"cwk\", \"hqx\", \"fb2\", \"mw\", \"mcw\", \"mwd\", \"pdb\", \"wn\"], \"legacyfileextensions\": [\"odf\", \"ott\", \"fodt\", \"uot\"]}, \"abcdesktopio/math.d:latest\": {\"id\": \"abcdesktopio/math.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-math\", \"name\": \"Math\", \"icon\": \"libreoffice-math.svg\", \"keyword\": \"libre office math,office,math\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--math\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": null, \"displayname\": \"Math\", \"mimetype\": [\"application/vnd.oasis.opendocument.formula\", \"application/vnd.sun.xml.math\", \"application/vnd.oasis.opendocument.formula-template\", \"text/mathml\", \"application/mathml+xml\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-math.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odf\", \"odc\"], \"legacyfileextensions\": [\"odf\", \"odc\"]}, \"abcdesktopio/impress.d:latest\": {\"id\": \"abcdesktopio/impress.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-impress\", \"name\": \"Impress\", \"icon\": \"libreoffice-impress.svg\", \"keyword\": \"libre office impress,office,impress\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--impress\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Impress\", \"mimetype\": [\"application/vnd.oasis.opendocument.presentation\", \"application/vnd.oasis.opendocument.presentation-template\", \"application/vnd.sun.xml.impress\", \"application/vnd.sun.xml.impress.template\", \"application/mspowerpoint\", \"application/vnd.ms-powerpoint\", \"application/vnd.openxmlformats-officedocument.presentationml.presentation\", \"application/vnd.ms-powerpoint.presentation.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.presentationml.template\", \"application/vnd.ms-powerpoint.template.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.presentationml.slide\", \"application/vnd.openxmlformats-officedocument.presentationml.slideshow\", \"application/vnd.ms-powerpoint.slideshow.macroenabled.12\", \"application/vnd.oasis.opendocument.presentation-flat-xml\", \"application/x-iwork-keynote-sffkey\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-impress.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odp\", \"pot\", \"potm\", \"potx\", \"pps\", \"ppsx\", \"ppt\", \"pptx\", \"pptm\"], \"legacyfileextensions\": [\"odp\"]}, \"abcdesktopio/calc.d:latest\": {\"id\": \"abcdesktopio/calc.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-calc\", \"name\": \"Calc\", \"icon\": \"libreoffice-calc.svg\", \"keyword\": \"libre office calc,office,calc\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--calc\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Calc\", \"mimetype\": [\"application/vnd.oasis.opendocument.spreadsheet\", \"application/vnd.oasis.opendocument.spreadsheet-template\", \"application/vnd.sun.xml.calc\", \"application/vnd.sun.xml.calc.template\", \"application/msexcel\", \"application/vnd.ms-excel\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", \"application/vnd.ms-excel.sheet.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.template\", \"application/vnd.ms-excel.template.macroenabled.12\", \"application/vnd.ms-excel.sheet.binary.macroenabled.12\", \"text/csv\", \"application/x-dbf\", \"text/spreadsheet\", \"application/csv\", \"application/excel\", \"application/tab-separated-values\", \"application/vnd.lotus-1-2-3\", \"application/vnd.oasis.opendocument.chart\", \"application/vnd.oasis.opendocument.chart-template\", \"application/x-dbase\", \"application/x-dos_ms_excel\", \"application/x-excel\", \"application/x-msexcel\", \"application/x-ms-excel\", \"application/x-quattropro\", \"application/x-123\", \"text/comma-separated-values\", \"text/tab-separated-values\", \"text/x-comma-separated-values\", \"text/x-csv\", \"application/vnd.oasis.opendocument.spreadsheet-flat-xml\", \"application/vnd.ms-works\", \"application/x-iwork-numbers-sffnumbers\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-calc.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"ods\", \"ots\", \"sxc\", \"stc\", \"fods\", \"uos\", \"uof\", \"xml\", \"xlsx\", \"xlsm\", \"xltm\", \"xltx\", \"xlsb\", \"xls\", \"xlm\", \"xlc\", \"xlw\", \"xlk\", \"xlt\", \"dif\", \"dbf\", \"htm\", \"html\", \"wk1\", \"wks\", \"123\", \"wb2\", \"rtf\", \"slk\", \"sylk\", \"csv\", \"numbers\", \"dummy\", \"cwk\", \"wps\", \"wk3\", \"wq1\", \"wq2\"], \"legacyfileextensions\": [\"ods\", \"ots\", \"csv\"]}, \"abcdesktopio/base.d:latest\": {\"id\": \"abcdesktopio/base.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-base\", \"name\": \"Base\", \"icon\": \"libreoffice-base.svg\", \"keyword\": \"libre office base,office,base\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"development\", \"args\": \"--base\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": null, \"displayname\": \"Base\", \"mimetype\": [\"application/vnd.oasis.opendocument.database\", \"application/vnd.sun.xml.base\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-base.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odb\"], \"legacyfileextensions\": [\"odb\"]}}\n\n</code></pre>"},{"location":"1.0/config/controllers/manager/#updateactivedirectorysite","title":"updateactivedirectorysite","text":"Params Type Description     None None None    <p>example :</p> <pre><code>curl http://localhost/API/manager/updateactivedirectorysite\n</code></pre>"},{"location":"1.0/config/controllers/manager/#garbagecollector","title":"garbagecollector","text":"Params Type Description     <code>expirein</code> integer number in seconds since the container create date time   <code>force</code> boolean garbage the container even if a user is connected    <p>example :</p> <pre><code>curl \"http://localhost/API/manager/garbagecollector?expirein=9473\"\ncurl \"http://localhost/API/manager/garbagecollector?expirein=9473&amp;force=True\"\n</code></pre>"},{"location":"1.0/setup/dockermode/","title":"Install abcdesktop.io for non-cluster hosts","text":"<p>abcdesktop.io support non-cluster hosts and kubernetes cluster hosts. In this section we will study how abcdesktop.io works in non-cluster hosts with only one dockerd installed. The abcdesktop.io for non-cluster hosts is recommended for personal use, all containers are hosted on the same host.</p> <p>In all configuration, the abcdesktop.io infrastructure uses six containers, each container has a specific role : </p>    Container Role Image Repository     oc.user User container abcdesktopio/oc.user.18.04 abcdesktopio   oc.pyos API Server abcdesktopio/oc.pyos abcdesktopio   oc.nginx Web Service (http proxy and http server) abcdesktopio/oc.nginx abcdesktopio   oc.speedtest http benchmarch abcdesktopio/oc.speedtest from LibreSpeed updated abcdesktopio   oc.mongo json database server mongodb MongoDB   memcached cache server memcached Memcached     <p>This page contains hands-on to learn step by step how to use docker-compose with abcdesktop.io.</p>"},{"location":"1.0/setup/dockermode/#requirements-for-non-cluster-hosts","title":"Requirements for Non-cluster hosts","text":""},{"location":"1.0/setup/dockermode/#docker-compose","title":"docker-compose","text":"<p>The command docker-compose is used in this hands-on, to run each containers together.</p> <ul> <li> <p>On desktop systems like Docker Desktop for Mac and Windows, Docker Compose is included as part of those desktop installs.</p> </li> <li> <p>On Linux systems, first install the Docker for your OS as described on the Get Docker page, then come back here for instructions on installing Compose on Linux systems.</p> </li> </ul>"},{"location":"1.0/setup/dockermode/#quick-installation-linux-or-macos","title":"Quick installation (Linux or macOS)","text":"<p>Quick installation can be run on Linux or macOS operation system.  For Microsoft Windows, please read the following chapter 'Manually installation step by step' </p>  <p>You can watch the youtube video sample. This video describes the Quick installation process.</p>   <p>Download and extract the latest release automatically (Linux or macOS):</p> <pre><code>curl -L https://raw.githubusercontent.com/abcdesktopio/conf/main/docker/install.sh | sh -\n</code></pre> <p>The command above downloads the latest release (numerically) of abcdesktop.io.  The quick installation process runs the all commands step by step:</p> <ul> <li>download user's core images: oc.user</li> <li>download some applications images sample: the LibreOffice suite (calc, writer, impress), Firefox, Gimp, and gnome-terminal.</li> <li>download the docker-compose.yml YAML file</li> <li>run <code>docker-compose -p abcdesktop up</code></li> </ul>"},{"location":"1.0/setup/dockermode/#manually-installation-step-by-step-linux-macos-or-windows","title":"Manually installation step by step (Linux, macOS or Windows)","text":"<p>The following commands will let you install an abcdesktop plateform on your single server. All applications run on the single server.  </p>"},{"location":"1.0/setup/dockermode/#pull-user-container-image","title":"Pull user container image","text":"<p>The user container is named <code>abcdesktopio/oc.user.18.04</code>. The size of the <code>abcdesktopio/oc.user.18.04</code> image is up to 2 GB. Download the user container image, using the docker pull commmand : </p> <pre><code>docker pull abcdesktopio/oc.user.18.04\n</code></pre>"},{"location":"1.0/setup/dockermode/#docker-compose_1","title":"docker-compose","text":"<p>Create a docker-compose.yml file, and copy &amp; paste this YAML file into.</p> <pre><code>version: '3'\nservices:\n  pyos:\n    depends_on:\n      - memcached\n      - mongodb\n    image: abcdesktopio/oc.pyos:${TAG:-1.0}\n    networks:\n      - netback\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n\n  speedtest:\n    image: abcdesktopio/oc.speedtest:${TAG:-1.0}\n    networks:\n      - netuser\n\n  nginx:\n    depends_on:\n      - memcached\n      - pyos\n    image: abcdesktopio/oc.nginx:${TAG:-1.0}\n    ports:\n      - 80:80\n      - 443:443\n    networks:\n      - netuser\n      - netback\n\n  memcached:\n    image: memcached\n    networks:\n      - netback\n\n  mongodb:\n    image: abcdesktopio/oc.mongo:4.4.14\n    networks:\n      - netback\n\nnetworks:\n  netuser:\n    driver: bridge\n  netback:\n    internal: true\n</code></pre>  <p>Run the docker-compose up command with projet name option set to <code>abcdesktop</code> value. The projet name <code>abcdesktop</code> is used by pyos to reference the network set by default to <code>abcdesktop_netuser</code></p> <p>You must set the projet name to <code>abcdesktop</code>, else the websocket connection will failed </p>  <pre><code>docker-compose -p abcdesktop up\n</code></pre>  <p>Since the abcdesktop pyos code needs to interact with the Docker API in order to CRUD containers, pyos need to mount /var/run/docker.sock into the container</p>  <p>dockerd downloads all container images, it could take a while</p> <pre><code>Pulling speedtest (abcdesktopio/oc.speedtest:)...\nlatest: Pulling from oc.speedtest\n....\nStatus: Downloaded newer image for abcdesktopio/oc.speedtest:latest\nPulling memcached (memcached:)...\nlatest: Pulling from library/memcached\n....\nStatus: Downloaded newer image for memcached:latest\nPulling mongodb (mongo:4.4)...\nlatest: Pulling from library/mongo:4.4\n....\nStatus: Downloaded newer image for mongo:latest\nPulling pyos (abcdesktopio/oc.pyos:)...\nlatest: Pulling from oc.pyos\n....\nStatus: Downloaded newer image for abcdesktopio/oc.pyos:latest\nPulling nginx (abcdesktopio/oc.nginx:)...\nlatest: Pulling from oc.nginx\n....\nStatus: Downloaded newer image for abcdesktopio/oc.nginx:latest\n</code></pre> <p>You should read the output to the standard output</p> <pre><code>docker-compose -p abcdesktop  up      \nStarting abcdesktop_memcached_1 ... done\nStarting abcdesktop_mongodb_1   ... done\nStarting abcdesktop_speedtest_1 ... done\nStarting abcdesktop_pyos_1      ... done\nStarting abcdesktop_nginx_1     ... done\nAttaching to abcdesktop_speedtest_1, abcdesktop_mongodb_1, abcdesktop_memcached_1, abcdesktop_pyos_1, abcdesktop_nginx_1\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.087+00:00\"},\"s\":\"I\",  \"c\":\"CONTROL\",  \"id\":23285,   \"ctx\":\"main\",\"msg\":\"Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'\"}\nnginx_1      | Kubernetes is not detected\nnginx_1      | Using default config file\npyos_1       | Kubernetes is not detected\npyos_1       | Using default config file\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.093+00:00\"},\"s\":\"W\",  \"c\":\"ASIO\",     \"id\":22601,   \"ctx\":\"main\",\"msg\":\"No TransportLayer configured during NetworkInterface startup\"}\nspeedtest_1  | AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.20.0.2. Set the 'ServerName' directive globally to suppress this message\npyos_1       | total 24\npyos_1       | drwxr-xr-x 2 root root 4096 Sep 19 17:44 .\npyos_1       | drwxr-xr-x 1 root root 4096 Oct  2 12:43 ..\npyos_1       | -rw-r--r-- 1 root root 1679 May 14 17:54 abcdesktop_jwt_desktop_signing_private_key.pem\npyos_1       | -rw-r--r-- 1 root root  452 May 14 17:54 abcdesktop_jwt_desktop_signing_public_key.pem\npyos_1       | -rw-r--r-- 1 root root  891 May 15 09:59 abcdesktop_jwt_user_signing_private_key.pem\npyos_1       | -rw-r--r-- 1 root root  272 May 15 09:59 abcdesktop_jwt_user_signing_public_key.pem\nspeedtest_1  | AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.20.0.2. Set the 'ServerName' directive globally to suppress this message\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.093+00:00\"},\"s\":\"I\",  \"c\":\"NETWORK\",  \"id\":4648601, \"ctx\":\"main\",\"msg\":\"Implicit TCP FastOpen unavailable. If TCP FastOpen is required, set tcpFastOpenServer, tcpFastOpenClient, and tcpFastOpenQueueSize.\"}\npyos_1       | total 24\npyos_1       | drwxr-xr-x 2 root root 4096 Sep 19 17:44 .\npyos_1       | drwxr-xr-x 1 root root 4096 Oct  2 12:43 ..\npyos_1       | -rw-r--r-- 1 root root 1679 May 14 17:54 abcdesktop_jwt_desktop_signing_private_key.pem\npyos_1       | -rw-r--r-- 1 root root  452 May 14 17:54 abcdesktop_jwt_desktop_signing_public_key.pem\npyos_1       | -rw-r--r-- 1 root root  891 May 15 09:59 abcdesktop_jwt_user_signing_private_key.pem\npyos_1       | -rw-r--r-- 1 root root  272 May 15 09:59 abcdesktop_jwt_user_signing_public_key.pem\npyos_1       | starting od.py\nspeedtest_1  | [Fri Oct 02 12:54:15.121521 2020] [mpm_prefork:notice] [pid 1] AH00163: Apache/2.4.25 (Debian) PHP/5.6.36 configured -- resuming normal operations\nspeedtest_1  | [Fri Oct 02 12:54:15.121740 2020] [core:notice] [pid 1] AH00094: Command line: 'apache2 -D FOREGROUND'\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.094+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":4615611, \"ctx\":\"initandlisten\",\"msg\":\"MongoDB starting\",\"attr\":{\"pid\":1,\"port\":27017,\"dbPath\":\"/data/db\",\"architecture\":\"64-bit\",\"host\":\"a466db429025\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.094+00:00\"},\"s\":\"I\",  \"c\":\"CONTROL\",  \"id\":23403,   \"ctx\":\"initandlisten\",\"msg\":\"Build Info\",\"attr\":{\"buildInfo\":{\"version\":\"4.4.1\",\"gitVersion\":\"ad91a93a5a31e175f5cbf8c69561e788bbc55ce1\",\"openSSLVersion\":\"OpenSSL 1.1.1  11 Sep 2018\",\"modules\":[],\"allocator\":\"tcmalloc\",\"environment\":{\"distmod\":\"ubuntu1804\",\"distarch\":\"x86_64\",\"target_arch\":\"x86_64\"}}}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.094+00:00\"},\"s\":\"I\",  \"c\":\"CONTROL\",  \"id\":51765,   \"ctx\":\"initandlisten\",\"msg\":\"Operating System\",\"attr\":{\"os\":{\"name\":\"Ubuntu\",\"version\":\"18.04\"}}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.094+00:00\"},\"s\":\"I\",  \"c\":\"CONTROL\",  \"id\":21951,   \"ctx\":\"initandlisten\",\"msg\":\"Options set by command line\",\"attr\":{\"options\":{\"net\":{\"bindIp\":\"*\"}}}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.095+00:00\"},\"s\":\"W\",  \"c\":\"STORAGE\",  \"id\":22271,   \"ctx\":\"initandlisten\",\"msg\":\"Detected unclean shutdown - Lock file is not empty\",\"attr\":{\"lockFile\":\"/data/db/mongod.lock\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.095+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22270,   \"ctx\":\"initandlisten\",\"msg\":\"Storage engine to use detected by data files\",\"attr\":{\"dbpath\":\"/data/db\",\"storageEngine\":\"wiredTiger\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.095+00:00\"},\"s\":\"W\",  \"c\":\"STORAGE\",  \"id\":22302,   \"ctx\":\"initandlisten\",\"msg\":\"Recovering data from the last clean checkpoint.\"}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.095+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22297,   \"ctx\":\"initandlisten\",\"msg\":\"Using the XFS filesystem is strongly recommended with the WiredTiger storage engine. See http://dochub.mongodb.org/core/prodnotes-filesystem\",\"tags\":[\"startupWarnings\"]}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.096+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22315,   \"ctx\":\"initandlisten\",\"msg\":\"Opening WiredTiger\",\"attr\":{\"config\":\"create,cache_size=483M,session_max=33000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000,close_scan_interval=10,close_handle_minimum=250),statistics_log=(wait=0),verbose=[recovery_progress,checkpoint_progress,compact_progress],\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.602+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22430,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger message\",\"attr\":{\"message\":\"[1601643255:602890][1:0x7f1abada1a80], txn-recover: [WT_VERB_RECOVERY_PROGRESS] Recovering log 3 through 4\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.644+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22430,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger message\",\"attr\":{\"message\":\"[1601643255:644351][1:0x7f1abada1a80], txn-recover: [WT_VERB_RECOVERY_PROGRESS] Recovering log 4 through 4\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.701+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22430,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger message\",\"attr\":{\"message\":\"[1601643255:701929][1:0x7f1abada1a80], txn-recover: [WT_VERB_RECOVERY | WT_VERB_RECOVERY_PROGRESS] Main recovery loop: starting at 3/256 to 4/256\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.702+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22430,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger message\",\"attr\":{\"message\":\"[1601643255:702746][1:0x7f1abada1a80], txn-recover: [WT_VERB_RECOVERY_PROGRESS] Recovering log 3 through 4\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.757+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22430,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger message\",\"attr\":{\"message\":\"[1601643255:757732][1:0x7f1abada1a80], file:index-3--1134620176205790706.wt, txn-recover: [WT_VERB_RECOVERY_PROGRESS] Recovering log 4 through 4\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.793+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22430,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger message\",\"attr\":{\"message\":\"[1601643255:793168][1:0x7f1abada1a80], file:index-3--1134620176205790706.wt, txn-recover: [WT_VERB_RECOVERY | WT_VERB_RECOVERY_PROGRESS] Set global recovery timestamp: (0, 0)\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.793+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22430,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger message\",\"attr\":{\"message\":\"[1601643255:793225][1:0x7f1abada1a80], file:index-3--1134620176205790706.wt, txn-recover: [WT_VERB_RECOVERY | WT_VERB_RECOVERY_PROGRESS] Set global oldest timestamp: (0, 0)\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.801+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":4795906, \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger opened\",\"attr\":{\"durationMillis\":705}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.802+00:00\"},\"s\":\"I\",  \"c\":\"RECOVERY\", \"id\":23987,   \"ctx\":\"initandlisten\",\"msg\":\"WiredTiger recoveryTimestamp\",\"attr\":{\"recoveryTimestamp\":{\"$timestamp\":{\"t\":0,\"i\":0}}}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.814+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":22262,   \"ctx\":\"initandlisten\",\"msg\":\"Timestamp monitor starting\"}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.816+00:00\"},\"s\":\"W\",  \"c\":\"CONTROL\",  \"id\":22120,   \"ctx\":\"initandlisten\",\"msg\":\"Access control is not enabled for the database. Read and write access to data and configuration is unrestricted\",\"tags\":[\"startupWarnings\"]}\nnginx_1      | nginx: [warn] duplicate MIME type \"text/html\" in /etc/nginx/nginx.conf:68\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.824+00:00\"},\"s\":\"I\",  \"c\":\"STORAGE\",  \"id\":20536,   \"ctx\":\"initandlisten\",\"msg\":\"Flow Control is enabled on this deployment\"}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.826+00:00\"},\"s\":\"I\",  \"c\":\"FTDC\",     \"id\":20625,   \"ctx\":\"initandlisten\",\"msg\":\"Initializing full-time diagnostic data capture\",\"attr\":{\"dataDirectory\":\"/data/db/diagnostic.data\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.829+00:00\"},\"s\":\"I\",  \"c\":\"NETWORK\",  \"id\":23015,   \"ctx\":\"listener\",\"msg\":\"Listening on\",\"attr\":{\"address\":\"/tmp/mongodb-27017.sock\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.829+00:00\"},\"s\":\"I\",  \"c\":\"NETWORK\",  \"id\":23015,   \"ctx\":\"listener\",\"msg\":\"Listening on\",\"attr\":{\"address\":\"0.0.0.0\"}}\nmongodb_1    | {\"t\":{\"$date\":\"2020-10-02T12:54:15.829+00:00\"},\"s\":\"I\",  \"c\":\"NETWORK\",  \"id\":23016,   \"ctx\":\"listener\",\"msg\":\"Waiting for connections\",\"attr\":{\"port\":27017,\"ssl\":\"off\"}}\npyos_1       | /usr/lib/python3/dist-packages/requests/__init__.py:80: RequestsDependencyWarning: urllib3 (1.25.10) or chardet (3.0.4) doesn't match a supported version!\npyos_1       |   RequestsDependencyWarning)\npyos_1       | 2020-10-02 12:54:16,239 [INFO   ] oc.logging.init_logging: Initializing logging subsystem\npyos_1       | 2020-10-02 12:54:16,239 [INFO   ] oc.logging.load_config: Reading cherrypy configuration section 'global/logging': path = od.config\npyos_1       | 2020-10-02 12:54:16,244 [INFO   ] oc.logging.init_logging: Applying configuration\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init:internal Init configuration --- \npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.load:internal Loading configuration file 'od.config'\npyos_1       | 2020-10-02 12:54:16 settings [WARNING] oc.od.settings.init_tls:internal SECURITY Warning clienttlskey is not set\npyos_1       | 2020-10-02 12:54:16 settings [WARNING] oc.od.settings.init_tls:internal SECURITY Warning clienttlscert is not set\npyos_1       | 2020-10-02 12:54:16 settings [WARNING] oc.od.settings.init_tls:internal SECURITY Warning tlscacert is not set\npyos_1       | 2020-10-02 12:54:16 settings [WARNING] oc.od.settings.init_tls:internal SECURITY Warning connection to docker dameon on host may failed or is insecure\npyos_1       | 2020-10-02 12:54:16 settings [WARNING] oc.od.settings.init_tls:internal Read HOWTO-configure documentation\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_config_mail_shared:internal Missing mail shared gconfig parameters, shared sendmail is disabled\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_config_mail_support:internal Missing mail support gconfig parameters, support sendmail is disabled\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_defaulthostfqdn:internal default_host_url: http://localhost\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_defaulthostfqdn:internal default_server_ipaddr: 127.0.0.1\npyos_1       | 2020-10-02 12:54:16 settings [DEBUG  ] oc.od.settings.init_config_auth:internal {}\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.get_mongoconfig:internal MONGODB_URL: None\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.get_mongoconfig:internal mongodburl is mongodb://mongodb:27017\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.get_mongoconfig:internal host mongodb resolved as 172.21.0.3\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.get_mongoconfig:internal mongodburl is set to: mongodb://mongodb:27017\npyos_1       | 2020-10-02 12:54:16 datastore [INFO   ] oc.datastore.MongoClientConfig.__init__:internal mongodb client config server mongodb://mongodb:27017\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_config_mongodb:internal MongoDB connection string: mongodb://mongodb:27017\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_config_memcached:internal stackmode is standalone\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_config_memcached:internal memcachedhostname is memcached\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_config_memcached:internal host memcached resolved as 172.21.0.2\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_config_memcached:internal Memcached connection string is set to: 172.21.0.2:11211\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_webdav:internal webdav support is : False\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_websocketrouting:internal mode is http_origin\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_policy:internal User Execute Policy is False\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_policy:internal Network Control Policy is False\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init_locales:internal Supported local language is set to  ['af_ZA', 'am_ET', 'an_ES', 'ar_AE', 'ar_BH', 'ar_DZ', 'ar_EG', 'ar_IN', 'ar_IQ', 'ar_JO', 'ar_KW', 'ar_LB', 'ar_LY', 'ar_MA', 'ar_OM', 'ar_QA', 'ar_SA', 'ar_SD', 'ar_SY', 'ar_TN', 'ar_YE', 'as_IN', 'ast_ES', 'az_AZ', 'be_BY', 'bg_BG', 'bn_BD', 'bn_IN', 'bo_CN', 'bo_IN', 'br_FR', 'bs_BA', 'ca_AD', 'ca_ES', 'ca_FR', 'ca_IT', 'crh_UA', 'cs_CZ', 'cy_GB', 'da_DK', 'de_AT', 'de_BE', 'de_CH', 'de_DE', 'de_LI', 'de_LU', 'dz_BT', 'el_CY', 'el_GR', 'en_AG', 'en_AU', 'en_BW', 'en_CA', 'en_DK', 'en_GB', 'en_HK', 'en_IE', 'en_IN', 'en_NG', 'en_NZ', 'en_PH', 'en_SG', 'en_US', 'en_ZA', 'en_ZM', 'en_ZW', 'eo', 'eo_US', 'es_AR', 'es_BO', 'es_CL', 'es_CO', 'es_CR', 'es_CU', 'es_DO', 'es_EC', 'es_ES', 'es_GT', 'es_HN', 'es_MX', 'es_NI', 'es_PA', 'es_PE', 'es_PR', 'es_PY', 'es_SV', 'es_US', 'es_UY', 'es_VE', 'et_EE', 'eu_ES', 'eu_FR', 'fa_IR', 'fi_FI', 'fr_BE', 'fr_CA', 'fr_CH', 'fr_FR', 'fr_LU', 'ga_IE', 'gd_GB', 'gl_ES', 'gu_IN', 'he_IL', 'hi_IN', 'hr_HR', 'hu_HU', 'id_ID', 'is_IS', 'it_CH', 'it_IT', 'ja_JP', 'ka_GE', 'kk_KZ', 'km_KH', 'kn_IN', 'ko_KR', 'ku_TR', 'lt_LT', 'lv_LV', 'mai_IN', 'mk_MK', 'ml_IN', 'mn_MN', 'mr_IN', 'ms_MY', 'my_MM', 'nb_NO', 'nds_DE', 'nds_NL', 'ne_NP', 'nl_AW', 'nl_BE', 'nl_NL', 'nn_NO', 'oc_FR', 'or_IN', 'pa_IN', 'pa_PK', 'pl_PL', 'pt_BR', 'pt_PT', 'ro_RO', 'ru_RU', 'ru_UA', 'si_LK', 'sk_SK', 'sl_SI', 'sq_AL', 'sq_MK', 'sr_ME', 'sr_RS', 'sv_FI', 'sv_SE', 'ta_IN', 'ta_LK', 'te_IN', 'tg_TJ', 'th_TH', 'tr_CY', 'tr_TR', 'ug_CN', 'uk_UA', 'uz_UZ', 'vi_VN', 'xh_ZA', 'zh_CN', 'zh_HK', 'zh_SG', 'zh_TW']\npyos_1       | 2020-10-02 12:54:16 settings [INFO   ] oc.od.settings.init:internal Init configuration done.\npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_messageinfo:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_accounting:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_datastore:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_datacache:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_auth:internal \npyos_1       | 2020-10-02 12:54:16 authservice [INFO   ] oc.auth.authservice.__init__:internal Adding Auth manager external\npyos_1       | 2020-10-02 12:54:16 authservice [INFO   ] oc.auth.authservice.__init__:internal Adding Auth manager explicit\npyos_1       | 2020-10-02 12:54:16 authservice [INFO   ] oc.auth.authservice.__init__:internal Adding Auth manager implicit\npyos_1       | 2020-10-02 12:54:16 authservice [INFO   ] oc.auth.authservice.initproviders:internal Adding provider name anonymous \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_internaldns:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_resolvnetbios:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_jwtdesktop:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_locator:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_webrtc:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_infra:internal \npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_infra:internal Configuration file stack_mode is set to standalone\npyos_1       | 2020-10-02 12:54:16 infra [INFO   ] oc.od.infra.ODInfra.__init__:internal nodehostname=None\npyos_1       | 2020-10-02 12:54:16 infra [INFO   ] oc.od.infra.ODInfra.getdockerClient:internal Creating client: base_url = 'unix://var/run/docker.sock'\npyos_1       | 2020-10-02 12:54:16 orchestrator [DEBUG  ] oc.od.orchestrator.ODOrchestratorKubernetes.__init__:internal config.load_kube_config not in cluster mode\npyos_1       | 2020-10-02 12:54:16 orchestrator [WARNING] oc.od.orchestrator.ODOrchestratorKubernetes.__init__:internal Invalid kube-config file. No configuration found.\npyos_1       | 2020-10-02 12:54:16 orchestrator [DEBUG  ] oc.od.orchestrator.ODOrchestratorKubernetes.__init__:internal ODOrchestratorKubernetes __init__ done configure=False\npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_infra:internal abcdesktop mode is using mode : standalone\npyos_1       | 2020-10-02 12:54:16 infra [INFO   ] oc.od.infra.ODInfra.__init__:internal nodehostname=None\npyos_1       | 2020-10-02 12:54:16 infra [INFO   ] oc.od.infra.ODInfra.getdockerClient:internal Creating client: base_url = 'unix://var/run/docker.sock'\npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_infra:internal default overlay network: abcdesktop_netuser - id ae6fbd05f88267783ff4910570e83d1a30d3fbe2e07c766632296e2707f56836\npyos_1       | 2020-10-02 12:54:16 services [INFO   ] oc.od.services.init_appscache:internal \npyos_1       | 2020-10-02 12:54:16 apps [DEBUG  ] oc.od.apps.build_applist:internal \npyos_1       | 2020-10-02 12:54:16 infra [INFO   ] oc.od.infra.ODInfra.__init__:internal nodehostname=None\npyos_1       | 2020-10-02 12:54:16 infra [DEBUG  ] oc.od.infra.ODInfra.getdockerClientAPI:internal Creating client: base_url = 'unix://var/run/docker.sock\npyos_1       | 2020-10-02 12:54:16 apps [DEBUG  ] oc.od.apps.build_applist:internal end\npyos_1       | 2020-10-02 12:54:16 od [INFO   ] __main__.run_server:internal Starting cherrypy service...\npyos_1       | 2020-10-02 12:54:16 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.accounting_controller'\npyos_1       | 2020-10-02 12:54:16 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.auth_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.composer_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.core_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.directory_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.key_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.manager_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.printer_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.store_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.user_controller'\npyos_1       | 2020-10-02 12:54:17 pyutils [DEBUG  ] oc.pyutils.import_classes:internal Importing module 'controllers.webrtc_controller'\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class AccountingController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class AuthController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class ComposerController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class CoreController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class DirectoryController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class KeyController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class ManagerController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class PrinterController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class StoreController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class UserController\npyos_1       | 2020-10-02 12:54:17 cherrypy [DEBUG  ] oc.cherrypy.create_controllers:internal instancing class WebRTCController\npyos_1       | 2020-10-02 12:54:17 od [INFO   ] __main__.run_server:anonymous Waiting for requests...\n</code></pre> <p>Check that the last pyos line is Waiting for requests...</p>"},{"location":"1.0/setup/dockermode/#start-your-web-browser","title":"Start your web browser","text":"<p>Start a web browser and go to your host where the docker-compose is running, in this example i run abcdesktopio on my laptop, <code>http://localhost</code> </p> <p>abcdesktopio use websockets, by default websocket connection establishment is permit to localhost. </p> <pre><code>http://localhost\n</code></pre> <p>You should see the authentication HTML page with the Sign-in Anonymously button</p>  <p>Click on the Sign-in Anonymously, have a look access button. Pyos is creating a new desktop using the user container docker image oc.user.18.04.</p> <p>Few seconds later, processes are ready to run. You should see the abcdesktop main screen, with only one application File Manager.</p>  <p>Great you have installed abcdesktop.io in Docker mode. You just need a web browser to reach your web workspace.</p>"},{"location":"1.0/setup/dockermode/#networks-abcdesktop_netuser-and-abcdestkop_netback","title":"Networks <code>abcdesktop_netuser</code> and <code>abcdestkop_netback</code>","text":"<p>abcdesktop.io in docker mode use two docker networks <code>abcdesktop_netuser</code> and <code>abcdesktop_netback</code>. </p> <ul> <li><code>abcdesktop_netuser</code> is a dedicated network between nginx and the user containers. </li> <li><code>abcdesktop_netback</code> is a dedicated network nginx, pyos, mongodb and memcache</li> </ul> <p>By design, and for security reasons, the user containers can not (and never) reach the netback network. If a process running inside the user container have to send a message to the API server, the message is send to the user's web browser and then forwarded to the API Server.</p>  <p>The <code>abcdesktop_netuser</code> bridge your local interface has defined in the docker-compose file, so you can reach the nginx website using <code>http://localhost</code> </p>  <pre><code> netuser:\n    driver: bridge\n</code></pre>"},{"location":"1.0/setup/dockermode/#list-all-docker-containers","title":"List all docker containers","text":"<p>Start a new shell and run the docker ps -a command to list all the containers</p> <pre><code>docker ps -a\n</code></pre> <p>You should read the output</p> <pre><code>CONTAINER ID        IMAGE                           COMMAND                  CREATED             STATUS                        PORTS                                                                              NAMES\n9376fc4e571e        abcdesktopio/oc.user.18.04   \"/composer/docker-en\u2026\"   40 seconds ago      Up 39 seconds                 4714/tcp, 6081/tcp, 29780-29781/tcp, 29783-29784/tcp, 29786/tcp, 55556-55557/tcp   g-340cabd2-6509-4609-8f82-3a713900be1f\n0fcd8663d02c        abcdesktopio/oc.nginx        \"/composer/docker-en\u2026\"   13 minutes ago      Up 2 minutes                  0.0.0.0:80-&gt;80/tcp, 554/tcp, 8554/tcp, 0.0.0.0:443-&gt;443/tcp, 9000/tcp              abcdesktop_nginx_1\n83d1c047cbf0        abcdesktopio/oc.pyos         \"/composer/docker-en\u2026\"   13 minutes ago      Up 2 minutes                                                                                                     abcdesktop_pyos_1\na466db429025        mongo                           \"docker-entrypoint.s\u2026\"   13 minutes ago      Up 2 minutes                                                                                                     abcdesktop_mongodb_1\n219eb62a89a4        abcdesktopio/oc.speedtest    \"docker-php-entrypoi\u2026\"   13 minutes ago      Up 2 minutes                  80/tcp                                                                             abcdesktop_speedtest_1\n676ca0fcf3a5        memcached                       \"docker-entrypoint.s\u2026\"   13 minutes ago      Up 2 minutes                                                                                                     abcdesktop_memcached_1\n\n</code></pre> <p>The new abcdesktop user container has been created</p> <pre><code>9376fc4e571e        abcdesktopio/oc.user.18.04:latest   \"/composer/docker-en\u2026\" \n</code></pre>"},{"location":"1.0/setup/dockermode/#add-new-applications-to-your-desktop","title":"Add new applications to your desktop","text":"<p>There is only one application on your desktop the File Manager. It's now time to add new application. Each application is a docker container, to install new docker container run the docker pull command :</p> <p>Install LibreOffice Suite </p> <pre><code>docker pull abcdesktopio/base.d\ndocker pull abcdesktopio/calc.d\ndocker pull abcdesktopio/impress.d\ndocker pull abcdesktopio/math.d\ndocker pull abcdesktopio/writer.d \n</code></pre> <p>Install Mozilla Suite </p> <pre><code>docker pull abcdesktopio/firefox.d\ndocker pull abcdesktopio/thunderbird.d\n</code></pre> <p>Install Gnome games </p> <pre><code>docker pull abcdesktopio/mines.d\ndocker pull abcdesktopio/tetravex.d\n</code></pre> <p>Install Gnome tools </p> <pre><code>docker pull abcdesktopio/calculator.d\ndocker pull abcdesktopio/terminal.d\n</code></pre>"},{"location":"1.0/setup/dockermode/#update-the-cache-application-list","title":"Update the cache application list","text":"<p>The API server receives a new image event from dockerd. To run the new applications just refresh you web browser page.</p> <p>Now reconnect to your abcdesktop. </p> <p>Reload your web browser page or start a new session. It's time to run the LibreOffice applications. </p>  <p>New applications appear in the dock, start the application <code>Firefox</code> for example.</p>  <p>Firefox application is running inside a container.</p>"},{"location":"1.0/setup/dockermode/#ready-to-use-for-a-personal-usage","title":"Ready to use for a personal usage","text":"<p>Great, you have installed abcdesktop.io in non-cluster hosts, and pull images for your workspace. You can build and add your application. </p>"},{"location":"1.0/setup/k8slinuxinstallation/","title":"Linux Requirements","text":""},{"location":"1.0/setup/k8slinuxinstallation/#packages-installation","title":"Packages installation","text":"<p>To install Kubernetes on your GNU/Linux, you can read the Kubernetes setup guide on the kubernetes.io web site.</p>"},{"location":"1.0/setup/k8slinuxinstallation/#install-kubernetes-on-linux","title":"Install Kubernetes on Linux","text":""},{"location":"1.0/setup/k8slinuxinstallation/#step-1-install-docker","title":"Step 1: Install Docker","text":"<p>Install the Docker utility and required packages on node by running the following command as sudo in a Terminal :</p> <pre><code>sudo apt-get install docker.io containerd gnupg openssl iptables acl python3-openssl apt-transport-https\n</code></pre> <p>You will be prompted with a Y/n option in order to proceed with the installation. Please enter Y and then hit enter to continue. Docker will then be installed on your system. You can verify the installation and also check the version number of Docker through the following command:</p> <pre><code>docker --version\n</code></pre>"},{"location":"1.0/setup/k8slinuxinstallation/#step-2-enable-docker","title":"Step 2: Enable Docker","text":"<p>Enable the Docker utility by running the following command on each:</p> <pre><code>sudo systemctl enable docker\n</code></pre>"},{"location":"1.0/setup/k8slinuxinstallation/#step-3-add-the-kubernetes-signing-key","title":"Step 3: Add the Kubernetes signing key","text":"<p>Run the following command in order to get the Kubernetes signing key:</p> <pre><code>curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add - \n</code></pre> <p>If <code>curl</code> is not installed on your system, you can install it through the following command as root:</p> <pre><code>sudo apt install curl\n</code></pre> <p>You will be prompted with a Y/n option in order to proceed with the installation. Please enter <code>Y</code> and then hit enter to continue. The Curl utility will then be installed on your system.</p>"},{"location":"1.0/setup/k8slinuxinstallation/#step-4-add-xenial-kubernetes-repository","title":"Step 4: Add Xenial Kubernetes Repository","text":"<p>Run the following commands in order to add the Xenial Kubernetes repository:</p> <pre><code>echo \"deb https://apt.kubernetes.io/ kubernetes-xenial main\" | sudo tee -a /etc/apt/sources.list.d/kubernetes.list \nsudo apt-get update\n</code></pre>"},{"location":"1.0/setup/k8slinuxinstallation/#step-5-install-kubernetes-utilities","title":"Step 5: Install Kubernetes utilities","text":"<pre><code>sudo apt-get install -y kubectl=1.23.7-00 kubeadm=1.23.7-00  kubelet=1.23.7-00\n</code></pre> <p>You will be prompted with a Y/n option in order to proceed with the installation. Please enter Y and then hit enter to continue. K8s utilities will then be installed on your system.</p> <ul> <li>Your kubernetes version must be greater than or equal to 1.15.0-00 and less than 1.24.XX</li> </ul> <p>You can check the version number of Kubeadm and also verify the installation through the following command:</p> <pre><code>kubeadm version\n</code></pre>"},{"location":"1.0/setup/k8smacosinstallation/","title":"MacOS/X Kubernetes","text":""},{"location":"1.0/setup/k8smacosinstallation/#enable-kubernetes-on-macosx","title":"Enable Kubernetes on MacOS/X","text":"<p>Click on the Docker icon in MacOS/X menu bar.</p>  <p>Then choose <code>Preferences...</code> </p>  <p>The following window should appear :</p>  <p>Choose <code>Kubernetes</code>, then check the  <code>Enable Kubernetes</code> </p> <p>Kubernetes stay in <code>Starting</code> state during few minutes. Please wait to download all container images and for kubernetes installation process.</p>  <p>On the bottom you should read next <code>Docker Running</code> <code>Kubernetes Running</code></p>  <p>Great, you have installed Kubernetes on MacOS/X.</p>"},{"location":"1.0/setup/k8smacosinstallation/#run-the-new-kubectl-command","title":"Run the new <code>kubectl</code> command","text":"<p>Open a Terminal, then run the command <code>kubectl version</code> </p> <pre><code>% kubectl version\nClient Version: version.Info{Major:\"1\", Minor:\"15\", GitVersion:\"v1.15.5\", GitCommit:\"20c265fef0741dd71a66480e35bd69f18351daea\", GitTreeState:\"clean\", BuildDate:\"2019-10-15T19:16:51Z\", GoVersion:\"go1.12.10\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\nServer Version: version.Info{Major:\"1\", Minor:\"15\", GitVersion:\"v1.15.5\", GitCommit:\"20c265fef0741dd71a66480e35bd69f18351daea\", GitTreeState:\"clean\", BuildDate:\"2019-10-15T19:07:57Z\", GoVersion:\"go1.12.10\", Compiler:\"gc\", Platform:\"linux/amd64\"}\n</code></pre> <p>Run the command <code>kubectl get pods</code> </p> <pre><code>% kubectl get pods\nNo resources found.\n</code></pre> <p>Great, the kubectl command works. It's time to deploy abcdesktop.io</p>"},{"location":"1.0/setup/k8swindows10installation/","title":"Windows 10 Kubernetes Installation","text":""},{"location":"1.0/setup/k8swindows10installation/#enable-kubernetes-on-windows-10","title":"Enable Kubernetes on Windows 10","text":"<p>Click on the <code>Docker Desktop</code> icon in the windows tray. </p> <p>The following menu should appear, choose <code>Settings</code> :</p>  <p>The following window should appear :</p>  <p>Choose <code>Kubernetes</code>, then check the  <code>Enable Kubernetes</code> </p>  <p>Press the <code>Apply and Restart</code> button. Please wait to download all container images and for kubernetes installation process.</p>  <p>On the bottom you should read next <code>Docker Running</code> and <code>Kubernetes Running</code>.</p> <p>Great, you have installed Kubernetes on Windows 10.</p>"},{"location":"1.0/setup/k8swindows10installation/#run-the-new-kubectl-command","title":"Run the new <code>kubectl</code> command","text":"<p>Open a Terminal <code>cmd.exe</code>, then run the command <code>kubectl version</code> </p> <pre><code>Client Version: version.Info{Major:\"1\", Minor:\"15\", GitVersion:\"v1.15.5\", GitCommit:\"20c265fef0741dd71a66480e35bd69f18351daea\", GitTreeState:\"clean\", BuildDate:\"2019-10-15T19:16:51Z\", GoVersion:\"go1.12.10\", Compiler:\"gc\", Platform:\"windows/amd64\"}\nServer Version: version.Info{Major:\"1\", Minor:\"15\", GitVersion:\"v1.15.5\", GitCommit:\"20c265fef0741dd71a66480e35bd69f18351daea\", GitTreeState:\"clean\", BuildDate:\"2019-10-15T19:07:57Z\", GoVersion:\"go1.12.10\", Compiler:\"gc\", Platform:\"linux/amd64\"}\n</code></pre> <p>Run the command <code>kubectl get pods</code> </p> <pre><code>kubectl get pods\nNo resources found.\n</code></pre> <p>Great, the kubectl command works. It's time to deploy abcdesktop.io</p>"},{"location":"1.0/setup/kubernetes_abcdesktop/","title":"abcdesktop.io in kubernetes mode","text":"<p>abcdesktop.io support docker mode and kubernetes mode. In this section we will study how abcdabcdesktopio/esktop.io works in kubernetes mode. The abcdesktop.io kubernetes mode is recommended for enterprise use,  all applications containers can be distributed on different hosts.</p> <p>In kubernetes mode, the abcdesktop.io infrastructure use seven containers (oc.cups is optional), each container has a specific role :</p>    Container Role Image From     oc.user user container abcdesktopio/oc.user.18.04 abcdesktopio   oc.cups printing container abcdesktopio/oc.cupsd.18.04 abcdesktopio   oc.pyos API Server abcdesktopio/oc.pyos abcdesktopio   oc.nginx web server proxy abcdesktopio/oc.nginx abcdesktopio   oc.speedtest http benchmarch abcdesktopio/oc.speedtest LibreSpeed   oc.mongo json database server mongo MongoDB   memcached cache server memcached Memcached"},{"location":"1.0/setup/kubernetes_abcdesktop/#requirements","title":"Requirements","text":"<p>You need to have a Kubernetes cluster, and the <code>kubectl</code> command-line tool must be configured to communicate with your cluster. If you do not already have a cluster, you can create one by reading Kubernetes Setup. The command line <code>openssl</code> must be installed too.</p> <p>You can run the Quick installation process or choose the Manually installation step by step</p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#quick-installation-linux-or-macos","title":"Quick installation (Linux or macOS)","text":"<p>Quick installation can be run on Linux or macOS operation system.  For Microsoft Windows, please read the following chapter 'Manually installation step by step'</p>  <p>You can watch the youtube video sample. </p> <p>This video describes the Quick installation process.</p>   <p>Download and extract the latest release automatically (Linux or macOS):</p> <pre><code>curl -sL https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/install.sh | bash\n</code></pre> <p>The command above downloads the latest release (numerically) of abcdesktop.io.  The quick installation process runs the all commands step by step:</p> <ul> <li>create the abcdesktop namespace</li> <li>build all rsa keys pairs for jwt signing and payload encryption</li> <li>create all services, pods, secrets and configmaps</li> <li>download user's core images: oc.user, oc.cupsd, oc.pulseaudio</li> <li>download some applications images sample: the LibreOffice suite (calc, writer, impress), Firefox, Gimp, and gnome-terminal.</li> </ul> <p>You can also download the install.sh bash script, and read it and then run it.</p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#manually-installation-step-by-step-linux-macos-or-windows","title":"Manually installation step by step (Linux, macOS or Windows)","text":"<p>The following commands will let you prepare and build abcdesktop plateform on the master node. All applications run on a single server.  </p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#install-abcdesktop","title":"Install abcdesktop","text":""},{"location":"1.0/setup/kubernetes_abcdesktop/#step-1-create-abcdesktop-namespace","title":"Step 1: Create abcdesktop namespace","text":"<p>We will create abcdesktop namespace and set it as default :</p> <pre><code># First create the abcdesktop namespace\nkubectl create namespace abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>namespace/abcdesktop created\n</code></pre>  <p>Option : To use the namespace <code>abcdestkop</code> as default namespace  <code>kubectl config set-context $(kubectl config current-context) --namespace=abcdesktop</code></p> <p>All kubectl commands will be executed with abcdesktop namespace. This will avoid to add \"-n abcdesktop\" to all commands. </p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#step-2-securized-abcdesktop","title":"Step 2: Securized abcdesktop","text":"<p>All communications between nginx, pyos and user navigator are encrypted by JSON Web Tokens.</p> <ul> <li>The JSON Web Tokens payload is encrypted with the abcdesktop jwt desktop payload private by pyos</li> <li> <p>The JSON Web Tokens payload is decrypted with the abcdesktop jwt desktop payload public keys by nginx.</p>  <p>Please use the payload private as private key, and the payload public as private key.  Do not publish the public key. This public key must stay private, this is a special case, this is not stupid, it's only a more secure option.</p>  </li> <li> <p>The JSON Web Tokens payload is signed with the abcdesktop jwt desktop signing private keys</p> </li> <li> <p>The JSON Web Tokens payload is verified with the abcdesktop jwt desktop signing public keys.</p> </li> <li> <p>The JSON Web Tokens user is signed with the abcdesktop jwt user signing private keys by pyos.</p> </li> <li>The JSON Web Tokens user is verified with the abcdesktop jwt user signing public keys by pyos <p>As multiple pods of pyos can run simultaneously, the same private and public keys value are stored into kubernetes secret.</p>  </li> </ul> <p>The abcdesktop jwt desktop payload public key is read by nginx lua script and by pyos, export the public key using the <code>RSAPublicKey_out</code> option, to use the <code>RSAPublicKey</code> format. The <code>RSAPublicKey</code> format make key file format compatible between python and lua.</p> <p>The following commands will let you create all necessary keys :</p> <pre><code># build rsa kay pairs for jwt payload \n# 1024 bits is a smallest value, change here if need but use more than 1024\nopenssl genrsa  -out abcdesktop_jwt_desktop_payload_private_key.pem 1024\nopenssl rsa     -in  abcdesktop_jwt_desktop_payload_private_key.pem -outform PEM -pubout -out  _abcdesktop_jwt_desktop_payload_public_key.pem\nopenssl rsa -pubin -in _abcdesktop_jwt_desktop_payload_public_key.pem -RSAPublicKey_out -out abcdesktop_jwt_desktop_payload_public_key.pem\n\n# build rsa kay pairs for the desktop jwt signing \nopenssl genrsa -out abcdesktop_jwt_desktop_signing_private_key.pem 1024\nopenssl rsa     -in abcdesktop_jwt_desktop_signing_private_key.pem -outform PEM -pubout -out abcdesktop_jwt_desktop_signing_public_key.pem\n\n# build rsa kay pairs for the user jwt signing \nopenssl genrsa -out abcdesktop_jwt_user_signing_private_key.pem 1024\nopenssl rsa     -in abcdesktop_jwt_user_signing_private_key.pem -outform PEM -pubout -out abcdesktop_jwt_user_signing_public_key.pem\n\n</code></pre> <p>Then, create the kubernetes secrets from the new key files:</p> <pre><code># create the kubernetes rsa keys secret for abcdesktop\nkubectl create secret generic abcdesktopjwtdesktoppayload --from-file=abcdesktop_jwt_desktop_payload_private_key.pem --from-file=abcdesktop_jwt_desktop_payload_public_key.pem --namespace=abcdesktop\nkubectl create secret generic abcdesktopjwtdesktopsigning --from-file=abcdesktop_jwt_desktop_signing_private_key.pem --from-file=abcdesktop_jwt_desktop_signing_public_key.pem --namespace=abcdesktop\nkubectl create secret generic abcdesktopjwtusersigning --from-file=abcdesktop_jwt_user_signing_private_key.pem --from-file=abcdesktop_jwt_user_signing_public_key.pem --namespace=abcdesktop\n</code></pre> <p>You should read on the standard output :</p> <pre><code>secret/abcdesktopjwtdesktoppayload created\nsecret/abcdesktopjwtdesktopsigning created\nsecret/abcdesktopjwtusersigning created\n</code></pre>  <p>Only if you use a private registry or if the abcdesktop registry is private Create Secret to allow kubernetes to download abcdesktop images from docker registry. For this part you need to change docker-username and docker-password by credentials provided by project owner. If you don't have this values, you will have to build abcdesktop images by yourself.</p> <p>change docker.json path if need /root/.docker/config.json  <code>kubectl create secret generic abcdesktopregistrysecret --from-file=.dockerconfigjson=/root/.docker/config.json --type=kubernetes.io/dockerconfigjson -n abcdesktop</code></p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#verify-secrets","title":"Verify Secrets","text":"<p>You can verify secrets creation with the following command :</p> <pre><code>kubectl get secrets -n abcdesktop\n</code></pre> <p>You should read on the standard output :</p> <pre><code>NAME                           TYPE                                  DATA   AGE\ndefault-token-5zknd            kubernetes.io/service-account-token   3      6m6s\nabcdesktopjwtdesktoppayload   Opaque                                2      68s\nabcdesktopjwtdesktopsigning   Opaque                                2      68s\nabcdesktopjwtusersigning      Opaque                                2      67s\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop/#step-3-download-core-images-create-pods-and-services","title":"Step 3: Download core images, create Pods, and services","text":"<p>Pre download the three user default images, to make sure that Kubernetes will find the docker images at startup time. </p> <pre><code>docker pull abcdesktopio/oc.user.18.04\ndocker pull abcdesktopio/oc.cupsd.18.04\ndocker pull abcdesktopio/oc.pulseaudio.18.04\n</code></pre> <p>You should read on the standard output</p> <pre><code>oc.user.18.04: Pulling from abcdesktopio\n...[cut here]...\ndocker.io/abcdesktopio/oc.user.18.04\n\noc.cupsd.18.04: Pulling from abcdesktopio\n...[cut here]...\ndocker.io/abcdesktopio/oc.cupsd.18.04\n\noc.pulseaudio.18.04: Pulling from abcdesktopio\n...[cut here]...\ndocker.io/abcdesktopio/oc.pulseaudio.18.04\n</code></pre> <p>Create the abcdesktop pods and services</p> <p>abcdesktop.yaml file contains declarations for all roles, service account, pods, and services required for abcdesktop.</p> <p>Run the command line</p> <pre><code>kubectl create -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop.yaml\n</code></pre> <p>You should read on the standard output</p> <pre><code>clusterrole.rbac.authorization.k8s.io/pyos-role created\nclusterrolebinding.rbac.authorization.k8s.io/pyos-rbac created\nserviceaccount/pyos-serviceaccount created\nstorageclass.storage.k8s.io/storage-local-abcdesktop created\npersistentvolume/pv-volume-home-directory created\npersistentvolumeclaim/persistentvolumeclaim-home-directory created\nconfigmap/abcdesktop-config created\nconfigmap/nginx-config created\ndeployment.apps/memcached-od created\nsecret/mongodb-secret created\nstatefulset.apps/mongodb-od created\ndaemonset.apps/daemonset-nginx created\ndeployment.apps/speedtest-od created\ndaemonset.apps/daemonset-pyos created\nendpoints/desktop created\nservice/desktop created\nservice/memcached created\nservice/mongodb created\nservice/speedtest created\nservice/nginx created\nservice/pyos created\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop/#verify-pods","title":"Verify Pods","text":"<p>Once the pods are created, all pods should be running. For the first time, status maybe long to become running as some container images may be downloaded</p> <pre><code>kubectl get pods -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME                                   READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-nfsbm                  1/1     Running   0          29s\ndaemonset-pyos-8kvfp                   1/1     Running   0          29s\nmemcached-od-5bf65bf745-j69lh          1/1     Running   0          29s\nmongodb-od-6cbf8d74d-2rdmd             1/1     Running   0          29s\nopenldap-od-8dc9f56d8-wtlxl            1/1     Running   0          29s\nspeedtest-od-7cb7dd44f5-p947s          1/1     Running   0          29s\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop/#connect-your-local-abcdesktop","title":"Connect your local abcdesktop","text":"<p>Open your navigator to http://[your-ip-hostname]:30443/</p> <p>abcdesktop homepage should be available :</p>  <p>Click on the Connect with Anonymous access button. abcdesktop service pyos is creating a new desktop using the user container docker image oc.user.18.04.</p>  <p>Few seconds later, processes are ready to run. You should see the abcdesktop main screen, with only one application File Manager.</p>  <p>Great you have installed abcdesktop.io in Kubernetes mode. You just need a web browser to reach your web workspace. It' now time to add some container applications. Read the chapter add kubernetes contain</p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#troubleshoot","title":"Troubleshoot","text":"<p>All kubernetes resources can be inspected to get more informations.</p> <p>First list elements you want to verify, in the following case, we will inspect pods :</p> <pre><code>    kubectl get pods -n abcdesktop\n\n    NAME                            READY   STATUS             RESTARTS   AGE\n    daemonset-nginx-qnd4n           1/1     Running            0          92s\n    daemonset-pyos-6mgq4            1/1     Running            0          92s\n    memcached-od-db69c45fb-mqt4n    1/1     Running            0          92s\n    mongodb-od-ff874fcb5-sm6f7      1/1     Running            0          92s\n    speedtest-od-55c58fdd69-5znpr   0/1     ImagePullBackOff   0          92s\n</code></pre> <p>As we can see, status is \"ImagePullBackOff\" for speedtest-od pod. We will then ask kubernetes to describe the pod with the following command :</p> <pre><code>kubectl describe pod speedtest-od-55c58fdd69-t99ck -n abcdesktop\n</code></pre> <p>In this case, the important information part is at the end (it's not always the case, you can also look at \"Conditions:\" section) : </p> <pre><code>    Events:\n      Type     Reason   Age                    From             Message\n      ----     ------   ----                   ----             -------\n      Warning  Failed   7m6s (x4837 over 18h)  kubelet, cube05  Error: ImagePullBackOff\n      Normal   BackOff  2m9s (x4860 over 18h)  kubelet, cube05  Back-off pulling image \"registry.mydomain.local:443/oc.speedtest\"\n</code></pre> <p>As we can see, in this case, Kubernetes had a problem to pull oc.speedtest image from registry.</p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#verify-daemonsets","title":"Verify Daemonsets","text":"<pre><code>kubectl get daemonsets -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME              DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE\ndaemonset-nginx   1         1         1       1            1           &lt;none&gt;          16m\ndaemonset-pyos    1         1         1       1            1           &lt;none&gt;          16m\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop/#verify-service-ports","title":"Verify service ports","text":"<pre><code>kubectl get services -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE\ndesktop     ClusterIP   None             &lt;none&gt;        &lt;none&gt;         17m\nmemcached   ClusterIP   10.110.16.25     &lt;none&gt;        11211/TCP      17m\nmongodb     ClusterIP   10.110.49.161    &lt;none&gt;        27017/TCP      17m\nnginx       NodePort    10.102.13.5      &lt;none&gt;        80:30443/TCP   17m\nopenldap    ClusterIP   10.108.52.65     &lt;none&gt;        389/TCP        17m\npyos        ClusterIP   10.111.123.108   &lt;none&gt;        8000/TCP       17m\nspeedtest   ClusterIP   10.101.137.100   &lt;none&gt;        80/TCP         17m\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop/#verify-cluster-roles","title":"Verify cluster roles","text":"<pre><code>kubectl describe ClusterRole pyos-role -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>Name:         pyos-role\nLabels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\nPolicyRule:\n  Resources  Non-Resource URLs  Resource Names  Verbs\n  ---------  -----------------  --------------  -----\n  pods/exec  []                 []              [create get list watch update patch delete]\n  pods       []                 []              [get list watch create update patch delete]\n  secrets    []                 []              [get list watch create update patch delete]\n  pods/log   []                 []              [get list watch]\n  nodes      []                 []              [get watch list]\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop/#verify-cluster-role-bindind","title":"Verify Cluster Role Bindind","text":"<pre><code>kubectl describe ClusterRoleBinding pyos-rbac -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>Name:         pyos-rbac\nLabels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\nRole:\n  Kind:  ClusterRole\n  Name:  pyos-role\nSubjects:\n  Kind            Name                 Namespace\n  ----            ----                 ---------\n  ServiceAccount  pyos-serviceaccount  abcdesktop\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop/#view-pyos-logs","title":"View pyos logs","text":"<p>Since the abcdesktop pyos code needs to interact with the Docker API in order to CRUD containers, pyos need to mount /var/run/docker.sock into the container</p>  <pre><code>kubectl logs daemonset-pyos-tklg8 --follow -n abcdesktop\n</code></pre> <p>Note that you also can view logs using docker command</p>"},{"location":"1.0/setup/kubernetes_abcdesktop/#rollout-daemonset","title":"Rollout daemonset","text":"<p>To rollout restart the abcdesktop daemonset</p> <pre><code>kubectl rollout restart daemonset -n abcdesktop\n</code></pre> <p>You should read on the standard output </p> <pre><code>daemonset.apps/daemonset-nginx restarted\ndaemonset.apps/daemonset-pyos restarted\n</code></pre> <p>Check the pods status  </p> <pre><code>kubectl get pods  -n abcdesktop\nNAME                            READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-dh2xd           1/1     Running   0          4m22s\ndaemonset-pyos-9xn26            1/1     Running   0          3m52s\nmemcached-od-5bf65bf745-xpvvr   1/1     Running   3          45h\nmongodb-od-656d85c49f-242jh     1/1     Running   4          45h\nopenldap-od-5945946767-qf2hn    1/1     Running   0          45m\nspeedtest-od-d94b8cb5c-52wf5    1/1     Running   0          45m\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop_applications/","title":"Setup applications for abcdesktop","text":"<p>Each application is a docker container, to install new docker container run the docker pull command :</p> <p>Install LibreOffice Suite </p> <pre><code>docker pull abcdesktopio/base.d\ndocker pull abcdesktopio/calc.d\ndocker pull abcdesktopio/impress.d\ndocker pull abcdesktopio/math.d\ndocker pull abcdesktopio/writer.d \n</code></pre> <p>Install Mozilla Suite </p> <pre><code>docker pull abcdesktopio/firefox.d\ndocker pull abcdesktopio/thunderbird.d\n</code></pre> <p>Install Gnome games </p> <pre><code>docker pull abcdesktopio/mines.d\ndocker pull abcdesktopio/tetravex.d\n</code></pre> <p>Install Gnome tools </p> <pre><code>docker pull abcdesktopio/calculator.d\ndocker pull abcdesktopio/terminal.d\n</code></pre>"},{"location":"1.0/setup/kubernetes_abcdesktop_applications/#connect-to-your-abcdesktop","title":"Connect to your abcdesktop","text":"<p>The API server receives a new image event from docker daemon. To run the new applications just refresh you web browser page.</p> <p>Now reconnect to your abcdesktop. </p> <p>Open your navigator to http://[your-ip-hostname]:30443/</p> <pre><code>http://localhost:30443/\n</code></pre> <p>The new applications are installed, and ready to run.</p>"},{"location":"1.0/setup/kubernetes_secure_etcd/","title":"Secure Etcd secrets database","text":"<p>This chapter is optional  you can skip it if you think that's your kubernetes etcd database access is secured. </p>  <p>Etcd secrets database is the place where all k8s secrets are stored. By default secrets are stored in plain text.  If an attacker can access Etcd database, he know then all your secrets.</p> <p>To secure secrets, we will crypt them at API server level. All secrets will be stored encrypted in Etcd and then be uncrypted at API server level when accessed by Kubernetes.</p>"},{"location":"1.0/setup/kubernetes_secure_etcd/#availbale-encryption-providers","title":"Availbale Encryption Providers","text":"<p>Here are officials available encryption providers (Kubernetes Official page ):</p> Providers for Kubernetes encryption at restNameEncryptionStrengthSpeedKey LengthOther Considerations<code>identity</code>NoneN/AN/AN/AResources written as-is without encryption. When set as the first provider, the resource will be decrypted as new values are written.<code>aescbc</code>AES-CBC with PKCS#7 paddingStrongestFast32-byteThe recommended choice for encryption at rest but may be slightly slower than <code>secretbox</code>.<code>secretbox</code>XSalsa20 and Poly1305StrongFaster32-byteA newer standard and may not be considered acceptable in environments that require high levels of review.<code>aesgcm</code>AES-GCM with random nonceMust be rotated every 200k writesFastest16, 24, or 32-byteIs not recommended for use except when an automated key rotation scheme is implemented.<code>kms</code>Uses envelope encryption scheme: Data is encrypted by data encryption keys (DEKs) using AES-CBC with PKCS#7 padding, DEKs are encrypted by key encryption keys (KEKs) according to configuration in Key Management Service (KMS)StrongestFast32-bytesThe recommended choice for using a third party tool for key management. Simplifies key rotation, with a new DEK generated for each encryption, and KEK rotation controlled by the user.  <p>aesgcm provider seem's a bit complex to be used. kms provider needs to use a dedicated container and will not work out of the box. For abcdesktop we will use aescbc provider</p>"},{"location":"1.0/setup/kubernetes_secure_etcd/#aescbc-encryption-configuration","title":"aescbc encryption configuration","text":""},{"location":"1.0/setup/kubernetes_secure_etcd/#create-configuration-directory","title":"create configuration directory","text":"<p>In  <code>/etc/kubernetes</code> directory, create a directory named aescbc:</p> <pre><code>sudo mkdir /etc/kubernetes/aescbc\n</code></pre>"},{"location":"1.0/setup/kubernetes_secure_etcd/#create-configuration-file","title":"Create configuration file","text":"<p>Create aescbc yaml configuration file:</p> <pre><code>sudo vi /etc/kubernetes/aescbc/encrypt_config.yaml\n</code></pre> <pre><code>apiVersion: apiserver.config.k8s.io/v1\nkind: EncryptionConfiguration\nresources:\n  - resources:\n    - secrets\n    providers:\n    - aescbc:\n        keys:\n        - name: key1\n          secret: vKZm8oL19mucMS8qKXW4P9wSpab5H7LrLtOOPUUcvQk=\n    - identity: {}\n</code></pre>"},{"location":"1.0/setup/kubernetes_secure_etcd/#change-secret-key","title":"Change secret key","text":"<p>Secret key can be generated using the following command:</p> <pre><code>head -c 32 /dev/urandom | base64\n</code></pre> <p>In encrypt_config.yaml,  replace secret for key1 in aescbc.keys section</p>"},{"location":"1.0/setup/kubernetes_secure_etcd/#change-rights-on-directory-and-file","title":"Change rights on directory and file","text":"<p>As the encryption key is also the key that will uncrypt Etcd, we will try to protect it as much as possible by changing rights on directory and file:</p> <pre><code>sudo chmod -R 600 /etc/kubernetes/aescbc\n</code></pre>"},{"location":"1.0/setup/kubernetes_secure_etcd/#configure-kubernetes-api-server","title":"Configure Kubernetes Api Server","text":"<p>Encryption will be done at Kubernetes Api Server level. We will now configure this server to crypt secrets</p>"},{"location":"1.0/setup/kubernetes_secure_etcd/#configure-kube-apiserveryaml","title":"configure kube-apiserver.yaml","text":"<p>Edit <code>kube-apiserver.yaml</code> configuration file:</p> <pre><code>vim /etc/kubernetes/manifests/kube-apiserver.yaml\n</code></pre> <p>In spec.containers.command section add:</p> <pre><code>    - --encryption-provider-config=/etc/kubernetes/aescbc/encrypt_config.yaml\n</code></pre> <p>In spec.containers.volumeMounts section add:</p> <pre><code>    - mountPath: /etc/kubernetes/aescbc\n      name: aescbc-config\n      readOnly: true\n</code></pre> <p>In spec.volumes section add:</p> <pre><code>  - hostPath:\n      path: /etc/kubernetes/aescbc\n      type: DirectoryOrCreate\n    name: aescbc-config\n</code></pre> <p>save the file</p>"},{"location":"1.0/setup/kubernetes_secure_etcd/#verify-api-server","title":"verify api server","text":"<p>When saving file, Kubernetes will detect changes and restart Api Server. This can be verified using the following command:</p> <pre><code>kubectl -n kube-system get pods\n</code></pre> <pre><code>NAME                             READY   STATUS    RESTARTS   AGE\ncoredns-66bff467f8-69b8r         1/1     Running   0          21h\ncoredns-66bff467f8-74j9n         1/1     Running   0          21h\netcd-cube05                      1/1     Running   0          21h\nkube-apiserver-cube05            1/1     Running   0          6s\nkube-controller-manager-cube05   1/1     Running   1          21h\nkube-flannel-ds-amd64-p9xhq      1/1     Running   0          20h\nkube-proxy-8xk5g                 1/1     Running   0          21h\nkube-scheduler-cube05            1/1     Running   1          21h\n</code></pre> <p>At this state, all created secrets will be crypted in etcd</p>"},{"location":"1.0/setup/kubernetes_secure_etcd/#verify-secrets-encryption","title":"Verify secrets encryption","text":""},{"location":"1.0/setup/kubernetes_secure_etcd/#create-a-secret","title":"Create a secret","text":"<pre><code>kubectl create secret generic secret1 -n default --from-literal=mykey=mydata\n</code></pre>"},{"location":"1.0/setup/kubernetes_secure_etcd/#verify-secret-creation","title":"Verify secret creation","text":"<pre><code>sudo kubectl -n default describe secret secret1\n</code></pre> <pre><code>Name:         secret1\nNamespace:    default\nLabels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\n\nType:  Opaque\n\nData\n====\nmykey:  6 bytes\n</code></pre>"},{"location":"1.0/setup/kubernetes_secure_etcd/#verify-secret-encryption","title":"Verify secret encryption","text":"<p>To verify secret encryption we will install etcd client package</p> <pre><code>apt-get install etcd-client\n</code></pre> <p>Run the following command:</p> <pre><code>ETCDCTL_API=3 etcdctl --cacert=/etc/kubernetes/pki/etcd/ca.crt \\\n--cert=/etc/kubernetes/pki/etcd/ca.crt --key=/etc/kubernetes/pki/etcd/ca.key \\\n--endpoints=https://localhost:2379 get /registry/secrets/default/secret1\n</code></pre> <p>Output will appear with the following text <code>k8s:enc:aescbc:v1:key1:</code> followed by binary values.</p> <p>Secrets are now encoded with aescbc v1 provider using key1</p>"},{"location":"1.0/setup/kubernetesadvanced/","title":"Kubernetesadvanced","text":""},{"location":"1.0/setup/kubernetesadvanced/#install-opendekstop-on-a-cluster","title":"Install Opendekstop on a cluster","text":"<p>For advanced installation, we will put abcdesktop on a kubernetes multi-master cluster. </p> <p>For this, we will need 6 VMs :  - 1 Master Control Plane  - 2 Control Plane  - 3 Workers  </p> <p>All VMs require 2 CPU, 2Go Ram and 30Go HDD. Meaning you will need 12 CPU, 12Go Ram and 180Go HDD</p> <p>The following procedure has been executed on a Ubuntu 18.04 server.</p>"},{"location":"1.0/setup/kubernetesadvanced/#create-vms","title":"Create VMs","text":"<p>To create and manage VMs, we will create scripts and files : - serverlist.sh - Servers Names and IP to manage - default.xml - Modified KVM default network definition to add domain name for DNS resolution inside cluster - create-vm.sh - Script to create pre-configured Ubuntu 18.04 VMs - do_all.sh - Script to create all VMs and network for all cluster servers - delete-vm.sh - Script to delete all created VMs  </p> <p>All chapters actions will be done on host server. VMs creation can be skipped if you have your own cluster or you wan't to create it in a different way.</p>"},{"location":"1.0/setup/kubernetesadvanced/#install-libvirt-and-kvm-pacakges","title":"Install libvirt and kvm pacakges","text":"<pre><code>  sudo apt-get install -qy \\\n  qemu-kvm virtinst bridge-utils cpu-checker libvirt-clients libvirt-daemon-system \n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#create-vm-creation-files","title":"Create VM creation files","text":""},{"location":"1.0/setup/kubernetesadvanced/#serverlistsh-file","title":"serverlist.sh file","text":"<p>serverlist.sh file will let you define server names and IP using a bash dictionnary.</p> <p>Create <code>serverlist.sh</code> file copying the following lines:</p> <pre><code>unset newipdict\ndeclare -A newipdict\nnewipdict[\"k8s-master\"]=\"192.168.122.11\"\nnewipdict[\"k8s-cp1\"]=\"192.168.122.12\"\nnewipdict[\"k8s-cp2\"]=\"192.168.122.13\"\nnewipdict[\"k8s-ws1\"]=\"192.168.122.14\"\nnewipdict[\"k8s-ws2\"]=\"192.168.122.15\"\nnewipdict[\"k8s-ws3\"]=\"192.168.122.16\"\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#defaultxml-file","title":"default.xml file","text":"<p>default.xml file is a modified version of default network created by libvirt/KVM. This file just add domain name to let server names DNS resolution working.</p> <p>Create <code>default.xml</code> file copying the following lines:</p> <pre><code>&lt;network&gt;\n  &lt;name&gt;default&lt;/name&gt;\n  &lt;uuid&gt;067c864a-2704-4dbb-b997-2b3006640623&lt;/uuid&gt;\n  &lt;forward mode='nat'&gt;\n    &lt;nat&gt;\n      &lt;port start='1024' end='65535'/&gt;\n    &lt;/nat&gt;\n  &lt;/forward&gt;\n  &lt;bridge name='virbr0' stp='on' delay='0'/&gt;\n  &lt;mac address='52:54:00:a6:b9:2f'/&gt;\n  &lt;domain name='abcdesktop.local' localOnly='yes'/&gt;\n  &lt;ip address='192.168.122.1' netmask='255.255.255.0'&gt;\n    &lt;dhcp&gt;\n      &lt;range start='192.168.122.2' end='192.168.122.254'/&gt;\n    &lt;/dhcp&gt;\n  &lt;/ip&gt;\n&lt;/network&gt;\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#create-vmsh-file","title":"create-vm.sh file","text":"<p>This file is the template to create cluster VMs. VMs will be configured for french. You will have to modify Ubuntu Preseed for your country. (This is the hard part of the procedure)</p> <p>Create <code>create-vm.sh</code> file copying the following lines:</p> <pre><code>#!/bin/bash\n\nif [ -z \"$1\" ] ;\nthen\n echo Specify a virtual-machine name.\n exit 1\nfi\n\nNAME=$1\nNTPSERVER=\"fr.pool.ntp.org\"\nUSERNAME=\"abcdesktop\"\nPASSWORD=\"password\"\n\nfunction cleanup_preseed_cfg() {\n    rm -v -f $PRESEED_FILE\n    rmdir -v $PRESEED_DIR\n}\n\nfunction generate_preseed_cfg() {\n    PRESEED_DIR=/tmp/preseed$$\n    PRESEED_BASENAME=preseed.cfg\n    PRESEED_FILE=$PRESEED_DIR/$PRESEED_BASENAME\n    mkdir -p $PRESEED_DIR\n    cat &gt; $PRESEED_FILE &lt;&lt;EOF\nd-i debian-installer/language string C\nd-i debian-installer/locale string fr_FR.UTF-8\nd-i debian-installer/country string FR\nd-i keymap select fr(latin9)\nd-i keyboard-configuration/toggle select No toggling\nd-i keyboard-configuration/layout string French\nd-i     keyboard-configuration/variant  string\nd-i console-setup/ask_detect boolean false\nd-i console-setup/layoutcode string fr\nd-i netcfg/choose_interface select auto\nd-i netcfg/get_hostname string $NAME\nd-i netcfg/get_domain string localdomain\nd-i netcfg/wireless_wep string\nd-i mirror/country string FR\nd-i mirror/http/hostname string archive.ubuntu.com\nd-i mirror/http/directory string /ubuntu\nd-i mirror/http/proxy string $PROXY\nd-i mirror/http/mirror select archive.ubuntu.com\nd-i clock-setup/utc boolean true\nd-i time/zone string Europ/Paris\nd-i clock-setup/ntp boolean true\nd-i clock-setup/ntp-server string $NTPSERVER\nd-i partman-auto/method string lvm\nd-i partman-lvm/device_remove_lvm boolean true\nd-i partman-lvm/confirm boolean true\nd-i partman-lvm/confirm_nooverwrite boolean true\nd-i partman-auto-lvm/guided_size string max\n# - atomic: all files in one partition\n# - home:   separate /home partition\n# - multi:  separate /home, /usr, /var, and /tmp partitions\nd-i partman-auto/choose_recipe select atomic\nd-i partman-partitioning/confirm_write_new_label boolean true\nd-i partman/choose_partition select Finish partitioning and write changes to disk\nd-i partman/confirm boolean true\nd-i partman/confirm_nooverwrite boolean true\nd-i passwd/user-fullname string $USERNAME\nd-i passwd/username string $USERNAME\nd-i passwd/user-password password $PASSWORD\nd-i passwd/user-password-again password $PASSWORD\nd-i user-setup/allow-password-weak boolean true\nd-i user-setup/encrypt-home boolean false\n#tasksel tasksel/first multiselect\ntasksel tasksel/first multiselect standard\nd-i apt-setup/restricted boolean true\nd-i apt-setup/universe boolean true\nd-i apt-setup/backports boolean true\nd-i apt-setup/local0/repository string deb https://apt.kubernetes.io/ kubernetes-xenial main\nd-i apt-setup/local0/comment string Kubernetes Packages\nd-i apt-setup/local0/source boolean false\nd-i apt-setup/local0/key string http://packages.cloud.google.com/apt/doc/apt-key.gpg\nd-i pkgsel/include string openssh-server build-essential acpid git-core ntp \\\n                          docker.io containerd gnupg openssl iptables acl \\\n                          python3-openssl apt-transport-https kubectl=1.17.0-00 kubelet=1.17.0-00 kubeadm=1.17.0-00\nd-i pkgsel/upgrade select none\nd-i pkgsel/update-policy select none\nd-i grub-installer/only_debian boolean true\nd-i grub-installer/with_other_os boolean true\nd-i finish-install/reboot_in_progress note\nd-i preseed/late_command string \\\n    sed -i \"s;quiet;quiet console=ttyS0;\" /target/etc/default/grub ;   \\\n    sed -i \"s;quiet;quiet console=ttyS0;g\" /target/boot/grub/grub.cfg ; \\\n    echo '$USERNAME ALL=(ALL) NOPASSWD: ALL' &gt;/target/etc/sudoers.d/$USERNAME ; \\\n    in-target chmod 440 /etc/sudoers.d/$USERNAME ; \\\n    in-target swapoff -a ; \\\n    in-target rm -f /swapfile ; \\\n    in-target usermod -aG docker $USERNAME ; \\\n    in-target sed -ri '/\\sswap\\s/s/^#?/#/' /etc/fstab ; \\\n    in-target sed -i \"/ExecStart/s/$/ -H tcp:\\/\\/0.0.0.0:2376/g\" /lib/systemd/system/docker.service ; \\\n    in-target systemctl enable docker.service ; \\ \n    in-target mkdir /mnt/oio ; \\\n    in-target rm -f /etc/udev/rules.d/70-persistent-net.rules\nEOF\n}\n\ngenerate_preseed_cfg\n\nsudo virt-install \\\n--name $1 \\\n--ram 2096 \\\n--check all=off \\\n--disk path=/var/lib/libvirt/images/$1.qcow2,size=30,bus=virtio \\\n--vcpus 2 \\\n--os-type linux \\\n--os-variant ubuntu18.04 \\\n--network bridge=virbr0 \\\n--graphics none \\\n--console pty,target_type=serial \\\n--initrd-inject $PRESEED_FILE \\\n--location 'http://gb.archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/' \\\n--extra-args 'console=ttyS0,115200n8 serial'\n\ncleanup_preseed_cfg\n\n</code></pre> <p>Change rights to make file executable:</p> <pre><code>chmod 777 create-vm.sh\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#do_allsh-file","title":"do_all.sh file","text":"<p>This script will check VMs to create and if not available, will call VM template creation script and add necessary network entries.</p> <p>Create <code>do_all.sh</code> file copying the following lines:</p> <pre><code>#!/bin/bash\n\nsource serverlist.sh\n\nguesttowait=()\n\n# check if guest already exists\nvms=$(virsh list --all|tail -n +3|head -n -1|awk '{ print $2 }')\nfor vm in ${!newipdict[@]}\ndo\n    if [[ $vms =~ \"${vm}\" ]]\n    then\n        echo \"${vm} already exists ! We won't run guest creation for this value\"\n    else\n    echo \"Creating guest ${vm} this may take several minutes\"\n    guesttowait+=(\"${vm}\")\n    ./create-vm.sh ${vm} &amp;\n    fi;\ndone\n\nnbtowait=${#guesttowait[@]}\nif [ \"$nbtowait\" -eq 0 ]\nthen \n    echo \"All guests already created, nothing to do...\"\n    exit 0\nfi\n\nsleep 1\n\necho \"Adding domain name for cluster name resolving\"\nvirsh net-undefine default\nvirsh net-define default.xml\nvirsh start default\nvirsh net-autostart default\n\nconcserv=$( IFS=$'|'; echo \"${guesttowait[*]}\" )\nnb=$(virsh list --all | grep -E ${concserv} | grep \"shut off\"|wc -l)\n\nwhile [ \"$nb\" -ne \"$nbtowait\" ]\ndo\n   echo \"still waiting for ${guesttowait[*]} to create and shut off\"\n   sleep 10\n   # concserv=$( IFS=$'|'; echo \"${guesttowait[*]}\" )\n   nb=$(virsh list --all | grep -E ${concserv} | grep \"shut off\"|wc -l)\n   virsh list --all | grep -E concserv\ndone\n\nfor name in ${guesttowait[*]}\ndo\n    echo \"Fixing IP for $name\"\n    mac=$(virsh domiflist ${name}|head -n +3|tail -n +3|awk '{print $5}')\n    newip=${newipdict[$name]};\n\n    todelete=$(virsh net-dumpxml default | grep \"${name}\"| grep -o \"&lt;[^&gt;]*&gt;\")\n    if [[ ! -z $todelete ]]\n    then\n        echo \"deleting : ${todelete}\"\n        virsh net-update default delete ip-dhcp-host \"${todelete}\" --live --config\n    fi\n    echo \"creating : &lt;host mac='${mac}' name='${name}' ip='${newip}'/&gt;\"\n    virsh net-update default add ip-dhcp-host \"&lt;host mac='${mac}' name='${name}' ip='${newip}'/&gt;\" --live --config\n\n    echo \"restarting link\"\n    virsh domif-setlink ${name} ${mac} down\n    virsh domif-setlink ${name} ${mac} up\n\ndone\n\nvirsh net-dumpxml default\n</code></pre> <p>Change rights to make file executable:</p> <pre><code>chmod 777 do_all.sh\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#delete-vmsh-file","title":"delete-vm.sh file","text":"<p>This script will read server list and delete all matching VM names.</p> <p>Create <code>delete-vm.sh</code> file copying the following lines:</p> <pre><code>#!/bin/bash\n\nsource serverlist.sh\n\nvms=$(virsh list --all|tail -n +3|head -n -1|awk '{ print $2 }')\nfor vm in ${!newipdict[@]}\ndo\n    if [[ $vms =~ \"${vm}\" ]]\n    then\n        echo \"Deleting ${vm}\"\n        sudo virsh shutdown ${vm}\n        sudo virsh destroy ${vm}\n        sudo virsh undefine ${vm} --remove-all-storage\n        echo \"${vm} deleted\"\n    else\n    echo \"VM ${vm} not found. We do nothing\"\n    fi;\ndone\n\nvirsh list --all\n</code></pre> <p>Change rights to make file executable:</p> <pre><code>chmod 777 delete-vm.sh\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#run-cluster-creation","title":"Run cluster creation","text":"<p>Cluster creation will create the 6 necessary VMs. The process will be long (about 1 hour, depending off your network connection) as we will download a Ubuntu 18.04 and all necessary packages for kubernetes and abcdesktop.</p> <p>Run the following command and go for a coffee :</p> <pre><code>do_all.sh\n</code></pre> <p>During VMs creation, you will see the following message every 10 seconds :</p> <pre><code>still waiting for k8s-master  k8s-cp1  k8s-cp2 k8s-ws1 k8s-ws2 k8s-ws3 to create and shut off\n</code></pre> <p>Script will wait for all servers to be created and shut down before creating network connections</p> <p>Once everything has been done, you should see the following state for all VMs :</p> <pre><code>sudo virsh list --all\n</code></pre> <pre><code> Id   Name         State\n-----------------------------\n -    k8s-cp1      shut off\n -    k8s-cp2      shut off\n -    k8s-master   shut off\n -    k8s-ws1      shut off\n -    k8s-ws2      shut off\n -    k8s-ws3      shut off\n\n</code></pre> <p>All servers can now be started manually with the following commands or using virt-manager GUI :</p> <pre><code>virsh start k8s-master\nvirsh start k8s-cp1\nvirsh start k8s-cp2\nvirsh start k8s-vm1\nvirsh start k8s-vm2\nvirsh start k8s-vm3\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#kubernetes-cluster-creation","title":"Kubernetes cluster creation","text":"<p>At this state, you are ready to create kubernetes cluster. We will create HAproxy configuration and init master controle plane, additionnal control planes and workers.</p>"},{"location":"1.0/setup/kubernetesadvanced/#haproxy-server","title":"HAproxy server","text":"<p>HAproxy will be the entrypoint for kubernetes control planes and abcdesktop access.</p> <p>Connect k8s-master using ssh (default password is <code>password</code>):</p> <pre><code>ssh abcdesktop@192.168.122.11\n</code></pre> <p>Install haproxy package:</p> <pre><code>sudo apt install haproxy\n</code></pre> <p>Modify haproxy configuration:</p> <pre><code>sudo vi /etc/haproxy/haproxy.cfg\n</code></pre> <pre><code>global\n    log /dev/log    local0\n    log /dev/log    local1 notice\n    chroot /var/lib/haproxy\n    stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners\n    stats timeout 30s\n    user haproxy\n    group haproxy\n    daemon\n\n    # Default SSL material locations\n    ca-base /etc/ssl/certs\n    crt-base /etc/ssl/private\n\n    # Default ciphers to use on SSL-enabled listening sockets.\n    # For more information, see ciphers(1SSL). This list is from:\n    #  https://hynek.me/articles/hardening-your-web-servers-ssl-ciphers/\n    # An alternative list with additional directives can be obtained from\n    #  https://mozilla.github.io/server-side-tls/ssl-config-generator/?server=haproxy\n    ssl-default-bind-ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!aNULL:!MD5:!DSS\n    ssl-default-bind-options no-sslv3\n\ndefaults\n    log global\n    mode    tcp\n    option  tcplog\n    option  dontlognull\n        timeout connect 5000\n        timeout client  50000\n        timeout server  50000\n    errorfile 400 /etc/haproxy/errors/400.http\n    errorfile 403 /etc/haproxy/errors/403.http\n    errorfile 408 /etc/haproxy/errors/408.http\n    errorfile 500 /etc/haproxy/errors/500.http\n    errorfile 502 /etc/haproxy/errors/502.http\n    errorfile 503 /etc/haproxy/errors/503.http\n    errorfile 504 /etc/haproxy/errors/504.http\n\nfrontend api-front\n    bind 192.168.122.11:8443\n    bind 127.0.0.1:8443\n    mode tcp\n    option tcplog\n    use_backend api-backend\n\nbackend api-backend\n    mode tcp\n    option tcplog\n    option tcp-check\n    balance roundrobin\n    # balance source\n    server master1  192.168.122.11:6443 check\n    server master2  192.168.122.12:6443 check\n    server master3  192.168.122.13:6443 check\n\nfrontend api-front2\n    bind 192.168.122.11:1234\n    bind 127.0.0.1:1234\n    mode tcp\n    option tcplog\n    use_backend api-backend2\n\nbackend api-backend2\n    mode tcp\n    option tcplog\n    option tcp-check\n\n    # option httpcheck\n    balance roundrobin\n    # balance source\n    default-server inter 3s fall 3 rise 2\n    server ws1  192.168.122.14:30443 check\n    server ws2  192.168.122.15:30443 check\n    server ws3  192.168.122.16:30443 check\n</code></pre> <p>Control planes will communicate over 192.168.122.11:8443 entrypoint abcdesktop will be available connecting 192.168.122.11:1234 address</p> <p>Restart haproxy service to apply configuration</p> <pre><code>sudo systemctl restart haproxy.service\n</code></pre> <p>Enable haproxy service:</p> <pre><code>sudo systemctl enable haproxy.service\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#init-master-controle-plane","title":"Init master controle plane","text":"<p>Create kubeadm config file :</p> <pre><code>vi ./kubeadm-config.yaml\n</code></pre> <pre><code>apiVersion: kubeadm.k8s.io/v1beta1\nkind: ClusterConfiguration\nkubernetesVersion: stable\napiServer:\n  certSANs:\n  - \"192.168.122.11\"\ncontrolPlaneEndpoint: \"192.168.122.11:8443\"\nnetworking:\n   podSubnet: \"10.244.0.0/16\"\n</code></pre> <p>Launch kubeadm init configuration</p> <pre><code>sudo kubeadm init --config=kubeadm-config.yaml --upload-certs\n</code></pre> <p>Last messages of the command are the important parts, copy them in a file :</p> <pre><code>Your Kubernetes control-plane has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nYou should now deploy a pod network to the cluster.\nRun \"kubectl apply -f [podnetwork].yaml\" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nYou can now join any number of the control-plane node running the following command on each as root:\n\n  kubeadm join 192.168.122.11:8443 --token b6e1s0.e1h4r8h6byavke8z \\\n    --discovery-token-ca-cert-hash sha256:54b72a18e02641f5b38bb48b436814530333b0ab16f6c1d72408abb547a49ca9 \\\n    --control-plane --certificate-key a71a13880fd492e32436df72d5a872f05205748a697f6c63f0d2a9d6c66eaf76\n\nPlease note that the certificate-key gives access to cluster sensitive data, keep it secret!\nAs a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use\n\"kubeadm init phase upload-certs --upload-certs\" to reload certs afterward.\n\nThen you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join 192.168.122.11:8443 --token b6e1s0.e1h4r8h6byavke8z \\\n    --discovery-token-ca-cert-hash sha256:54b72a18e02641f5b38bb48b436814530333b0ab16f6c1d72408abb547a49ca9 \n\n</code></pre> <p>First execute the following part of the message :</p> <pre><code>  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre> <p>Now connect using ssh to all cotrol planes (k8s-cp1 and k8s-cp2) and execute the following command to let additionnal control planes to join cluster (Copy/Past command from master init messages) :</p> <pre><code>sudo  kubeadm join 192.168.122.11:8443 --token b6e1s0.e1h4r8h6byavke8z \\\n    --discovery-token-ca-cert-hash sha256:54b72a18e02641f5b38bb48b436814530333b0ab16f6c1d72408abb547a49ca9 \\\n    --control-plane --certificate-key a71a13880fd492e32436df72d5a872f05205748a697f6c63f0d2a9d6c66eaf76\n</code></pre> <p>Now connect using ssh to all workers (k8s-ws1, k8s-ws2 and k8s-ws3) and execute the following command (Copy/Past command from master init messages):</p> <pre><code>sudo kubeadm join 192.168.122.11:8443 --token b6e1s0.e1h4r8h6byavke8z \\\n    --discovery-token-ca-cert-hash sha256:54b72a18e02641f5b38bb48b436814530333b0ab16f6c1d72408abb547a49ca9 \n</code></pre> <p>At this state, all nodes should be to \"NotReady\" state.</p> <pre><code>abcdesktop@k8s-master:~$ kubectl get nodes\nNAME         STATUS     ROLES    AGE    VERSION\nk8s-cp1      NotReady      master   56m    v1.17.0\nk8s-cp2      NotReady      master   58m    v1.17.0\nk8s-master   NotReady      master   59m    v1.17.0\nk8s-ws1      NotReady      &lt;none&gt;   7m2s   v1.17.0\nk8s-ws2      NotReady      &lt;none&gt;   89s    v1.17.0\nk8s-ws3      NotReady   &lt;none&gt;   39s    v1.17.0\n</code></pre> <p>Kubernetes need cni definition to become \"Ready\". We will use flannel for this:</p> <pre><code>kubectl apply -f https://github.com/coreos/flannel/raw/master/Documentation/kube-flannel.yml\n</code></pre> <p>Now, all nodes should be \"Ready\"</p> <pre><code>abcdesktop@k8s-master:~$ kubectl get nodes\nNAME         STATUS     ROLES    AGE    VERSION\nk8s-cp1      Ready      master   56m    v1.17.0\nk8s-cp2      Ready      master   58m    v1.17.0\nk8s-master   Ready      master   59m    v1.17.0\nk8s-ws1      Ready      &lt;none&gt;   7m2s   v1.17.0\nk8s-ws2      Ready      &lt;none&gt;   89s    v1.17.0\nk8s-ws3      Ready   &lt;none&gt;   39s    v1.17.0\n</code></pre>"},{"location":"1.0/setup/kubernetesadvanced/#install-abcdesktop","title":"Install abcdesktop","text":"<p>First we create opendeksotp namespace:</p> <pre><code>sudo kubectl create namespace abcdesktop\n</code></pre> <p>Change default namespace to abcdesktop:</p> <pre><code>kubectl config set-context $(kubectl config current-context) --namespace=abcdesktop\n</code></pre> <p>Create abcdesktop secrets:</p> <pre><code># build rsa kay pairs for jwt payload \n# 256 bits is a small value, change here if need\n# rm abcdesktop_jwt_desktop_payload_private_key.pem _abcdesktop_jwt_desktop_payload_public_key.pem abcdesktop_jwt_desktop_payload_public_key.pem\n# rm abcdesktop_jwt_desktop_signing_private_key.pem abcdesktop_jwt_desktop_signing_public_key.pem\n\nopenssl genrsa  -out abcdesktop_jwt_desktop_payload_private_key.pem 512\nopenssl rsa     -in  abcdesktop_jwt_desktop_payload_private_key.pem -outform PEM -pubout -out  _abcdesktop_jwt_desktop_payload_public_key.pem\nopenssl rsa -pubin -in _abcdesktop_jwt_desktop_payload_public_key.pem -RSAPublicKey_out -out abcdesktop_jwt_desktop_payload_public_key.pem\n\n# build rsa kay pairs for jwt signing \nopenssl genrsa -out abcdesktop_jwt_desktop_signing_private_key.pem 1024\nopenssl rsa     -in abcdesktop_jwt_desktop_signing_private_key.pem -outform PEM -pubout -out abcdesktop_jwt_desktop_signing_public_key.pem\n\n# kubectl delete secrets abcdesktopjwtdesktoppayload abcdesktopjwtdesktopsigning -n abcdesktop\nkubectl create secret generic abcdesktopjwtdesktoppayload --from-file=abcdesktop_jwt_desktop_payload_private_key.pem --from-file=abcdesktop_jwt_desktop_payload_public_key.pem --namespace=abcdesktop\nkubectl create secret generic abcdesktopjwtdesktopsigning --from-file=abcdesktop_jwt_desktop_signing_private_key.pem --from-file=abcdesktop_jwt_desktop_signing_public_key.pem --namespace=abcdesktop\n</code></pre> <p>At this step it is recommended to pull necessary docker images on each workers. Kubernetes will attemp to pull them, but you will have no monitoring of pull advance. As abcdesktop images are quite heavy, this would result in various errors when trying to access abcdesktop before the end. Minimal image list can be found at top of this link : kubernetes </p> <p>abcdesktop deployment will be done with the following command :</p> <pre><code>kubectl create -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop.yaml\n</code></pre> <pre><code>abcdesktop@k8s-master:~$ kubectl create -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop.yaml\nclusterrole.rbac.authorization.k8s.io/pyos-role created\nclusterrolebinding.rbac.authorization.k8s.io/pyos-rbac created\nserviceaccount/pyos-serviceaccount created\nstorageclass.storage.k8s.io/storage-local-abcdesktop created\npersistentvolume/pv-volume-home-directory created\npersistentvolumeclaim/persistentvolumeclaim-home-directory created\nconfigmap/abcdesktop-config created\nconfigmap/nginx-config created\ndeployment.apps/memcached-od created\ndeployment.apps/mongodb-od created\ndaemonset.apps/daemonset-nginx created\ndeployment.apps/speedtest-od created\ndaemonset.apps/daemonset-pyos created\nservice/memcached created\nservice/mongodb created\nservice/speedtest created\nservice/nginx created\nservice/pyos created\n</code></pre> <p>abcdesktop.yaml can be downloaded manually here : https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop.yaml</p> <p>abcdesktop deployment can be verified with the following command :</p> <pre><code>abcdesktop@k8s-master:~$ kubectl get pods\nNAME                            READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-4ql2g           1/1     Running   0          34m\ndaemonset-nginx-7zxdc           1/1     Running   0          34m\ndaemonset-nginx-s8wmk           1/1     Running   0          34m\ndaemonset-pyos-97qmt            1/1     Running   0          34m\ndaemonset-pyos-k496h            1/1     Running   0          34m\ndaemonset-pyos-wngpg            1/1     Running   0          34m\nmemcached-od-db69c45fb-hbzld    1/1     Running   0          34m\nmongodb-od-86bbf5c655-xjldj     1/1     Running   0          34m\nspeedtest-od-6567f8b4c4-tfqsl   1/1     Running   0          34m\n\n</code></pre> <p>If everything is at \"Running\" status, you can then start testing</p>"},{"location":"1.0/setup/kubernetesadvanced/#test-abcdesktop","title":"Test abcdesktop","text":"<p>Simply connect to the following address with your web browser :</p> <pre><code>http://192.168.122.11:1234\n</code></pre>"},{"location":"1.0/setup/kubernetesmode/","title":"Setup kubernetes for GNU/Linux","text":"<p>This section apply only to configure kubernetes for GNU/Linu. The Docker setup process for MacOS/X and for Microsoft Windows is ready to use by cheching the kubernetes options.</p> <p>abcdesktop.io support docker mode and kubernetes mode. In this section we will study how abcdesktop.io is working in kubernetes mode. The abcdesktop.io kubernetes mode is recommended for enterprise use, all user containers can be distributed on different hosts.</p>"},{"location":"1.0/setup/kubernetesmode/#requirements","title":"Requirements","text":"<p>Linux Requierements</p>"},{"location":"1.0/setup/kubernetesmode/#installation","title":"Installation","text":"<p>The following commands will let you prepare kubernetes on one node. In this case, all applications run on a single node. To deploy a abcdesktopio on multi nodes read the next section. It's recommended to start with a single node.</p>"},{"location":"1.0/setup/kubernetesmode/#initialize-kubernetes-master-node","title":"Initialize Kubernetes Master Node","text":""},{"location":"1.0/setup/kubernetesmode/#step-1-disable-swap-memory-if-running","title":"Step 1: Disable swap memory (if running)","text":"<p>You need to disable swap memory on nodes as Kubernetes does not perform properly on a system that is using swap memory. Run the following command in order to disable swap memory.  </p> <pre><code>swapoff -a\n</code></pre> <p>If you have some swaps in /etc/fstab, just comment them out. <code>swapoff -a</code> will disable all swaps temporarily.</p> <ul> <li>disable by masking it with sysctl:</li> </ul> <pre><code>systemctl mask dev-zram1.swap\n\nCreated symlink /etc/systemd/system/dev-zram1.swap \u2192 /dev/null.\n</code></pre>"},{"location":"1.0/setup/kubernetesmode/#step-2-initialize-kubernetes","title":"Step 2: Initialize Kubernetes","text":"<p>Run the following command as sudo on the master node:</p> <pre><code>kubeadm init --pod-network-cidr=10.244.0.0/16\n</code></pre> <p>The process might take a minute or more depending on your internet connection.  </p> <p>To be able to manage your kubernetes server, you need to run the following commands as a regular user:</p> <pre><code>mkdir -p $HOME/.kube\ncp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nchown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre>"},{"location":"1.0/setup/kubernetesmode/#step-3-remove-master-node-taint","title":"Step 3: Remove Master Node Taint","text":"<p>Taints are Kubernetes flags to prevent Pod Scheduling. Remove the taints on the master so that you can schedule pods on it.</p> <pre><code>kubectl taint node `hostname` node-role.kubernetes.io/master-\n</code></pre> <p>It should return the following string.</p> <pre><code>node/&lt;your-hostname&gt; untainted\n</code></pre> <p>Taints are Kubernetes flags to prevent Pod Scheduling.</p> <p>Confirm that you now have a node in your cluster with the following command.</p> <pre><code>kubectl get nodes -o wide\n</code></pre> <p>It should return something like the following.</p> <pre><code>NAME              STATUS      ROLES    AGE   VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\n&lt;your-hostname&gt;   NotReady    master   2m    v1.19.3   192.168.8.2   &lt;none&gt;        Ubuntu 20.04.1 LTS   5.4.0-52-generic   docker://19.3.13\n</code></pre>"},{"location":"1.0/setup/kubernetesmode/#step-4-deploy-a-pod-network-through-the-master-node","title":"Step 4: Deploy a Pod Network through the master node","text":"<p>A pod network is a medium of communication between the nodes of a network. We are deploying a Flannel pod network on our cluster through the following command:</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n</code></pre> <p>It should return the following strings.</p> <pre><code>podsecuritypolicy.policy/psp.flannel.unprivileged created\nclusterrole.rbac.authorization.k8s.io/flannel created\nclusterrolebinding.rbac.authorization.k8s.io/flannel created\nserviceaccount/flannel created\nconfigmap/kube-flannel-cfg created\ndaemonset.apps/kube-flannel-ds created\n</code></pre>"},{"location":"1.0/setup/kubernetesmode/#check-node-status","title":"Check node status","text":"<p>Now when you see the status of the nodes, you will see that the master-node is ready :</p> <pre><code>kubectl get nodes -o wide\n</code></pre> <pre><code>NAME             STATUS   ROLES    AGE   VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION     CONTAINER-RUNTIME\n&lt;your-hostname&gt;  Ready    master   5m    v1.19.3   192.168.8.2   &lt;none&gt;        Ubuntu 20.04.1 LTS   5.4.0-52-generic   docker://19.3.13\n</code></pre> <p>At this step, there is no more <code>Taints</code> and your node is <code>Ready</code>. </p> <p>Next step, continue with the setup abcdesktop for kubernetes.</p>"},{"location":"1.0/setup/novnc/","title":"Use noVNC as VNC Client","text":""},{"location":"1.0/setup/novnc/#requirements","title":"Requirements","text":"<ul> <li>A running dockerd last version</li> <li>An access to the docker public registry</li> <li>An access to the ubuntu repository </li> <li>An access to the github website to run git clone command</li> <li>An access to the bintray.com website to download a file</li> </ul> <p>AbcDeskopio use the amazing projet noVNC. noVNC is a VNC client JavaScript library. Before you start using noVNC get some information about it:</p>"},{"location":"1.0/setup/novnc/#novnc-description","title":"noVNC description","text":"<p>noVNC is an open source VNC client.  noVNC is both a VNC client JavaScript library as well as an application built on top of that library. noVNC runs well in any modern browser including mobile browsers (iOS and Android). Many companies, projects and products have integrated noVNC including OpenStack, OpenNebula, LibVNCServer, and ThinLinc. See the Projects and Companies wiki page for a more complete list with additional info and links.</p>"},{"location":"1.0/setup/novnc/#browser-requirements","title":"Browser Requirements","text":"<p>noVNC uses many modern web technologies so a formal requirement list is not available. However these are the minimum versions we are currently aware of:</p> <ul> <li>Chrome 49, Firefox 44, Safari 11, Opera 36, IE 11, Edge 12</li> </ul>"},{"location":"1.0/setup/novnc/#features","title":"Features","text":"<ul> <li>Supports all modern browsers including mobile (iOS, Android)</li> <li>Supported VNC encodings: raw, copyrect, rre, hextile, tight, tightPNG</li> <li>Supports scaling, clipping and resizing the desktop</li> <li>Local cursor rendering</li> <li>Clipboard copy/paste</li> <li>Translations</li> <li>Licensed mainly under the MPL 2.0, see   the license document for details</li> </ul>"},{"location":"1.0/setup/novnc/#create-a-shared-volume-myshared","title":"Create a shared volume myshared","text":"<p>Before creating containers, we need a shared volume, to share data and unix socket between containers. Run the docker volume create command.</p> <pre><code>docker volume create myshared \n</code></pre>"},{"location":"1.0/setup/novnc/#start-the-first-container-myx11server","title":"Start the first container myx11server","text":"<p>Start the first graphical container named myx11server and forward the tcp port 6081 to the 6081 container tcp port.</p> <ul> <li>The tcp port 6081 will be use later by ws2tcp nodejs server.</li> <li>The volume myshared is mounted to /tmp</li> </ul> <p>Note: We do not need the default 5900 VNC tcp port any more.</p> <pre><code>docker run -it -v myshared:/tmp --name myx11server -p 6081:6081 ubuntu:latest bash\n\n</code></pre> <p>You should see a prompt like :</p> <pre><code>root@6de36e574877:/#\n</code></pre> <p>Install the package wget  Install the library files for tigervnc. </p> <p>Package list:</p> <ul> <li>libx11-6 xkb-data x11-xkb-utils xauth libfile-readbackwards-perl netbase libaudit1 libbsd0 libgcrypt20 libgl1 libgnutls30 libjpeg8 libpam0g libpixman-1-0 libselinux1 libstdc++6 libsystemd0 libunwind8 libxau6 libxdmcp6 libxfont2 zlib1g libgl1-mesa-dri xfonts-base x11-xserver-utils xfonts-100dpi xfonts-scalable </li> </ul> <p>Those packages are used by tigervnc. We need to install them.</p> <pre><code>apt-get update\napt-get install -y wget\napt-get install -y libx11-6 xkb-data x11-xkb-utils xauth libfile-readbackwards-perl netbase libaudit1 libbsd0 libgcrypt20 libgl1 libgnutls30 libjpeg8 libpam0g libpixman-1-0 libselinux1 libstdc++6 libsystemd0 libunwind8 libxau6 libxdmcp6 libxfont2 zlib1g libgl1-mesa-dri xfonts-base x11-xserver-utils xfonts-100dpi xfonts-scalable \n</code></pre> <p>Download the last tigervnc X11 graphics server from the bintray.com web site</p> <pre><code> wget \"https://bintray.com/tigervnc/stable/download_file?file_path=tigervnc-1.10.1.x86_64.tar.gz\" -O tigervnc-1.10.1.x86_64.tar.gz\n</code></pre> <p>Untar the tigervnc-1.10.1.x86_64.tar.gz file in the container's root file system </p> <pre><code>cd /\ntar -xvf tigervnc-1.10.1.x86_64.tar.gz\ncp -r /tigervnc-1.10.1.x86_64/usr/* /usr/\n</code></pre> <p>Start the tigervnc release 1.10. The tigervnc release 1.10 support the option rfbunixpath used by ws-tcp-bridge in next section</p> <pre><code>Xvnc :0 -rfbunixpath /tmp/.x11vnc -SecurityTypes=none &amp;\n</code></pre> <p>You should read the output </p> <pre><code>Xvnc TigerVNC 1.10.0 - built Dec 20 2019 07:12:07\nCopyright (C) 1999-2019 TigerVNC Team and many others (see README.rst)\nSee https://www.tigervnc.org for information on TigerVNC.\nUnderlying X server release 12001000, The X.Org Foundation\n\n\nTue Mar  3 11:05:48 2020\n vncext:      VNC extension running!\n vncext:      Listening for VNC connections on /tmp/.x11vnc (mode 0600)\n vncext:      created VNC server for screen 0\n</code></pre> <p>Check that the Xvnc TigerVNC release is 1.10.0. </p> <p>Great, you have installed an X11 server inside a docker container, and the Xvnc server is listening for VNC connections on /tmp/.x11vnc. </p>"},{"location":"1.0/setup/novnc/#install-the-ws-tcp-bridge","title":"Install the ws-tcp-bridge","text":"<p>ws-tcp-bridge translate websocket to tcp and have to listen on websocket tcp port 6081 and forward to local unix socket unix:/tmp/.x11vnc.</p> <p>ws-tcp-bridge is a nodejs server, then we need to install nodejs and npm.</p> <p>Before, install the package gcc g++ make curl </p> <pre><code>apt-get install -y gcc g++ make curl \n</code></pre> <p>Install nodejs and npm</p> <pre><code>curl -sL https://deb.nodesource.com/setup_13.x | bash -\n</code></pre> <pre><code>apt-get install -y nodejs\n</code></pre> <p>Install ws-tcp-bridge</p> <pre><code>npm install ws-tcp-bridge -g\n</code></pre> <p>Start ws-tcp-bridge with the parameters --method=ws2tcp --lport 6081 --rhost=unix:/tmp/.x11vnc in background </p>  <p>Add the <code>&amp;</code> at the end of the command line to run this process in background</p>  <pre><code>/usr/bin/ws-tcp-bridge --method=ws2tcp --lport 6081 --rhost=unix:/tmp/.x11vnc &amp;\n</code></pre> <p>You should read on the standard output</p> <pre><code>proxy mode ws -&gt; tcp\nforwarding port 6081 to unix:/tmp/.x11vnc\n</code></pre> <p>Great, ws-tcp-bridge is running and forward websocket to Xvnc unix socket </p>"},{"location":"1.0/setup/novnc/#get-the-ip-address-on-your-first-container-myx11server","title":"Get the ip address on your first container myx11server","text":"<p>On the container myx11server, to get the container local IP Address, install the package net-tools package</p> <pre><code>apt-get install -y net-tools\n</code></pre> <p>And run the ifconfig command </p> <pre><code>ifconfig eth0\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 172.17.0.2 netmask 255.255.0.0  broadcast 172.17.255.255\n        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)\n        RX packets 65149  bytes 95569807 (95.5 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 20880  bytes 1159982 (1.1 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>Write here the ip address of your container myx11server:</p> <p>IP Address of myx11server _ .  . _ . </p>"},{"location":"1.0/setup/novnc/#create-a-new-container-webserver","title":"Create a new container webserver","text":"<p>Open a new shell window and start a new docker container named mywebserver, forward the tcp port 80 to the container tcp port 80.</p> <pre><code>docker run -it --name mywebserver -p 80:80 ubuntu:latest\n</code></pre> <p>You should see a prompt like:</p> <pre><code>root@96df62a73e4f:/# \n</code></pre> <p>Install nginx webserver, run the command</p> <pre><code>apt-get update\napt-get install -y nginx-extras\n</code></pre> <p>Install the git and vim package, run the command</p> <pre><code>apt-get install -y git vim\n</code></pre> <p>Clone the novnc git on github.com, inside the nginx's root directory.</p> <pre><code>cd /var/www/html\ngit clone https://github.com/novnc/noVNC.git\n</code></pre> <p>You should read on the standart output </p> <pre><code>Cloning into 'noVNC'...\nremote: Enumerating objects: 26, done.\nremote: Counting objects: 100% (26/26), done.\nremote: Compressing objects: 100% (21/21), done.\nremote: Total 10395 (delta 8), reused 13 (delta 5), pack-reused 10369\nReceiving objects: 100% (10395/10395), 9.01 MiB | 7.15 MiB/s, done.\nResolving deltas: 100% (7310/7310), done.\n</code></pre> <p>Start the nginx web server</p> <pre><code>nginx\n</code></pre> <p>The web server nginx is running in backgound. </p> <p>Great, nginx web server is running, now we need to configure the proxy pass rule with the myx11server container's ip address.</p>"},{"location":"1.0/setup/novnc/#check-that-the-container-webserver-can-ping-the-container-myx11server","title":"Check that the container webserver can ping the container myx11server","text":"<p>Install the ping command, run the command</p> <pre><code>apt-get install -y iputils-ping\n</code></pre> <p>Get the myx11server container's ip address write before and replace  xxx.xxx.xxx.xxx with the myx11server container's ip address</p> <pre><code>ping -c 5 xxx.xxx.xxx.xxx\n</code></pre> <p>In this example, i replace xxx.xxx.xxx.xxx by 172.17.0.2</p> <pre><code>ping -c 5 172.17.0.2\nPING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.\n64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.108 ms\n64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.365 ms\n64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.206 ms\n64 bytes from 172.17.0.2: icmp_seq=4 ttl=64 time=0.181 ms\n64 bytes from 172.17.0.2: icmp_seq=5 ttl=64 time=0.206 ms\n\n--- 172.17.0.2 ping statistics ---\n5 packets transmitted, 5 received, 0% packet loss, time 4074ms\nrtt min/avg/max/mdev = 0.108/0.213/0.365/0.084 ms\n</code></pre> <p>The container webserver should receive package from the myx11server container</p>"},{"location":"1.0/setup/novnc/#edit-the-nginx-configuration-file","title":"Edit the nginx configuration file","text":"<p>Edit the nginx configuration file /etc/nginx/sites-enabled/default with the vim editor.</p> <pre><code>vim /etc/nginx/sites-enabled/default\n</code></pre> <p>In the server section, after the line location you should found :</p> <pre><code>    location / {\n        # First attempt to serve request as file, then\n        # as directory, then fall back to displaying a 404.\n        try_files $uri $uri/ =404;\n    }\n</code></pre> <p>Add a /websockify route to proxyfied the websocket http request to your myx11server container. </p> <pre><code>    location = /websockify {\n        proxy_buffering              off;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Upgrade         $http_upgrade;\n        proxy_set_header Connection      \"upgrade\";\n        proxy_pass                       http://XXX.XXX.XXX.XXX:6081/;\n    }\n</code></pre> <p>You have to replace the line  </p> <pre><code>proxy_pass       http://XXX.XXX.XXX.XXX:6081/;\n</code></pre> <p>by the ip address of your myx11server container, for example replace http://XXX.XXX.XXX.XXX:6081/ with http://172.17.0.2:6081/ </p> <pre><code>proxy_pass       http://172.17.0.2:6081/;\n</code></pre> <p>The complete server section in the nginx file is for example</p> <pre><code>server {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n\n    # SSL configuration\n    #\n    # listen 443 ssl default_server;\n    # listen [::]:443 ssl default_server;\n    #\n    # Note: You should disable gzip for SSL traffic.\n    # See: https://bugs.debian.org/773332\n    #\n    # Read up on ssl_ciphers to ensure a secure configuration.\n    # See: https://bugs.debian.org/765782\n    #\n    # Self signed certs generated by the ssl-cert package\n    # Don't use them in a production server!\n    #\n    # include snippets/snakeoil.conf;\n\n    root /var/www/html;\n\n    # Add index.php to the list if you are using PHP\n    index index.html index.htm index.nginx-debian.html;\n\n    server_name _;\n\n    location / {\n        # First attempt to serve request as file, then\n        # as directory, then fall back to displaying a 404.\n        try_files $uri $uri/ =404;\n    }\n\n    location = /websockify {\n        proxy_buffering              off;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Upgrade         $http_upgrade;\n        proxy_set_header Connection      \"upgrade\";\n        proxy_pass           http://172.17.0.2:6081/; # change this line \n    }\n\n\n    # pass PHP scripts to FastCGI server\n    #\n    #location ~ \\.php$ {\n    #   include snippets/fastcgi-php.conf;\n    #\n    #   # With php-fpm (or other unix sockets):\n    #   fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;\n    #   # With php-cgi (or other tcp sockets):\n    #   fastcgi_pass 127.0.0.1:9000;\n    #}\n\n    # deny access to .htaccess files, if Apache's document root\n    # concurs with nginx's one\n    #\n    #location ~ /\\.ht {\n    #   deny all;\n    #}\n}\n</code></pre> <p>Now, it's time to reload your nginx configuration, by running the command</p> <pre><code>nginx -s reload\n</code></pre>"},{"location":"1.0/setup/novnc/#connect-to-your-nginx-website","title":"Connect to your nginx website","text":"<p>Run a web browser like Google Chrome or Firefox and go to your nginx website. If you run the nginx website on a separated host replace the name with your hostname or his ip address.</p> <p>Go to the URL http://localhost or the ip address of your own server</p>  <p>In this exercice in use <code>localhost</code> in the screenshot because all containers are running on my desktop, you may have to replace localhost by ip address, or the <code>fully qualified domain name</code> of your own server.</p>  <pre><code>http://localhost\n</code></pre> <p>or</p> <pre><code>http://YOUR_SERVER_IP_ADDRESS\n</code></pre> <p>You should read the Welcome to nginx! message in your web browser</p>  <p>Go to the noVNC URL http://localhost/noVNC/vnc.html</p> <pre><code>http://localhost/noVNC/vnc.html\n</code></pre>  <p>Remember, remplace localhost by your <code>fully qualified domain name</code> if need</p>  <p>You should read the Welcome to nginx! message in your web browser</p>  <p>To change the connection settings, click on the settings icon and choose Advanced  You have to fill the WebSocket properties as follow:</p> <ul> <li>The Encrypt is <code>not checked</code></li> <li>Set the Host as <code>localhost</code> (or your host ip address where your contianers are running )</li> <li>Set the Port to <code>80</code></li> <li>Set the Path to <code>/websockify</code></li> </ul>  <p>Then, press the <code>Connect</code> Button</p>"},{"location":"1.0/setup/novnc/#install-libreoffice-as-a-docker-application","title":"Install libreoffice as a docker application","text":"<p>On your host, where your container myx11server is running. Open a new shell window and start a new docker container named mylibreoffice.</p> <pre><code>docker run -it -v myshared:/tmp --name mylibreoffice ubuntu:latest\n</code></pre> <p>You should see a prompt like :</p> <pre><code>root@96df62a73e4f:/# \n</code></pre> <p>To install libreoffice application, run the install libreoffice command in your mylibreoffice container.</p> <pre><code>apt-get update\napt-get install -y libreoffice\n</code></pre> <p>Run the soffice command to start Libreoffice</p> <pre><code>export DISPLAY=:0.0\nsoffice --writer\n</code></pre> <p>You should read the output </p> <pre><code>(soffice:7412): dbind-WARNING **: 16:32:03.928: Couldn't connect to accessibility bus: Failed to connect to socket /tmp/dbus-HN3KrNpoAq: Connection refused\n</code></pre> <p>On the web browser, the application <code>Libreoffice Writer</code> should appear. </p>  <p>Type some text data like 'Hello, I am running inside a docker container'</p>"},{"location":"1.0/setup/novnc/#install-the-windows-manager-openbox-on-your-myx11server-container","title":"Install the windows manager openbox on your myx11server container","text":"<p>To move, resize, close, the windows applications, we need a windows manager. <code>abcdesktop</code> is the windows manager. OpenBox is a lightweight, powerful, and highly configurable stacking window manager with extensive standards support. </p> <p>Run the install openbox command in your myx11server container.</p> <pre><code>apt-get install -y openbox\n</code></pre> <p>Set the DISPLAY environment variable to :0.0 and start openbox in background</p> <pre><code>export DISPLAY=:0.0\nopenbox &amp;\n</code></pre>  <p>Now, you can move the <code>Libreoffice</code> windows. All windows are decorated. </p> <p>Great you have installed the novnc gateway, and you just need a HTML Web browser to use a <code>Libreoffice</code> </p>"},{"location":"1.0/setup/retrieve_all_images/","title":"Get all applications for abcdesktop","text":"<p>Lot of application are ready to use for abcdesktop. All applications are opensource.</p> <p>You can download the image list from the applist file, or run the command the pull command where $APP is the name of your application.</p> <pre><code>docker pull abcdesktopio/$APP.d\n</code></pre> <p>for example to download libreoffice calc, run the command</p> <pre><code>docker pull abcdesktopio/calc.d\n</code></pre> <p>Read the list of all applications on the application list page</p>"},{"location":"1.0/setup/secure_dockerd/","title":"Secure your dockerd to run in production with kubernetes and abcdesktop.io","text":""},{"location":"1.0/setup/secure_dockerd/#goals","title":"Goals","text":"<p>Protect your docker daemon socket. </p>"},{"location":"1.0/setup/secure_dockerd/#requirements","title":"Requirements","text":"<p>You need to have a running abcdesktop.io Kubernetes cluster, and the kubectl command-line tool must be configured to communicate with your cluster. If you do not already have a cluster, you can create one by reading Kubernetes Setup.</p> <p>You need a previous installation of abcdesktop</p>"},{"location":"1.0/setup/secure_dockerd/#installation","title":"Installation","text":"<p>The following commands will let you update abcdesktop plateform on the master node. All applications run on a single server.  </p>"},{"location":"1.0/setup/secure_dockerd/#enable-tls-at-the-dockerd-start-up","title":"Enable TLS at the dockerd start-up","text":"<p>THIS SECTION AS TO BE WRITTEN</p>"},{"location":"1.0/setup/secure_dockerd/#locate-the-kubernetes-ca-root-and-the-x-509-certificats","title":"Locate the kubernetes CA Root and the X-509 certificats","text":"<pre><code>/var/lib/kubelet/pki\n</code></pre>"},{"location":"1.0/setup/secure_dockerd/#custom-docker-daemon-options","title":"Custom Docker daemon options","text":"<p>There are a number of ways to configure the daemon flags and environment variables for your Docker daemon. The recommended way is to use a systemd drop-in file (as described in the systemd.unit documentation). These are local files named .conf in the /etc/systemd/system/docker.service.d directory.  On ubuntu 18.04 use the filename /etc/systemd/system/multi-user.target.wants/docker.service. <p>Edit this file and change the ExecStart line </p> <pre><code>ExecStart=/usr/bin/dockerd -H unix://\n</code></pre> <p>Add the TLS option string </p> <pre><code>ExecStart=/usr/bin/dockerd --tlsverify --tlscacert=/etc/docker/ssl/ca.pem --tlscert=/etc/docker/ssl/$HOSTNAME.cert.pem --tlskey=/etc/docker/ssl/$HOSTNAME.pem -H=0.0.0.0:2376 -H unix://\n</code></pre> <p>Example</p> <pre><code>[Unit]\nDescription=Docker Application Container Engine\nDocumentation=https://docs.docker.com\nAfter=network.target docker.socket firewalld.service\nRequires=docker.socket\n\n[Service]\nType=notify\n# the default is not to use systemd for cgroups because the delegate issues still\n# exists and systemd currently does not support the cgroup feature set required\n# for containers run by docker\n# ExecStart=/usr/bin/dockerd -H unix://\nExecReload=/bin/kill -s HUP $MAINPID\nExecStart=/usr/bin/dockerd --tlsverify --tlscacert=/etc/docker/ssl/ca.pem --tlscert=/etc/docker/ssl/host.domain.local.cert.pem --tlskey=/etc/docker/ssl/host.domain.local.pem -H=0.0.0.0:2376 -H unix://\n\nLimitNOFILE=1048576\n# Having non-zero Limit*s causes performance problems due to accounting overhead\n# in the kernel. We recommend using cgroups to do container-local accounting.\nLimitNPROC=infinity\nLimitCORE=infinity\n# Uncomment TasksMax if your systemd version supports it.\n# Only systemd 226 and above support this version.\nTasksMax=infinity\nTimeoutStartSec=0\n# set delegate yes so that systemd does not reset the cgroups of docker containers\nDelegate=yes\n# kill only the docker process, not all processes in the cgroup\nKillMode=process\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>"},{"location":"1.0/setup/secure_dockerd/#apply-changes","title":"Apply changes","text":"<p>Flush changes</p> <pre><code>sudo systemctl daemon-reload\n</code></pre> <p>Restart Docker daemon:</p> <pre><code>systemctl restart docker\n</code></pre>"},{"location":"1.0/setup/secure_dockerd/#check-your-dockerd","title":"Check your dockerd","text":"<p>Check that your dockerd is listenning on TCP port 2376</p> <pre><code># netstat -anp |grep 2376\ntcp6       0      0 :::2376                 :::*                    LISTEN      27553/dockerd\n</code></pre>"},{"location":"1.0/setup/secure_dockerd/#connect-your-local-abcdesktop","title":"Connect your local abcdesktop","text":"<p>Open your navigator to http://[your-ip-hostname]:30443/</p> <p>You can get your ip hostname by running</p> <pre><code>ifconfig\n</code></pre> <p>abcdesktop homepage should be available :</p>  <p>Click on the Connect with Anonymous access button. Pyos is creating a new desktop using the user container docker image oc.user.18.04.</p> <p>Few seconds later, processes are ready to run. You should see the abcdesktop main screen, with only one application File Manager.</p>  <p>Great you have installed abcdesktop.io in Kubernetes mode. You just need a web browser to reach your web workspace.</p>"},{"location":"1.0/setup/secure_dockerd/#troubleshoot","title":"Troubleshoot","text":"<p>All kubernetes resources can be inspected to get more informations.</p> <p>First list elements you want to verify, in the following case, we will inspect pods :</p> <pre><code>sudo kubectl get pods\n\nNAME                            READY   STATUS             RESTARTS   AGE\ndaemonset-nginx-qnd4n           1/1     Running            0          92s\ndaemonset-pyos-6mgq4            1/1     Running            0          92s\nmemcached-od-db69c45fb-mqt4n    1/1     Running            0          92s\nmongodb-od-ff874fcb5-sm6f7      1/1     Running            0          92s\nspeedtest-od-55c58fdd69-5znpr   0/1     ImagePullBackOff   0          92s\n</code></pre> <p>As we can see, status is \"ImagePullBackOff\" for speedtest-od pod. We will then ask kubernetes to describe the pod with the following command :</p> <pre><code>sudo kubectl describe pod speedtest-od-55c58fdd69-t99ck\n</code></pre> <p>In this case, the important information part is at the end (it's not always the case, you can also look at \"Conditions:\" section) : </p> <pre><code>Events:\n  Type     Reason   Age                    From             Message\n  ----     ------   ----                   ----             -------\n  Warning  Failed   7m6s (x4837 over 18h)  kubelet, cube05  Error: ImagePullBackOff\n  Normal   BackOff  2m9s (x4860 over 18h)  kubelet, cube05  Back-off pulling image \"registry.mydomain.local:443/oc.speedtest\"\n</code></pre> <p>As we can see, in this case, Kubernetes had a problem to pull oc.speedtest image from registry.</p>"},{"location":"1.0/setup/secure_dockerd/#view-pyos-logs","title":"View Pyos logs","text":"<pre><code>sudo kubectl logs daemonset-pyos-tklg8 --follow\n</code></pre> <p>Note that you also can view logs using docker command</p>"},{"location":"1.0/setup/uninstall_kubernetes/","title":"Uninstall abcdesktop","text":"<p>Uninstall abcdesktop.io for kuberntes</p>"},{"location":"1.0/setup/uninstall_kubernetes/#commands-to-uninstall-abcdesktopio","title":"Commands to uninstall abcdesktop.io","text":"<p>Run the bash commands : </p> <pre><code>echo \"starting abcdesktop uninstall commands\"\necho \"stop and remove abcdesktop user pods\"\nkubectl delete pods --selector=\"type=x11server\" -n abcdesktop\necho \"remove all services, pods\"\nkubectl delete -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop.yaml\necho \"remove all secrets\"\nkubectl delete secrets --all -n abcdesktop\necho \"remove namespace\"\nkubectl delete namespace abcdesktop\necho \"delete all abcdesktop docker images\"\ndocker images --filter=reference='abcdesktopio/*:*' --format \"{{.Repository}}\"  | xargs docker rmi\necho \"abcdesktop is uninstalled\"\n</code></pre> <p><code>kubectl delete namespace</code> command and <code>docker rmi</code> commands can take few minutes.</p> <p>Please wait for the output message: </p> <pre><code>abcdesktop is uninstalled\n</code></pre> <p>Great, you have uninstalled abcdesktop for kubernetes.</p>"},{"location":"1.0/setup/uninstalldockermode/","title":"Uninstall abcdesktop.io for non-cluster hosts","text":""},{"location":"1.0/setup/uninstalldockermode/#commands-to-uninstall-abcdesktopio","title":"Commands to uninstall abcdesktop.io","text":"<p>Go to the abcdesktop directory (where the <code>docker-compose.yml</code> is located), and run the bash commands  : </p> <pre><code>echo \"starting abcdesktop uninstall commands\"\ndocker-compose -p abcdesktop down\necho \"stop and remove abcdesktop services\"\ndocker-compose rm -s -v -f\necho \"remove all abcdesktop user container\"\ndocker ps --filter \"label=type=x11server\" -q | xargs docker stop\ndocker ps --filter \"label=type=x11server\" -q | xargs docker rm\necho \"remove all abcdesktop images\"\ndocker images --filter=reference='abcdesktopio/*:*' --format \"{{.Repository}}:{{.Tag}}\"  | xargs docker rmi\necho \"remove all user volumes\"\ndocker volume ls -f label=type=x11server -q | xargs docker volume rm\necho \"abcdesktop is uninstalled\"\n</code></pre> <p>Great, you have uninstalled abcdesktop in non-cluster hosts.</p>"},{"location":"1.0/setup/vnc/","title":"abcdesktop.io from scratch","text":"<p>The goal of this chapter is to learn how abcdesktop.io works.  You should not repeat the process in production, but prefer use a Dockerfile and the docker build command.     </p>"},{"location":"1.0/setup/vnc/#requirements","title":"Requirements","text":"<ul> <li>A running dockerd last version </li> <li>A VNC Client </li> <li>An access to the docker public registry</li> <li>An access to the ubuntu repository </li> </ul>"},{"location":"1.0/setup/vnc/#create-a-shared-volume-myshared","title":"Create a shared volume myshared","text":"<p>Before creating containers, we need a shared volume, to share data and unix socket between containers. Run the docker volume create command.</p> <pre><code>docker volume create myshared \n</code></pre>"},{"location":"1.0/setup/vnc/#start-the-first-container-myx11server","title":"Start the first container myx11server","text":"<p>Start the first graphical container named myx11server, forward the tcp port 5900 to the container.</p> <ul> <li>The tcp port 5900 will be use later by the vnc server.</li> <li>The volume myshared is mounted to /tmp</li> </ul> <pre><code>docker run -it -v myshared:/tmp --name myx11server -p 5900:5900 ubuntu:latest bash\n\n</code></pre> <p>You should see a prompt like :</p> <pre><code>root@6de36e574877:/#\n</code></pre> <p>Install the X11 graphics server tigervnc</p> <pre><code>apt-get update\napt-get install -y tigervnc-standalone-server tigervnc-xorg-extension\n</code></pre> <p>Start the X11 graphics server tigervnc</p> <pre><code> Xvnc :0 -SecurityTypes=none &amp;\n</code></pre> <p>You should read the output </p> <pre><code>Xvnc TigerVNC 1.7.0 - built Dec  5 2017 09:25:01\nCopyright (C) 1999-2016 TigerVNC Team and many others (see README.txt)\nSee http://www.tigervnc.org for information on TigerVNC.\nUnderlying X server release 11905000, The X.Org Foundation\n\n\nMon Mar  2 11:43:56 2020\n vncext:      VNC extension running!\n vncext:      Listening for VNC connections on all interface(s), port 5900\n vncext:      created VNC server for screen 0\n</code></pre> <p>Great, you have installed an X11 server inside a docker container, and the Xvnc server is listening for VNC connections on the tcp port 5900. Keep this container running.</p> <p>We will use the host tcp port 5900 to connect VNC Client.</p>"},{"location":"1.0/setup/vnc/#use-vnc-client-to-connect-to-your-first-container-myx11server","title":"Use VNC client to connect to your first container myx11server","text":"<p>From your host or from another host, install a VNC client. You can use your prefered VNC Client for your operating system or the RealVNC's VNC Viewer. You can download the RealVNC's VNC Client, by following the link https://www.realvnc.com/fr/connect/download/viewer/</p> <p>Run the VNC Viewer, and set the hostname where the container myx11server is running.  In the following example.</p> <p>Here I am using VNC Viewer on Mac OS/X and I did set the hostname to localhost.</p>  <p>This is a getting started guide to understand how abcdesktop works, so we did not set a password to protect the VNC access. This is not the best practices guide for production installations.  As we did not set a password to protect the VNC access, you have to confirm the uncrypted connection warning dialog box and then press the <code>Continue</code> button.</p> <p>This is just an example to understand how abcdesktop works, so we did not set a password to protect the VNC access. </p>  <p>You need to confirm the uncrypted connection warning dialog box. Press the Continue button.</p> <p>A black screen should appear :</p>  <p>Keep this VNC Client running, we will use this display to show our applications later.</p>"},{"location":"1.0/setup/vnc/#install-an-x11-application-as-a-docker-application","title":"Install an x11 application as a docker application","text":"<p>On your host, where your container myx11server is running. Open a new shell window and start a new docker container named myapp. The myapp container access to the volume myshared and mount it to /tmp.</p> <pre><code>docker run -it -v myshared:/tmp --name myapp ubuntu:latest\n</code></pre> <p>You should see a prompt like :</p> <pre><code>root@96df62a73e4f:/# \n</code></pre> <p>To install standart application like xedit, xman or xeyes, install the package x11-apps.</p> <p>Run those commands in your myx11server container.</p> <pre><code>apt-get update\napt-get install -y x11-apps\n</code></pre> <p>Set the DISPLAY environment variable to :0.0 and then start the xedit command.</p> <pre><code>export DISPLAY=:0.0\nxedit\n</code></pre> <p>On the VNC Viewer, the application xedit should appear. </p>  <p>Great, you can run a X11 application inside a dedicated docker container, and use your myx11server as DISPLAY. But you can't move, resize or close the xedit window.</p>"},{"location":"1.0/setup/vnc/#install-the-windows-manager-openbox-on-your-myx11server-container","title":"Install the windows manager openbox on your myx11server container","text":"<p>To move, resize, close, the windows applications, we need a windows manager. abcdesktop use the windows manager openbox. OpenBox is a lightweight, powerful, and highly configurable stacking window manager with extensive standards support. </p> <p>Run the install openbox command in your myx11server container.</p> <pre><code>apt-get install -y openbox\n</code></pre> <p>Set the DISPLAY environment variable to :0.0 and then start openbox.</p> <pre><code>export DISPLAY=:0.0\nopenbox\n</code></pre> <p>The Openbox message appear to the sdterr </p> <pre><code>Openbox-Message: Unable to find a valid menu file \"/var/lib/openbox/debian-menu.xml\"\n</code></pre>  <p>Now, you can move the window xedit. The windows are decorated. </p>"},{"location":"1.0/setup/vnc/#remove-the-myapp-container","title":"Remove the myapp container","text":"<p>Activate the window shell with your myapp running container, and press CTRL+C</p> <pre><code>root@9abc7da524a5:/# xedit \n^C\nroot@9abc7da524a5:/# exit\nexit\n</code></pre> <p>You can remove your docker container, to clean up your environment</p> <pre><code>docker rm myapp\n</code></pre>"},{"location":"1.0/setup/vnc/#install-another-x11-application-as-a-docker-application","title":"Install another x11 application as a docker application","text":"<p>On your host, where your container myx11server is running, open a new shell window and start a new docker container named myapp.</p> <pre><code>docker run -it -v myshared:/tmp --name myfirefox ubuntu:latest\n</code></pre> <p>You should see a prompt like :</p> <pre><code>root@96df62a73e4f:/# \n</code></pre> <p>To install firefox application, run the install firefox command in your myfirefox container.</p> <pre><code>apt-get update\napt-get install -y firefox\n</code></pre> <p>Run the firefox command</p> <pre><code>export DISPLAY=:0.0\nfirefox\n</code></pre> <p>You should read the output </p> <pre><code>\n(firefox:1831): LIBDBUSMENU-GLIB-WARNING **: 14:42:14.737: Unable to get session bus: Failed to execute child process ?dbus-launch? (No such file or directory)\n</code></pre> <p>On the VNC Viewer, the application firefox should appear. </p>  <p>Check that firefox works and go to your favorite web site.</p>"},{"location":"1.0/setup/vnc/#clean-your-setup","title":"Clean your setup","text":"<p>To clean your work space, stop the running containers myapp myfirefox myx11server, then remove them. We also need to remove the shared volume myshared</p> <p>Run the commands :</p> <pre><code>docker stop myfirefox myx11server\ndocker rm myfirefox myx11server\ndocker volume rm myshared\n\n</code></pre> <p>Keep the docker images ubuntu, we will use it in the next chapter</p>"},{"location":"1.0/setup/vnc/#next-chapter","title":"Next chapter","text":"<p>In the next chapter, we will replace the VNC Client by a web browser.</p>"},{"location":"2.0/features/","title":"abcdesktop release 2.0","text":"<p>The abcdesktop release 2.0 has started in May 2020</p> <ul> <li>docker instance version 18 and above.</li> <li>abcdesktop (pyos) need a dockerd socket access.</li> <li>Kubernetes release less or equal than 1.23.7-00 (if you use kubernetes release 1.24 or above, you must use abcdesktop release 3.0)</li> <li>an application runs as docker container or as kubernetes pod</li> <li>abcdesktop release 2.x is stable</li> </ul>"},{"location":"2.0/config/authentification-rules/","title":"Authentification rules configuration","text":"<p>All auth providers support rules configuration</p> <p>A rule take some parameters and set label to the auth user. All labels are stored inside the JWT Auth token. The labels are use to define a container execution context. For example to set a dedicated network for firefox application ( read the how-to ) </p>"},{"location":"2.0/config/authentification-rules/#the-rule-object","title":"The rule object","text":"<p>A rule is a dictionary object with :</p> <ul> <li>a name (the entry of the rules)</li> <li>one or more conditions</li> <li>and expected boolean value True or False</li> <li>a label to set if the conditions are equal to the expected boolean value</li> </ul> <p>Example :</p> <p>To test if the user source IP address is equal to <code>8.8.8.1/32</code></p> <pre><code>'rule-home': { \n    'conditions' : [   { 'network': '8.8.8.1/32', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'homeipsource' }\n</code></pre>"},{"location":"2.0/config/authentification-rules/#the-conditions-object","title":"The conditions object","text":"<p><code>conditions</code> is a list of condition. All condition are always tested, as a logical <code>AND</code>. The result must be equal to the <code>expected</code> value.</p>"},{"location":"2.0/config/authentification-rules/#examples","title":"Examples:","text":""},{"location":"2.0/config/authentification-rules/#example-true-and-true-expected-true","title":"Example (TRUE and TRUE) expected TRUE:","text":"<p>To test if the user source IP address is in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'shipcrewandnet80', if the 'expected' value is <code>True</code></p>"},{"location":"2.0/config/authentification-rules/#example-true-and-true-expected-false","title":"Example (TRUE and TRUE) expected FALSE:","text":"<p>To test if the user source IP address is <code>NOT</code> in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is  <code>NOT</code> a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : False,\n    'label': 'noshipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'noshipcrewandnonet80', if the 'expected' value is <code>False</code></p>"},{"location":"2.0/config/authentification-rules/#example-true-and-false-expected-true","title":"Example (TRUE and FALSE) expected TRUE:","text":"<p>To test if the user source IP address is in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is  <code>NOT</code> a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : False } ], \n    'expected' : True,\n    'label': 'noshipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'noshipcrewandnet80', if the 'expected' value is <code>True</code></p>"},{"location":"2.0/config/authentification-rules/#example-false-and-true-expected-true","title":"Example (FALSE and TRUE) expected TRUE:","text":"<p>To test if the user source IP address is <code>NOT</code> in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is   a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : False },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewandnonet80'\n}\n</code></pre> <p>Add the labels 'shipcrewandnonet80', if the 'expected' value is <code>True</code></p>"},{"location":"2.0/config/authentification-rules/#the-condition-value","title":"The condition value","text":"name description example     boolean always true or false 'boolean' : 'true'   httpheader test a HTTP header value 'httpheader':   memberOf test if the LDAP user object is member of group 'memberOf': [ 'cn=ship_crew,ou=people,dc=planetexpress,dc=com']   network test if the client user IP Address is in a network subnet 'network': [ '1.2.3.4/24']   primarygroupid test if the LDAP user object has a attibute primaryGroupID and is equal to value 'primarygroupid': '513'"},{"location":"2.0/config/authentification-rules/#condition-boolean","title":"condition boolean","text":"<p>This condition is a dummy condition; Only use to force a label or to disable a test.</p> <pre><code>'boolean': boolean\n</code></pre> <p>The commun usage is </p> <pre><code>'rule-dummy': { 'conditions':  [  { 'boolean': True, 'expected' : True  } ],\n                   'expected' : True,\n                 'label': 'dummy'\n}\n</code></pre> <p>or alway False</p> <pre><code>'rule-dummy': { 'conditions':  [  { 'boolean': True, 'expected' : True  } ],\n                   'expected' : False,\n                 'label': 'dummy'\n}\n</code></pre>"},{"location":"2.0/config/authentification-rules/#condition-httpheader","title":"condition httpheader","text":"<p>This condition is test if a HTTP Header value is equal to a string. </p> <pre><code>'httpheader': dict\n</code></pre> <p>example : if the 'User-Agent' is equal to <code>'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36' then add the label 'chromemaxosx112'</code></p> <pre><code>\n 'rule-httpheader': { \n        'conditions' : [ \n            {   'httpheader': { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36' }, \n                'expected' : True  } ],\n        'expected' : True,\n        'label': 'chromemaxosx112' }\n\n</code></pre>"},{"location":"2.0/config/authentification-rules/#condition-network","title":"condition network","text":"<p>This condition is test if the client source ip address is in a subnet. IPv4 and IPv6 are supported.</p> <pre><code>'network': string\n</code></pre> <p>example</p> <p>To test if the user source IP address is equal to <code>8.8.8.1/32</code></p> <pre><code>'rule-home': { \n    'conditions' : [   { 'network': '8.8.8.1/32', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'homeipsource' }\n</code></pre> <p>To test if the user source IP address is in the subnet <code>10.0.0.0/8</code></p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '10.0.0.0/8', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'localnet' }\n</code></pre> <p>To test if the user source IP address is NOT in the subnet <code>192.168.0.0/24</code></p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '192.168.0.0/24', 'expected' : False } ],\n                         'expected' : True,\n                         'label': 'no192168net' }\n</code></pre> <p>same as </p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '192.168.0.0/24', 'expected' : True } ],\n                         'expected' : False,\n                         'label': 'no192168net' }\n</code></pre>"},{"location":"2.0/config/authentification-rules/#ipv4-and-ipv6-subnets-support","title":"IPv4 and IPv6 subnets support","text":"<p>To support private ip addresses subnet in the rfc 1918 and rfc 3927, write separated rules. Both IPv6 and IPv4 addresses are supported.  You can share the same label <code>privatenetwork</code> a separated rule. </p> <pre><code>'policies': {\n    'acl' : {},\n    'rules' : { \n          'rule-privatenetwork-10': {   'conditions' : [ { 'network': '10.0.0.0/8', 'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'rule-privatenetwork-172': {'conditions' : [ { 'network': '172.16.0.0/12', 'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'Rule-privatenetwork-192': {'conditions' : [ { 'network': '192.168.0.0/16',     'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'Rule-privatenetwork-169': {'conditions' : [ { 'network': '169.254.0.0/16',     'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'rule-privatenetwork-fe80':{  'conditions' : [ { 'network': 'fe80::/10',     'expected' : True } ], \n                                                'expected'   : True, \n                                                'label': 'privatenetwork' }\n    }\n}                       \n</code></pre>"},{"location":"2.0/config/authentification-rules/#condition-memberof","title":"condition memberof","text":"<p>This condition test if the user is a member of a LDAP Distinguished Name. </p> <pre><code>'memberOf': string\n</code></pre> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewgrp'\n}\n</code></pre>"},{"location":"2.0/config/authentification-rules/#condition-primarygroupid","title":"condition primarygroupid","text":"<p>This test is only used with Microsoft Active Directory. primarygroupid test if the user attibute primaryGroupID is equal to a string.</p> <pre><code>'primarygroupid': string\n</code></pre> <p>To check is a user is memberof a <code>DOMAIN\\USER</code> the primary group id is <code>513</code></p> <pre><code>'rule-domainuser': {    'conditions':  [ { 'primarygroupid': '513', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'domainuser'\n}\n</code></pre> <p>However, if the user needed to be seen as a <code>Domain Admin for POSIX</code>, the <code>PrimaryGroupID</code> is <code>512</code>, the RID for that group. </p> <pre><code>'rule-posixdomainadmin': {  'conditions':  [ { 'primarygroupid': '519', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'posixdomainadmin'\n}\n</code></pre> <p>The <code>Enterprise Admins group</code>, <code>519</code>, is also used to grant this level in POSIX.</p> <pre><code>'rule-enterpriseadmin': {   'conditions':  [ { 'primarygroupid': '519', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'enterpriseadmin'\n}\n</code></pre>"},{"location":"2.0/config/authentification/","title":"Authentification","text":""},{"location":"2.0/config/authentification/#configuration-file","title":"Configuration file","text":"<p>The authentification configuration is set in the <code>od.config</code> file. In this chapter you will need to update the od.config configuration file.  This update differs depending on the configuration docker mode or kubernetes mode. </p> <p>Read the  Update your configuration file and apply the new configuration file section to make change in od.config file for kubernetes cluster.</p>"},{"location":"2.0/config/authentification/#the-dictionary-authmanagers","title":"The dictionary authmanagers","text":"<p>The authmanagers is defined as a dictionnary object :</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { }\n}\n</code></pre> <p>The <code>od.config</code> defines four kinds of entries in the <code>authmanagers</code> object :</p> <ul> <li><code>external</code>: use for OAuth 2.0 Authentification</li> <li><code>explicit</code>: use for LDAP, LDAPS and ActiveDirectory Authentification</li> <li><code>metaexplicit</code>: use  Microsoft Active Directory Trusted relationship, with support of FSP (Foreign Security Principals)</li> <li><code>implicit</code>: use for Anonymous Authentification and SSL-client certificat </li> </ul>"},{"location":"2.0/config/authentification/#related-authmanagers","title":"Related authmanagers","text":"authmanagers type Description     <code>external</code> For OAuth 2.0 authentification   <code>metaexplicit</code> For Microsoft Active Directory Trusted relationship, with support of Foreign Security Principals and Special Identities   <code>explicit</code> For LDAP, LDAPS, Active Directory Authentification, and Kerberos authentification   <code>implicit</code> For anonymous authentification, for an always True Authentification, and SSL-client certificat"},{"location":"2.0/config/authentification/#hands-on","title":"Hands-on","text":""},{"location":"2.0/config/authentification/#requirements","title":"Requirements","text":"<p>You should have read the hands-on :</p> <ul> <li>Update your configuration file and apply the new configuration file section to make change in od.config file for kubernetes cluster.</li> </ul>"},{"location":"2.0/config/authentification/#change-authmanagers-configuration","title":"Change authmanagers configuration","text":"<p>Edit your od.config pyos configuration file, and set the value to the authmanagers dictionnay with empty values for <code>implicit</code>, <code>explicit</code>, and <code>external</code>, as describe :</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { }\n}\n</code></pre> <p>Save your new od.config file, and restart the pyos daemonset</p> <p>Start your web browser and open the URL <code>http://localhost:30443</code></p>  <p>The Web home page should only show the title abcdesktop.io. There is no <code>authmanagers</code> available.</p> <p>Great you can now add some value to authenticate your users.</p>"},{"location":"2.0/config/authentification/#authmanagers-implicit","title":"authmanagers <code>implicit</code>:","text":"<p><code>implicit</code> is the easiest configuration mode, and is used to run Anonymous authentification (always True).  Read the authmanagers implicit Section.</p>"},{"location":"2.0/config/authentification/#authmanagers-explicit","title":"authmanagers <code>explicit</code>:","text":"<p><code>explicit</code> is defined to use a directory service like LDAP.  Read the authmanagers explicit Section.</p>"},{"location":"2.0/config/authentification/#authmanagers-metaexplicit","title":"authmanagers <code>metaexplicit</code>:","text":"<p><code>metaexplicit</code> offers a support to Microsoft Active Directory Trusted relationship, with support of Foreign Security Principals and Special Identities.  Read the authmanagers explicit Section.</p>"},{"location":"2.0/config/authentification/#authmanagers-external","title":"authmanagers <code>external</code>:","text":"<p><code>external</code> use external OAuth 2.0 authentication, for example Google OAuth 2.0, or Github OAuth 2.0  Read the authmanagers external Section.</p>"},{"location":"2.0/config/authentification/#authmanagers-sample","title":"authmanagers sample","text":"<p>In the authmanagers implicit section, authmanagers explicit section, and authmanagers external section, you have learned how to defined the providers. </p> <p>You can set a complete <code>authmanagers</code> dictionary as described with <code>external</code>, <code>explicit</code> and <code>implicit</code></p> <pre><code>authmanagers: {\n  'external': {\n    'providers': {\n      'facebook': { \n        'displayname': 'Facebook', \n        'enabled': True,\n        'client_id':     'XXXXXXX', \n        'client_secret': 'YYYYYYY', \n        'dialog_url': 'https://www.facebook.com/dialog/oauth?client_id={client_id}&amp;redirect_uri={callback_url}&amp;response_type=code',\n        'auth_url': 'https://graph.facebook.com/v2.3/oauth/access_token?code={code}&amp;redirect_uri={callback_url}&amp;client_id={client_id}&amp;client_secret={client_secret}',\n        'userinfo_url': 'https://graph.facebook.com/v2.6/me?access_token={access_token}&amp;fields=picture.width(400),name',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}',\n        'userinfomap': {\n            '*': '*',\n            'picture': 'picture.data.url'\n        }\n      },\n      'orange': {       \n        'displayname': 'Orange', \n        'enabled': True,\n        'basic_auth': True,\n        'userinfo_auth': True,\n        'client_id':      'AAAAAAAA', \n        'client_secret':  'BBBBBBBB',\n        'dialog_url': 'https://api.orange.com/oauth/v2/authorize?client_id={client_id}&amp;redirect_uri={callback_url}&amp;scope=openid+profile+offline_access&amp;response_type=code&amp;prompt=login+consent&amp;state={callba\nck_url}',\n        'auth_url': 'https://api.orange.com/openidconnect/fr/v1/token?code={code}&amp;redirect_uri={callback_url}&amp;grant_type=authorization_code', \n        'userinfo_url': 'https://api.orange.com/openidconnect/v1/userinfo',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      },\n      'mobileorange': { \n        'displayname': 'Mobile Connect', \n        'enabled': False,\n        'client_id':     'CCCCCCCC', \n        'client_secret': 'DDDDDDDD',\n        'basic_auth': True,\n        'dialog_url': 'https://api.orange.com/oauth/v2/authorize?client_id={client_id}&amp;redirect_uri={callback_url}&amp;scope=openid+profile&amp;response_type=code&amp;prompt=login+consent&amp;state=&amp;state={callback_url}'\n,\n        'auth_url': 'https://api.orange.com/oauth/v2/token?code={code}&amp;redirect_uri={callback_url}&amp;grant_type=authorization_code', \n        'userinfo_url': 'https://api.orange.com/oauth/v2/authorize',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      },\n      'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id':     'EEEEEEEE.apps.googleusercontent.com', \n        'client_secret': 'FFFFFFFF',\n        'scope': 'https://www.googleapis.com/auth/userinfo.email',\n        'dialog_url': 'https://accounts.google.com/o/oauth2/v2/auth?client_id={client_id}&amp;redirect_uri={callback_url}&amp;response_type=code&amp;scope={scope}',\n        'auth_url': 'https://oauth2.googleapis.com/token?code={code}&amp;grant_type=authorization_code&amp;redirect_uri={callback_url}&amp;scope={scope}&amp;client_id={client_id}&amp;client_secret={client_secret}',\n        'userinfo_url': 'https://openidconnect.googleapis.com/v1/userinfo?access_token={access_token}',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      }\n    }\n  },\n  'explicit': {\n    'show_domains': True,\n    'default_domain': 'AD',\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n    }\n  },\n  'implicit': {\n    'providers': {\n      'anonymous': {\n        'displayname': 'Anonymous',\n        'caption': 'Have a look !',\n        'userid': 'anonymous',\n        'username': 'Anonymous'\n      }     \n    }\n  }}\n\n\nadconfig : { 'AD': {    'default'       : True, \n                        'ldap_timeout'  : 15,\n                        'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                        'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                        'domain'        : 'AD',\n                        'auth_type'     : 'NTLM',\n                        'domain_fqdn'   : 'AD.DOMAIN.LOCAL',\n                        'servers'       : [ 'ldap://192.168.1.12', 'ldaps://192.168.1.13'],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL'\n}}\n</code></pre>"},{"location":"2.0/config/authexplicit-activedirectory/","title":"Authentification <code>explicit</code> for Microsoft Active Directory services","text":""},{"location":"2.0/config/authexplicit-activedirectory/#authmanagers-explicit-object","title":"authmanagers <code>explicit</code> object","text":"<p>The <code>explicit</code> authentification configuration is defined as a dictionnary object and contains an <code>explicit</code> provider. </p> <p>For example :</p> <pre><code>'explicit': {\n    'show_domains': True,\n    'default_domain': 'AD',\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n}\n</code></pre>    Variable name Type Description     <code>show_domains</code> boolean Permit the domain name to be listed in API getclientdata, the default value is False   <code>default_domain</code> string Default domain name prefix if the user format does not containthe domain prefix like DOMAIN\\USER. If the user login value is USER, the login is prefixed with the  default_domain\\USER   <code>providers</code> dictionnary <code>{ 'AD': {  'config_ref': 'adconfig',  'enabled': True  }}</code>"},{"location":"2.0/config/authexplicit-activedirectory/#providers-configuration","title":"providers configuration","text":"<p>The <code>provider</code> authentification configuration is defined as a dictionnary object and must contain a key name. The key name must be set as the <code>USERDOMAIN</code> and defined in the <code>config_ref</code> with the exact same value.</p> <p>Providers :</p> <p>The provider is formated as a dictionnary </p> <p><code>{ 'AD': {               'config_ref': 'adconfig',               'enabled': True           }  }</code></p>    Variable name Type Description     config_ref string For increased legibility, the <code>USERDOMAIN</code> configuration is defined in a dedicated dictionnary used the key:value <code>'config_ref': 'adconfig'</code>, where <code>key</code> is <code>config_ref</code> and <code>value</code> is the dictionnay variable name.   enable boolean enable or disable the domain entry    <p>The adconfig is a dictionnary. For example :</p> <pre><code>adconfig : { 'AD': {   'default'       : True, \n                       'ldap_timeout'  : 15,\n                       'ldap_protocol' : 'ldap',\n                       'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                       'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                       'domain'        : 'AD',\n                       'domain_fqdn': 'AD.DOMAIN.LOCAL',\n                       'servers'    : [ '192.168.7.12' ],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL',\n                        'query_dcs' : True,\n                        'wins_servers'  : [ '192.168.1.12' ],\n                        'serviceaccount': { 'login': 'SVCACCOUNT', 'password': 'SVCACCOUNTPASSWORD' }\n     }\n}\n</code></pre> <p>If this example, the Microsoft Active Directory value are set to :</p>    Variable name Value for example     <code>USERDOMAIN</code> <code>AD</code>   <code>USERDNSDOMAIN</code> <code>AD.DOMAIN.LOCAL</code>    <p>For Active Directory authmanagers, replace the variable name with your own value.</p>    Variable name Type Description Example     <code>default</code> boolean Use this domain as default domain True   <code>ldap_basedn</code> string LDAP Base Distinguished Names <code>DC=ad,DC=domain,DC=local</code>   <code>ldap_fqdn</code> string _ldap._tcp.Domain_Name <code>_ldap._tcp.ad.domain.local</code>   <code>domain_fqdn</code> string domain FQDN (also know as Domain_Name) <code>AD.DOMAIN.LOCAL</code>   <code>servers</code> list of string list of the Active Director servers <code>[ '192.168.1.12', '192.168.1.13' ]</code>   <code>kerberos_realm</code> string Replace kerberos_realm wih your kerberos realm (in UPPER CASE) <code>AD.DOMAIN.LOCAL</code>    <p>The <code>explicit</code> authentification is support <code>LDAP</code> and <code>LDAPS</code> bind.</p> <p>The Microsoft Active Directory value are set to :</p>    Variable name Value     <code>USERDOMAIN</code> <code>AD</code>   <code>USERDNSDOMAIN</code> <code>AD.DOMAIN.LOCAL</code>    <p>For Active Directory authmanagers, replace the variable name with your own value.</p>    Variable name Description Example     <code>ldap_basedn</code> Replace ldap_basedn with your LDAP Base Distinguished Names <code>DC=ad,DC=domain,DC=local</code>   <code>ldap_fqdn</code> Replace ldap_fqdn with the _ldap._tcp fqdn <code>_ldap._tcp.ad.domain.local</code>   <code>domain_fqdn</code> Replace domain_fqdn with domain FQDN value <code>AD.DOMAIN.LOCAL</code>   <code>servers</code> Replace servers with list of the Active Director servers <code>[ '192.168.1.12', '192.168.1.13' ]</code>   <code>kerberos_realm</code> Replace kerberos_realm wih your kerberos realm (in UPPER CASE) <code>AD.DOMAIN.LOCAL</code>"},{"location":"2.0/config/authexplicit-activedirectory/#service-account","title":"Service Account","text":"<p>The service account is use when od.py starts. It runs query to the Active Directory service to read the subnet and location from the sites in 'CN=Subnets,CN=Sites,CN=Configuration,' + BASE_DN , (for example CN=Subnets,CN=Sites,CN=Configuration,DC=example,DC=com)</p>"},{"location":"2.0/config/authexplicit-activedirectory/#site","title":"Site","text":"<p>This features is only available if a service account is defined. Site is used to locate a user from his ip adress. The attributs location and subnet are cached in memory.</p>    Variable name Type Defautl value     <code>site_subnetdn</code> string <code>CN=Subnets,CN=Sites,CN=Configuration, + config.get('basedn') )</code>   <code>site_scope</code> ldap python <code>ldap.SCOPE_SUBTREE</code> read Python ldap reference for more details   <code>site_filter</code> string <code>(objectClass=subnet)</code>   <code>site_attrs</code> list <code>['cn', 'siteObject', 'location']</code>"},{"location":"2.0/config/authexplicit-activedirectory/#printers","title":"Printers","text":"<p>This features is only available if a service account is defined. Printers are used to list printer available in the current user's site. The site is identified using the user's ip address. <code>location</code> is the join key to match local printer for the user.</p>    Variable name Type Defautl value     <code>printer_printerdn</code> string <code>OU=Applications + config.get('basedn')</code>   <code>printer_scope</code> ldap python <code>ldap.SCOPE_SUBTREE</code> read Python ldap reference for more details   <code>site_filter</code> string <code>(objectClass=printQueue)</code>   <code>site_attrs</code> list <code>[ 'cn', 'uNCName', 'location', 'driverName', 'driverVersion', 'name',  'portName', 'printColor', 'printerName', 'printLanguage', 'printSharename', 'serverName', 'shortServerName', 'url', 'printMediaReady', 'printBinNames',  'printMediaSupported',  'printOrientationsSupported' ]</code>    <p>Great, you have check how the explicit Authentification configuration works.</p>"},{"location":"2.0/config/authexplicit-ldap/","title":"Authentification <code>explicit</code> for LDAP Directory Services","text":""},{"location":"2.0/config/authexplicit-ldap/#authmanagers-explicit-object","title":"authmanagers <code>explicit</code> object","text":"<p><code>explicit</code> authentification use a directory service. A bind operation is used to authenticate clients to the directory server, to establish an authorisation identity that will be used for subsequent operations processed on that connection. </p> <p>The <code>explicit</code> authentification configuration is defined as a dictionary object and contains an <code>explicit</code> provider. </p> <p>For example :</p> <pre><code>'explicit': {\n    'providers': {\n      'LDAP': { \n        'config_ref': 'ldapconfig', \n        'enabled': True\n       }\n}\n</code></pre> <p>In this example, <code>ldapconfig</code> dict must have a key <code>LDAP</code></p>    Variable name Type Description     <code>default_domain</code> string set the default domain name, if user does not prefix the login by domain\\s. <code>default_domain</code> is  only used by Active Directory provider   <code>providers</code> dictionary <code>{ 'LDAP': {  'config_ref': 'ldapconfig',  'enabled': True  }}</code>"},{"location":"2.0/config/authexplicit-ldap/#providers-configuration","title":"providers configuration","text":"<p>The <code>provider</code> authentification configuration is defined as a dictionary object and must contain a key name. The key name must be set with the same value in provider configuration and <code>config_ref</code>.</p> <p>The provider is formatted as a dictionary. Example for a <code>provider</code> defined as <code>planet</code></p> <pre><code> { 'planet': {  \n            'config_ref': 'ldapconfig',  \n            'enabled': True  \n        }\n }\n</code></pre>    Variable name Type Description     config_ref string For  increased readability , the configuration is defined in a dedicated and separated dictionary as (key,value) <code>'config_ref': 'planet'</code>, where <code>key</code> is <code>config_ref</code> and <code>value</code> is the dictionary variable name.   enable boolean <code>True</code> to enable or <code>False</code> to disable the provider configuration    <p>The <code>ldapconfig</code> is a dictionary. </p> <p>For example :</p> <pre><code>ldapconfig : { \n  'planet': {    \n    'default'       : True, \n    'ldap_timeout'  : 15,\n    'ldap_protocol' : 'ldap',\n    'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n    'servers'       : [ 'ldap://192.168.8.195' ],\n    'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' } \n  } \n } \n}\n</code></pre>"},{"location":"2.0/config/authexplicit-ldap/#ldap-configuration-reference","title":"ldap configuration reference","text":"Variable name Type Description Example     <code>default</code> boolean Use this ldap configuration as default (if more than one ldap auth provider is defined) True   <code>auth_only</code> boolean Do not run ldap queries, only use to run authentication False   <code>auth_type</code> string authentification protocol to bind the ldap server. Values can be 'KERBEROS', 'NTLM' or 'SIMPLE' The default value is 'SIMPLE'   <code>basedn</code> string LDAP base Distinguished Name <code>ou=people,dc=planetexpress,dc=com</code>   <code>servers</code> list of string list of LDAP servers (IP Adress or FQDN), if entry does not respond, the next one is used. This entry must be prefixed by the protocol <code>ldap</code> or <code>ldaps</code> for each server <code>[ 'ldap://192.168.1.12', 'ldaps://192.168.1.13' ]</code> LDAP server address IP Address or FQDN value   <code>scope</code> LDAP Perform an LDAP search operation, with base as the DN of the entry at which to start the search, <code>scope</code> being one of <code>SCOPE_BASE</code> (to search the object itself), <code>SCOPE_ONELEVEL</code> (to search the object\u2019s immediate children), or <code>SCOPE_SUBTREE</code> (to search the object and all its descendants). <code>ldap.SCOPE_SUBTREE</code>   <code>timeout</code> integer ldap time out in second 10   <code>exec_timeout</code> integer execute time out in seconds, to obtain ntlm_auth credentials, or cntlm auth credentials, or kerberos keytab file the exec timeout is used to run external command line. 10   <code>users_ou</code> string Users Organisation Unit <code>ou=people,dc=planetexpress,dc=com</code>   <code>attrs</code> list list of default attributs to read in user object. read the Definition of the inetOrgPerson LDAP Object Class     <code>filter</code> string LDAP filter to find user object <code>(&amp;(objectClass=inetOrgPerson)(cn=%s))</code>   <code>group_filter</code> string LDAP filter to find group object <code>(&amp;(objectClass=Group)(cn=%s))</code>   <code>group_attrs</code> string LDAP filter to find group object <code>(&amp;(objectClass=Group)(cn=%s))</code>   <code>serviceaccount</code> dictionary entries to defined service account credentials formatted like <code>{ 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' }</code> or <code>{ 'login': 'file://config/serviceaccount/login', 'password': 'file://config/serviceaccount/passwd' }</code>"},{"location":"2.0/config/authexplicit-ldap/#ldap-service-account","title":"ldap service account","text":"<p>Ldap service account permits service account binding. A service account can be defined using clear text <code>login</code> and <code>password</code> data, or as file reference <code>login</code> and <code>password</code> starting by <code>file://</code>. </p> <ul> <li>If <code>login</code> starts by <code>file://</code>, then pyos open the defined file to read login data.</li> <li>If <code>password</code> starts by <code>file://</code>, then pyos open the defined file to read password data.</li> </ul> <p>The file reference <code>file://</code> for <code>login</code> and <code>password</code> is used to read kubernetes secret file data.</p>"},{"location":"2.0/config/authexplicit-ldap/#configure-auth-using-the-openldap-container","title":"Configure Auth using the OpenLDAP container","text":""},{"location":"2.0/config/authexplicit-ldap/#openldap-container-for-testing","title":"OpenLDAP container for testing","text":"<p>To configure abcdesktop to use an explicit authentification, we need a directory service. We use an OpenLDAP container for testing with provisioned values. docker-test-openldap from rroemhild works fine ans id very useful.</p> <p>Read the OpenLDAP container for testing documentation on the url abcdesktop OpenLDAP Docker Image for testing</p>"},{"location":"2.0/config/authexplicit-ldap/#update-the-odconfig-configuration-file","title":"Update the <code>od.config</code> configuration file","text":"<p>Update the <code>od.config</code> configuration file.</p> <p>Add the <code>explicit</code> entry to the dictionary <code>authmanagers</code>.</p> <pre><code>authmanagers: {\n  'external': {\n  },\n  'explicit': {\n    'show_domains': True,\n    'providers': {\n      'planet': { \n        'config_ref': 'ldapconfig', \n        'enabled': True\n       }\n    }\n  },\n  'implicit': {\n  }}      \n</code></pre>  <p>Note: the <code>config_ref</code> is <code>ldapconfig</code>. </p>  <p>Add a new dictionary object named <code>ldapconfig</code> to the configuration file. These values come from the LDAP structure of OpenLDAP Docker Image for testing</p> <pre><code>ldapconfig : { 'planet': {    \n                        'default'       : True, \n                        'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n                        'servers'       : [ 'ldap://openldap' ] }}\n</code></pre> <p>Save your new od.config file.</p> <p>Open the URL:<code>http://localhost:30443</code></p> <p>The authmanagers <code>explicit</code> is enabled. The Web home page insert the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p>"},{"location":"2.0/config/authexplicit-ldap/#the-ldap-structure-of-openldap-container-for-testing","title":"The LDAP structure of OpenLDAP container for testing","text":""},{"location":"2.0/config/authexplicit-ldap/#basedn","title":"BaseDN","text":"<p>The <code>basedn</code> is <code>dc=planetexpress,dc=com</code></p>"},{"location":"2.0/config/authexplicit-ldap/#admin-account","title":"admin account","text":"<p>The admin account is described as</p>    Admin Secret     cn=admin,dc=planetexpress,dc=com GoodNewsEveryone"},{"location":"2.0/config/authexplicit-ldap/#ou-users","title":"OU Users","text":"<ul> <li>The User Orgnanistation Unit is <code>ou=people,dc=planetexpress,dc=com</code></li> </ul>"},{"location":"2.0/config/authexplicit-ldap/#users","title":"Users","text":""},{"location":"2.0/config/authexplicit-ldap/#cnhubert-j-farnsworthoupeopledcplanetexpressdccom","title":"cn=Hubert J. Farnsworth,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Hubert J. Farnsworth   sn Farnsworth   description Human   displayName Professor Farnsworth   employeeType Owner   employeeType Founder   givenName Hubert   jpegPhoto JPEG-Photo (630x507 Pixel, 26780 Bytes)   mail professor@planetexpress.com   mail hubert@planetexpress.com   ou Office Management   title Professor   uid professor   userPassword professor"},{"location":"2.0/config/authexplicit-ldap/#cnphilip-j-fryoupeopledcplanetexpressdccom","title":"cn=Philip J. Fry,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Philip J. Fry   sn Fry   description Human   displayName Fry   employeeType Delivery boy   givenName Philip   jpegPhoto JPEG-Photo (429x350 Pixel, 22132 Bytes)   mail fry@planetexpress.com   ou Delivering Crew   uid fry   userPassword fry"},{"location":"2.0/config/authexplicit-ldap/#cnjohn-a-zoidbergoupeopledcplanetexpressdccom","title":"cn=John A. Zoidberg,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn John A. Zoidberg   sn Zoidberg   description Decapodian   displayName Zoidberg   employeeType Doctor   givenName John   jpegPhoto JPEG-Photo (343x280 Pixel, 26438 Bytes)   mail zoidberg@planetexpress.com   ou Staff   title Ph. D.   uid zoidberg   userPassword zoidberg"},{"location":"2.0/config/authexplicit-ldap/#cnhermes-conradoupeopledcplanetexpressdccom","title":"cn=Hermes Conrad,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Hermes Conrad   sn Conrad   description Human   employeeType Bureaucrat   employeeType Accountant   givenName Hermes   mail hermes@planetexpress.com   ou Office Management   uid hermes   userPassword hermes"},{"location":"2.0/config/authexplicit-ldap/#cnturanga-leelaoupeopledcplanetexpressdccom","title":"cn=Turanga Leela,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Turanga Leela   sn Turanga   description Mutant   employeeType Captain   employeeType Pilot   givenName Leela   jpegPhoto JPEG-Photo (429x350 Pixel, 26526 Bytes)   mail leela@planetexpress.com   ou Delivering Crew   uid leela   userPassword leela"},{"location":"2.0/config/authexplicit-ldap/#groups","title":"Groups","text":""},{"location":"2.0/config/authexplicit-ldap/#cnadmin_staffoupeopledcplanetexpressdccom","title":"cn=admin_staff,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass Group   cn admin_staff   member cn=Hubert J. Farnsworth,ou=people,dc=planetexpress,dc=com   member cn=Hermes Conrad,ou=people,dc=planetexpress,dc=com"},{"location":"2.0/config/authexplicit-ldap/#cnship_crewoupeopledcplanetexpressdccom","title":"cn=ship_crew,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass Group   cn ship_crew   member cn=Turanga Leela,ou=people,dc=planetexpress,dc=com   member cn=Philip J. Fry,ou=people,dc=planetexpress,dc=com   member cn=Bender Bending Rodr\u00edguez,ou=people,dc=planetexpress,dc=com"},{"location":"2.0/config/authexplicit-ldap/#insert-the-user-credentials","title":"Insert the user credentials","text":"<p>Start your web browser and open the URL <code>http://localhost</code></p> <p>The Web home page contains the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p> <p>You can use for example on user of the list above.</p>    Credentials Value     Login Turanga Leela   Password leela     <p>Insert the login credentials :</p> <p><code>Turanga Leela</code> as login and <code>leela</code> as password, then click on the <code>Sign in</code> button.</p>  <p>Look at the top of the sreen. The user name is <code>Turanga Leela</code>:  </p>"},{"location":"2.0/config/authexplicit-ldap/#applications-remainted","title":"Applications remainted","text":"<p>Start LibreOffice Writer, and start a new file for your instructor.  Type few words for example :</p> <pre><code>I like this amazing project abcdesktop.io\n</code></pre> <p>Do not save your file and just close your web browser.</p> <p>Start your web browser again, and open the same URL <code>http://localhost</code>, and log in with the same account: <code>Turanga Leela</code> as login and <code>leela</code> as password, then click on the <code>Sign in</code> button.</p> <p>The application LibreOffice Writer is still running and the greeting message <code>I like this amazing project abcdesktop.io</code></p>   <p>All applications are maintained. </p>  <p>Great, you have check how the explicit Authentification configuration works, install an openldap directory service, and check that all sessions are maintained. </p>"},{"location":"2.0/config/authexplicit/","title":"Authentification <code>explicit</code>","text":""},{"location":"2.0/config/authexplicit/#authmanagers-explicit","title":"authmanagers <code>explicit</code>:","text":"<p><code>explicit</code> authentification use a directory service. The bind operation is used to authenticate clients to the directory server, to establish an authorization identity that will be used for subsequent operations processed on that connection.</p> <p>The <code>explicit</code> authentification configuration is defined as a dictionary object and contains an <code>explicit</code> provider. </p> <p>The <code>explicit</code> provider support the directory services <code>ldap</code>, <code>ldaps</code>, and <code>Microsoft Active Directory</code>, and <code>SIMPLE</code>, <code>NTLM</code> and <code>KERBEROS</code> protocols.</p> <p>Configuration sample for <code>Microsoft Active Directory</code> with <code>KERBEROS</code> protocol :</p> <pre><code>'explicit': {\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n}\n</code></pre> <pre><code>adconfig : { 'AD': {   'default'       : True, \n                       'ldap_timeout'  : 15,\n                       'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                       'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                       'domain'        : 'AD',\n                       'auth_type'     : 'KERBEROS'\n                       'domain_fqdn'   : 'AD.DOMAIN.LOCAL',\n                       'servers'       : [ 'ldap://192.168.7.12' ],\n                       'kerberos_realm': 'AD.DOMAIN.LOCAL' } } }\n</code></pre>"},{"location":"2.0/config/authexplicit/#home-page-authentification","title":"Home page authentification","text":"<p>If the authmanagers <code>explicit</code> is enabled. The Web home page insert the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p>"},{"location":"2.0/config/authexplicit/#ldap-authmanagers","title":"LDAP authmanagers :","text":"<p>Read the specific chapter on LDAP explicit authmanagers</p>"},{"location":"2.0/config/authexplicit/#microsoft-active-directory-authmanagers","title":"Microsoft Active Directory authmanagers :","text":"<p>Microsoft Active Directory is implemented as a LDAP Server, start reading the chapter on LDAP LDAP and LDAPS explicit authmanagers, then read the specific chapter for Microsoft Active Director Microsoft Active Directory explicit authmanagers</p> <p>Great, you have check how the explicit Authentification configuration works.</p>"},{"location":"2.0/config/authexternal/","title":"Authentification <code>external</code>","text":""},{"location":"2.0/config/authexternal/#requirements","title":"Requirements","text":"<p>To use <code>external</code> Authentification OAuth 1.0 and or OAuth 2.0, you need an internet FQDN and a secured web site with https.</p>"},{"location":"2.0/config/authexternal/#library","title":"Library","text":"<p>abcdesktop uses requests_oauthlib python module. Requests-OAuthlib uses the Python Requests and OAuthlib libraries for building OAuth1 and OAuth2 clients.</p>"},{"location":"2.0/config/authexternal/#authmanagers-external","title":"authmanagers <code>external</code>:","text":"<p><code>external</code> authentification use OAuth 2.0 authenticaton.</p> <p>The <code>external</code> authentification configuration is defined as a dictionary object and contains a list of <code>external</code> provider. </p> <p>Sample providers entry using the Google OAuth 2.0 authentification service. </p> <pre><code>'external': {\n    'providers': {\n    'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id': 'XXX-YYY.apps.googleusercontent.com', \n        'client_secret': 'XXX',\n        'userinfo_auth': True,\n        'scope': [ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ],\n        'userinfo_url': 'https://www.googleapis.com/oauth2/v1/userinfo',\n        'redirect_uri_prefix' : 'https://host.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=google',\n        'authorization_base_url': 'https://accounts.google.com/o/oauth2/v2/auth',\n        'token_url': 'https://oauth2.googleapis.com/token'\n    }\n}\n</code></pre> <p>The variable values <code>client_id</code> and <code>client_secret</code> have been set to obfuscate value 'XXX'. The FQDN is refered to the public server FQDN. </p>    Variable name Type Description Sample     <code>displayname</code> string Display Name show in Web front <code>Google</code>   <code>enabled</code> boolean LDAP Base Distinguished Names <code>True</code>   <code>client_id</code> string client id <code>XXX-YYY.apps.googleusercontent.com</code>   <code>client_secret</code> string client secret <code>XXX</code>   <code>scope</code> list of string scope <code>[ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ]</code>   <code>userinfo_url</code> string dialog URL `https://www.googleapis.com/oauth2/v1/userinfo'   <code>redirect_uri_prefix</code> string redirect URL <code>https://hostname.domain.local/API/auth/oauth</code>   <code>redirect_uri_querystring</code> string URL query string <code>manager=external&amp;provider=google</code>   <code>authorization_base_url</code> string callback URL <code>https://accounts.google.com/o/oauth2/v2/auth</code>   <code>token_url</code> string token URL <code>https://oauth2.googleapis.com/token</code>    <p>The complete redirect url concats the two values <code>redirect_uri_prefix</code> and <code>redirect_uri_querystring</code>.</p>"},{"location":"2.0/config/authexternal/#orange-oauth-20","title":"Orange OAuth 2.0","text":"<p>Orange's OAuth is supported for authentication. This API is based on OpenID Connect, which combines end-user authentication with OAuth2 authorisation. </p>"},{"location":"2.0/config/authexternal/#orange-application","title":"Orange Application","text":"<p>Create your Orange Application here https://developer.orange.com/apis and set credentials for Orange Authentification API in the section </p> <pre><code>'orange': {       \n        'displayname': 'Orange', \n        'enabled': True,\n        'basic_auth': True,\n        'userinfo_auth': True,\n        'scope' : [ 'openid', 'form_filling' ],\n        'client_id': 'XXX',\n        'client_secret': 'YYY',\n        'redirect_uri_prefix' : 'https://hostname.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=orange',\n        'authorization_base_url': 'https://api.orange.com/openidconnect/fr/v1/authorize',\n        'token_url': 'https://api.orange.com/openidconnect/fr/v1/token', \n        'userinfo_url': 'https://api.orange.com/formfilling/fr/v1/userinfo',\n      }\n</code></pre>"},{"location":"2.0/config/authexternal/#facebook-oauth-20","title":"Facebook OAuth 2.0","text":"<p>Facebook's OAuth is supported for authentication. </p>"},{"location":"2.0/config/authexternal/#facebook-application","title":"Facebook Application","text":"<p>Create your Facebook Application credentials here : https://developers.facebook.com/apps/ and set the credentials for Facebook Authentification API  </p> <pre><code>'facebook': { \n        'displayname': 'Facebook', \n        'enabled': True,\n        'userinfo_auth': True,\n        'client_id': 'XXX', \n        'client_secret': 'YYY', \n        'redirect_uri_prefix' : 'https://hostname.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=facebook',\n        'authorization_base_url': 'https://www.facebook.com/dialog/oauth',\n        'userinfo_url': 'https://graph.facebook.com/v2.6/me?fields=picture.width(400),name',\n        'token_url': 'https://graph.facebook.com/v2.3/oauth/access_token',\n        'userinfomap': {\n            '*': '*',\n            'picture': 'picture.data.url'\n        }\n</code></pre>"},{"location":"2.0/config/authexternal/#google-oauth-20","title":"Google OAuth 2.0","text":"<p>Google's OAuth is supported for authentication. The client_id is the google's OAuth client ID, and the client_secret is the OAuth client secret. </p>"},{"location":"2.0/config/authexternal/#google-application","title":"Google Application","text":"<p>Create your Google credentials here : https://console.developers.google.com/apis/ and set the correct credentials for Google Authentification API in the section [gauth]</p> <pre><code>'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id': 'XXX-YYY.apps.googleusercontent.com', \n        'client_secret': 'XXX',\n        'userinfo_auth': True,\n        'scope': [ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ],\n        'userinfo_url': 'https://www.googleapis.com/oauth2/v1/userinfo',\n        'redirect_uri_prefix' : 'https://host.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=google',\n        'authorization_base_url': 'https://accounts.google.com/o/oauth2/v2/auth',\n        'token_url': 'https://oauth2.googleapis.com/token'\n    }\n</code></pre> <p>Great, you have check how the implicit Authentification configuration works.</p>"},{"location":"2.0/config/authimplicit/","title":"Authentification <code>implicit</code>","text":""},{"location":"2.0/config/authimplicit/#authmanagers-implicit","title":"authmanagers <code>implicit</code>:","text":"<p><code>implicit</code> is the easiest configuration mode, and is used as 'Anonymous' authentification. </p> <p>The provider is defined as a dictionary object and contains an <code>anonymous</code> provider.</p> <p><code>anonymous</code> provider always permits authentification, and create a uuid as userid. <code>anonymous</code> provider is used to skip the authentification process in a demonstration mode.</p> <pre><code>'implicit': {\n    'providers': {\n      'anonymous': {\n        'displayname': 'Anonymous',\n        'caption': 'Have a look !',\n        'userid': 'anonymous',\n        'username': 'Anonymous'\n      }     \n    }\n</code></pre> <p><code>anonymous</code> provider always permit authentification, and create a uuid as userid. </p> <p>Set in your configuration file the <code>authmanagers</code> dictionary as described</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { \n     'providers': {\n         'anonymous': {\n           'displayname': 'Anonymous',\n           'caption': 'Anonymous',\n           'userid': 'anonymous',\n           'username': 'Anonymous'\n      } \n   }\n}\n</code></pre> <p>Update your configuration file and apply the new configuration file</p> <p>Open a new Web Browser and go to your abcdesktop URL. You should see the login HTML page with the Anonymous button :</p>  <p>Select the <code>Sign-In Anonymously</code> button.</p> <p>Then, choose the <code>settings</code> in the menu at the upper right corner </p>  <p>Choose the <code>System</code> in the settings control panel.</p>  <p>Then choose <code>User containers</code></p>  <p>This screen show you the <code>hostname</code>. </p> <p>You can read the hostname. In the example the hostname is <code>f097ab7aac57</code>, from the container id.</p> <p>Using a shell, run the command </p> <pre><code>kubectl get pods -n abcdesktop \n</code></pre> <p>Find a running container with the containerid previously  identified.</p> <p>In this example the containerid is <code>f097ab7aac57</code></p> <pre><code>f097ab7aac57   abcdesktopio/oc.user.18.04   \"/composer/docker-en\u2026\"   8 minutes ago    Up 8 minutes               4714/tcp, 6081/tcp, 29780-29781/tcp, 29783-29784/tcp, 29786/tcp, 55556-55557/tcp   g-06b686a5-c98d-4889-b73d-3455f692e6c2\n</code></pre> <p>Run the command <code>docker inspect CONTAINERID</code>, replace the string CONTAINERID with your container id value.</p>  <p>For example <code>docker inspect f097ab7aac57</code></p>  <pre><code>docker inspect f097ab7aac57\n</code></pre> <p>Locate the <code>Mounts</code> description. User's containers created with an implicit provider anonymous have only one volume type. Anonymous home directory DO NOT USE persistant volume data. Explicit and </p> <pre><code> \"Mounts\": [\n            {\n                \"Type\": \"volume\",\n                \"Name\": \"tmp-06b686a5-c98d-4889-b73d-3455f692e6c2\",\n                \"Source\": \"/var/lib/docker/volumes/tmp-06b686a5-c98d-4889-b73d-3455f692e6c2/_data\",\n                \"Destination\": \"/tmp\",\n                \"Driver\": \"local\",\n                \"Mode\": \"z\",\n                \"RW\": true,\n                \"Propagation\": \"\"\n            },\n            {\n                \"Type\": \"volume\",\n                \"Name\": \"home-06b686a5-c98d-4889-b73d-3455f692e6c2\",\n                \"Source\": \"/var/lib/docker/volumes/home-06b686a5-c98d-4889-b73d-3455f692e6c2/_data\",\n                \"Destination\": \"/home/balloon\",\n                \"Driver\": \"local\",\n                \"Mode\": \"z\",\n                \"RW\": true,\n                \"Propagation\": \"\"\n            }\n        ],\n\n</code></pre> <p>When an anonymous user close his session, the anonymous home directory is deleted.</p> <p>Great, you have check how the implicit Authentification configuration works.</p>"},{"location":"2.0/config/authmetaexplicit/","title":"Authentification <code>metaexplicit</code> for Microsoft Active Directory services with trust relationships","text":""},{"location":"2.0/config/authmetaexplicit/#authmanagers-metaexplicit-object","title":"authmanagers <code>metaexplicit</code> object","text":"<p>The <code>metaexplicit</code> authentification manager contains only one provider. The provider must be defined as <code>metadirectory</code>.</p> <pre><code>'metaexplicit': {\n    'providers': {\n      'metadirectory': { \n        'config_ref': 'coporateconfig', \n        'enabled': True\n       }\n}\n</code></pre>    Variable name Type Description     <code>providers</code> dictionary <code>{ 'metadirectory': {  'config_ref': 'coporateconfig',  'enabled': True  }}</code>"},{"location":"2.0/config/authmetaexplicit/#metadirectory-provider-configuration","title":"<code>metadirectory</code> provider configuration","text":"<p>The <code>metadirectory</code> provider is defined as a dictionnary object and must contain key name. The key name must be set as the name of a dictionaryin the <code>config_ref</code>.</p> <p>A <code>metadirectory</code> provider must contain a ldap attribut to describe the original DOMAIN and sAMaccountName. The ldap attribut is defined as <code>join_key_ldapattribut</code>.</p> <pre><code>coporateconfig : { 'metadirectory': {  \n                    'domain'        : 'CORPORATE',\n                    'ldap_basedn'   : 'DC=foo,DC=corporate,DC=local',\n                    'ldap_fqdn'     : '_ldap._tcp.foo.corporate.local',\n                    'servers'       : [ 'ldap://192.168.9.11', 'ldap://192.168.7.12', 'ldap://192.168.7.13' ],\n                    # join_key_ldapattribut must be defined for a metadirectory provider\n                    'join_key_ldapattribut' : 'description',\n                    'auth_type'  : 'KERBEROS',\n                    'domain_fqdn': 'foo.corporate.local',\n                    'kerberos_realm': 'FOO.CORPORATE.LOCAL',\n                    # serviceaccount must be defined for a metadirectory provider\n                    'serviceaccount': { 'login': 'svcaccount', 'password':'superpass' }\n                 } } \n</code></pre> <p>Pyos binds the metadirectory ldap server with serviceaccount credentials Pyos read the ldap attribut <code>description</code> value to get the user's trusted domain.</p> <p>For example :</p> <pre><code>description: AD\\john\n</code></pre> <p>Then pyos look for provider <code>AD</code> configuration and process authentification on domain <code>AD</code></p> <p>The <code>metadirectory</code> accounts can be disabled.  The ldap attribut <code>userAccountControl</code> is not read on metaDirectory provider. The account can have the bit <code>UF_ACCOUNT_DISABLE</code> set or not.</p> <p>A service account must defined for a <code>metadirectory</code> provider. The service account is used to bind the metadirectory.</p>"},{"location":"2.0/config/authmetaexplicit/#complete-example-with-a-metadirectory-provider-and-active-directory-user-domain","title":"Complete example with a <code>metadirectory</code> provider and active directory user domain","text":"<p>The user's domain mane is AD. The meta domain name is CORPORATE. The meta domain use a dedicated attribut <code>join_key_ldapattribut</code></p> <pre><code>authmanagers: {\n  #\n  # define the meta explicit manager\n  # This is the trusted external forest for the followed domain\n  #\n  'metaexplicit': {\n    'providers': {\n      # define the metadirectory provider\n      # only one metadirectory provider is supported \n      'metadirectory': { \n        'config_ref': 'coporateconfig', \n        'enabled': True } \n    }\n  },\n\n  #        \n  # define the Active Directory provider for each DOMAIN\n  # define two domains in two disctinct forest with a trust relationship \n  # \n  'explicit': { \n    # define an Active Directory provider AD \n    'AD': {  'config_ref': 'adconfig', 'enabled': True },\n    # define an Active Directory provider ANOTHER\n    'ANOTHER': { 'config_ref': 'anotherconfig', 'enabled': True }  \n  }\n} # end of authmanagers\n\n# In this example ldap attribut's description contains AD\\myuser or ANOTHER\\myuser \ncoporateconfig : { 'metadirectory': {  \n                    'domain'        : 'CORPORATE',\n                    'ldap_basedn'   : 'DC=foo,DC=corporate,DC=local',\n                    'ldap_fqdn'     : '_ldap._tcp.foo.corporate.local',\n                    'servers'       : [ 'ldap://192.168.9.11', 'ldap://192.168.7.12', 'ldap://192.168.7.13' ],\n                    # join_key_ldapattribut must be defined for a metadirectory provider\n                    'join_key_ldapattribut' : 'description',\n                    'auth_type'  : 'KERBEROS',\n                    'domain_fqdn': 'foo.corporate.local',\n                    'kerberos_realm': 'FOO.CORPORATE.LOCAL',\n                    # serviceaccount must be defined for a metadirectory provider\n                    'serviceaccount': { 'login': 'svcaccount', 'password':'superpass' }\n                 } }\n\n\n# \n# define the first DOMAIN AD\n# The adconfig ref for domain AD\n#\nadconfig : { 'AD': {  'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                      'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                      'domain'        : 'AD',\n                      'auth_type'     : 'NTLM',\n                      'domain_fqdn'   : 'AD.DOMAIN.LOCAL',\n                      'servers'       : [ 'ldap://192.168.7.12' ] } }\n\n#\n# define the second DOMAIN ANOTHER\n# The anotherconfig ref for domain ANOTHER\n#\nanotherconfig : { 'ANOTHER': {\n                      'ldap_basedn'   : 'DC=another,DC=super,DC=local',\n                      'ldap_fqdn'     : '_ldap._tcp.another.super.local',\n                      'domain'        : 'ANOTHER',\n                      'auth_type'     : 'KERBEROS',\n                      'domain_fqdn'   : 'ANOTHER.SUPER.LOCAL',\n                      'servers'       : [ 'ldap://192.168.10.12' ],\n                      'kerberos_realm': 'AD.SUPER.LOCAL' } }\n</code></pre>"},{"location":"2.0/config/authmetaexplicit/#metadirectorysupport","title":"<code>metadirectory</code>support","text":"<p><code>metadirectory</code> support the foreign security principal (FSP) to query security principal in the trusted external forest. These objects are created in the foreign security principals container of the domain. <code>metadirectory</code> support <code>isMemberOf</code> on foreign security principal. </p> <p>The user's <code>SID</code> of domain  'AD' or 'ANOTHER' is NOT read. A new ldap bind is done using the trusted domain on metadirectory provider and not unsing the service account.</p> <p>The ldap query is build : ( \"search_base={q.basedn}, search_scope={q.scope}, search_filter={filter}\" )</p> <p>To get more information about foreign security principal (FSP), read :</p> <ul> <li> <p>Foreign Security Principals Container</p> </li> <li> <p>Active Directory: Foreign Security Principals and Special Identities</p> </li> </ul>"},{"location":"2.0/config/balloon/","title":"balloon user entry in od.config","text":"<p><code>balloon</code> is the default generic user.</p> <p>The <code>balloon</code> user is created inside the oc.user container</p> <p>The default values are </p>    balloon Default Values     <code>name</code> <code>balloon</code>   <code>uid</code> <code>4096</code>   <code>gid</code> <code>4096</code>   <code>homedirectory</code> <code>/home/balloon</code>    <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre>"},{"location":"2.0/config/controllers/","title":"Controllers","text":""},{"location":"2.0/config/controllers/#controllers_1","title":"Controllers","text":"<p>abcdesktop.io use a Model\u2013view\u2013controller (usually known as MVC) is a software design pattern commonly used for developing user interfaces which divides the related program logic into three interconnected elements. This is done to separate internal representations of information from the ways information is presented to and accepted from the user.</p>    Controller Description     <code>AccountingController</code> accounting data json and ebnf format   <code>AuthController</code> authenticate user   <code>ComposerController</code> CRUD main services (like createDesktop, runApplication)   <code>CoreController</code> get configuration and user message info   <code>ManagerController</code> manage pyos   <code>PrinterController</code> CRUD printer object   <code>StoreController</code> CRUD key value data   <code>UserController</code> retrieve user information"},{"location":"2.0/config/controllers/#access-permission","title":"Access Permission","text":"<p>The <code>AccountingController</code> and <code>ManagerController</code> access is protected with a source ip address filter. The access control filter is defined in a dictionary. Each dictionary entry use the <code>controller</code> name and with an entry <code>permitip</code>. The <code>permitip</code> is a list of subnet, for example <code>[ '10.0.0.0/8', '172.16.0.0/12' ]</code>. If <code>permitip</code> is not set or the <code>controller</code> name is not set, all ip source address are allowed the send a request to the controller.</p> <p>The <code>controllers</code> dictionnary is defined in the <code>od.config</code> file.  By default the configuration permit private network defined in rfc1918 and rfc4193. Get more information about the private network.</p> <p>By default others controllers access is enabled, without ip restriction.</p> <pre><code>    controllers : { \n        'AccountingController': \n            { \n                'permitip': [ '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', 'fd00::/8', '169.254.0.0/16', '127.0.0.0/8' ] \n            },\n        'AuthController' :      { 'permitip': None },\n        'ComposerController' :  { 'permitip': None },\n        'CoreController' :      { 'permitip': None },\n        'ManagerController': \n            { \n                'permitip': [ '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', 'fd00::/8', '169.254.0.0/16', '127.0.0.0/8' ] \n            },\n        'PrinterController' :   { 'permitip': None },\n        'StoreController' :     { 'permitip': None },\n        'UserController' :      { 'permitip': None }\n    } \n</code></pre> <p>If the source ip address is not allowed, the response is a HTTP status <code>code 403 Forbidden</code></p> <pre><code>{\"status\": 403, \"status_message\": \"403 Forbidden\", \"message\": \"Request forbidden -- authorization will not help\"} \n</code></pre>"},{"location":"2.0/config/desktop/","title":"desktop options in od.config","text":"<p>The od.config contains options to describe how the oc.user and applications containers have to be created. Options differ if abcdesktop.io is running in <code>docker mode</code> or in <code>kubernetes mode</code>.</p>"},{"location":"2.0/config/desktop/#desktopoptions","title":"desktop.options","text":"<p>All desktop options are defined in od.config file. Desktop options start with the prefix <code>desktop.</code>, then add the name of the option.</p>    Option name Type Sample     <code>desktop.usex11unixsocket</code> boolean True   <code>desktop.defaultbackgroundcolors</code> list [ '#6EC6F0', '#333333',  '#666666', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]   <code>desktop.homedirectorytype</code> string 'volume'   <code>desktop.remotehomedirectorytype</code> list []   <code>desktop.persistentvolumeclaim</code> string None   <code>desktop.allowPrivilegeEscalation</code> boolean False   <code>desktop.securityopt</code> list [ 'no-new-privileges', 'seccomp=unconfined' ]   <code>desktop.imagePullSecret</code> string None   <code>desktop.image</code> string 'abcdesktopio/oc.user.18.04:latest'   <code>desktop.imageprinter</code> string 'abcdesktopio/oc.cupsd.18.04:latest'   <code>desktop.useprintercontainer</code> boolean False   <code>desktop.soundimage</code> string 'abcdesktopio/oc.pulseaudio.18.04'   <code>desktop.usesoundcontainer</code> boolean False   <code>desktop.usecontainerimage</code> boolean False   <code>desktop.initcontainerimage</code> string 'abcdesktopio/oc.busybox'   <code>desktop.envlocal</code> dictionary <code>{ 'DISPLAY': ':0.0', 'USER': 'balloon', 'LIBOVERLAY_SCROLLBAR': '0', 'UBUNTU_MENUPROXY': '0', 'HOME': '/home/balloon', 'LOGNAME': 'balloon' }</code>   <code>desktop.nodeselector</code> dictionary <code>{}</code>   <code>desktop.username</code> string 'balloon'   <code>desktop.userid</code> integer 4096   <code>desktop.groupid</code> integer 4096   <code>desktop.userhomedirectory</code> string <code>'/home/balloon'</code>   <code>desktop.useinternalfqdn</code> boolean False   <code>desktop.uselocaltime</code> boolean False   <code>desktop.host_config</code> dictionary <code>{  'auto_remove'   : True, 'ipc_mode'      : 'shareable', 'network_mode'  : 'container', 'shm_size'      : '128M', 'mem_limit'     : '512M', 'cpu_period'    : 100000, 'cpu_quota'     : 150000, 'security_opt'  : [ 'seccomp=unconfined' ] }</code>   <code>desktop.application_config</code> dictionary <code>{  'auto_remove'   : True, 'ipc_mode'      : 'shareable', 'pid_mode'      : True, 'network_mode'  : 'container', 'shm_size'      : '512M', 'mem_limit'     : '2G', 'cpu_period'    : 200000, 'cpu_quota'     : 150000, 'security_opt'  : [ 'seccomp=unconfined' ] }</code>   <code>desktop.policies</code> dictionary <code>{ 'rules':{}, 'max_app_counter':5 }</code>   <code>desktop.webhookdict</code> dictionary <code>{ 'firewall': '192.168.7.1' }</code>"},{"location":"2.0/config/desktop/#desktopusex11unixsocket","title":"desktop.usex11unixsocket","text":"<p>The <code>desktop.usex11unixsocket</code> force the X11 server to use local unix socket. The name of the X11 unix socket is <code>/tmp/.X11-unix/X0</code></p> <ul> <li> <p>If this feature is enable: A container application need a the DISPLAY. The DISPLAY is in this case <code>:0.0</code>. The container application and the oc.user container share the same volume <code>/tmp</code>, and share the X11 unix socket is <code>/tmp/.X11-unix/X0</code>.</p> </li> <li> <p>If this feature is disable: A container application need a DISPLAY. The DISPLAY is <code>:0.0</code> (don't think at <code>IPADDRESS_OF_X11_SERVER:0.0</code> to protect X11 access control). The two containers share the same network stack by default. The X11 server NEED to listen to a TCP or UDP port.</p> </li> </ul> <p>You can disable this features, but you have to replace the default  TigerVNC by another X11 Server and a VNC Server. You can choose (x.org + x11vnc) for example, but you need more CPU ressource than TigerVNC.  </p> <p>TigerVNC does not support to listen on TCP Port. TigerVNC is a X11 and a VNC Server.</p> <p>Set the <code>desktop.usex11unixsocket</code> value to <code>True</code> in most case, and this should not be changed.</p>"},{"location":"2.0/config/desktop/#desktopshareipcnamespace","title":"desktop.shareipcnamespace","text":"<p>The type of desktop.shareipcnamespace is a string. The default value is 'shareable' This option permit user contain to share the ipc namespace with application</p>    Value Description     <code>''</code> Use daemon\u2019s default.   <code>'none'</code> Own private IPC namespace, with /dev/shm not mounted.   <code>'private'</code> Own private IPC namespace.   <code>'shareable'</code> Own private IPC namespace, with a possibility to share it with other containers.   <code>'host'</code> Use the host system\u2019s IPC namespace.    <p>If not specified, daemon default is used, which can either be <code>'private'</code> or <code>'shareable'</code>, depending on the daemon version and configuration. IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments, semaphores and message queues. </p> <p>Shared memory segments are used to accelerate inter-process communication at memory speed, rather than through pipes or through the network stack. Shared memory is commonly used by databases and custom-built (typically C/OpenMPI, C++/using boost libraries) high performance applications for scientific computing and financial services industries. </p> <p>If these types of applications are broken into multiple containers, you might need to share the IPC mechanisms of the containers, using \"shareable\" mode for the main (i.e. \u201cdonor\u201d) container, and containers can access \"container:\". <p>Default value <code>desktop.shareipcnamespace : 'shareable'</code></p>"},{"location":"2.0/config/desktop/#desktophomedirectory","title":"desktop.homedirectory","text":"<p>This option describes how the default home directory for user user ballon should be created :</p> <ul> <li><code>None</code>: no dedicated volume is created, the oc.user container use a directory inside the container. All user data will be removed at logout.</li> <li><code>'volume'</code>: This value is only recommended in docker mode. <code>'volume'</code>option create a dedicated volume, the oc.user container and applications may share this volume. User home data are persistent.</li> <li><code>'persistentVolumeClaim'</code>: This value is only avalaible in kubernetes. PersistentVolumeClaim option use a persistentVolumeClaim to create the user home directory. The persistentVolumeClaim can be mapped to differents storage data (like NFS, iSCSI, RBD...). Read more about persistentVolumeClaim on the kubernetes.io website. You need the set the value of <code>desktop.persistentvolumeclaim</code> or create a default Persistent Volume Claim named <code>'abcdesktop-pvc'</code></li> </ul>"},{"location":"2.0/config/desktop/#desktoppersistentvolumeclaim","title":"desktop.persistentvolumeclaim","text":"<p>This value is only avalaible in kubernetes mode.</p> <p><code>desktop.persistentvolumeclaim</code> is the name of the Persistent Volume Claim if the <code>desktop.homedirectory</code> is set to <code>'persistentVolumeClaim'</code>. The PVC (Persistent Volume Claim) must exist.</p> <p>Run the <code>kubectl get pvc command</code> to list the persistent volume claim</p> <pre><code>NAME                                   STATUS   VOLUME                     CAPACITY   ACCESS MODES   STORAGECLASS           AGE\nabcdesktop-pvc                        Bound    abcdesktop-pv             5Gi        RWO            abcdesktop-standard   170d\n</code></pre>"},{"location":"2.0/config/desktop/#desktopremotehomedirectorytype","title":"desktop.remotehomedirectorytype","text":"<p>desktop.remotehomedirectorytype is a list of string. Each string describe if the remount access to a directory is allowed. example [ 'cifs', 'webdav' ]</p> <p>For each entry in the desktop.remotehomedirectorytype list, abcdesktop.io try to mount the remote file system using data from the implicit auth provider.</p> <p>If <code>desktop.remotehomedirectorytype</code> contains 'cifs' and if the authentification provider get <code>homeDrive</code> and <code>homeDirectory</code> attributs then abcdesktop request the kubernetes abcdesktop/CIFS Driver to mount the remote filesystem. The user find a mount point named <code>homeDrive</code> value, and mounted to <code>homeDirectory</code>.</p>"},{"location":"2.0/config/desktop/#desktopallowprivilegeescalation","title":"desktop.allowPrivilegeEscalation","text":"<p>The <code>desktop.allowPrivilegeEscalation</code> option allow a user to run a sudo command. The execve system call can grant a newly-started program privileges that its parent did not have, such as the setuid or setgid Linux flags.</p> <p>The default value is <code>False</code>  You should only set <code>desktop.allowPrivilegeEscalation</code> to run <code>sudo</code> command.</p> <p>In production this value MUST be set to <code>False</code></p>"},{"location":"2.0/config/desktop/#desktopdefaultbackgroundcolors","title":"desktop.defaultbackgroundcolors","text":"<p>The <code>desktop.defaultbackgroundcolors</code> allow you to change the default background color.</p> <p>The default value is a list of string <code>[ '#6EC6F0', '#333333',  '#666666', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]</code></p> <p>The <code>desktop.defaultbackgroundcolors</code> length can contain up to 8 entries. To see the color </p> <p>Open the url http://localhost, in your web browser, to start a simple abcdesktop.io container. </p> <pre><code>http://localhost\n</code></pre> <p>You should see the abcdesktop.io home page.</p> <p>Press the <code>Connect with Anonymous access, have look</code></p> <p>At the right top corner, click on the menu and choose <code>Settings</code>, then click on <code>Screen Colors</code></p> <p>You should see the default background colors, for example : </p>"},{"location":"2.0/config/desktop/#desktopimagepullsecret","title":"desktop.imagePullSecret","text":"<p>The <code>desktop.imagePullSecret</code> is the name of the secret used by Kubernetes to access to the private registry. The type of <code>desktop.imagePullSecret</code> is a string. This option is only available in Kubernetes mode, and anly used if you need to store the abcdesktop docker image on a private registry. </p> <ul> <li>Example to build a registry Kubernetes secret named abcdesktopregistrysecret with the docker hub.</li> </ul> <pre><code>kubectl create secret docker-registry abcdesktopregistrysecret --docker-server=https://index.docker.io/v1/ --docker-username=XXXXXXX --docker-password=YYYYYYYU\n</code></pre> <ul> <li>Example to build a registry Kubernetes secret named abcdesktopregistrysecret with your own privateregistry</li> </ul> <pre><code>kubectl create secret docker-registry abcdesktopregistrysecret --docker-server=registry.mydomain.local:443 --docker-username=XXXXXXX --docker-password=YYYYYYYU\n</code></pre>"},{"location":"2.0/config/desktop/#desktopimage","title":"desktop.image","text":"<p>The <code>desktop.image</code> is the name of the X11 server container The default value is <code>abcdesktopio/oc.user.18.04</code></p>"},{"location":"2.0/config/desktop/#desktopprinterimage","title":"desktop.printerimage","text":"<p>The <code>desktop.printerimage</code> is the name of the  printer container The default value is <code>abcdesktopio.oc.cupds.18.04</code></p>"},{"location":"2.0/config/desktop/#desktopuseprintercontainer","title":"desktop.useprintercontainer","text":"<p>The <code>desktop.useprintercontainer</code> is boolean, to use printer <code>cupsd</code> service as an separated container. This value is only available in kubernetes mode.  The default value is <code>False</code>.</p>"},{"location":"2.0/config/desktop/#desktopsoundimage","title":"desktop.soundimage","text":"<p>The <code>desktop.soundimage</code> is the name of the sound container image The default value is <code>abcdesktopio/oc.pulseaudio.18.04</code></p>"},{"location":"2.0/config/desktop/#desktopusesoundcontainer","title":"desktop.usesoundcontainer","text":"<p>The <code>desktop.usesoundcontainer</code> is boolean, to use pulseaudio service as a separated container. This value is only available in kubernetes mode. The default value is <code>False</code>.</p>"},{"location":"2.0/config/desktop/#desktopuseinitcontainer","title":"desktop.useinitcontainer","text":"<p>The <code>desktop.useinitcontainer</code> is boolean, to use init container. The default value is <code>False</code>. The code call the <code>desktop.initcontainercommand</code> list .</p> <p>The initcontainerimage is a busybox shell, for example to make sure that the home directory belongs to user balloon. </p>  <p><code>/home/balloon</code> must belong to <code>balloon</code> default user and <code>balloon</code> default group.</p>"},{"location":"2.0/config/desktop/#desktopinitcontainercommand","title":"desktop.initcontainercommand","text":"<p>The <code>desktop.initcontainercommand</code> runs the command at init container. The default value is <code>None</code>, the default type is <code>list</code>.</p> <p>desktop.initcontainercommand example :</p> <pre><code>desktop.initcontainercommand : [ 'sh', '-c', 'chown 4096:4096 /home/balloon' ]\n</code></pre> <p>This option is used when presistent volume data mount a nfs storage. The uid and gid of /home/balloon must be set to the default value of <code>(balloon:balloon) (4096:4096)</code>. </p>"},{"location":"2.0/config/desktop/#desktopinitcontainerimage","title":"desktop.initcontainerimage","text":"<p>The <code>desktop.initcontainerimage</code> is the name of the init container image. The default value is <code>busybox</code>. </p>"},{"location":"2.0/config/desktop/#desktopenvlocal","title":"desktop.envlocal","text":"<p><code>desktop.envlocal</code> is a dictionary. <code>desktop.envlocal</code> contains a (key,value) added as environment variables to oc.user.</p> <p>The default value is :</p> <pre><code>{ \n        'DISPLAY': ':0.0', \n        'USER': 'balloon', \n        'LIBOVERLAY_SCROLLBAR': '0',\n        'WINEARCH': 'win32',\n        'UBUNTU_MENUPROXY': '0',\n        'HOME': '/home/balloon',\n        'LOGNAME': 'balloon',\n        'PULSE_SERVER: '/tmp/.pulse.sock', \n        'CUPS_SERVER': '/tmp/.cups.sock' \n}\n</code></pre>  <p>Add <code>'CUPS_SERVER: '/tmp/.cups.sock'</code>  only if <code>desktop.useprintercontainer</code> is True. Add <code>'PULSE_SERVER: '/tmp/.pulse.sock'</code> only if <code>desktop.usesoundcontainer</code> is True.</p>"},{"location":"2.0/config/desktop/#desktopnodeselector","title":"desktop.nodeselector","text":"<p><code>desktop.nodeselector</code> is a dictionary. This option permits to assign user pods to nodes. It specifies a map of key-value pairs. For the pod to be eligible to run on a node, the node must have each of the indicated key-value pairs as labels (it can have additional labels as well).  The most common usage is one key-value pair. </p> <pre><code>{ 'disktype': 'ssd' }\n</code></pre>"},{"location":"2.0/config/desktop/#desktopusername","title":"desktop.username","text":"<p><code>desktop.username</code> describes the balloon user created inside the oc.user container. The type of desktop.username is string. The default value is 'balloon'.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"2.0/config/desktop/#desktopuserid","title":"desktop.userid","text":"<p><code>desktop.userid</code> describes the <code>uid</code> of the user created inside the oc.user container.     The type of desktop.userid is integer. The default value is 4096.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"2.0/config/desktop/#desktopgroupid","title":"desktop.groupid","text":"<p><code>desktop.groupid</code> describes the <code>gid</code> of the user created inside the oc.user container. The type of desktop.userid is integer. The default value is 4096.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>RUN groupadd --gid 4096 $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"2.0/config/desktop/#desktopuserhomedirectory","title":"desktop.userhomedirectory","text":"<p><code>desktop.userhomedirectory</code> describes the <code>homedirectory</code> of the user created inside the oc.user container. The type of <code>desktop.userhomedirectory</code> is string. The default value is <code>/home/balloon</code>.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"2.0/config/desktop/#desktopuselocaltime","title":"desktop.uselocaltime","text":"<p>The <code>desktop.uselocaltime</code> is boolean, to use host value of <code>/etc/localtime</code>. The default value is <code>False</code>. If <code>desktop.uselocaltime</code> is True, this add a volume mapping from host file  <code>/etc/localtime</code> to container file <code>/etc/localtime</code>.</p>"},{"location":"2.0/config/desktop/#desktoppolicies","title":"desktop.policies","text":"<p>The <code>desktop.policies</code> is a dictionary.</p>    Entry Description     <code>max_app_counter</code> limit applications counter, without checking the docker container status   <code>rules</code> rules dictionary <code>'rules': { 'volumes': { 'domainuser':  { 'type': 'cifs', 'name': 'homedirectory', 'volumename': 'homedir' } }</code>   <code>acl</code> allow or denied desktop creation    <p>Example</p> <pre><code>desktop.policies: { 'rules':\n    { 'volumes': \n        { 'domainuser':  \n            { 'type': 'cifs', 'name': 'homedirectory', 'volumename': 'homedir' },\n            'Mygroupteam':  { 'type': 'cifs', 'name': 'toto', 'unc': '//192.168.7.101/team', 'volumename': 'team' } \n            } \n        },\n      'acls' : {},\n      'max_app_counter' : 4  }\n</code></pre>"},{"location":"2.0/config/desktop/#desktopapplication_config","title":"desktop.application_config","text":"<p>Default application host_config dictionary, maps the dictionary as arguments from docker API  create_host_config</p> <p>Define how the application can be run, read host_config  description page to get more informations</p>"},{"location":"2.0/config/desktop/#desktophost_config","title":"desktop.host_config","text":"<p>Default desktop oc.user host_config dictionary, maps the dictionary as arguments from docker API  create_host_config</p> <p>Define how the oc.user container can be run, read host_config description page to get more informations</p>"},{"location":"2.0/config/desktop/#desktopwebhookdict","title":"desktop.webhookdict","text":"<p>desktop.webhookdict is a dictionary to add key/value to the command <code>create</code> and <code>destroy</code> in rules objects.</p>"},{"location":"2.0/config/desktop/#experimental-features","title":"Experimental features","text":""},{"location":"2.0/config/desktop/#desktopdesktopuseinternalfqdn","title":"desktop.desktopuseinternalfqdn","text":"<p>WARNING <code>desktop.desktopuseinternalfqdn</code> is an experimental feature, keep this value to False in production</p> <p><code>desktop.desktopuseinternalfqdn</code> describes the content of the payload data in the JWT Desktop Token. The default value is <code>False</code>. </p> <p>Nginx front end act as a reverse proxy. This reverse proxy use the FQDN of the user's pod to route http request. If this value is set to <code>False</code> the payload data in the JWT Desktop Token contains the IP Address of the user Pod. If this value is set to <code>True</code> the payload data in the JWT Desktop Token contains the FQDN of the user Pod.</p> <p>If you CAN NOT add <code>endpoint_pod_names</code> in the coredns configuration, you MUST set <code>desktop.desktopuseinternalfqdn</code> to <code>False</code>. This choice is less secure.</p> <p>To set <code>desktop.desktopuseinternalfqdn</code> to <code>True</code> value, you have to update the <code>coredns</code> ConfigMap.</p> <pre><code>kind: ConfigMap\napiVersion: v1\nmetadata:\n  name: coredns\n  namespace: kube-system\ndata:\n  Corefile: |\n    .:53 {\n        log\n        errors\n        health\n        ready\n        kubernetes cluster.local in-addr.arpa ip6.arpa {\n           endpoint_pod_names\n           pods insecure\n           fallthrough in-addr.arpa ip6.arpa\n           transfer to * \n           ttl 30\n        }\n        prometheus :9153\n        forward . /etc/resolv.conf\n        cache 30\n        loop\n        reload\n        loadbalance\n    }\n</code></pre>"},{"location":"2.0/config/editconfig/","title":"How to edit <code>pyos</code> core service configuration file","text":""},{"location":"2.0/config/editconfig/#edit-your-configuration-file","title":"Edit your configuration file","text":"<p>Download the default od.config file and save it to your abcdesktop local directory.</p> <p>To make change, edit your own <code>od.config</code> file</p> <pre><code>vim od.config \n</code></pre> <p>Change the defaultbackgroundcolors option in the desktop options.</p> <p>Locate the line <code>desktop.defaultbackgroundcolors</code> and update the first entries with the values <code>'#FF0000', '#FFFFFF',  '#0000FF'</code></p> <pre><code>desktop.defaultbackgroundcolors : [ '#FF0000', '#FFFFFF',  '#0000FF', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]\n</code></pre> <p>Save your local <code>od.config</code> file.</p> <p>To apply changes, you can replace the <code>abcdesktop-config</code></p> <pre><code>kubectl delete configmap abcdesktop-config -n abcdesktop\nkubectl create --from-file=od.config -n abcdesktop\n</code></pre> <p>| you can also use the replace command <code>kubectl create configmap -n abcdesktop abcdesktop-config --from-file=od.config  -o yaml --dry-run | kubectl replace -n abcdesktop -f -</code></p> <p>Restart pyos daemonset</p> <pre><code>kubectl rollout restart daemonset daemonset-pyos -n abcdesktop\n</code></pre>"},{"location":"2.0/config/editconfig/#check-that-the-new-colours-are-presents-in-front","title":"Check that the new colours are presents in front :","text":"<p>Open the url <code>http://localhost:30443</code>, in your web browser, to start a simple abcdesktop.io container. </p> <pre><code>http://localhost:30443\n</code></pre> <p>You should see the abcdesktop.io home page.</p> <p>Press the <code>Sign-in Anonymously, have look</code></p> <p>At the right top corner, click on the menu and choose <code>Settings</code>, then click on <code>Screen Colors</code></p> <p>Choose your colour and you should have it as background colour :</p>  <p>Great, you can easily update your configuration file <code>od.config</code>. </p>"},{"location":"2.0/config/frontjs/","title":"dock configuration in od.config","text":""},{"location":"2.0/config/frontjs/#menu-setting","title":"Menu Setting","text":"<p>The menu can be changed using the dictionnary object <code>menuconfig</code></p> <pre><code>menuconfig : {\n    'settings'  : True, \n    'appstore'  : True, \n    'screenshot'    : True, \n    'download'  : True, \n    'logout'        : True, \n    'disconnect'    : True \n}\n</code></pre>"},{"location":"2.0/config/frontjs/#default-dock-config","title":"default dock config","text":"<p>The dock session in od.config file describe the default docker in abcdesktop.io. The default dock value contains the default applications. The <code>dock</code> option is a dictionnary read by the front web as a json object.</p>    docker entry Descriptions     <code>filemanager</code> FileManager application   <code>terminal</code> Terminal application   <code>webshell</code> HTML 5, terminal application based on xterm.js   <code>webshorcut</code> Web browser url launch inside the container    <pre><code>dock : {       \n    'filemanager':  {       'args': None,\n                            'showinview': u'dock',\n                            'name': u'FileManager',\n                            'keyword': u'files,file manager',\n                            'launch': u'nautilus.Nautilus',\n                            'displayname': u'FileManager',\n                            'execmode': u'builtin',\n                            'cat': u'utilities,office',\n                            'id': u'filemanager.d',\n                            'icon': u'pantheon-files-icons.svg' },\n    'terminal':     {       'args': '',\n                            'name': u'TerminalBuiltin',\n                            'keyword': u'terminal,shell,bash,builtin,pantheon',\n                            'launch': u'qterminal.qterminal',\n                            'displayname': u'Terminal Builtin',\n                            'execmode': u'builtin',\n                            'cat': u'utilities,development',\n                            'id': u'terminalbuiltin.d',\n                            'hideindock': True,\n                            'icon': u'pantheon-terminal-builtin-icons.svg' },\n\n    'webshell':     {       'name': u'WebShell',\n                            'keyword': u'terminal,shell,webshell,bash',\n                            'launch': u'frontendjs.webshell',\n                            'displayname': u'Web Shell',\n                            'execmode': u'frontendjs',\n                            'cat': u'utilities,development',\n                            'id': u'webshell.d',\n                            'icon': u'webshell.svg' }\n}\n</code></pre>"},{"location":"2.0/config/frontjs/#additional-applications","title":"Additional applications","text":"<p>This feature is deprecated. To run embeded application inside the oc.user image container, with specific attribut <code>{ 'execmode': 'builtin' }</code> add </p> <pre><code>'webshortcut':  {   'name': u'xlogo',\n                    'showinview': u'dock',\n                    'keyword': u'xlogo',\n                    'execmode': u'builtin',\n                    'launch': u'/usr/bin/xlogo',\n                    'displayname': u'xlogo',\n                    'execmode': u'builtin',\n                    'cat': u'utilities',\n                    'id': u'xlogo.d',\n                    'icon': u'xlogo.svg',\n                    'hideindock': False,\n                    'args': '' \n}\n</code></pre>"},{"location":"2.0/config/host_config/","title":"host_config resource description","text":"<p><code>host_config</code> resource description allows to change the running context for docker application. <code>host_config</code> is a dictionary and uses the same format in <code>applist.json</code> file and <code>od.config</code> file.</p> <p>The same <code>host_config</code> format is reused in a multiple configuration files. <code>host_config</code> is present in <code>applist.json</code> file to build application image, and in <code>od.config</code> to set default running values in desktop and in application.</p> <p>For example you can set low cpu and memory values to an application like the great X11 xeyes.</p> <pre><code>{   \n    \"mem_limit\":  \"32M\", \n    \"shm_size\":   \"OM\", \n    \"cpu_period\":  50000, \n    \"cpu_quota\":   50000, \n    \"pid_mode\":   false, \n    \"network_mode\": \"none\" \n}\n</code></pre>"},{"location":"2.0/config/host_config/#host_config-entries","title":"host_config entries","text":"Key name Type Description     <code>auto_remove</code> bool enable auto removal of the container on daemon side when the container\u2019s process exits.   <code>cpu_period</code> int The length of a CPU period in microseconds.   <code>cpu_quota</code> int Microseconds of CPU time that the container can get in a CPU period.   <code>cpu_shares</code> int CPU shares relative weight.   <code>cpuset_cpus</code> str CPUs in which to allow execution 0 3 0 1 .   <code>cpuset_mems</code> str Memory nodes    MEMs in which to allow execution 0 3 0 1. Only effective on NUMA systems.   <code>device_cgroup_rules</code> list A list of cgroup rules to apply to the container.   <code>device_read_bps</code> bytes per second Limit read rate from a device in the form of: [{\u201cPath\u201d: \u201cdevice_path\u201d \u201cRate\u201d: rate}]   <code>device_read_iops</code> IO per second Limit read rate from a device.   <code>device_write_bps</code> bytes per second Limit write rate from a device.   <code>device_write_iops</code> IO per second Limit write rate from a device.   <code>devices</code> list Expose host devices to the container as a list of strings in the form ::. For example /dev/sda:/dev/xvda:rwm allows the container to have read write access to the host\u2019s /dev/sda via a node named /dev/xvda inside the container.   <code>device_requests</code> list Expose host resources such as GPUs to the container as a list of docker.types.DeviceRequest instances.   <code>ipc_mode</code> str Set the IPC mode for the container.   <code>mem_limit</code> float or str Memory limit. Accepts float values which represent the memory limit of the created container in bytes or a string with a units identification char 100000b 1000k 128m 1g.   <code>mem_reservation</code> float or str Memory soft limit   <code>mem_swappiness</code> int Tune a container s memory swappiness behavior. Accepts number between 0 and 100.   <code>memswap_limit</code> str or int Maximum amount of memory + swap a container is allowed to consume.   <code>oom_kill_disable</code> bool Whether to disable OOM killer.   <code>oom_score_adj</code> int An integer value containing the score given to the container in order to tune OOM killer preferences.   <code>shm_size</code> str or int Size of /dev/shm e.g. 1G.   <code>cap_add</code> list of str Add kernel capabilities.  <code>{ 'add': [ 'SYS_ADMIN', 'SYS_PTRACE' ]}</code>for example to permit the call ptrace: <code>SYS_PTRACE</code>, trace arbitrary processes using ptrace, and <code>SYS_ADMIN</code>, perform a range of system administration operations. Read the docker run command informations https://docs.docker.com/engine/reference/run/ chapter Runtime privilege and Linux capabilities   <code>cap_drop</code> list of str Drop kernel capabilities.   <code>dns</code> list Set custom DNS servers.   <code>dns_opt</code> list Additional options to be added to the container\u2019s resolv.conf file   <code>dns_search</code> list DNS search domains.   <code>extra_hosts</code> dict Additional hostnames to resolve inside the container as a mapping of hostname to IP address.   <code>group_add</code> list List of additional group names and/or IDs that the container process will run as.   <code>isolation</code> str Isolation technology to use. Default: None.   <code>pid_mode</code> str  or bool If set to hostuse the host PID namespace inside the container. If set to host, use the host PID namespace inside the container.   <code>pids_limit</code> int Tune a container\u2019s pids limit. Set -1 for unlimited.   <code>privileged</code> bool Give extended privileges to this container.   <code>security_opt</code> list A list of string values to customize labels for MLS systems such as SELinux.   <code>storage_opt</code> dict Storage driver options per container as a key value mapping.   <code>sysctls</code> dict Kernel parameters to set in the container.   <code>ulimits</code> list Ulimits to set inside the container as a list of docker.types.Ulimit instances.   <code>userns_mode</code> str Sets the user namespace mode for the container when user namespace remapping option is enabled. Supported values are: host   <code>uts_mode</code> str Sets the UTS namespace mode for the container. Supported values are: host   <code>runtime</code> str Runtime to use with this container.   <code>network_mode</code> str One of: bridge Create a new network stack for the container on the bridge network. none No networking for this container. container: Reuse another container\u2019s network stack. host Use the host network stack. This mode is incompatible with port_bindings."},{"location":"2.0/config/host_config/#main-host_config-entries-descriptions","title":"Main host_config entries descriptions","text":""},{"location":"2.0/config/host_config/#auto_remove","title":"<code>auto_remove</code>","text":"<p>The <code>auto_remove</code> is use to remove or not remove an abcdesktop container application or desktop.</p>  <p>For example, when an application container is exited,  do we need to remove the container, by running the <code>docker rm</code> command ?</p>  <p>By default the auto_remove is <code>True</code>. But if you need to keep your application container to post-mortem debugging or to get some value, set this value to <code>False</code>. Set this value to <code>False</code> only to troubleshoot an application. </p> <p>In production this value MUST be set to <code>True</code></p>"},{"location":"2.0/config/host_config/#cpu_period-cpu_quota","title":"<code>cpu_period</code> <code>cpu_quota</code>","text":"<p><code>cpu_period</code> Specify the CPU CFS scheduler period, which is used alongside --cpu-quota. Defaults to 100000 microseconds (100 milliseconds). Most users do not change this from the default. </p> <p><code>cpu-quota</code> impose a CPU CFS quota on the container. The number of microseconds per --cpu-period that the container is limited to before throttled. As such acting as the effective ceiling. </p>"},{"location":"2.0/config/host_config/#privileged","title":"<code>privileged</code>","text":"<p>The <code>privileged</code> option runs a user container in <code>privileged</code> mode. When the operator executes docker run privileged, docker will enable access to all devices on the host as well as set some configuration in AppArmor or SELinux to allow the container nearly all the same access to the host as processes running outside containers on the host.allow a user to run a sudo command. The default value is <code>False</code>. You should only set privilege to True for troobleshooting. In production this value MUST be set to False.</p>"},{"location":"2.0/config/host_config/#ipc_mode","title":"<code>ipc_mode</code>","text":"<p>The <code>ipc_mode</code> value is a string, the default value is <code>'shareable'</code>. This option permits user's container to share the ipc namespace with application This option is used by pulseaudio service by default. </p>    value description     <code>''</code> Use daemon default.   <code>'none'</code> Own private IPC namespace.   <code>'private'</code> Own private IPC namespace.   <code>'shareable'</code> Own private IPC namespace, with a possibility to share it with other containers.   <code>'host'</code> Use the host system IPC namespace.    <p>If not specified, daemon default is used, which can either be \"private\" or \"shareable\", depending on the daemon version and configuration. IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments, semaphores and message queues. Shared memory segments are used to accelerate inter-process communication at memory speed, rather than through pipes or through the network stack. Shared memory is commonly used by databases and custom-built.  If these types of applications are broken into multiple containers, you might need to share the IPC mechanisms of the containers, using shareable mode for the main (i.e. donor) container, and container: for other containers."},{"location":"2.0/config/host_config/#security_opt","title":"<code>security_opt</code>","text":"<p>The <code>securityopt</code> option allow to set the <code>security_opt</code> default value for a docker application container. <code>security_opt</code> is the docker parameter.</p> <ul> <li>To run without the default seccomp profile <code>seccomp=unconfined</code></li> <li>To disable sudo command add <code>no-new-privileges</code> to the list. For example: <code>[ 'no-new-privileges', 'seccomp=unconfined' ]</code></li> </ul> <p>Docker's default seccomp profile is a whitelist which specifies the calls that are allowed. The table below lists the significant (but not all) syscalls that are effectively blocked because they are not on the whitelist. The table includes the reason each syscall is blocked rather than white-listed.</p>    Syscall Description     <code>acct</code> Accounting syscall which could let containers disable their own resource limits or process accounting. Also gated by <code>CAP_SYS_PACCT</code>.   <code>add_key</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>bpf</code> Deny loading potentially persistent bpf programs into kernel, already gated by <code>CAP_SYS_ADMIN</code>.   <code>clock_adjtime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>clock_settime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>clone</code> Deny cloning new namespaces. Also gated by <code>CAP_SYS_ADMIN</code> for CLONE_* flags, except <code>CLONE_USERNS</code>.   <code>create_module</code> Deny manipulation and functions on kernel modules. Obsolete. Also gated by <code>CAP_SYS_MODULE</code>.   <code>delete_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>finit_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>get_kernel_syms</code> Deny retrieval of exported kernel and module symbols. Obsolete.   <code>get_mempolicy</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>init_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>ioperm</code> Prevent containers from modifying kernel I/O privilege levels. Already gated by <code>CAP_SYS_RAWIO</code>.   <code>iopl</code> Prevent containers from modifying kernel I/O privilege levels. Already gated by <code>CAP_SYS_RAWIO</code>.   <code>kcmp</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>kexec_file_load</code> Sister syscall of <code>kexec_load</code> that does the same thing, slightly different arguments. Also gated by <code>CAP_SYS_BOOT</code>.   <code>kexec_load</code> Deny loading a new kernel for later execution. Also gated by <code>CAP_SYS_BOOT</code>.   <code>keyctl</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>lookup_dcookie</code> Tracing/profiling syscall, which could leak a lot of information on the host. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>mbind</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>mount</code> Deny mounting, already gated by <code>CAP_SYS_ADMIN</code>.   <code>move_pages</code> Syscall that modifies kernel memory and NUMA settings.   <code>name_to_handle_at</code> Sister syscall to <code>open_by_handle_at</code>. Already gated by <code>CAP_DAC_READ_SEARCH</code>.   <code>nfsservctl</code> Deny interaction with the kernel nfs daemon. Obsolete since Linux 3.1.   <code>open_by_handle_at</code> Cause of an old container breakout. Also gated by <code>CAP_DAC_READ_SEARCH</code>.   <code>perf_event_open</code> Tracing/profiling syscall, which could leak a lot of information on the host.   <code>personality</code> Prevent container from enabling BSD emulation. Not inherently dangerous, but poorly tested, potential for a lot of kernel vulns.   <code>pivot_root</code> Deny <code>pivot_root</code>, should be privileged operation.   <code>process_vm_readv</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>process_vm_writev</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>ptrace</code> Tracing/profiling syscall. Blocked in Linux kernel versions before 4.8 to avoid seccomp bypass. Tracing/profiling arbitrary processes is already blocked by dropping <code>CAP_SYS_PTRACE</code>, because it could leak a lot of information on the host.   <code>query_module</code> Deny manipulation and functions on kernel modules. Obsolete.   <code>quotactl</code> Quota syscall which could let containers disable their own resource limits or process accounting. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>reboot</code> Don't let containers reboot the host. Also gated by <code>CAP_SYS_BOOT</code>.   <code>request_key</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>set_mempolicy</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>setns</code> Deny associating a thread with a namespace. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>settimeofday</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>stime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>swapon</code> Deny start/stop swapping to file/device. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>swapoff</code> Deny start/stop swapping to file/device. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>sysfs</code> Obsolete syscall.   <code>_sysctl</code> Obsolete, replaced by /proc/sys.   <code>umount</code> Should be a privileged operation. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>umount2</code> Should be a privileged operation. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>unshare</code> Deny cloning new namespaces for processes. Also gated by <code>CAP_SYS_ADMIN</code>, with the exception of <code>unshare --user</code>.   <code>uselib</code> Older syscall related to shared libraries, unused for a long time.   <code>userfaultfd</code> Userspace page fault handling, largely needed for process migration.   <code>ustat</code> Obsolete syscall.   <code>vm86</code> In kernel x86 real mode virtual machine. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>vm86old</code> In kernel x86 real mode virtual machine. Also gated by <code>CAP_SYS_ADMIN</code>.    <p>Read security_opt from the docker website.</p>"},{"location":"2.0/config/host_config/#capabilities-cap_add-cap_drop","title":"capabilities <code>cap_add</code> <code>cap_drop</code>","text":"<p>This value is added to the oc.user docker container, or as securityContext attribut in kubernetes mode :</p> <pre><code>securityContext:\n      capabilities:\n        desktop.capabilities\n</code></pre> <p>For example </p> <pre><code>    { \n        'add': [ \"SYS_ADMIN\", \"SYS_PTRACE\" ]\n    }\n</code></pre> <p>Permit a container  to call ptrace:</p> <ul> <li>\"SYS_PTRACE\": Trace arbitrary processes using ptrace</li> <li>\"SYS_ADMIN\": Perform a range of system administration operations.</li> </ul> <p>Read the docker run command informations Docker run reference </p> <p>By default, Docker has a default list of capabilities that are kept. The following table lists the Linux capability options which can be added or dropped.</p>    Capability Key Capability Description     SETPCAP Modify process capabilities.   SYS_MODULE Load and unload kernel modules.   SYS_RAWIO Perform I/O port operations (iopl(2) and ioperm(2)).   SYS_PACCT Use acct(2), switch process accounting on or off.   SYS_ADMIN Perform a range of system administration operations.   SYS_NICE Raise process nice value (nice(2), setpriority(2)) and change the nice value for arbitrary processes.   SYS_RESOURCE Override resource Limits.   SYS_TIME Set system clock (settimeofday(2), stime(2), adjtimex(2)); set real-time (hardware) clock.   SYS_TTY_CONFIG Use vhangup(2); employ various privileged ioctl(2) operations on virtual terminals.   MKNOD Create special files using mknod(2).   AUDIT_WRITE Write records to kernel auditing log.   AUDIT_CONTROL Enable and disable kernel auditing; change auditing filter rules; retrieve auditing status and filtering rules.   MAC_OVERRIDE Allow MAC configuration or state changes. Implemented for the Smack LSM.   MAC_ADMIN Override Mandatory Access Control (MAC). Implemented for the Smack Linux Security Module (LSM).   NET_ADMIN Perform various network-related operations.   SYSLOG Perform privileged syslog(2) operations.   CHOWN Make arbitrary changes to file UIDs and GIDs (see chown(2)).   NET_RAW Use RAW and PACKET sockets.   DAC_OVERRIDE Bypass file read, write, and execute permission checks.   FOWNER Bypass permission checks on operations that normally require the file system UID of the process to match the UID of the file.   DAC_READ_SEARCH Bypass file read permission checks and directory read and execute permission checks.   FSETID Don't clear set-user-ID and set-group-ID permission bits when a file is modified.   KILL Bypass permission checks for sending signals.   SETGID Make arbitrary manipulations of process GIDs and supplementary GID list.   SETUID Make arbitrary manipulations of process UIDs.   LINUX_IMMUTABLE Set the FS_APPEND_FL and FS_IMMUTABLE_FL i-node flags.   NET_BIND_SERVICE Bind a socket to internet domain privileged ports (port numbers less than 1024).   NET_BROADCAST Make socket broadcasts, and listen to multicasts.   IPC_LOCK Lock memory (mlock(2), mlockall(2), mmap(2), shmctl(2)).   IPC_OWNER Bypass permission checks for operations on System V IPC objects.   SYS_CHROOT Use chroot(2), change root directory.   SYS_PTRACE Trace arbitrary processes using ptrace(2).   SYS_BOOT Use reboot(2) and kexec_load(2), reboot and load a new kernel for later execution.   LEASE Establish leases on arbitrary files (see fcntl(2)).   SETFCAP Set file capabilities.   WAKE_ALARM Trigger something that will wake up the system.   BLOCK_SUSPEND Employ features that can block system suspend.    <p>Further reference information is available on the capabilities(7) - Linux man page</p>  <p>Set this value only to troubleshoot an application. </p>  <p>In production this value MUST be set to an empty dict <code>{}</code></p>"},{"location":"2.0/config/jira/","title":"JIRA configuration","text":"<p>abcdesktop.io support JIRA </p>"},{"location":"2.0/config/jira/#jira-option","title":"JIRA option","text":"<p>In <code>od.config</code> add the <code>jira</code> option. <code>jira</code> option is a dictionary with the entries :</p>    entry sample value               \u00a0\u00a0     url https://domainexample.atlassian.net/   project_id ABCD   username account@domain.local   apikey XXXXXXXXXXXXXXXXXXXX    <p>And fill the dictionary </p> <pre><code>jira : { \n            'url':          'https://domainexample.atlassian.net/',\n            'project_id':   'ABCD',\n            'username':     'account@domain.local',\n            'apikey' :      'XXXXXXXXXXXXXXXXXXXX' }\n</code></pre> <p>Then apply the new configuration file <code>od.config</code> by retrasting the daemon.</p> <p>When <code>jira</code> option is set, a new icon <code>issue</code> appears at the top.</p>  <p>Click on the <code>issue</code> icon, a new window is appear.</p>  <p>Fill <code>Summary</code> and <code>Your Report</code> values</p>  <p>Then press the <code>Send</code> button. A notification message appears on the left top corner.</p>  <p>Log into your jira server, and check your backlog </p>  <p>Great you added a new issue tracking.</p>"},{"location":"2.0/config/language/","title":"Language entry in od.config","text":"<p>The language option is a list of string. Each string is formatted as a locale variable. The locale is simply the language/country combination <code>en + US = en_US</code></p>"},{"location":"2.0/config/language/#language-in-abcdesktopio-ocuser","title":"Language in abcdesktop.io oc.user","text":"<p>The language list must match with the oc.user local packages all ready installed.</p> <p>If the language is not found, the default value is set to <code>en_US</code></p> <p>The oc.user.18.04 is built-in with the default language package :</p> <ul> <li><code>language-pack-en</code> </li> <li><code>language-pack-fr</code></li> </ul> <pre><code>apt-get install -y \\\n    language-pack-en \\\n    language-pack-fr \\\n    &amp;&amp; locale-gen    \\\n    &amp;&amp; apt-get clean\n</code></pre> <p>The full supported language list is set by default </p> <pre><code>language : [  'af_ZA', 'am_ET', 'an_ES', 'ar_AE', 'ar_BH', 'ar_DZ', 'ar_EG', 'ar_IN', 'ar_IQ', 'ar_JO', 'ar_KW','ar_LB', 'ar_LY', 'ar_MA', 'ar_OM', 'ar_QA', 'ar_SA', 'ar_SD', 'ar_SY', 'ar_TN', 'ar_YE', 'as_IN', 'ast_ES', 'az_AZ', 'be_BY', 'bg_BG', 'bn_BD', 'bn_IN', 'bo_CN', 'bo_IN', 'br_FR', 'bs_BA', 'ca_AD', 'ca_ES', 'ca_FR', 'ca_IT', 'crh_UA', 'cs_CZ', 'cy_GB', 'da_DK', 'de_AT', 'de_BE', 'de_CH', 'de_DE', 'de_LI', 'de_LU', 'dz_BT', 'el_CY', 'el_GR', 'en_AG', 'en_AU', 'en_BW', 'en_CA', 'en_DK', 'en_GB', 'en_HK', 'en_IE', 'en_IN', 'en_NG', 'en_NZ', 'en_PH', 'en_SG', 'en_US', 'en_ZA', 'en_ZM', 'en_ZW', 'eo', 'eo_US', 'es_AR', 'es_BO', 'es_CL', 'es_CO', 'es_CR', 'es_CU', 'es_DO', 'es_EC', 'es_ES', 'es_GT', 'es_HN', 'es_MX', 'es_NI', 'es_PA', 'es_PE', 'es_PR', 'es_PY', 'es_SV', 'es_US', 'es_UY', 'es_VE', 'et_EE', 'eu_ES', 'eu_FR', 'fa_IR', 'fi_FI', 'fr_BE', 'fr_CA', 'fr_CH', 'fr_FR', 'fr_LU', 'ga_IE', 'gd_GB', 'gl_ES', 'gu_IN', 'he_IL', 'hi_IN', 'hr_HR', 'hu_HU', 'id_ID', 'is_IS', 'it_CH', 'it_IT', 'ja_JP', 'ka_GE', 'kk_KZ', 'km_KH', 'kn_IN', 'ko_KR', 'ku_TR', 'lt_LT', 'lv_LV', 'mai_IN', 'mk_MK', 'ml_IN', 'mn_MN', 'mr_IN', 'ms_MY', 'my_MM', 'nb_NO', 'nds_DE', 'nds_NL', 'ne_NP', 'nl_AW', 'nl_BE', 'nl_NL', 'nn_NO', 'oc_FR', 'or_IN', 'pa_IN', 'pa_PK', 'pl_PL', 'pt_BR', 'pt_PT', 'ro_RO', 'ru_RU', 'ru_UA', 'si_LK', 'sk_SK', 'sl_SI', 'sq_AL', 'sq_MK', 'sr_ME', 'sr_RS', 'sv_FI', 'sv_SE', 'ta_IN', 'ta_LK', 'te_IN', 'tg_TJ', 'th_TH', 'tr_CY', 'tr_TR', 'ug_CN', 'uk_UA', 'uz_UZ', 'vi_VN', 'xh_ZA', 'zh_CN', 'zh_HK', 'zh_SG', 'zh_TW' ]\n</code></pre> <p>This list must match with the <code>Accept-Language</code> request HTTP header.</p>"},{"location":"2.0/config/language/#language-in-abcdesktopio-applications","title":"Language in abcdesktop.io Applications","text":"<p>abcdesktop.io use the web browser language property to set the application's language. This list must match with the <code>Accept-Language</code> request HTTP header. If the language is not found, the default value is set to <code>en_US</code>.</p>  <p>Hands-on: </p> <p>Change your web browser language, and run LibreOffice applications. The language setting use the web browser value. During this exercice you can keep the same abcdesktop.io users session. </p>"},{"location":"2.0/config/language/#set-the-web-browsers-default-language-to-en_us","title":"Set the web browser's default language to <code>en_US</code> :","text":"<p> The launch LibreOffice Writer. The menu is set to <code>en_US</code>  LibreOffice Writer use English/US <code>en_US</code> language.</p>"},{"location":"2.0/config/language/#set-the-web-browsers-default-language-to-fr_fr","title":"Set the web browser's default language to <code>fr_FR</code> :","text":"<p>You can keep the same abcdesktop.io users session, you do not need to logout.</p>  <p>The launch LibreOffice Writer. The menu is set to <code>fr_FR</code>  LibreOffice Writer use French <code>fr_FR</code>language.</p> <p>Great you have change the language settings of applications running inside an abcdesktop docker container</p>"},{"location":"2.0/config/linux_syslog_config/","title":"Linux syslog config","text":""},{"location":"2.0/config/linux_syslog_config/#modify-etcrsyslogconf","title":"Modify /etc/rsyslog.conf","text":"<p>By default syslog program is configured to log messages received over unix socket files. rsyslog configuration file need to be modified to accept messages over UDP.</p> <p>Edit /etc/rsyslog.conf file with your prefered linux text editor as sudo ou root:</p> <pre><code>sudo vi /etc/rsyslog.conf\n</code></pre>  <p>Uncomment the following lines and save file :</p> <pre><code>module(load=\"imudp\")\ninput(type=\"imudp\" port=\"514\")\n</code></pre>"},{"location":"2.0/config/linux_syslog_config/#restart-rsyslog","title":"Restart rsyslog","text":"<p>Now we have enabled rsyslog over UDP on 514 port in config file, we have to restart rsyslog to take new parameters into account. Execute the following command as sudo:</p> <pre><code>sudo systemctl restart rsyslog\n</code></pre>"},{"location":"2.0/config/logging/","title":"Logging configuration in od.config","text":"<p>The <code>logging</code> configuration is a dictionnary object. The logging configuration describes where and how log message information have to been send.</p> <p><code>logging</code> dict use the python logging module logging module</p> <p>The <code>syslog</code> and <code>graylog</code> protocol messaging are supported too.</p> <p>The default features for each handlers are : </p>    handler Features     <code>console</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>ext://sys.stdout</code> formated as standard   <code>cherrypy_console</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>ext://sys.stdout</code> formatted as access   <code>cherrypy_access</code> log message using a <code>logging.StreamHandler</code> to the file stream <code>logs/access.log</code> formatted as access   <code>cherrypy_trace</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>logs/trace.log</code> formatted as standard    <p>Sub modules used by od.py can log information too. </p>    Sub module Default Values     <code>docker.utils.config</code> <code>{ 'level': 'INFO' },</code>   <code>urllib3.connectionpool</code> <code>{ 'level': 'ERROR'},</code>    <p>The <code>logging</code> sample configuration :</p> <pre><code>#              \n# logging configuration \n# come from https://docs.python.org/3.8/library/logging.config.html\n# need double %% to escape %\n# \n# graylog https://github.com/severb/graypy\n# use handler class name as\n# graypy.GELFUDPHandler - UDP log forwarding\n# graypy.GELFTCPHandler - TCP log forwarding\n# graypy.GELFTLSHandler - TCP log forwarding with TLS support\n# graypy.GELFHTTPHandler - HTTP log forwarding\n# graypy.GELFRabbitHandler - RabbitMQ log forwarding\n\nlogging: {\n  'version': 1,\n  'disable_existing_loggers': False,\n  'formatters': {\n    'access': {\n      'format': '%%(message)s - user: %%(userid)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'standard': {\n      'format': '%%(asctime)s %%(module)s [%%(levelname)-7s] %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'syslog': {\n      'format': '%%(asctime)s %%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'graylog': {\n      'format': '%%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s'      \n    }\n  },\n  'filters': {\n    'odcontext': {\n      '()': 'oc.logging.OdContextFilter'\n    }\n  },\n  'handlers': {\n    'console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_access': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'filename': 'logs/access.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8'\n    },\n    'cherrypy_trace': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'filename': 'logs/trace.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8',\n      'mode': 'w'\n    }\n  },\n  'loggers': {\n    '': {\n      'handlers': [ 'console', 'cherrypy_trace'  ],\n      'level': 'DEBUG'\n    },\n    'docker.utils.config': {\n      'level': 'INFO'\n    },\n    'urllib3.connectionpool': {\n      'level': 'ERROR'\n    },\n    'cherrypy.access': {\n      'handlers': [ 'cherrypy_access' ],\n      'level': 'INFO',\n      'propagate': False\n    },\n    'cherrypy.error': {\n      'handlers': [ 'console', 'cherrypy_trace' ],\n      'level': 'ERROR',\n      'propagate': False\n    }\n  } }\n</code></pre>"},{"location":"2.0/config/stack/","title":"stack entry in od.config","text":""},{"location":"2.0/config/stack/#stackmode","title":"stack.mode","text":"<p><code>stack.mode</code> describes how abcdesktop.io can manage user's containers and application. </p> <ul> <li>If you run a docker only daemon, set the value to <code>standalone</code>.</li> <li>If you run a kubernetes cluster, set the value to <code>kubernetes</code>.</li> </ul>    stack.mode Description     <code>standalone</code> Use a dockerd only, this is for personal usage   <code>kubernetes</code> Use a kubernetes services"},{"location":"2.0/config/stack/#stackkubernetesdefaultdomain","title":"stack.kubernetesdefaultdomain","text":"<p><code>stack.kubernetesdefaultdomain</code> is the default domain name configured in kubernetes cluster. This value is type is string and only read if stack.mode is <code>kubernetes</code>.</p> <p>The default value is <code>abcdesktop.svc.cluster.local</code> </p> <p>If option value <code>mongodb</code> or <code>memcached</code> are set, the values are NOT overridden, and keep unchanged.</p> <p>If option value <code>mongodb</code> or <code>memcached</code> are set to <code>None</code> (by default), then <code>stack.kubernetesdefaultdomain</code> is used to complete the FQDN of <code>mongodb</code> and <code>memcached</code> servers name. This value is concatenated to the server hostname.</p>    Hostname FQDN     <code>mongodb</code> <code>mongodb.abcdesktop.svc.cluster.local</code>   <code>memcached</code> <code>memcached.abcdesktop.svc.cluster.local</code>    <p>The dns resolution need a running <code>core-dns</code>is the namespace <code>kube-system</code></p> <p><code>stack.kubernetesdefaultdomain</code> is used also if <code>desktop.desktopuseinternalfqdn: True</code></p> <p>The pod name FQDN is built using the <code>$podid</code>.desktop.<code>$stack.kubernetesdefaultdomain</code></p> <p>For example, by default :</p> <p><code>c8c7d38f-7621-40bb-a777-83f41b32733e.desktop.abcdesktop.svc.cluster.local</code></p>"},{"location":"2.0/config/sudo-kubernetes/","title":"Sudo kubernetes","text":""},{"location":"2.0/config/sudo-kubernetes/#how-to-get-a-root-access-inside-a-container-running-kubernetes-abcdesktop","title":"How to get a root access inside a container running kubernetes abcdesktop ?","text":"<p>run the sudo command inside the user kubernetes pods</p>   <pre><code>balloon@43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e:~$ sudo bash\nsudo: effective uid is not 0, is /usr/bin/sudo on a file system with the 'nosuid' option set or an NFS file system without root privileges?\n</code></pre> <ol> <li>Download the default abcdesktop.yaml</li> <li>Update the od.config file inside the <code>configmap/abcdesktop-config</code></li> <li>Allow in the od.config section, update the option desktop.allowPrivilegeEscalation value to True </li> </ol> <pre><code>    # desktop.allowPrivilegeEscalation\n    # value True or False\n    # This value is only avalaible in kubernetes mode,\n    # The desktop.allowPrivilegeEscalation allow a user to run a sudo command.\n    # This option set the runtime privilege and Linux capabilities\n    # The execve system call can grant a newly-started program privileges that its parent did not have,\n    # such as the setuid or setgid Linux flags.\n    # The default value is False\n    # You should only set desktop.allowPrivilegeEscalation to run sudo command.\n    # In production this value MUST be set to False\n\n    desktop.allowPrivilegeEscalation: True \n\n</code></pre> <ol> <li>Update the kubernetes config with the new abcdesktop.yaml  </li> </ol> <pre><code>% kubectl apply -f abcdesktop.yaml\n  configmap/abcdesktop-config configured\n</code></pre> <ol> <li>Restart the pyos pod </li> </ol> <p>List all pods </p> <pre><code>% kubectl get pods -n abcdesktop\nNAME                                   READY   STATUS    RESTARTS   AGE\n43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e   3/3     Running   0          17m\ndaemonset-nginx-bbbvj                  1/1     Running   0          37m\ndaemonset-pyos-ckqx6                   1/1     Running   0          39h\nmemcached-od-5bf65bf745-l62jr          1/1     Running   0          39h\nmongodb-od-656d85c49f-jx2zj            1/1     Running   0          39h\nopenldap-od-5945946767-82qh4           1/1     Running   0          39h\nspeedtest-od-58b9847b4b-gllrt          1/1     Running   0          39h\n</code></pre> <p>Delete the pyos pod</p> <pre><code>% kubectl delete pods daemonset-pyos-ckqx6  -n abcdesktop\npod \"daemonset-pyos-ckqx6\" deleted\n</code></pre> <p>Kubenestes restart the new pyos pod</p> <pre><code>kubectl get pods -n abcdesktop                         \nNAME                                   READY   STATUS    RESTARTS   AGE\n43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e   3/3     Running   0          18m\ndaemonset-nginx-bbbvj                  1/1     Running   0          38m\ndaemonset-pyos-fhbx5                   1/1     Running   0          3s\nmemcached-od-5bf65bf745-l62jr          1/1     Running   0          39h\nmongodb-od-656d85c49f-jx2zj            1/1     Running   0          39h\nopenldap-od-5945946767-82qh4           1/1     Running   0          39h\nspeedtest-od-58b9847b4b-gllrt          1/1     Running   0          39h\n</code></pre> <ol> <li>Make sure that your user has done a logoff his pod, then login again and run terminal web shell </li> </ol> <p>The default balloon password is <code>lmdpocpetit</code></p> <pre><code>balloon@c182dc39-6a00-4869-8b01-2039f37c1eab:~$ sudo bash\n[sudo] password for balloon: \nroot@c182dc39-6a00-4869-8b01-2039f37c1eab:~# id\nuid=0(root) gid=0(root) groups=0(root),105(lpadmin)\nroot@c182dc39-6a00-4869-8b01-2039f37c1eab:~#  \n</code></pre> <p>After the sudo command, you get a root level inside the shell of the users's pod</p>   <p>In production this value should be set to False</p>"},{"location":"2.0/config/syslog/","title":"Syslog configuration in od.config","text":""},{"location":"2.0/config/syslog/#add-syslog-server-support","title":"Add syslog server support","text":"<pre><code>   'filters': [ 'odcontext' ],\n</code></pre> <p>syslog is a protocol for tracking and logging system messages in Linux. Applications use syslog to export all their error and status messages to the files in the /var/log directory.</p> <p>syslog uses the client-server model; a client transmits a text message to the server (receiver). The server is commonly called syslogd, syslog daemon, or syslog server. syslog uses the User Datagram Protocol (UDP) port 514 for communication. </p>"},{"location":"2.0/config/syslog/#start-syslog-container","title":"Start syslog container","text":"<p>Those running linux can simply modify their syslog configuration file following linux syslog config steps</p> <p>For others (Windows/Mac) or those that don't want to modify their syslog config, you can simply run the following command :</p> <pre><code>docker run -it -p 514:514/udp --name syslog-ng balabit/syslog-ng:latest -edv\n</code></pre> <pre><code>[2020-04-07T12:29:39.485318] Accepting connections; addr='AF_INET(0.0.0.0:514)'\n[2020-04-07T12:29:39.485752] You have a TLS enabled source without a X.509 keypair. Make sure you have tls(key-file() and cert-file()) options, TLS handshake to this source will fail; location='/etc/syslog-ng/syslog-ng.conf:21:2'\n[2020-04-07T12:29:39.485964] Accepting connections; addr='AF_INET(0.0.0.0:6514)'\n[2020-04-07T12:29:39.486179] Accepting connections; addr='AF_INET(0.0.0.0:601)'\n[2020-04-07T12:29:39.486600] Running application hooks; hook='1'\n[2020-04-07T12:29:39.486621] Running application hooks; hook='6'\n[2020-04-07T12:29:39.486674] syslog-ng starting up; version='3.26.1'\n[2020-04-07T12:29:39.486850] Running application hooks; hook='2'\n[2020-04-07T12:39:39.587220] Log statistics; processed='global(payload_reallocs)=0', processed='global(sdata_updates)=0', queued='global(scratch_buffers_bytes)=0', processed='src.internal(s_local#0)=0', stamp='src.internal(s_local#0)=0', processed='destination(d_local)=0', processed='source(s_local)=0', processed='source(s_network)=0', processed='global(msg_clones)=0', processed='center(received)=0', queued='global(scratch_buffers_count)=0', processed='center(queued)=0'\n</code></pre>"},{"location":"2.0/config/syslog/#modify-logging-entry","title":"Modify logging entry","text":"<p>To let abcdesktop log events in syslog trought UDP, we will have to modify abcdesktop configuration file to add  an handler and 'syslog' entry in general logger and cherrypy.error logger. (syslog formatter is already in sample file)</p>"},{"location":"2.0/config/syslog/#add-syslog-handler","title":"Add Syslog Handler","text":"<p>In handlers entry add the following lines:</p> <pre><code>        ,\n        'syslog': {\n          'class': 'logging.handlers.SysLogHandler',\n          'filters': [ 'odcontext' ],\n          'formatter': 'syslog',\n          'socktype': 2,\n          'address' : [ '192.168.0.52', 514 ]\n        }\n</code></pre> <p>Replace 192.168.0.52 ip address by your local IP Addresse.</p> <p>You can get your local IP address using the following command:</p> <pre><code>hostname -I | cut -d ' ' -f1\n</code></pre>"},{"location":"2.0/config/syslog/#add-loggers-handlers-entries","title":"Add loggers handlers entries","text":"<p>In general loggers (key '' in loggers entry) and 'cherrypy.error' add <code>syslog'</code> handler in handlers list:</p> <pre><code>        '': {\n          'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n          'level': 'INFO'\n        }\n\n       'cherrypy.error': {\n          'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n          'level': 'ERROR',\n          'propagate': False\n        }\n</code></pre>"},{"location":"2.0/config/syslog/#resulting-modified-sample-configuration-file","title":"Resulting Modified sample configuration file","text":"<pre><code>#              \n# logging configuration \n# come from https://docs.python.org/3.8/library/logging.config.html\n# need double %% to escape %\n# \n# graylog https://github.com/severb/graypy\n# use handler class name as\n# graypy.GELFUDPHandler - UDP log forwarding\n# graypy.GELFTCPHandler - TCP log forwarding\n# graypy.GELFTLSHandler - TCP log forwarding with TLS support\n# graypy.GELFHTTPHandler - HTTP log forwarding\n# graypy.GELFRabbitHandler - RabbitMQ log forwarding\n\nlogging: {\n  'version': 1,\n  'disable_existing_loggers': False,\n  'formatters': {\n    'access': {\n      'format': '%%(message)s - user: %%(userid)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'standard': {\n      'format': '%%(asctime)s %%(module)s [%%(levelname)-7s] %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'syslog': {\n      'format': '%%(asctime)s %%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'graylog': {\n      'format': '%%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s'      \n    }\n  },\n  'filters': {\n    'odcontext': {\n      '()': 'oc.logging.OdContextFilter'\n    }\n  },\n  'handlers': {\n    'console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_access': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'filename': 'logs/access.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8'\n    },\n    'cherrypy_trace': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'filename': 'logs/trace.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8',\n      'mode': 'w'\n    },\n    'syslog': {\n       'class': 'logging.handlers.SysLogHandler',\n       'filters': [ 'odcontext' ],\n       'formatter': 'syslog',\n       'socktype': 2,\n       'address' : [ '192.168.0.52', 514 ]\n    }\n  },\n  'loggers': {\n    '': {\n      'handlers': [ 'console', 'cherrypy_trace', 'syslog'  ],\n      'level': 'DEBUG'\n    },\n    'docker.utils.config': {\n      'level': 'INFO'\n    },\n    'urllib3.connectionpool': {\n      'level': 'ERROR'\n    },\n    'cherrypy.access': {\n      'handlers': [ 'cherrypy_access' ],\n      'level': 'INFO',\n      'propagate': False\n    },\n    'cherrypy.error': {\n      'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n      'level': 'ERROR',\n      'propagate': False\n    }\n  } }\n</code></pre>"},{"location":"2.0/config/syslog/#restart-pods","title":"Restart Pods","text":"<p>To restart Pods, we will delete and recreate all pods</p>"},{"location":"2.0/config/syslog/#delete-pods","title":"Delete pods","text":"<p>To delete pods, execute the following command:</p> <pre><code>kubectl delete -f abcdesktop.yaml\n</code></pre>"},{"location":"2.0/config/syslog/#create-pods","title":"Create pods","text":"<p>To create pods, execute the following command:</p> <pre><code>kubectl create -f abcdesktop.yaml\n</code></pre>"},{"location":"2.0/config/syslog/#verify-syslogs","title":"Verify syslogs","text":"<p>At this state, new abcdesktop logging configuration should be applied. We can now verify syslog logs:</p> <pre><code>tail /var/log/syslog\n</code></pre>  <p>If you see some lines with 'INFO' Level, you probably see abcdesktop logs in syslog ! If not try to do actions in abcdesktop (open session, launch new application, close session) and apply the tail command again.</p>"},{"location":"2.0/config/webrtc/","title":"Sound server configuration","text":"<p>By default abcdesktop use the <code>module-http-protocol-tcp</code> from pulseaudio sound server to send wav data to the web browser</p>"},{"location":"2.0/config/webrtc/#pulseaudio-http-stream-by-default","title":"pulseaudio http stream (by default)","text":"<p>By default, abcdesktop uses the pulseaudio http stream and play wave data (poor sound quality but works in https only)</p>  <p>In terminal webshell run the command : </p> <pre><code>pactl -s /tmp/.pulse.sock list short modules\n</code></pre> <pre><code>balloon@bac345323f37:/var/log/desktop$ pactl -s /tmp/.pulse.sock list short modules\n0 module-augment-properties\n1 module-null-sink sink_name=u8_1_11025 format=u8 channels=1 rate=11025 sink_properties=\"device.description='default format=u8 c=1 rate=11025'\"\n2 module-null-sink sink_name=s16_1_22050 format=s16be channels=1 rate=22050 sink_properties=\"device.description='default format=s16be c=1 rate=22050'\"\n3 module-null-sink sink_name=s16_1_44100 format=s16be channels=1 rate=44100 sink_properties=\"device.description='default format=s16be c=1 rate=44100'\"\n4 module-null-sink sink_name=ulaw8_1_8000 format=ulaw channels=1 rate=8000 sink_properties=\"device.description='default format=ulaw c=1 rate=8000'\"\n5 module-null-sink sink_name=rtp format=alaw channels=1 rate=8000 sink_properties=\"device.description='RTP Multicast Sink'\"\n6 module-native-protocol-unix auth-group=balloon socket=/tmp/.pulse.sock\n7 module-http-protocol-tcp listen=172.21.0.5\n8 module-always-sink\n</code></pre>"},{"location":"2.0/config/webrtc/#webrtc-gateway-enable","title":"webrtc gateway enable","text":"<p>To get a better sound quality, you can use a webrtc gateway and send a rtp stream to the webrtc gateway. abcdesktop plays sound using the web browser webrtc stack (good sound quality)</p>  <p>abcdesktop update the pulseaudio configuration, and add <code>module-rtp-send</code>. The <code>module-rtp-send</code> pusleaudio send to the destination_ip (in this example 1.2.3.4) </p> <pre><code>pactl -s /tmp/.pulse.sock list short modules\n</code></pre> <pre><code>balloon@414e3db9-60d8-4f92-a356-a3a74833990c:~$ pactl -s /tmp/.pulse.sock list short modules\n0       module-augment-properties\n1       module-null-sink        sink_name=rtp  format=alaw channels=1 rate=8000 sink_properties=\"device.description='RTP Multicast Sink'\"\n2       module-native-protocol-unix     auth-group=balloon socket=/tmp/.pulse.sock\n3       module-always-sink\n4       module-rtp-send source=rtp.monitor destination_ip=1.2.3.4 port=5119 channels=1 format=alaw\n</code></pre> <p>The <code>sink_name</code> is rtp, and the <code>source</code> for the <code>module-rtp-send</code> is rtp.monitor.</p> <p>The default source is <code>rtp.monitor</code></p> <pre><code>Source #\n        State: RUNNING\n        Name: rtp.monitor\n        Description: Monitor of RTP Multicast Sink\n        Driver: module-null-sink.c\n        Sample Specification: aLaw 1ch 8000Hz\n        Channel Map: mono\n        Owner Module: 5\n        Mute: no\n        Volume: mono: 65536 / 100% / 0.00 dB\n                balance 0.00\n        Base Volume: 65536 / 100% / 0.00 dB\n        Monitor of Sink: rtp\n        Latency: 0 usec, configured 160000 usec\n        Flags: DECIBEL_VOLUME LATENCY \n        Properties:\n                device.description = \"Monitor of RTP Multicast Sink\"\n                device.class = \"monitor\"\n                device.icon_name = \"audio-input-microphone\"\n        Formats:\n                pcm\n</code></pre> <p>The default output is </p> <pre><code>\nSource Output #0\n        Driver: module-rtp-send.c\n        Owner Module: 9\n        Client: n/a\n        Source: 4\n        Sample Specification: aLaw 1ch 8000Hz\n        Channel Map: mono\n        Format: pcm, format.sample_format = \"\\\"aLaw\\\"\"  format.rate = \"8000\"  format.channels = \"1\"  format.channel_map = \"\\\"mono\\\"\"\n        Corked: no\n        Mute: no\n        Volume: mono: 65536 / 100% / 0.00 dB\n                balance 0.00\n        Buffer Latency: 0 usec\n        Source Latency: 0 usec\n        Resample method: n/a\n        Properties:\n                media.name = \"RTP Monitor Stream\"\n                rtp.source = \"0.0.0.0\"\n                rtp.destination = \"1.2.3.4\"\n                rtp.mtu = \"1280\"\n                rtp.port = \"5119\"\n                rtp.ttl = \"1\"\n</code></pre> <p>By default, the format is <code>pcm</code></p> <pre><code>Format: pcm, format.sample_format = \"\\\"aLaw\\\"\"  format.rate = \"8000\"  format.channels = \"1\"  format.channel_map = \"\\\"mono\\\"\"\n</code></pre> <p>To change the default format update the values in od.config file.</p> <pre><code> 'audiopt': 8,\n 'audiortpmap': 'PCMA/8000',\n</code></pre> <p>To get the 'audiopt' and 'audiortpmap' values, read the web pages</p> <ul> <li>meetecho streaming plugin documentation</li> <li>RTP payload formats</li> </ul>"},{"location":"2.0/config/webrtc/#requirements","title":"Requirements","text":"<ul> <li>a janus server  </li> <li>add webrtc configuration in od.config file</li> </ul>"},{"location":"2.0/config/webrtc/#install-a-janus-server","title":"Install a janus server","text":""},{"location":"2.0/config/webrtc/#install-janus","title":"Install janus","text":"<p>Install a janus service from meetecho.com on a server </p> <pre><code>apt-get install janus\n</code></pre>"},{"location":"2.0/config/webrtc/#add-x509-certificats","title":"Add X509 certificats","text":"<p>Add X509 certificats in your janus.jcfg configuration. Certificate and key to use for DTLS (and passphrase if needed). If missing, Janus will autogenerate a self-signed certificate to use. Notice that self-signed certificates are fine for the purpose of WebRTC DTLS connectivity, for the time being, at least until Identity Providers are standardized and implemented in browsers.</p> <pre><code>certificates: {\n    cert_pem = \"/etc/ssl/certs/ssl-cert-snakeoil.pem\"\n    cert_key = \"/etc/ssl/private/ssl-cert-snakeoil.key\"\n    cert_pwd = \"secretpassphrase\"\n}\n</code></pre>"},{"location":"2.0/config/webrtc/#add-the-webrtc-entry-in-odconfig","title":"add the webrtc entry in od.config","text":"<p>Update the od.config file, for example :</p> <pre><code># WebRTC Janus config\nwebrtc.enable : True\nwebrtc.server : {   'janus.domain.local' : { 'schema' : 'http',\n                                          'host': 'janus.domain.local',\n                                          'hostip': '1.2.3.4',\n                                          'port': 8088,\n                                          'audiopt': 8,\n                                          'audiortpmap': 'PCMA/8000',\n                                          'apisecret': 'janusrocks',\n                                          'adminkey': 'supersecret',\n                                          'startport': 5100 } }\n</code></pre>"},{"location":"2.0/config/webrtc/#webrtcenable","title":"webrtc.enable","text":"<p><code>webrtc.enable</code> is a boolean. The default value is <code>False</code>. Set this value to <code>True</code> to enable webrtc services for <code>pulseaudio</code>.</p>"},{"location":"2.0/config/webrtc/#webrtcserver","title":"webrtc.server","text":"<p><code>webrtc.server</code> is a dict. The default value is <code>None</code>.  Set all dictionnary values to enable webrtc access for <code>pulseaudio</code> and for the web browser client.</p> <p>The <code>hostip</code> value, is used by pluse audio to configure the rtp stream. This value must be an ip address (do not set the fqdn). This can be an internal ip address, and is only to configure pulseaudio module and describe how to send stream data to reach the webrtc gateway.</p> <pre><code>'hostip': '1.2.3.4'\n</code></pre> <p>The <code>host</code> value, is used by the browser to reach the webrtc gateway and get the rtp stream. This value must(should) be a <code>fqdn</code>. This <code>fqdn</code> is used by the web browser.</p> <pre><code>webrtc.server : {   'janus.domain.local' : { 'schema' : 'http',\n                                          'host': 'janus.domain.local',\n                                          'hostip': '1.2.3.4',\n                                          'port': 8088,\n                                          'audiopt': 8,\n                                          'audiortpmap': 'PCMA/8000',\n                                          'apisecret': 'janusrocks',\n                                          'adminkey': 'supersecret',\n                                          'startport': 5100 } }\n</code></pre>"},{"location":"2.0/config/controllers/manager/","title":"ManagerController","text":""},{"location":"2.0/config/controllers/manager/#http-request","title":"HTTP Request","text":"<p>The http request path is <code>/API/manager</code></p>    Path Params Response type     <code>/API/manager/buildapplist</code> None Json object   <code>/API/manager/updateactivedirectorysite</code> None Json object   <code>/API/manager/garbagecollector</code> expirein=, force=False Json object"},{"location":"2.0/config/controllers/manager/#buildapplist","title":"buildapplist","text":"<p><code>buildapplist</code> ask pyos to list all abcdesktop.io docker image. Each docker image must have the specified label <code>type=apps</code>. abcdesktop.io </p>    Params Type Description     None None None    <p>example :</p> <pre><code>curl http://localhost/API/manager/buildapplist\n</code></pre> <p>Return the complete array if json images objects ready to run.</p> <pre><code>{\"abcdesktopio/writer.d:latest\": {\"id\": \"abcdesktopio/writer.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-writer\", \"name\": \"Writer\", \"icon\": \"libreoffice-writer.svg\", \"keyword\": \"libre office writer,office,writer\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--writer\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Writer\", \"mimetype\": [\"application/vnd.oasis.opendocument.text\", \"application/vnd.oasis.opendocument.text-template\", \"application/vnd.oasis.opendocument.text-web\", \"application/vnd.oasis.opendocument.text-master\", \"application/vnd.oasis.opendocument.text-master-template\", \"application/vnd.sun.xml.writer\", \"application/vnd.sun.xml.writer.template\", \"application/vnd.sun.xml.writer.global\", \"application/msword\", \"application/vnd.ms-word\", \"application/x-doc\", \"application/x-hwp\", \"application/rtf\", \"text/rtf\", \"application/vnd.wordperfect\", \"application/wordperfect\", \"application/vnd.lotus-wordpro\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", \"application/vnd.ms-word.document.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.template\", \"application/vnd.ms-word.template.macroenabled.12\", \"application/vnd.stardivision.writer-global\", \"application/x-extension-txt\", \"application/x-t602\", \"application/vnd.oasis.opendocument.text-flat-xml\", \"application/x-fictionbook+xml\", \"application/macwriteii\", \"application/x-aportisdoc\", \"application/prs.plucker\", \"application/vnd.palm\", \"application/clarisworks\", \"application/x-sony-bbeb\", \"application/x-abiword\", \"application/x-iwork-pages-sffpages\", \"application/x-mswrite\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-writer.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"sxw\", \"stw\", \"doc\", \"dot\", \"wps\", \"rtf\", \"602\", \"wpd\", \"docx\", \"docm\", \"dotx\", \"dotm\", \"abw\", \"zabw\", \"pages\", \"dummy\", \"lrf\", \"cwk\", \"hqx\", \"fb2\", \"mw\", \"mcw\", \"mwd\", \"pdb\", \"wn\"], \"legacyfileextensions\": [\"odf\", \"ott\", \"fodt\", \"uot\"]}, \"abcdesktopio/math.d:latest\": {\"id\": \"abcdesktopio/math.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-math\", \"name\": \"Math\", \"icon\": \"libreoffice-math.svg\", \"keyword\": \"libre office math,office,math\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--math\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": null, \"displayname\": \"Math\", \"mimetype\": [\"application/vnd.oasis.opendocument.formula\", \"application/vnd.sun.xml.math\", \"application/vnd.oasis.opendocument.formula-template\", \"text/mathml\", \"application/mathml+xml\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-math.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odf\", \"odc\"], \"legacyfileextensions\": [\"odf\", \"odc\"]}, \"abcdesktopio/impress.d:latest\": {\"id\": \"abcdesktopio/impress.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-impress\", \"name\": \"Impress\", \"icon\": \"libreoffice-impress.svg\", \"keyword\": \"libre office impress,office,impress\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--impress\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Impress\", \"mimetype\": [\"application/vnd.oasis.opendocument.presentation\", \"application/vnd.oasis.opendocument.presentation-template\", \"application/vnd.sun.xml.impress\", \"application/vnd.sun.xml.impress.template\", \"application/mspowerpoint\", \"application/vnd.ms-powerpoint\", \"application/vnd.openxmlformats-officedocument.presentationml.presentation\", \"application/vnd.ms-powerpoint.presentation.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.presentationml.template\", \"application/vnd.ms-powerpoint.template.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.presentationml.slide\", \"application/vnd.openxmlformats-officedocument.presentationml.slideshow\", \"application/vnd.ms-powerpoint.slideshow.macroenabled.12\", \"application/vnd.oasis.opendocument.presentation-flat-xml\", \"application/x-iwork-keynote-sffkey\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-impress.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odp\", \"pot\", \"potm\", \"potx\", \"pps\", \"ppsx\", \"ppt\", \"pptx\", \"pptm\"], \"legacyfileextensions\": [\"odp\"]}, \"abcdesktopio/calc.d:latest\": {\"id\": \"abcdesktopio/calc.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-calc\", \"name\": \"Calc\", \"icon\": \"libreoffice-calc.svg\", \"keyword\": \"libre office calc,office,calc\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--calc\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Calc\", \"mimetype\": [\"application/vnd.oasis.opendocument.spreadsheet\", \"application/vnd.oasis.opendocument.spreadsheet-template\", \"application/vnd.sun.xml.calc\", \"application/vnd.sun.xml.calc.template\", \"application/msexcel\", \"application/vnd.ms-excel\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", \"application/vnd.ms-excel.sheet.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.template\", \"application/vnd.ms-excel.template.macroenabled.12\", \"application/vnd.ms-excel.sheet.binary.macroenabled.12\", \"text/csv\", \"application/x-dbf\", \"text/spreadsheet\", \"application/csv\", \"application/excel\", \"application/tab-separated-values\", \"application/vnd.lotus-1-2-3\", \"application/vnd.oasis.opendocument.chart\", \"application/vnd.oasis.opendocument.chart-template\", \"application/x-dbase\", \"application/x-dos_ms_excel\", \"application/x-excel\", \"application/x-msexcel\", \"application/x-ms-excel\", \"application/x-quattropro\", \"application/x-123\", \"text/comma-separated-values\", \"text/tab-separated-values\", \"text/x-comma-separated-values\", \"text/x-csv\", \"application/vnd.oasis.opendocument.spreadsheet-flat-xml\", \"application/vnd.ms-works\", \"application/x-iwork-numbers-sffnumbers\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-calc.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"ods\", \"ots\", \"sxc\", \"stc\", \"fods\", \"uos\", \"uof\", \"xml\", \"xlsx\", \"xlsm\", \"xltm\", \"xltx\", \"xlsb\", \"xls\", \"xlm\", \"xlc\", \"xlw\", \"xlk\", \"xlt\", \"dif\", \"dbf\", \"htm\", \"html\", \"wk1\", \"wks\", \"123\", \"wb2\", \"rtf\", \"slk\", \"sylk\", \"csv\", \"numbers\", \"dummy\", \"cwk\", \"wps\", \"wk3\", \"wq1\", \"wq2\"], \"legacyfileextensions\": [\"ods\", \"ots\", \"csv\"]}, \"abcdesktopio/base.d:latest\": {\"id\": \"abcdesktopio/base.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-base\", \"name\": \"Base\", \"icon\": \"libreoffice-base.svg\", \"keyword\": \"libre office base,office,base\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"development\", \"args\": \"--base\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": null, \"displayname\": \"Base\", \"mimetype\": [\"application/vnd.oasis.opendocument.database\", \"application/vnd.sun.xml.base\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-base.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odb\"], \"legacyfileextensions\": [\"odb\"]}}\n\n</code></pre>"},{"location":"2.0/config/controllers/manager/#updateactivedirectorysite","title":"updateactivedirectorysite","text":"Params Type Description     None None None    <p>example :</p> <pre><code>curl http://localhost/API/manager/updateactivedirectorysite\n</code></pre>"},{"location":"2.0/config/controllers/manager/#garbagecollector","title":"garbagecollector","text":"Params Type Description     <code>expirein</code> integer number in seconds since the container create date time   <code>force</code> boolean garbage the container even if a user is connected    <p>example :</p> <pre><code>curl \"http://localhost/API/manager/garbagecollector?expirein=9473\"\ncurl \"http://localhost/API/manager/garbagecollector?expirein=9473&amp;force=True\"\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/","title":"abcdesktop.io in kubernetes mode","text":"<p>abcdesktop.io release 2.x support only kubernetes mode. All applications containers can be distributed on different hosts.</p> <p>In kubernetes mode, the abcdesktop.io infrastructure use seven containers (oc.cups is optional), each container has a specific role : </p>    Container Role Image From     oc.user user container abcdesktopio/oc.user.18.04:2.0 abcdesktopio   oc.cups printing container abcdesktopio/oc.cupsd.18.04:2.0 abcdesktopio   oc.pyos API Server abcdesktopio/oc.pyos:2.0 abcdesktopio   oc.nginx web server proxy abcdesktopio/oc.nginx:2.0 abcdesktopio   oc.speedtest http benchmarch abcdesktopio/oc.speedtest LibreSpeed   oc.mongo json database server mongo MongoDB   memcached cache server memcached Memcached"},{"location":"2.0/setup/kubernetes_abcdesktop/#requirements","title":"Requirements","text":"<p>You need to have a Kubernetes cluster, and the <code>kubectl</code> command-line tool must be configured to communicate with your cluster. The command line <code>openssl</code> must be installed too.</p> <p>You can run the Quick installation process or choose the Manually installation step by step</p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#quick-installation-linux-or-macos","title":"Quick installation (Linux or macOS)","text":"<p>Quick installation can be run on Linux or macOS operation system.  For Microsoft Windows, please read the following chapter 'Manually installation step by step'</p>  <p>Download and extract the latest release automatically (Linux or macOS):</p> <pre><code>curl -sL https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/install.2.x.sh | bash\n</code></pre> <p>The command above downloads the latest release (numerically) of abcdesktop.io.  The quick installation process runs the all commands step by step:</p> <ul> <li>create the abcdesktop namespace</li> <li>build all rsa keys pairs for jwt signing and payload encryption</li> <li>create all services, pods, secrets and configmaps</li> <li>download user's core images: oc.user, oc.cupsd, oc.pulseaudio</li> <li>download some applications images sample: the LibreOffice suite (calc, writer, impress), Firefox, Gimp, and gnome-terminal.</li> </ul> <p>You can also download the install.2.x.sh bash script, and read it and then run it.</p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#manually-installation-step-by-step-linux-macos-or-windows","title":"Manually installation step by step (Linux, macOS or Windows)","text":"<p>The following commands will let you prepare and build abcdesktop plateform on the master node. All applications run on a single server.  </p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#install-abcdesktop","title":"Install abcdesktop","text":""},{"location":"2.0/setup/kubernetes_abcdesktop/#step-1-create-abcdesktop-namespace","title":"Step 1: Create abcdesktop namespace","text":"<p>We will create abcdesktop namespace and set it as default :</p> <pre><code># First create the abcdesktop namespace\nkubectl create namespace abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>namespace/abcdesktop created\n</code></pre>  <p>Option : To use the namespace <code>abcdestkop</code> as default namespace  <code>kubectl config set-context $(kubectl config current-context) --namespace=abcdesktop</code></p> <p>All kubectl commands will be executed with abcdesktop namespace. This will avoid to add \"-n abcdesktop\" to all commands. </p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#step-2-securized-abcdesktop","title":"Step 2: Securized abcdesktop","text":"<p>All communications between nginx, pyos and user navigator are encrypted by JSON Web Tokens.</p> <ul> <li>The JSON Web Tokens payload is encrypted with the abcdesktop jwt desktop payload private by pyos</li> <li> <p>The JSON Web Tokens payload is decrypted with the abcdesktop jwt desktop payload public keys by nginx.</p>  <p>Please use the payload private as private key, and the payload public as private key.  Do not publish the public key. This public key must stay private, this is a special case, this is not stupid, it's only a more secure option.</p>  </li> <li> <p>The JSON Web Tokens payload is signed with the abcdesktop jwt desktop signing private keys</p> </li> <li> <p>The JSON Web Tokens payload is verified with the abcdesktop jwt desktop signing public keys.</p> </li> <li> <p>The JSON Web Tokens user is signed with the abcdesktop jwt user signing private keys by pyos.</p> </li> <li>The JSON Web Tokens user is verified with the abcdesktop jwt user signing public keys by pyos <p>As multiple pods of pyos can run simultaneously, the same private and public keys value are stored into kubernetes secret.</p>  </li> </ul> <p>The abcdesktop jwt desktop payload public key is read by nginx lua script and by pyos, export the public key using the <code>RSAPublicKey_out</code> option, to use the <code>RSAPublicKey</code> format. The <code>RSAPublicKey</code> format make key file format compatible between python and lua.</p> <p>The following commands will let you create all necessary keys :</p> <pre><code># build rsa kay pairs for jwt payload \n# 1024 bits is a smallest value, change here if need but use more than 1024\nopenssl genrsa  -out abcdesktop_jwt_desktop_payload_private_key.pem 1024\nopenssl rsa     -in  abcdesktop_jwt_desktop_payload_private_key.pem -outform PEM -pubout -out  _abcdesktop_jwt_desktop_payload_public_key.pem\nopenssl rsa -pubin -in _abcdesktop_jwt_desktop_payload_public_key.pem -RSAPublicKey_out -out abcdesktop_jwt_desktop_payload_public_key.pem\n\n# build rsa kay pairs for the desktop jwt signing \nopenssl genrsa -out abcdesktop_jwt_desktop_signing_private_key.pem 1024\nopenssl rsa     -in abcdesktop_jwt_desktop_signing_private_key.pem -outform PEM -pubout -out abcdesktop_jwt_desktop_signing_public_key.pem\n\n# build rsa kay pairs for the user jwt signing \nopenssl genrsa -out abcdesktop_jwt_user_signing_private_key.pem 1024\nopenssl rsa     -in abcdesktop_jwt_user_signing_private_key.pem -outform PEM -pubout -out abcdesktop_jwt_user_signing_public_key.pem\n\n</code></pre> <p>Then, create the kubernetes secrets from the new key files:</p> <pre><code># create the kubernetes rsa keys secret for abcdesktop\nkubectl create secret generic abcdesktopjwtdesktoppayload --from-file=abcdesktop_jwt_desktop_payload_private_key.pem --from-file=abcdesktop_jwt_desktop_payload_public_key.pem --namespace=abcdesktop\nkubectl create secret generic abcdesktopjwtdesktopsigning --from-file=abcdesktop_jwt_desktop_signing_private_key.pem --from-file=abcdesktop_jwt_desktop_signing_public_key.pem --namespace=abcdesktop\nkubectl create secret generic abcdesktopjwtusersigning --from-file=abcdesktop_jwt_user_signing_private_key.pem --from-file=abcdesktop_jwt_user_signing_public_key.pem --namespace=abcdesktop\n</code></pre> <p>You should read on the standard output :</p> <pre><code>secret/abcdesktopjwtdesktoppayload created\nsecret/abcdesktopjwtdesktopsigning created\nsecret/abcdesktopjwtusersigning created\n</code></pre>  <p>Only if you use a private registry or if the abcdesktop registry is private Create Secret to allow kubernetes to download abcdesktop images from docker registry. For this part you need to change docker-username and docker-password by credentials provided by project owner. If you don't have this values, you will have to build abcdesktop images by yourself.</p> <p>change docker.json path if need /root/.docker/config.json  <code>kubectl create secret generic abcdesktopregistrysecret --from-file=.dockerconfigjson=/root/.docker/config.json --type=kubernetes.io/dockerconfigjson -n abcdesktop</code></p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#verify-secrets","title":"Verify Secrets","text":"<p>You can verify secrets creation with the following command :</p> <pre><code>kubectl get secrets -n abcdesktop\n</code></pre> <p>You should read on the standard output :</p> <pre><code>NAME                           TYPE                                  DATA   AGE\ndefault-token-5zknd            kubernetes.io/service-account-token   3      6m6s\nabcdesktopjwtdesktoppayload   Opaque                                2      68s\nabcdesktopjwtdesktopsigning   Opaque                                2      68s\nabcdesktopjwtusersigning      Opaque                                2      67s\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/#step-3-download-core-images-create-pods-and-services","title":"Step 3: Download core images, create Pods, and services","text":"<p>On a worker node, fetch the three user default images, to make sure that Kubernetes will find the docker images at startup time. </p> <pre><code>docker pull abcdesktopio/oc.user.kubernete.18.04:2.0\ndocker pull abcdesktopio/oc.cupsd.18.04:2.0\ndocker pull abcdesktopio/oc.pulseaudio.18.04:2.0\n</code></pre> <p>You should read on the standard output</p> <pre><code>oc.user.18.04: Pulling from abcdesktopio\n...[cut here]...\ndocker.io/abcdesktopio/oc.user.18.04:2.0\n\noc.cupsd.18.04: Pulling from abcdesktopio\n...[cut here]...\ndocker.io/abcdesktopio/oc.cupsd.18.04\n\noc.pulseaudio.18.04: Pulling from abcdesktopio\n...[cut here]...\ndocker.io/abcdesktopio/oc.pulseaudio.18.04\n</code></pre> <p>Create the abcdesktop pods and services</p> <p>abcdesktop.yaml file contains declarations for all roles, service account, pods, and services required for abcdesktop.</p> <p>Run the command line</p> <pre><code>kubectl create -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop.2.0.yaml\n</code></pre> <p>You should read on the standard output</p> <pre><code>clusterrole.rbac.authorization.k8s.io/pyos-role created\nclusterrolebinding.rbac.authorization.k8s.io/pyos-rbac created\nserviceaccount/pyos-serviceaccount created\nstorageclass.storage.k8s.io/storage-local-abcdesktop created\npersistentvolume/pv-volume-home-directory created\npersistentvolumeclaim/persistentvolumeclaim-home-directory created\nconfigmap/abcdesktop-config created\nconfigmap/nginx-config created\ndeployment.apps/memcached-od created\nsecret/mongodb-secret created\nstatefulset.apps/mongodb-od created\ndaemonset.apps/daemonset-nginx created\ndeployment.apps/speedtest-od created\ndaemonset.apps/daemonset-pyos created\nendpoints/desktop created\nservice/desktop created\nservice/memcached created\nservice/mongodb created\nservice/speedtest created\nservice/nginx created\nservice/pyos created\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/#verify-pods","title":"Verify Pods","text":"<p>Once the pods are created, all pods should be running. For the first time, status maybe long to become running as some container images may be downloaded</p> <pre><code>kubectl get pods -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME                                   READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-nfsbm                  1/1     Running   0          29s\ndaemonset-pyos-8kvfp                   1/1     Running   0          29s\nmemcached-od-5bf65bf745-j69lh          1/1     Running   0          29s\nmongodb-od-6cbf8d74d-2rdmd             1/1     Running   0          29s\nopenldap-od-8dc9f56d8-wtlxl            1/1     Running   0          29s\nspeedtest-od-7cb7dd44f5-p947s          1/1     Running   0          29s\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/#connect-your-local-abcdesktop","title":"Connect your local abcdesktop","text":"<p>Open your navigator to http://[your-ip-hostname]:30443/</p> <p>abcdesktop homepage should be available :</p>  <p>Click on the Connect with Anonymous access button. abcdesktop service pyos is creating a new desktop using the user container docker image oc.user.18.04.</p>  <p>Few seconds later, processes are ready to run. You should see the abcdesktop main screen.</p>  <p>Great you have installed abcdesktop.io in Kubernetes mode. You just need a web browser to reach your web workspace. It' now time to add some applications. Read the chapter add kubernetes container</p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#troubleshoot","title":"Troubleshoot","text":"<p>All resources can be inspected to get more informations.</p> <p>First list elements you want to verify, in the following case, we will inspect pods :</p> <pre><code>    kubectl get pods -n abcdesktop\n\n    NAME                            READY   STATUS             RESTARTS   AGE\n    daemonset-nginx-qnd4n           1/1     Running            0          92s\n    daemonset-pyos-6mgq4            1/1     Running            0          92s\n    memcached-od-db69c45fb-mqt4n    1/1     Running            0          92s\n    mongodb-od-ff874fcb5-sm6f7      1/1     Running            0          92s\n    speedtest-od-55c58fdd69-5znpr   0/1     ImagePullBackOff   0          92s\n</code></pre> <p>As we can see, status is \"ImagePullBackOff\" for speedtest-od pod. We will then ask kubernetes to describe the pod with the following command :</p> <p><code>kubectl describe pod speedtest-od-55c58fdd69-t99ck -n abcdesktop</code></p> <p>In this case, the important information part is at the end (it's not always the case, you can also look at \"Conditions:\" section) :</p> <pre><code>    Events:\n      Type     Reason   Age                    From             Message\n      ----     ------   ----                   ----             -------\n      Warning  Failed   7m6s (x4837 over 18h)  kubelet, cube05  Error: ImagePullBackOff\n      Normal   BackOff  2m9s (x4860 over 18h)  kubelet, cube05  Back-off pulling image \"registry.mydomain.local:443/oc.speedtest\"\n</code></pre> <p>As we can see, in this case, Kubernetes had a problem to pull oc.speedtest image from registry.</p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#verify-daemonsets","title":"Verify Daemonsets","text":"<pre><code>kubectl get daemonsets -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME              DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE\ndaemonset-nginx   1         1         1       1            1           &lt;none&gt;          16m\ndaemonset-pyos    1         1         1       1            1           &lt;none&gt;          16m\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/#verify-service-ports","title":"Verify service ports","text":"<pre><code>kubectl get services -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE\ndesktop     ClusterIP   None             &lt;none&gt;        &lt;none&gt;         17m\nmemcached   ClusterIP   10.110.16.25     &lt;none&gt;        11211/TCP      17m\nmongodb     ClusterIP   10.110.49.161    &lt;none&gt;        27017/TCP      17m\nnginx       NodePort    10.102.13.5      &lt;none&gt;        80:30443/TCP   17m\nopenldap    ClusterIP   10.108.52.65     &lt;none&gt;        389/TCP        17m\npyos        ClusterIP   10.111.123.108   &lt;none&gt;        8000/TCP       17m\nspeedtest   ClusterIP   10.101.137.100   &lt;none&gt;        80/TCP         17m\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/#verify-cluster-roles","title":"Verify cluster roles","text":"<pre><code>kubectl describe ClusterRole pyos-role -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>Name:         pyos-role\nLabels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\nPolicyRule:\n  Resources  Non-Resource URLs  Resource Names  Verbs\n  ---------  -----------------  --------------  -----\n  pods/exec  []                 []              [create get list watch update patch delete]\n  pods       []                 []              [get list watch create update patch delete]\n  secrets    []                 []              [get list watch create update patch delete]\n  pods/log   []                 []              [get list watch]\n  nodes      []                 []              [get watch list]\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/#verify-cluster-role-bindind","title":"Verify Cluster Role Bindind","text":"<pre><code>kubectl describe ClusterRoleBinding pyos-rbac -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>Name:         pyos-rbac\nLabels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\nRole:\n  Kind:  ClusterRole\n  Name:  pyos-role\nSubjects:\n  Kind            Name                 Namespace\n  ----            ----                 ---------\n  ServiceAccount  pyos-serviceaccount  abcdesktop\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop/#view-pyos-logs","title":"View pyos logs","text":"<p>Since the abcdesktop pyos code needs to interact with the Docker API in order to CRUD containers, pyos need to mount /var/run/docker.sock into the container</p>  <pre><code>kubectl logs daemonset-pyos-tklg8 --follow -n abcdesktop\n</code></pre> <p>Note that you also can view logs using docker command</p>"},{"location":"2.0/setup/kubernetes_abcdesktop/#rollout-daemonset","title":"Rollout daemonset","text":"<p>To rollout restart the abcdesktop daemonset</p> <pre><code>kubectl rollout restart daemonset -n abcdesktop\n</code></pre> <p>You should read on the standard output </p> <pre><code>daemonset.apps/daemonset-nginx restarted\ndaemonset.apps/daemonset-pyos restarted\n</code></pre> <p>Check the pods status  </p> <pre><code>kubectl get pods  -n abcdesktop\nNAME                            READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-dh2xd           1/1     Running   0          4m22s\ndaemonset-pyos-9xn26            1/1     Running   0          3m52s\nmemcached-od-5bf65bf745-xpvvr   1/1     Running   3          45h\nmongodb-od-656d85c49f-242jh     1/1     Running   4          45h\nopenldap-od-5945946767-qf2hn    1/1     Running   0          45m\nspeedtest-od-d94b8cb5c-52wf5    1/1     Running   0          45m\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop_applications/","title":"Setup applications for abcdesktop","text":"<p>Each application is a docker container, to install new docker container run the docker pull command :</p> <p>Install LibreOffice Suite </p> <pre><code>docker pull abcdesktopio/base.d:2.0\ndocker pull abcdesktopio/calc.d:2.0\ndocker pull abcdesktopio/impress.d:2.0\ndocker pull abcdesktopio/math.d:2.0\ndocker pull abcdesktopio/writer.d:2.0\n</code></pre> <p>Install Mozilla Suite </p> <pre><code>docker pull abcdesktopio/firefox.d:2.0\ndocker pull abcdesktopio/thunderbird.d:2.0\n</code></pre> <p>Install Gnome games </p> <pre><code>docker pull abcdesktopio/mines.d:2.0\ndocker pull abcdesktopio/tetravex.d:2.0\n</code></pre> <p>Install Gnome tools </p> <pre><code>docker pull abcdesktopio/calculator.d:2.0\ndocker pull abcdesktopio/terminal.d:2.0\n</code></pre>"},{"location":"2.0/setup/kubernetes_abcdesktop_applications/#connect-to-your-abcdesktop","title":"Connect to your abcdesktop","text":"<p>The API server receives a new image event from docker daemon. To run the new applications just refresh you web browser page.</p> <p>Now reconnect to your abcdesktop. </p> <p>Open your navigator to http://[your-ip-hostname]:30443/</p> <pre><code>http://localhost:30443/\n</code></pre> <p>The new applications are installed, and ready to run.</p>"},{"location":"2.0/setup/requirements/","title":"Requirements","text":""},{"location":"2.0/setup/requirements/#prerequisites-for-abcdesktop-setup-in-release-2x","title":"Prerequisites for abcdesktop setup in release 2.x","text":"<ul> <li>Architecture <code>x86-64</code> ( <code>arm-64</code> is not yet available)</li> <li>16 GB of free space to store sample applications ( <code>gimp</code>, <code>libreoffice writer</code>, <code>libreoffice calc</code>, <code>libreoffice math</code>, <code>libreoffice impress</code>, <code>firefox</code> ) and core image services</li> </ul>"},{"location":"2.0/setup/requirements/#release-2x","title":"Release 2.x","text":"<ul> <li> <p>Kubernetes release must be less than 1.24</p> </li> <li> <p>You need to install <code>docker</code> on each worker node. There is a depend to dockerd in all releases 2.x. Application runs as <code>docker container</code> or as <code>kubernetes pod</code>. </p> </li> <li> <p><code>Pyos</code> service use access to the <code>dockerd socket</code>.</p> </li> </ul>"},{"location":"2.0/setup/requirements/#supported-architectures","title":"Supported Architectures","text":"<p>Our images support only architectures <code>x86-64</code>. The architectures supported by this image is:</p>    Architecture Tag     x86-64 amd64-latest"},{"location":"2.0/setup/requirements/#gnulinux","title":"GNU/Linux","text":"<p>The recommended distrubution is Ubuntu 20.04.5 LTS (Focal Fossa)</p>"},{"location":"3.0/features/","title":"abcdesktop release 3.0","text":"<p>The abcdesktop release 3.0 has started in May 2022</p> <ul> <li>Kubernetes release greater or equal to 1.24</li> <li>No depend to docker, an application runs as pod or as an ephermeral container</li> <li>All container-runtimes are supported. <code>containerd</code> is recommended by default</li> <li>abcdesktop release 3.x is unstable, API endpoints can change.</li> </ul>"},{"location":"3.0/features/#architecture-abcdesktop-30","title":"Architecture abcdesktop 3.0","text":"<p>In release 3.0, the abcdesktop control plane uses only <code>Kubernetes</code> API. It doesn't depend to <code>dockerd</code>. </p>"},{"location":"3.0/features/#user-pod","title":"User pod","text":""},{"location":"3.0/features/#applications","title":"Applications","text":"<p>Application can run as : </p> <ul> <li><code>kubernetes pod</code></li> <li><code>kubernetes ephemeral container</code></li> </ul>"},{"location":"3.0/features/#volumes","title":"Volumes","text":"<p><code>ephemeral container</code> doesn't support <code>subpath</code>. It means that abcdesktop desktop application based on <code>ephemeral container</code> doesn't support subpath. abcdesktop user home directory MUST be mounted as <code>hostPath</code> on each worker node.</p> <p>In the release <code>persistentVolumeClaim</code> is not supported for user home directory, while <code>ephemeral container</code> doesn't support <code>subpath</code>.</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/","title":"application runtime <code>Ephemeral container</code> and <code>Pod</code>","text":"<p>An abcdesktop application can run as a kubernetes <code>ephemeral container</code> or as a <code>pod</code>.</p> <p>An <code>ephemeral container</code> can access to share memory <code>shm</code> with the X11 server. An ephemeral container run always on the same node as the user pod, where the graphical container 'X11 server' is running. An <code>ephemeral container</code> does not prevent cpu and memory resource limits.</p> <p>A <code>pod</code> can't access to share memory with the X11 server. An kubernetes pod can run on separated node from the user's pod node. For a <code>pod</code>, you can specify resource limits.</p>  <p>To describe the difference between <code>ephemeral-container</code> and <code>pod-application</code>, we use the game 2048, one instance come from alpine based on <code>gtk</code>, the second one come from ubuntu based on <code>qt</code></p> <ul> <li><code>2048-alpine</code> is a GTK application, and is defined to run as <code>ephemeral-container</code></li> <li><code>2048-ubuntu</code> is a QT application, and is defined to run as a kubernetes pod</li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#requirements","title":"Requirements","text":"<ul> <li><code>jq</code> command preinstalled.</li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#start-a-shell-to-your-abcdesktop-server","title":"Start a shell to your abcdesktop server","text":"<p>Get a shell to your abcdestkop server.</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#download-2048-alpine-and-2048-ubuntu-json-files","title":"Download <code>2048-alpine</code> and <code>2048-ubuntu</code> json files","text":"<p>Open a shell to your abcdesktop server</p> <pre><code>curl --output 2048-alpine.d.3.0.json https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/2048-alpine.d.3.0.json\ncurl --output 2048-ubuntu.d.3.0.json https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/2048-ubuntu.d.3.0.json\n</code></pre> <p>Check that the json files are downloaded</p> <pre><code>$ ls -la *.json\n-rw-r--r-- 1 root root 29183 Dec 28 16:24 2048-alpine.d.3.0.json\n-rw-r--r-- 1 root root 29099 Dec 28 16:24 2048-ubuntu.d.3.0.json\n</code></pre> <p>Look at the label oc.containerengine for each json file </p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#read-the-label-occontainerengine-for-2048-alpine","title":"Read the label oc.containerengine for 2048-alpine","text":"<pre><code>cat 2048-alpine.d.3.0.json | jq -r '.[0].Config.Labels.\"oc.containerengine\"'\n</code></pre> <p>The response is <code>ephemeral_container</code></p> <pre><code>ephemeral_container\n</code></pre> <p>This application 2048-alpine will start as an <code>ephemeral_container</code></p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#read-the-label-occontainerengine-for-2048-alpine_1","title":"Read the label oc.containerengine for 2048-alpine","text":"<pre><code>cat 2048-ubuntu.d.3.0.json | jq -r '.[0].Config.Labels.\"oc.containerengine\"'\n</code></pre> <p>The response is <code>pod_application</code></p> <pre><code>pod_application\n</code></pre> <p>This application 2048-ubuntu will start as a <code>pod_application</code>, it's a pod.</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#put-2048-alpine-and-2048-ubuntu-applications-to-your-abcdesktop-service","title":"PUT <code>2048-alpine</code> and <code>2048-ubuntu</code> applications to your abcdesktop service","text":"<pre><code>curl -X PUT -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image -d @2048-alpine.d.3.0.json\ncurl -X PUT -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image -d @2048-ubuntu.d.3.0.json\n</code></pre> <p>Each curl command returns a complete json document.</p> <p>Wait for the pull pod are <code>Ready</code></p> <pre><code>kubectl wait --for=condition=Ready pods --selector=type=pod_application --timeout=-1s -n abcdesktop\n</code></pre> <p>Wait for condition met</p> <pre><code>pod/pull-2048-alpine-install-4280c633e777dceb3f529f208b442c0dff891 condition met\npod/pull-2048-ubuntu-install-ee652f4ff381655768bcc09d54a9b62ab7684 condition met\n</code></pre>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#login-to-your-abcdesktop-service","title":"Login to your abcdesktop service","text":"<p>Using a web browser, open the abcdesktop service url. If your are running abcdesktop on your local device, the url should be : </p> <pre><code>http://localhost:30443\n</code></pre>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#choose-to-login-as-hermes","title":"Choose to login as hermes","text":"<p>Login in as the user <code>Hermes Conrad</code> </p> <ul> <li>Login: <code>Hermes Conrad</code></li> <li>Password: <code>hermes</code></li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#your-desktop-is-created","title":"Your desktop is created","text":"<p>Your desktop is created. By default your dock is empty.</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#look-for-2048","title":"Look for 2048","text":"<p>In the search text area, write the keyword <code>2048</code></p>  <p>The two applications appear in the search result applications area. </p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#start-each-2048-application","title":"Start each 2048 application","text":"<p>Start <code>2048-ubuntu</code> and <code>2048-alpine</code> application</p>  <p><code>2048-ubuntu</code> and <code>2048-alpine</code> applications start. The application <code>2048-alpine</code> can start quickly than the application <code>2048-ubuntu</code>. </p> <ul> <li><code>2048-alpine</code> is an ephemeral container attached to the graphical container.</li> <li><code>2048-ubuntu</code> is a complete kubernetes pod.</li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#lets-have-a-look-on-your-server-side","title":"Let's have a look on your server side","text":""},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#get-pod-application","title":"Get pod application","text":"<p>Get the running pod using <code>kubectl get pods -n abcdesktop</code></p> <pre><code>$ kubectl get pods -n abcdesktop\nNAME                                                      READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-4wdkd                                     1/1     Running   0          11m\ndaemonset-pyos-5cxtw                                      1/1     Running   0          11m\nhermes-7af63f49-0d25-4de8-9d28-5fa79cc83faa               4/4     Running   0          92s\nhermes-app-2048-ubuntu-a5a8695d1a2744fd9240ad31954e64e6   1/1     Running   0          27s\nmemcached-od-bdcbbcb74-kwwb5                              1/1     Running   0          11m\nmongodb-od-6484d8bc67-24w6v                               1/1     Running   0          11m\nopenldap-od-795c55f6db-mnqvb                              1/1     Running   0          11m\nspeedtest-od-5565dfdc67-6p67m                             1/1     Running   0          11m\n</code></pre> <p>The application <code>2048-ubuntu</code> is listed as a pod. The application <code>2048-ubuntu</code> is a pod. The prefix is the <code>$userid-app</code> for example <code>hermes-app-2048-ubuntu-a5a8695d1a2744fd9240ad31954e64e6</code>, followed by the application name <code>2048-ubuntu</code> and a uuid.</p> <p>The application <code>2048-alpine</code> is not a pod.</p> <p>The application <code>2048-alpine</code> is listed as an ephemeral container, inside the user pod <code>hermes-7af63f49-0d25-4de8-9d28-5fa79cc83faa</code></p> <pre><code>kubectl get pods hermes-7af63f49-0d25-4de8-9d28-5fa79cc83faa -o json -n abcdesktop | jq -r \".status.ephemeralContainerStatuses\"\n</code></pre> <p>The application 2048-alpine.d is listed in the .status.ephemeralContainerStatuses </p> <pre><code>[\n  {\n    \"containerID\": \"containerd://3ae068cd70b251bb5da5d22d29247d0ffc3916fae742748bdf87f15d92d58e18\",\n    \"image\": \"docker.io/abcdesktopio/2048-alpine.d:3.0\",\n    \"imageID\": \"docker.io/abcdesktopio/2048-alpine.d@sha256:5ba5291dbf719ad70d70c763d899aeb012048a1e7f80e03b500ad050b436273c\",\n    \"lastState\": {},\n    \"name\": \"hermes-conrad-2048-alpine-7b6f7fae3fe84a81b28c578d6d48147e\",\n    \"ready\": false,\n    \"restartCount\": 0,\n    \"state\": {\n      \"running\": {\n        \"startedAt\": \"2022-12-28T16:29:19Z\"\n      }\n    }\n  }\n]\n</code></pre>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#ephemeral-container-versus-pod-application","title":"Ephemeral container versus Pod application","text":"<p>An <code>ephemeral container</code> can access to share memory <code>shm</code> with the X11 server. An ephemeral container run always on the same node as the X11 server. </p> <p>A <code>pod</code> can't access to share memory with the X11 server. An Kubernetes pod can run on a separated node from the X11 server.</p> <p>If your application need to share memory with X11 server, when you have to set the <code>oc.containerengine</code> label to <code>ephemeral_container</code>. </p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#compare-kubernetes-ephemeral-container-and-pod","title":"Compare kubernetes ephemeral container and pod","text":""},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#kubernetes-ephemeral-container","title":"Kubernetes ephemeral container","text":"<p>Use an ephemeral container to start an application have some advantages and some disadvantages.</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#advantages","title":"advantages","text":"<ul> <li>Start quickly</li> <li>Less system resources than a pod</li> <li>Share Process Namespace is allowed <code>shareProcessNamespace: true</code></li> <li>Share memory shm is allowed</li> <li>Share the network stack (IP Address) of the user pod</li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#disadvantages","title":"disadvantages","text":"<ul> <li>resources is disallowed</li> <li>no <code>limits</code> and <code>requests</code> (cpu, memory)</li> <li><code>nodeSelector</code> not supported</li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#kubernetes-pod","title":"Kubernetes Pod","text":"<p>Use a kubernetes pod to start an application have some advantages and some disadvantages.</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#advantages_1","title":"advantages","text":"<ul> <li>resources (cpu, memory) is allowed</li> <li><code>limits</code> and <code>requests</code> are supported</li> <li>ports, livenessProbe, readinessProbe are allowed</li> <li><code>nodeSelector</code> support an application can run on a dedicated node (for example with GPU)</li> <li>can use a dedicated network to route application data</li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#disadvantages_1","title":"disadvantages","text":"<ul> <li>More system resources than an ephemeral container</li> <li>Need X11 tcp port enabled on the user pod <code>'X11LISTEN': 'tcp'</code></li> <li>Increase network resource if application pod and user pod run a distinct host </li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#troubleshooting","title":"Troubleshooting","text":""},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#troubleshooting-badshmseg-error","title":"Troubleshooting <code>BadShmSeg</code> error","text":"<p>If you configure  2048-alpine with gtk to start as a pod and not as an ephemeral container, you will get the BadShmSeg error</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#install-the-application-2048-alpine-with-error","title":"Install the application 2048-alpine-with-error","text":"<pre><code>curl --output 2048-alpine.d.3.0.json https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/2048-alpine-with-error.d.3.0.json\n2048-alpine-with-error.d.3.0.json\n</code></pre>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#put-2048-alpine-with-error-applications-to-your-abcdesktop-service","title":"PUT <code>2048-alpine-with-error</code> applications to your abcdesktop service","text":"<pre><code>curl -X PUT -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image -d @2048-alpine-with-error.d.3.0.json\n</code></pre> <p>Wait for the pulled pod are <code>Ready</code></p> <pre><code>kubectl wait --for=condition=Ready pods --selector=type=pod_application_pull --timeout=-1s -n abcdesktop\n</code></pre> <p>Wait for condition met</p> <pre><code>pod/pull-2048-alpine-with-error-install-935509a58088531ae57756 condition met\n</code></pre> <p>Login to your abcdesktop service </p> <p>Using a web browser, open the abcdesktop service url. If your are running abcdesktop on your local device, the url should be : </p> <pre><code>http://localhost:30443\n</code></pre>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#choose-to-login-as-hermes_1","title":"Choose to login as hermes","text":"<p>Login in as the user <code>Hermes Conrad</code> </p> <ul> <li>Login: <code>Hermes Conrad</code></li> <li>Password: <code>hermes</code></li> </ul>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#your-desktop-is-created_1","title":"Your desktop is created","text":"<p>Your desktop is created. By default your dock is empty.</p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#look-for-2048_1","title":"Look for 2048","text":"<p>In the search text area, write the keyword <code>2048</code></p>  <p>The three applications appear in the search result applications area. </p> <p>Start the 2048 (alpine gtk with error) application. It uses shared segment with X Window System, it must run as an ephemeral container, but as a pod it fails. The application starts but exit after few seconds, the content of the application does not appear.</p>  <p>In the abcdesktop menu, choose <code>Settings</code> |\u00a0<code>Tasks</code>. </p>  <p>Then select the <code>Logs</code> button. The error was 'BadShmSeg (invalid shared segment parameter)'.</p> <pre><code>(org.gnome.TwentyFortyEight:36): Gdk-WARNING **: 10:14:26.185: The program 'org.gnome.TwentyFortyEight' received an X Window System error.\nThis probably reflects a bug in the program.\nThe error was 'BadShmSeg (invalid shared segment parameter)'.\n(Details: serial 820 error_code 128 request_code 131 (MIT-SHM) minor_code 3)\n(Note to programmers: normally, X errors are reported asynchronously;\nthat is, you will receive the error a while after causing it.\nTo debug your program, run it with the GDK_SYNCHRONIZE environment\nvariable to change this behavior. You can then get a meaningful\nbacktrace from your debugger if you break on the gdk_x_error() function.)\n</code></pre> <p>If you are running QT application, you can disable the X11 MIT Shared Memory Extension support. The MIT-SHM is an extension to the X server which allows faster transactions by using shared memory. Container isolation blocks it. Qt applications can be forced not to use the extension, by setting the variable <code>QT_X11_NO_MITSHM</code> value to <code>1</code>.</p> <pre><code>QT_X11_NO_MITSHM=1 \n</code></pre>  <p>Note your can also use <code>QT_XCB_NO_MITSHM</code> value to <code>1</code> </p>"},{"location":"3.0/application/applicationruntime_ephemeralcontainer_pod/#troubleshooting-cannot-open-display-or-could-not-connect-to-display-error","title":"Troubleshooting <code>cannot open display</code> or <code>could not connect to display</code> error","text":"<p>When you start an application the log file write <code>cannot open display</code> error</p> <pre><code>kubectl logs hermes-app-2048-ubuntu-c7360cd025d04813ad5e0af74b6df4ba  -n abcdesktop \n</code></pre> <pre><code>qt.qpa.xcb: could not connect to display 172.17.0.10:0\nqt.qpa.plugin: Could not load the Qt platform plugin \"xcb\" in \"\" even though it was found.\nThis application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.\n\nAvailable platform plugins are: eglfs, linuxfb, minimal, minimalegl, offscreen, vnc, xcb.\n</code></pre> <p>Using the web shell inside an abcdesktop session, start <code>netstat -a</code> command line</p> <p>The result should show that the process <code>Xvnc</code> is listening on tcp port number <code>6000</code></p>  <pre><code>hermes:~$ netstat  -anp\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 0.0.0.0:6000            0.0.0.0:*               LISTEN      82/Xvnc               \n</code></pre> <p>If <code>Xvnc</code> is not listening on tcp port number <code>6000</code></p>  <p>Update od.config to make <code>Xvnc</code> listen on tcp port number <code>6000</code></p> <p>Open your od.config file, and look at the <code>desktop.envlocal</code> option.</p> <p>Add <code>'X11LISTEN': 'tcp'</code> to the dictionary :</p> <pre><code>desktop.envlocal :  {   'DISPLAY'               : ':0.0',\n                        'SET_DEFAULT_WALLPAPER' : 'welcometoabcdesktop.png',\n                        'X11LISTEN'             : 'tcp' }\n</code></pre> <p>Save your local <code>od.config</code> file.</p> <p>To apply changes, you can replace the <code>abcdesktop-config</code></p> <pre><code>kubectl delete configmap abcdesktop-config -n abcdesktop\nkubectl create --from-file=od.config -n abcdesktop\n</code></pre> <p>Then restart pyos daemonset</p> <pre><code>kubectl rollout restart daemonset.apps/daemonset-pyos -n abcdesktop\n</code></pre> <p>You should read on stdout</p> <pre><code>daemonset.apps/daemonset-pyos restarted\n</code></pre>"},{"location":"3.0/application/createsampleapplication/","title":"Create a sample application in release 3.0","text":""},{"location":"3.0/application/createsampleapplication/#requirements","title":"Requirements","text":"<ul> <li><code>ctr</code> command preinstalled .</li> <li><code>nodejs</code> and npm command preinstalled.</li> <li><code>docker</code> command preinstalled.</li> </ul>"},{"location":"3.0/application/createsampleapplication/#goals","title":"Goals","text":"<ul> <li>Create a sample application <code>xterm</code>. xterm program is a terminal emulator for the X Window System. </li> </ul>"},{"location":"3.0/application/createsampleapplication/#git-clone-application-repository","title":"git clone application repository","text":"<p>The abcdesktop application repository is https://github.com/abcdesktopio/oc.apps </p> <pre><code>git clone https://github.com/abcdesktopio/oc.apps.git\ncd oc.apps\n</code></pre> <p>And install <code>nodejs</code> packages for <code>oc.apps</code></p> <pre><code>npm install\n</code></pre>"},{"location":"3.0/application/createsampleapplication/#create-a-samplejson-file","title":"Create a sample.json file","text":"<p>abcdesktop uses a json file description to build an application.</p> <p>Create a <code>sample.json</code> file</p> <pre><code>{\n  \"tag\": \"3.0\",\n  \"acl\": { \"permit\": [ \"all\" ] },\n  \"cat\": \"development\",\n  \"icon\": \"small.svg\",\n  \"apkpackage\": \"xterm\",\n  \"keyword\": \"xterm,shell,cmd\",\n  \"launch\": \"xterm.XTerm\",\n  \"name\": \"Xterm\",\n  \"path\": \"/usr/bin/xterm\",\n  \"rules\": { \"homedir\": { \"default\": true } },\n  \"template\": \"abcdesktopio/oc.template.alpine.minimal\"\n}\n</code></pre>"},{"location":"3.0/application/createsampleapplication/#make-a-dockerfile-from-the-samplejson-file","title":"make a <code>Dockerfile</code> from the <code>sample.json</code> file","text":"<p><code>make.js</code> is a command line for abcdesktop. <code>make.js</code> read a json file and create a <code>Dockerfile</code></p> <p>The <code>make.js</code> options are :</p> <ul> <li><code>-r 3.0</code> : to build image in abcdesktop 3.0 format</li> <li><code>-d True</code> : to create a <code>Dockerfile</code> as output</li> <li><code>-f sample.json</code>: file to read as input</li> </ul> <p>npm i argparse npm notice created a lockfile as package-lock.json. You should commit this file. + argparse@2.0.1 added 1 package and audited 1 package in 0.837s found 0 vulnerabilities</p> <pre><code>node make.js -r 3.0 -d True  -f sample.json\n</code></pre> <p>Your read on stdout.</p> <pre><code>Namespace(dockerfile='True', release='3.0', applicationfile='sample.json')\nBuilding image for release=3.0\nRead database json file=sample.json\nOnly one file option to force output to dockerfile=True\nopening file sample.json\napplist.json entries: 1\n{ tag: '3.0',\n  acl: { permit: [ 'all' ] },\n  cat: 'development',\n  icon: 'small.svg',\n  apkpackage: 'xterm',\n  keyword: 'xterm,shell,cmd',\n  launch: 'xterm.XTerm',\n  name: 'Xterm',\n  path: '/usr/bin/xterm',\n  rules: { homedir: { default: true } },\n  template: 'abcdesktopio/oc.template.alpine.minimal' }\nBuilding xterm.XTerm\n</code></pre> <p>Read the <code>Dockerfile</code></p> <pre><code>cat Dockerfile\n</code></pre> <pre><code># Dynamic DockerFile application file for abcdesktopio generated by abcdesktopio/oc.apps/make.js\n# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN\nARG TAG=3.0\nFROM abcdesktopio/oc.template.alpine.minimal:$TAG\nUSER root\nRUN apk add --no-cache --update xterm\nENV BUSER balloon\nLABEL oc.icon=\"small.svg\"\nLABEL oc.icondata=\"PHN2ZyB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmVlbiIvPjwvc3ZnPgo=\"\nLABEL oc.keyword=\"xterm,xterm,shell,cmd\"\nLABEL oc.cat=\"development\"\nLABEL oc.launch=\"xterm.XTerm\"\nLABEL oc.template=\"abcdesktopio/oc.template.alpine.minimal\"\nLABEL oc.name=\"Xterm\"\nLABEL oc.displayname=\"Xterm\"\nLABEL oc.path=\"/usr/bin/xterm\"\nLABEL oc.type=app\nLABEL oc.rules=\"{\\\"homedir\\\":{\\\"default\\\":true}}\"\nLABEL oc.acl=\"{\\\"permit\\\":[\\\"all\\\"]}\"\nRUN  if [ -d /usr/share/icons ]   &amp;&amp; [ -x /composer/safelinks.sh ] &amp;&amp; [ -d /usr/share/icons   ];  then cd /usr/share/icons;    /composer/safelinks.sh; fi \nRUN  if [ -d /usr/share/pixmaps ] &amp;&amp; [ -x /composer/safelinks.sh ] &amp;&amp; [ -d /usr/share/pixmaps ];  then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi \nENV APPNAME \"Xterm\"\nENV APPBIN \"/usr/bin/xterm\"\nENV APP \"/usr/bin/xterm\"\nUSER root\nRUN mkdir -p /var/secrets/abcdesktop/localaccount &amp;&amp; cp /etc/passwd /etc/group /etc/shadow /var/secrets/abcdesktop/localaccount\nRUN rm -f /etc/passwd &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/passwd /etc/passwd\nRUN rm -f /etc/group &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/group  /etc/group\nRUN rm -f /etc/shadow &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/shadow /etc/shadow\nUSER balloon\nCMD [\"/composer/appli-docker-entrypoint.sh\"]\nWORKDIR /home/balloon\n</code></pre>"},{"location":"3.0/application/createsampleapplication/#build-the-abcsample30-from-dockerfile","title":"build the <code>abcsample:3.0</code> from Dockerfile","text":"<pre><code>docker build -t abcsample:3.0 .\n</code></pre> <pre><code>Sending build context to Docker daemon  44.21MB\nStep 1/29 : ARG TAG=3.0\nStep 2/29 : FROM abcdesktopio/oc.template.alpine.minimal:$TAG\n ---&gt; 8528ff0674c7\nStep 3/29 : USER root\n ---&gt; Using cache\n ---&gt; 10372fb6f76c\nStep 4/29 : RUN apk add --no-cache --update xterm\n ---&gt; Using cache\n ---&gt; f222db3926f1\nStep 5/29 : LABEL oc.icon=\"small.svg\"\n ---&gt; Running in 3303dde31f46\nRemoving intermediate container 3303dde31f46\n ---&gt; 2cb2fac76cbd\nStep 6/29 : LABEL oc.icondata=\"PHN2ZyB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmVlbiIvPjwvc3ZnPgo=\"\n ---&gt; Running in 65170013c043\nRemoving intermediate container 65170013c043\n ---&gt; 52af61054ac3\nStep 7/29 : LABEL oc.keyword=\"xterm,xterm,shell,cmd\"\n ---&gt; Running in ad13bedc4b0a\nRemoving intermediate container ad13bedc4b0a\n ---&gt; 5bde38f46888\nStep 8/29 : LABEL oc.cat=\"development\"\n ---&gt; Running in 238c24528439\nRemoving intermediate container 238c24528439\n ---&gt; 886ede105940\nStep 9/29 : LABEL oc.launch=\"xterm.XTerm\"\n ---&gt; Running in 1b2c45e68c29\nRemoving intermediate container 1b2c45e68c29\n ---&gt; cf827822a393\nStep 10/29 : LABEL oc.template=\"abcdesktopio/oc.template.alpine.minimal\"\n ---&gt; Running in 8adfa795a837\nRemoving intermediate container 8adfa795a837\n ---&gt; 5e17811c5290\nStep 11/29 : LABEL oc.name=\"Xterm\"\n ---&gt; Running in e2ed34859ca2\nRemoving intermediate container e2ed34859ca2\n ---&gt; e3ed08726ea1\nStep 12/29 : LABEL oc.displayname=\"Xterm\"\n ---&gt; Running in 636fa338c00f\nRemoving intermediate container 636fa338c00f\n ---&gt; 0c756bf8c322\nStep 13/29 : LABEL oc.path=\"/usr/bin/xterm\"\n ---&gt; Running in 2a7355d27588\nRemoving intermediate container 2a7355d27588\n ---&gt; 06ae4c2fdaa7\nStep 14/29 : LABEL oc.type=app\n ---&gt; Running in 0c6f5f1c9d07\nRemoving intermediate container 0c6f5f1c9d07\n ---&gt; 4bd3f1462669\nStep 15/29 : LABEL oc.rules=\"{\\\"homedir\\\":{\\\"default\\\":true}}\"\n ---&gt; Running in 1d836f666a9e\nRemoving intermediate container 1d836f666a9e\n ---&gt; 28ed74393046\nStep 16/29 : LABEL oc.acl=\"{\\\"permit\\\":[\\\"all\\\"]}\"\n ---&gt; Running in 3489fb9b8571\nRemoving intermediate container 3489fb9b8571\n ---&gt; 902caf61d44f\nStep 17/29 : RUN  if [ -d /usr/share/icons ]   &amp;&amp; [ -x /composer/safelinks.sh ] &amp;&amp; [ -d /usr/share/icons   ];  then cd /usr/share/icons;    /composer/safelinks.sh; fi\n ---&gt; Running in 0de74bad43c7\nRemoving intermediate container 0de74bad43c7\n ---&gt; 720830424aeb\nStep 18/29 : RUN  if [ -d /usr/share/pixmaps ] &amp;&amp; [ -x /composer/safelinks.sh ] &amp;&amp; [ -d /usr/share/pixmaps ];  then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi\n ---&gt; Running in 47b9a1b745e1\nRemoving intermediate container 47b9a1b745e1\n ---&gt; 9f63628f1cb5\nStep 19/29 : ENV APPNAME \"Xterm\"\n ---&gt; Running in d175a1ece669\nRemoving intermediate container d175a1ece669\n ---&gt; 150c4cfe4aa3\nStep 20/29 : ENV APPBIN \"/usr/bin/xterm\"\n ---&gt; Running in 997fee55d34e\nRemoving intermediate container 997fee55d34e\n ---&gt; 425ac1a6e205\nStep 21/29 : ENV APP \"/usr/bin/xterm\"\n ---&gt; Running in 53dd44a513fd\nRemoving intermediate container 53dd44a513fd\n ---&gt; 7df215f71bec\nStep 22/29 : USER root\n ---&gt; Running in 003691cdc4f2\nRemoving intermediate container 003691cdc4f2\n ---&gt; 0af1892ae7ad\nStep 23/29 : RUN mkdir -p /var/secrets/abcdesktop/localaccount &amp;&amp; cp /etc/passwd /etc/group /etc/shadow /var/secrets/abcdesktop/localaccount\n ---&gt; Running in 47d3dff0120d\nRemoving intermediate container 47d3dff0120d\n ---&gt; bd4bc4ebf2cf\nStep 24/29 : RUN rm -f /etc/passwd &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/passwd /etc/passwd\n ---&gt; Running in 91dfbff4d2d2\nRemoving intermediate container 91dfbff4d2d2\n ---&gt; 230d75aceb20\nStep 25/29 : RUN rm -f /etc/group &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/group  /etc/group\n ---&gt; Running in 4e0d720f0cfd\nRemoving intermediate container 4e0d720f0cfd\n ---&gt; 2545327438db\nStep 26/29 : RUN rm -f /etc/shadow &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/shadow /etc/shadow\n ---&gt; Running in 37770cba900b\nRemoving intermediate container 37770cba900b\n ---&gt; 06ba8e872dfb\nStep 27/29 : RUN rm -f /etc/gshadow &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/gshadow /etc/gshadow\n ---&gt; Running in 88f16a8cbe63\nRemoving intermediate container 88f16a8cbe63\n ---&gt; 7464bca775cd\nStep 28/29 : USER balloon\n ---&gt; Running in b7ac37070372\nRemoving intermediate container b7ac37070372\n ---&gt; e476af17dfbd\nStep 29/29 : CMD [ \"/composer/appli-docker-entrypoint.sh\" ]\n ---&gt; Running in 05b3b17a1c8c\nRemoving intermediate container 05b3b17a1c8c\n ---&gt; e96d24e8088e\nSuccessfully built e96d24e8088e\nSuccessfully tagged abcsample:3.0\n</code></pre>"},{"location":"3.0/application/createsampleapplication/#export-and-import-abcsample30","title":"export and import <code>abcsample:3.0</code>","text":"<p>abcdesktop is designed to use a private or public image registry. A registry is a mandatory service to manage kubernetes cluster with some nodes.</p> <p>In this case, we suppose we don't have a registry, and we use the same host to build and run application. We need to offer the registry service manually, and copy container image.</p> <p>Export the image to OCI image format</p> <pre><code>docker save abcsample:3.0 -o abcsample.tar\n</code></pre> <p>Import  abcsample into the namespace <code>k8s.io</code> using <code>ctr</code> </p> <pre><code>ctr -n k8s.io images import abcsample.tar\n</code></pre> <pre><code>unpacking docker.io/library/abcsample:3.0 (sha256:5ea681ec0e79928c15d9972f0ae3adfc197d55bfd27cd6cde8381a523c8ae8c0)...done\n</code></pre>"},{"location":"3.0/application/createsampleapplication/#put-abcsample30-in-to-abcdesktop","title":"put <code>abcsample:3.0</code> in to abcdesktop","text":"<p>Export the abcsample:3.0 image to OCI format</p> <pre><code>docker image inspect abcsample:3.0 &gt; abcsample.json\n</code></pre> <p>Import the <code>abcsample.json</code> into abcdesktop endpoint <code>/API/manager/image</code></p> <pre><code>curl -X PUT -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image -d @abcsample.json \n</code></pre> <p>Return a json document</p> <pre><code>[\n  {\n    \"home\": null,\n    \"cmd\": [\n      \"/composer/appli-docker-entrypoint.sh\"\n    ],\n    \"sha_id\": \"sha256:e96d24e8088ead49f0899498a377de88cf6b8b55f042bfe5dee4cfe385d71fe2\",\n    \"id\": \"abcsample:3.0\",\n    \"rules\": {\n      \"homedir\": {\n        \"default\": true\n      }\n    },\n    \"acl\": {\n      \"permit\": [\n        \"all\"\n      ]\n    },\n    \"launch\": \"xterm.XTerm\",\n    \"name\": \"Xterm\",\n    \"icon\": \"small.svg\",\n    \"icondata\": \"PHN2ZyB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmVlbiIvPjwvc3ZnPgo=\",\n    \"keyword\": \"xterm,xterm,shell,cmd\",\n    \"uniquerunkey\": null,\n    \"cat\": \"development\",\n    \"args\": null,\n    \"execmode\": null,\n    \"security_opt\": null,\n    \"showinview\": null,\n    \"displayname\": \"Xterm\",\n    \"mimetype\": [],\n    \"path\": \"/usr/bin/xterm\",\n    \"desktopfile\": null,\n    \"executablefilename\": \"xterm\",\n    \"usedefaultapplication\": null,\n    \"fileextensions\": [],\n    \"legacyfileextensions\": [],\n    \"host_config\": {},\n    \"secrets_requirement\": null,\n    \"run_inside_pod\": false,\n    \"image_pull_policy\": \"IfNotPresent\",\n    \"image_pull_secrets\": null\n  }\n]\n</code></pre>"},{"location":"3.0/application/createsampleapplication/#run-the-new-application","title":"Run the new application","text":"<p>Open a web browser and go to abcdesktop service url.</p> <p>Open a new abcdesktop session.</p>  <p>Look for your new application xterm</p>  <p>Start your new application xterm</p>  <p>The icon of then new application xterm is a green rect. It appears in the dock.</p> <p>Logoff to free ressources.</p> <p>You have created your own abcdesktop application, import the image, and start it. To get more details, look at the <code>applist.json</code> it describe all json applications for abcdesktop.</p>"},{"location":"3.0/application/createsampleapplication/#rebuild-all-images","title":"Rebuild all images","text":"<p>To rebuild all application in <code>applist.json</code>, run <code>node make.js -r 3.0</code></p> <pre><code>node make.js -r 3.0\n</code></pre> <p>This command has create new '.d' files. </p> <pre><code>$ ls *.d\nls *.d\nalpine-2048.d            calculator.d    drawio.d               flare.d          hyper.d       kturtle.d       octave.d        remotedesktopmanager.d  terminal.d     winefile-wine.d  youtube.d\napachedirectorystudio.d  chess.d         edge.d                 frozen-bubble.d  impress.d     leocad.d        onlyoffice.d    rhythmbox.d             terminalpod.d  winemine-wine.d\nastromenace.d            chrome.d        elementary.terminal.d  gcompris.d       inkscape.d    librecad.d      openshift.d     robots.d                tetravex.d     winhelp-wine.d\natom.d                   chromium.d      eog.d                  gedit.d          kalzium.d     mahjongg.d      pinta.d         shotcut.d               thunderbird.d  winscp-wine.d\nbase.d                   citrix.d        evince.d               gelemental.d     kdiamond.d    math.d          planner.d       stellarium.d            ubuntu-2048.d  wireshark.d\nbeekeeperstudio.d        cloudfoundry.d  evolution.d            geogebra.d       kgeography.d  mathwar.d       postman.d       step.d                  vice.d         writer.d\nblender.d                cntlm.d         file-roller.d          gimagereader.d   kigo.d        minecraft.d     putty-unix.d    stress.d                vlc.d          xedit.d\nbless.d                  corsix-th.d     filelight.d            gimp.d           klickety.d    mines.d         putty-wine.d    sublime-text.d          vmmacos.d      xeyes.d\nblobby.d                 dia.d           filezilla.d            gnumeric.d       klotski.d     nautilus.d      qelectrotech.d  supertux2.d             vmrc.d         xman.d\nbrackets.d               doom.d          firefox-esr.d          golly.d          konsole.d     notepad-wine.d  remarkable.d    swell-foop.d            vmubuntu.d     xpad.d\ncalc.d                   draw.d          firefox.d              gretl.d          ksquares.d    notepadqq.d     remmina.d       teams.d                 vscode.d       xterm.d\n</code></pre> <p>Each <code>.d</code> file is a <code>Dockerfile</code> </p> <p>Run <code>make</code> to build all applications (it can take more than 2 hours) </p> <pre><code>make\n</code></pre>"},{"location":"3.0/config/authentification-rules/","title":"Authentification rules configuration","text":"<p>All auth providers support rules configuration</p> <p>A rule take some parameters and set label to the auth user. All labels are stored inside the JWT Auth token. The labels are use to define a container execution context. For example to set a dedicated network for firefox application ( read the how-to ) </p>"},{"location":"3.0/config/authentification-rules/#the-rule-object","title":"The rule object","text":"<p>A rule is a dictionary object with :</p> <ul> <li>a name (the entry of the rules)</li> <li>one or more conditions</li> <li>and expected boolean value True or False</li> <li>a label to set if the conditions are equal to the expected boolean value</li> </ul> <p>Example :</p> <p>To test if the user source IP address is equal to <code>8.8.8.1/32</code></p> <pre><code>'rule-home': { \n    'conditions' : [   { 'network': '8.8.8.1/32', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'homeipsource' }\n</code></pre>"},{"location":"3.0/config/authentification-rules/#the-conditions-object","title":"The conditions object","text":"<p><code>conditions</code> is a list of condition. All condition are always tested, as a logical <code>AND</code>. The result must be equal to the <code>expected</code> value.</p>"},{"location":"3.0/config/authentification-rules/#examples","title":"Examples:","text":""},{"location":"3.0/config/authentification-rules/#example-true-and-true-expected-true","title":"Example (TRUE and TRUE) expected TRUE:","text":"<p>To test if the user source IP address is in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'shipcrewandnet80', if the 'expected' value is <code>True</code></p>"},{"location":"3.0/config/authentification-rules/#example-true-and-true-expected-false","title":"Example (TRUE and TRUE) expected FALSE:","text":"<p>To test if the user source IP address is <code>NOT</code> in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is  <code>NOT</code> a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : False,\n    'label': 'noshipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'noshipcrewandnonet80', if the 'expected' value is <code>False</code></p>"},{"location":"3.0/config/authentification-rules/#example-true-and-false-expected-true","title":"Example (TRUE and FALSE) expected TRUE:","text":"<p>To test if the user source IP address is in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is  <code>NOT</code> a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : True },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : False } ], \n    'expected' : True,\n    'label': 'noshipcrewandnet80'\n}\n</code></pre> <p>Add the labels 'noshipcrewandnet80', if the 'expected' value is <code>True</code></p>"},{"location":"3.0/config/authentification-rules/#example-false-and-true-expected-true","title":"Example (FALSE and TRUE) expected TRUE:","text":"<p>To test if the user source IP address is <code>NOT</code> in the subnet to <code>80.0.0.0/8</code> <code>AND</code> is   a <code>memberOf</code> ldap group DN 'cn=ship_crew,ou=people,dc=planetexpress,dc=com' </p> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'network': '80.0.0.0/8', 'expected' : False },\n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewandnonet80'\n}\n</code></pre> <p>Add the labels 'shipcrewandnonet80', if the 'expected' value is <code>True</code></p>"},{"location":"3.0/config/authentification-rules/#the-condition-value","title":"The condition value","text":"name description example     boolean always true or false 'boolean' : 'true'   httpheader test a HTTP header value 'httpheader':   memberOf test if the LDAP user object is member of group 'memberOf': [ 'cn=ship_crew,ou=people,dc=planetexpress,dc=com']   network test if the client user IP Address is in a network subnet 'network': [ '1.2.3.4/24']   primarygroupid test if the LDAP user object has a attibute primaryGroupID and is equal to value 'primarygroupid': '513'"},{"location":"3.0/config/authentification-rules/#condition-boolean","title":"condition boolean","text":"<p>This condition is a dummy condition; Only use to force a label or to disable a test.</p> <pre><code>'boolean': boolean\n</code></pre> <p>The commun usage is </p> <pre><code>'rule-dummy': { 'conditions':  [  { 'boolean': True, 'expected' : True  } ],\n                   'expected' : True,\n                 'label': 'dummy'\n}\n</code></pre> <p>or alway False</p> <pre><code>'rule-dummy': { 'conditions':  [  { 'boolean': True, 'expected' : True  } ],\n                   'expected' : False,\n                 'label': 'dummy'\n}\n</code></pre>"},{"location":"3.0/config/authentification-rules/#condition-httpheader","title":"condition httpheader","text":"<p>This condition is test if a HTTP Header value is equal to a string. </p> <pre><code>'httpheader': dict\n</code></pre> <p>example : if the 'User-Agent' is equal to <code>'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36' then add the label 'chromemaxosx112'</code></p> <pre><code>\n 'rule-httpheader': { \n        'conditions' : [ \n            {   'httpheader': { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36' }, \n                'expected' : True  } ],\n        'expected' : True,\n        'label': 'chromemaxosx112' }\n\n</code></pre>"},{"location":"3.0/config/authentification-rules/#condition-network","title":"condition network","text":"<p>This condition is test if the client source ip address is in a subnet. IPv4 and IPv6 are supported.</p> <pre><code>'network': string\n</code></pre> <p>example</p> <p>To test if the user source IP address is equal to <code>8.8.8.1/32</code></p> <pre><code>'rule-home': { \n    'conditions' : [   { 'network': '8.8.8.1/32', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'homeipsource' }\n</code></pre> <p>To test if the user source IP address is in the subnet <code>10.0.0.0/8</code></p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '10.0.0.0/8', 'expected' : True } ],\n                         'expected' : True,\n                         'label': 'localnet' }\n</code></pre> <p>To test if the user source IP address is NOT in the subnet <code>192.168.0.0/24</code></p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '192.168.0.0/24', 'expected' : False } ],\n                         'expected' : True,\n                         'label': 'no192168net' }\n</code></pre> <p>same as </p> <pre><code>'rule-localnet': { \n    'conditions' : [   { 'network': '192.168.0.0/24', 'expected' : True } ],\n                         'expected' : False,\n                         'label': 'no192168net' }\n</code></pre>"},{"location":"3.0/config/authentification-rules/#ipv4-and-ipv6-subnets-support","title":"IPv4 and IPv6 subnets support","text":"<p>To support private ip addresses subnet in the rfc 1918 and rfc 3927, write separated rules. Both IPv6 and IPv4 addresses are supported.  You can share the same label <code>privatenetwork</code> a separated rule. </p> <pre><code>'policies': {\n    'acl' : {},\n    'rules' : { \n          'rule-privatenetwork-10': {   'conditions' : [ { 'network': '10.0.0.0/8', 'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'rule-privatenetwork-172': {'conditions' : [ { 'network': '172.16.0.0/12', 'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'Rule-privatenetwork-192': {'conditions' : [ { 'network': '192.168.0.0/16',     'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'Rule-privatenetwork-169': {'conditions' : [ { 'network': '169.254.0.0/16',     'expected' : True } ], \n                                            'expected'   : True, \n                                            'label': 'privatenetwork' },\n          'rule-privatenetwork-fe80':{  'conditions' : [ { 'network': 'fe80::/10',     'expected' : True } ], \n                                                'expected'   : True, \n                                                'label': 'privatenetwork' }\n    }\n}                       \n</code></pre>"},{"location":"3.0/config/authentification-rules/#condition-memberof","title":"condition memberof","text":"<p>This condition test if the user is a member of a LDAP Distinguished Name. </p> <pre><code>'memberOf': string\n</code></pre> <pre><code> 'rule-sample': { 'conditions':  [ \n    { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',  'expected' : True } ], \n    'expected' : True,\n    'label': 'shipcrewgrp'\n}\n</code></pre>"},{"location":"3.0/config/authentification-rules/#condition-primarygroupid","title":"condition primarygroupid","text":"<p>This test is only used with Microsoft Active Directory. primarygroupid test if the user attibute primaryGroupID is equal to a string.</p> <pre><code>'primarygroupid': string\n</code></pre> <p>To check is a user is memberof a <code>DOMAIN\\USER</code> the primary group id is <code>513</code></p> <pre><code>'rule-domainuser': {    'conditions':  [ { 'primarygroupid': '513', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'domainuser'\n}\n</code></pre> <p>However, if the user needed to be seen as a <code>Domain Admin for POSIX</code>, the <code>PrimaryGroupID</code> is <code>512</code>, the RID for that group. </p> <pre><code>'rule-posixdomainadmin': {  'conditions':  [ { 'primarygroupid': '519', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'posixdomainadmin'\n}\n</code></pre> <p>The <code>Enterprise Admins group</code>, <code>519</code>, is also used to grant this level in POSIX.</p> <pre><code>'rule-enterpriseadmin': {   'conditions':  [ { 'primarygroupid': '519', 'expected' : True } ],\n                            'expected' : True,\n                            'label': 'enterpriseadmin'\n}\n</code></pre>"},{"location":"3.0/config/authentification/","title":"Authentification","text":""},{"location":"3.0/config/authentification/#configuration-file","title":"Configuration file","text":"<p>The authentification configuration is set in the <code>od.config</code> file. In this chapter you will need to update the od.config configuration file.  This update differs depending on the configuration docker mode or kubernetes mode. </p> <p>Read the  Update your configuration file and apply the new configuration file section to make change in od.config file for kubernetes cluster.</p>"},{"location":"3.0/config/authentification/#the-dictionary-authmanagers","title":"The dictionary authmanagers","text":"<p>The authmanagers is defined as a dictionnary object :</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { }\n}\n</code></pre> <p>The <code>od.config</code> defines four kinds of entries in the <code>authmanagers</code> object :</p> <ul> <li><code>external</code>: use for OAuth 2.0 Authentification</li> <li><code>explicit</code>: use for LDAP, LDAPS and ActiveDirectory Authentification</li> <li><code>metaexplicit</code>: use  Microsoft Active Directory Trusted relationship, with support of FSP (Foreign Security Principals)</li> <li><code>implicit</code>: use for Anonymous Authentification and SSL-client certificat </li> </ul>"},{"location":"3.0/config/authentification/#related-authmanagers","title":"Related authmanagers","text":"authmanagers type Description     <code>external</code> For OAuth 2.0 authentification   <code>metaexplicit</code> For Microsoft Active Directory Trusted relationship, with support of Foreign Security Principals and Special Identities   <code>explicit</code> For LDAP, LDAPS, Active Directory Authentification, and Kerberos authentification   <code>implicit</code> For anonymous authentification, for an always True Authentification, and SSL-client certificat"},{"location":"3.0/config/authentification/#hands-on","title":"Hands-on","text":""},{"location":"3.0/config/authentification/#requirements","title":"Requirements","text":"<p>You should have read the hands-on :</p> <ul> <li>Update your configuration file and apply the new configuration file section to make change in od.config file for kubernetes cluster.</li> </ul>"},{"location":"3.0/config/authentification/#change-authmanagers-configuration","title":"Change authmanagers configuration","text":"<p>Edit your od.config pyos configuration file, and set the value to the authmanagers dictionnay with empty values for <code>implicit</code>, <code>explicit</code>, and <code>external</code>, as describe :</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { }\n}\n</code></pre> <p>Save your new od.config file, and restart the pyos daemonset</p> <p>Start your web browser and open the URL <code>http://localhost:30443</code></p>  <p>The Web home page should only show the title abcdesktop.io. There is no <code>authmanagers</code> available.</p> <p>Great you can now add some value to authenticate your users.</p>"},{"location":"3.0/config/authentification/#authmanagers-implicit","title":"authmanagers <code>implicit</code>:","text":"<p><code>implicit</code> is the easiest configuration mode, and is used to run Anonymous authentification (always True).  Read the authmanagers implicit Section.</p>"},{"location":"3.0/config/authentification/#authmanagers-explicit","title":"authmanagers <code>explicit</code>:","text":"<p><code>explicit</code> is defined to use a directory service like LDAP.  Read the authmanagers explicit Section.</p>"},{"location":"3.0/config/authentification/#authmanagers-metaexplicit","title":"authmanagers <code>metaexplicit</code>:","text":"<p><code>metaexplicit</code> offers a support to Microsoft Active Directory Trusted relationship, with support of Foreign Security Principals and Special Identities.  Read the authmanagers explicit Section.</p>"},{"location":"3.0/config/authentification/#authmanagers-external","title":"authmanagers <code>external</code>:","text":"<p><code>external</code> use external OAuth 2.0 authentication, for example Google OAuth 2.0, or Github OAuth 2.0  Read the authmanagers external Section.</p>"},{"location":"3.0/config/authentification/#authmanagers-sample","title":"authmanagers sample","text":"<p>In the authmanagers implicit section, authmanagers explicit section, and authmanagers external section, you have learned how to defined the providers. </p> <p>You can set a complete <code>authmanagers</code> dictionary as described with <code>external</code>, <code>explicit</code> and <code>implicit</code></p> <pre><code>authmanagers: {\n  'external': {\n    'providers': {\n      'facebook': { \n        'displayname': 'Facebook', \n        'enabled': True,\n        'client_id':     'XXXXXXX', \n        'client_secret': 'YYYYYYY', \n        'dialog_url': 'https://www.facebook.com/dialog/oauth?client_id={client_id}&amp;redirect_uri={callback_url}&amp;response_type=code',\n        'auth_url': 'https://graph.facebook.com/v2.3/oauth/access_token?code={code}&amp;redirect_uri={callback_url}&amp;client_id={client_id}&amp;client_secret={client_secret}',\n        'userinfo_url': 'https://graph.facebook.com/v2.6/me?access_token={access_token}&amp;fields=picture.width(400),name',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}',\n        'userinfomap': {\n            '*': '*',\n            'picture': 'picture.data.url'\n        }\n      },\n      'orange': {       \n        'displayname': 'Orange', \n        'enabled': True,\n        'basic_auth': True,\n        'userinfo_auth': True,\n        'client_id':      'AAAAAAAA', \n        'client_secret':  'BBBBBBBB',\n        'dialog_url': 'https://api.orange.com/oauth/v2/authorize?client_id={client_id}&amp;redirect_uri={callback_url}&amp;scope=openid+profile+offline_access&amp;response_type=code&amp;prompt=login+consent&amp;state={callba\nck_url}',\n        'auth_url': 'https://api.orange.com/openidconnect/fr/v1/token?code={code}&amp;redirect_uri={callback_url}&amp;grant_type=authorization_code', \n        'userinfo_url': 'https://api.orange.com/openidconnect/v1/userinfo',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      },\n      'mobileorange': { \n        'displayname': 'Mobile Connect', \n        'enabled': False,\n        'client_id':     'CCCCCCCC', \n        'client_secret': 'DDDDDDDD',\n        'basic_auth': True,\n        'dialog_url': 'https://api.orange.com/oauth/v2/authorize?client_id={client_id}&amp;redirect_uri={callback_url}&amp;scope=openid+profile&amp;response_type=code&amp;prompt=login+consent&amp;state=&amp;state={callback_url}'\n,\n        'auth_url': 'https://api.orange.com/oauth/v2/token?code={code}&amp;redirect_uri={callback_url}&amp;grant_type=authorization_code', \n        'userinfo_url': 'https://api.orange.com/oauth/v2/authorize',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      },\n      'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id':     'EEEEEEEE.apps.googleusercontent.com', \n        'client_secret': 'FFFFFFFF',\n        'scope': 'https://www.googleapis.com/auth/userinfo.email',\n        'dialog_url': 'https://accounts.google.com/o/oauth2/v2/auth?client_id={client_id}&amp;redirect_uri={callback_url}&amp;response_type=code&amp;scope={scope}',\n        'auth_url': 'https://oauth2.googleapis.com/token?code={code}&amp;grant_type=authorization_code&amp;redirect_uri={callback_url}&amp;scope={scope}&amp;client_id={client_id}&amp;client_secret={client_secret}',\n        'userinfo_url': 'https://openidconnect.googleapis.com/v1/userinfo?access_token={access_token}',\n        'callback_url': 'https://host.domain.com/API/auth/oauth?manager={manager.name}&amp;provider={name}'\n      }\n    }\n  },\n  'explicit': {\n    'show_domains': True,\n    'default_domain': 'AD',\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n    }\n  },\n  'implicit': {\n    'providers': {\n      'anonymous': {\n        'displayname': 'Anonymous',\n        'caption': 'Have a look !',\n        'userid': 'anonymous',\n        'username': 'Anonymous'\n      }     \n    }\n  }}\n\n\nadconfig : { 'AD': {    'default'       : True, \n                        'ldap_timeout'  : 15,\n                        'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                        'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                        'domain'        : 'AD',\n                        'auth_type'     : 'NTLM',\n                        'domain_fqdn'   : 'AD.DOMAIN.LOCAL',\n                        'servers'       : [ 'ldap://192.168.1.12', 'ldaps://192.168.1.13'],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL'\n}}\n</code></pre>"},{"location":"3.0/config/authexplicit-activedirectory/","title":"Authentification <code>explicit</code> for Microsoft Active Directory services","text":""},{"location":"3.0/config/authexplicit-activedirectory/#authmanagers-explicit-object","title":"authmanagers <code>explicit</code> object","text":"<p>The <code>explicit</code> authentification configuration is defined as a dictionnary object and contains an <code>explicit</code> provider. </p> <p>For example :</p> <pre><code>'explicit': {\n    'show_domains': True,\n    'default_domain': 'AD',\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n}\n</code></pre>    Variable name Type Description     <code>show_domains</code> boolean Permit the domain name to be listed in API getclientdata, the default value is False   <code>default_domain</code> string Default domain name prefix if the user format does not containthe domain prefix like DOMAIN\\USER. If the user login value is USER, the login is prefixed with the  default_domain\\USER   <code>providers</code> dictionnary <code>{ 'AD': {  'config_ref': 'adconfig',  'enabled': True  }}</code>"},{"location":"3.0/config/authexplicit-activedirectory/#providers-configuration","title":"providers configuration","text":"<p>The <code>provider</code> authentification configuration is defined as a dictionnary object and must contain a key name. The key name must be set as the <code>USERDOMAIN</code> and defined in the <code>config_ref</code> with the exact same value.</p> <p>Providers :</p> <p>The provider is formated as a dictionnary </p> <p><code>{ 'AD': {               'config_ref': 'adconfig',               'enabled': True           }  }</code></p>    Variable name Type Description     config_ref string For increased legibility, the <code>USERDOMAIN</code> configuration is defined in a dedicated dictionnary used the key:value <code>'config_ref': 'adconfig'</code>, where <code>key</code> is <code>config_ref</code> and <code>value</code> is the dictionnay variable name.   enable boolean enable or disable the domain entry    <p>The adconfig is a dictionnary. For example :</p> <pre><code>adconfig : { 'AD': {   'default'       : True, \n                       'ldap_timeout'  : 15,\n                       'ldap_protocol' : 'ldap',\n                       'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                       'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                       'domain'        : 'AD',\n                       'domain_fqdn': 'AD.DOMAIN.LOCAL',\n                       'servers'    : [ '192.168.7.12' ],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL',\n                        'query_dcs' : True,\n                        'wins_servers'  : [ '192.168.1.12' ],\n                        'serviceaccount': { 'login': 'SVCACCOUNT', 'password': 'SVCACCOUNTPASSWORD' }\n     }\n}\n</code></pre> <p>If this example, the Microsoft Active Directory value are set to :</p>    Variable name Value for example     <code>USERDOMAIN</code> <code>AD</code>   <code>USERDNSDOMAIN</code> <code>AD.DOMAIN.LOCAL</code>    <p>For Active Directory authmanagers, replace the variable name with your own value.</p>    Variable name Type Description Example     <code>default</code> boolean Use this domain as default domain True   <code>ldap_basedn</code> string LDAP Base Distinguished Names <code>DC=ad,DC=domain,DC=local</code>   <code>ldap_fqdn</code> string _ldap._tcp.Domain_Name <code>_ldap._tcp.ad.domain.local</code>   <code>domain_fqdn</code> string domain FQDN (also know as Domain_Name) <code>AD.DOMAIN.LOCAL</code>   <code>servers</code> list of string list of the Active Director servers <code>[ '192.168.1.12', '192.168.1.13' ]</code>   <code>kerberos_realm</code> string Replace kerberos_realm wih your kerberos realm (in UPPER CASE) <code>AD.DOMAIN.LOCAL</code>    <p>The <code>explicit</code> authentification is support <code>LDAP</code> and <code>LDAPS</code> bind.</p> <p>The Microsoft Active Directory value are set to :</p>    Variable name Value     <code>USERDOMAIN</code> <code>AD</code>   <code>USERDNSDOMAIN</code> <code>AD.DOMAIN.LOCAL</code>    <p>For Active Directory authmanagers, replace the variable name with your own value.</p>    Variable name Description Example     <code>ldap_basedn</code> Replace ldap_basedn with your LDAP Base Distinguished Names <code>DC=ad,DC=domain,DC=local</code>   <code>ldap_fqdn</code> Replace ldap_fqdn with the _ldap._tcp fqdn <code>_ldap._tcp.ad.domain.local</code>   <code>domain_fqdn</code> Replace domain_fqdn with domain FQDN value <code>AD.DOMAIN.LOCAL</code>   <code>servers</code> Replace servers with list of the Active Director servers <code>[ '192.168.1.12', '192.168.1.13' ]</code>   <code>kerberos_realm</code> Replace kerberos_realm wih your kerberos realm (in UPPER CASE) <code>AD.DOMAIN.LOCAL</code>"},{"location":"3.0/config/authexplicit-activedirectory/#service-account","title":"Service Account","text":"<p>The service account is use when od.py starts. It runs query to the Active Directory service to read the subnet and location from the sites in 'CN=Subnets,CN=Sites,CN=Configuration,' + BASE_DN , (for example CN=Subnets,CN=Sites,CN=Configuration,DC=example,DC=com)</p>"},{"location":"3.0/config/authexplicit-activedirectory/#site","title":"Site","text":"<p>This features is only available if a service account is defined. Site is used to locate a user from his ip adress. The attributs location and subnet are cached in memory.</p>    Variable name Type Defautl value     <code>site_subnetdn</code> string <code>CN=Subnets,CN=Sites,CN=Configuration, + config.get('basedn') )</code>   <code>site_scope</code> ldap python <code>ldap.SCOPE_SUBTREE</code> read Python ldap reference for more details   <code>site_filter</code> string <code>(objectClass=subnet)</code>   <code>site_attrs</code> list <code>['cn', 'siteObject', 'location']</code>"},{"location":"3.0/config/authexplicit-activedirectory/#printers","title":"Printers","text":"<p>This features is only available if a service account is defined. Printers are used to list printer available in the current user's site. The site is identified using the user's ip address. <code>location</code> is the join key to match local printer for the user.</p>    Variable name Type Defautl value     <code>printer_printerdn</code> string <code>OU=Applications + config.get('basedn')</code>   <code>printer_scope</code> ldap python <code>ldap.SCOPE_SUBTREE</code> read Python ldap reference for more details   <code>site_filter</code> string <code>(objectClass=printQueue)</code>   <code>site_attrs</code> list <code>[ 'cn', 'uNCName', 'location', 'driverName', 'driverVersion', 'name',  'portName', 'printColor', 'printerName', 'printLanguage', 'printSharename', 'serverName', 'shortServerName', 'url', 'printMediaReady', 'printBinNames',  'printMediaSupported',  'printOrientationsSupported' ]</code>    <p>Great, you have check how the explicit Authentification configuration works.</p>"},{"location":"3.0/config/authexplicit-ldap/","title":"Authentification <code>explicit</code> for LDAP Directory Services","text":""},{"location":"3.0/config/authexplicit-ldap/#authmanagers-explicit-object","title":"authmanagers <code>explicit</code> object","text":"<p><code>explicit</code> authentification use a directory service. The bind operation is used to authenticate clients to the directory server, to establish an authorization identity that will be used for subsequent operations processed on that connection.</p> <p>The <code>explicit</code> authentification configuration is defined as a dictionnary object and contains an <code>explicit</code> provider. </p> <p>For example :</p> <pre><code>'explicit': {\n    'show_domains': True,\n    'providers': {\n      'LDAP': { \n        'config_ref': 'ldapconfig', \n        'enabled': True\n       }\n}\n</code></pre> <p>In this example, <code>ldapconfig</code> dict must have a key <code>LDAP</code></p>    Variable name Type Description     <code>show_domains</code> boolean Permit the domain name to be listed in API getclientdata, the default value is False   <code>default_domain</code> string not used by ldap, only used by Active Directory   <code>providers</code> dictionnary <code>{ 'LDAP': {  'config_ref': 'ldapconfig',  'enabled': True  }}</code>"},{"location":"3.0/config/authexplicit-ldap/#providers-configuration","title":"providers configuration","text":"<p>The <code>provider</code> authentification configuration is defined as a dictionnary object and must contain a key name. The key name must be set with the same value in providers configuration and <code>config_ref</code>.</p> <p>Providers :</p> <p>The provider is formated as a dictionnary </p> <p><code>{ 'planet': {               'config_ref': 'ldapconfig',               'enabled': True           }  }</code></p>    Variable name Type Description     config_ref string For increased legibility, the <code>USERDOMAIN</code> configuration is defined in a dedicated dictionnary used the key:value <code>'config_ref': 'adconfig'</code>, where <code>key</code> is <code>config_ref</code> and <code>value</code> is the dictionnay variable name.   enable boolean enable or disable the domain entry    <p>The ldapconfig is a dictionnary. </p> <p>For example :</p> <pre><code>ldapconfig : { 'planet': {    'default'       : True, \n                        'ldap_timeout'  : 15,\n                        'ldap_protocol' : 'ldap',\n                        'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n                        'servers'       : [ '192.168.8.195' ],\n                        'secure'        : False,\n                        'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' }\n           }}\n\n}\n</code></pre>"},{"location":"3.0/config/authexplicit-ldap/#ldap-configuration-reference","title":"ldap configuration reference","text":"Variable name Type Description Example     <code>default</code> boolean Use this domain as default domain True   <code>ldap_protocol</code> string protocol type. <code>ldap</code> or <code>ldaps</code> for LDAP directory services <code>ldap</code>   <code>tls_require_cert</code> boolean The default value is False. <code>tls_require_cert</code>  apply only if <code>ldap_protocol</code> is set to <code>ldaps</code>. Allow LDAPS connection if the ldaps server hostname does not match CommonName peer certificate. In production, set this value to <code>True</code> This will disable the ldap option call : <code>ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER)</code> False   <code>basedn</code> string LDAP Base Distinguished Names <code>ou=people,dc=planetexpress,dc=com</code>   <code>servers</code> list of string list of LDAP servers (IP Adress or FQDN), if entry does not respond, the next one is used. <code>[ '192.168.1.12', '192.168.1.13' ]</code> IP  Address or FQDN values   <code>scope</code> LDAP Perform an LDAP search operation, with base as the DN of the entry at which to start the search, <code>scope</code> being one of <code>SCOPE_BASE</code> (to search the object itself), <code>SCOPE_ONELEVEL</code> (to search the object\u2019s immediate children), or <code>SCOPE_SUBTREE</code> (to search the object and all its descendants). <code>ldap.SCOPE_SUBTREE</code>   <code>timeout</code> integer ldap time out in second 10   <code>exec_timeout</code> integer execute time out in seconds, to obtain ntlm_auth credentials, or cntlm auth credentials, or kerberos auth credentials. the exec timeout is used to run external command line. 10   <code>users_ou</code> string Users Organisation Unit <code>ou=people,dc=planetexpress,dc=com</code>   <code>attrs</code> list list of default attributs to read in user object. read the Definition of the inetOrgPerson LDAP Object Class     <code>filter</code> string LDAP filter to find user object <code>(&amp;(objectClass=inetOrgPerson)(cn=%s))</code>   <code>group_filter</code> string LDAP filter to find group object <code>(&amp;(objectClass=Group)(cn=%s))</code>   <code>group_attrs</code> string LDAP filter to find group object <code>(&amp;(objectClass=Group)(cn=%s))</code>"},{"location":"3.0/config/authexplicit-ldap/#hands-on-configure-auth-using-an-openldap-for-docker","title":"Hands-on : Configure Auth using  an OpenLDAP for Docker","text":""},{"location":"3.0/config/authexplicit-ldap/#requirements","title":"Requirements","text":"<p>You should have all read and done the hands-on :</p> <ul> <li>Setup abcdesktop.io in docker mode</li> <li>Edit your configuration file in docker mode</li> </ul>"},{"location":"3.0/config/authexplicit-ldap/#openldap-docker-image-for-testing","title":"OpenLDAP Docker Image for testing","text":"<p>To configure abcdesktop.io to use an explicit authentification, we need a directory service. We use an OpenLDAP Docker Image for testing with provioned values.</p> <p>Read the OpenLDAP Docker Image for testing documentation on the url abcdesktop OpenLDAP Docker Image for testing</p>"},{"location":"3.0/config/authexplicit-ldap/#update-the-docker-composeyml-file","title":"Update the docker-compose.yml file","text":"<p>Update the <code>docker-compose.yml</code> file to add an ldap as directory server </p> <p>The specific <code>openldap</code> section is describe as a service. The new complete <code>docker-compose.yml</code> file is now :</p> <pre><code>version: '3'\nservices:\n  pyos:\n    depends_on:\n      - memcached\n      - mongodb\n    image: 'abcdesktopio/oc.pyos'\n    networks:\n      - netback\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - /Users/alexandredevely/src/abcdesktop/od.config:/var/pyos/od.config\n  speedtest:\n    image: 'abcdesktopio/oc.speedtest'\n    networks:\n      - netuser\n  nginx:\n    depends_on:\n      - memcached\n      - pyos\n    image: 'abcdesktopio/oc.nginx'\n    ports:\n      - '80:80'\n      - '443:443'\n    networks:\n      - netuser\n      - netback\n  memcached:\n    image: memcached\n    networks:\n      - netback\n  mongodb:\n    image: mongo\n    networks:\n      - netback\n  openldap:\n    image: abcdesktopio/oc.openldap\n    networks:\n      - netback\nnetworks:\n  netuser:\n    driver: bridge\n  netback:\n    internal: true\n</code></pre>"},{"location":"3.0/config/authexplicit-ldap/#update-the-odconfig-configuration-file","title":"Update the <code>od.config</code> configuration file","text":"<p>Update the <code>od.config</code> configuration file.</p> <p>Add the <code>explicit</code> entry to the dictionary <code>authmanagers</code>.</p> <pre><code>authmanagers: {\n  'external': {\n  },\n  'explicit': {\n    'show_domains': True,\n    'providers': {\n      'planet': { \n        'config_ref': 'ldapconfig', \n        'enabled': True\n       }\n    }\n  },\n  'implicit': {\n  }}\n\n\n</code></pre>  <p>Note: the  <code>config_ref</code> is <code>ldapconfig</code>. </p>  <p>Add a new dictionnary object named <code>ldapconfig</code> to the configuration file. These values come from the LDAP structure of OpenLDAP Docker Image for testing</p> <pre><code>ldapconfig : { 'planet': {    'default'       : True, \n                        'ldap_timeout'  : 15,\n                        'ldap_protocol' : 'ldap',\n                        'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n                        'servers'       : [ 'openldap' ],\n                        'secure'        : False,\n                        'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' }\n           }}\n</code></pre>  <p>Note: the server name is the name of the service entry</p>  <p>Save your new od.config file.</p>  <p>The config file <code>od.config</code> has changed and od.py running inside the container should restart.  If it doesn't, restart your docker-compose to make sure that the od.py the your new od.config file.</p> <p><code>docker-compose restart</code> </p>  <p>Open the URL:<code>http://localhost</code></p> <p>The authmanagers <code>explicit</code> is enabled. The Web home page insert the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p>"},{"location":"3.0/config/authexplicit-ldap/#the-ldap-structure-of-openldap-docker-image-for-testing","title":"The LDAP structure of OpenLDAP Docker Image for testing","text":""},{"location":"3.0/config/authexplicit-ldap/#basedn","title":"BaseDN","text":"<p>The <code>basedn</code> is <code>dc=planetexpress,dc=com</code></p>"},{"location":"3.0/config/authexplicit-ldap/#admin-account","title":"admin account","text":"<p>The admin account is described as</p>    Admin Secret     cn=admin,dc=planetexpress,dc=com GoodNewsEveryone"},{"location":"3.0/config/authexplicit-ldap/#ou-users","title":"OU Users","text":"<ul> <li>The User Orgnanistation Unit is <code>ou=people,dc=planetexpress,dc=com</code></li> </ul>"},{"location":"3.0/config/authexplicit-ldap/#users","title":"Users","text":""},{"location":"3.0/config/authexplicit-ldap/#cnhubert-j-farnsworthoupeopledcplanetexpressdccom","title":"cn=Hubert J. Farnsworth,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Hubert J. Farnsworth   sn Farnsworth   description Human   displayName Professor Farnsworth   employeeType Owner   employeeType Founder   givenName Hubert   jpegPhoto JPEG-Photo (630x507 Pixel, 26780 Bytes)   mail professor@planetexpress.com   mail hubert@planetexpress.com   ou Office Management   title Professor   uid professor   userPassword professor"},{"location":"3.0/config/authexplicit-ldap/#cnphilip-j-fryoupeopledcplanetexpressdccom","title":"cn=Philip J. Fry,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Philip J. Fry   sn Fry   description Human   displayName Fry   employeeType Delivery boy   givenName Philip   jpegPhoto JPEG-Photo (429x350 Pixel, 22132 Bytes)   mail fry@planetexpress.com   ou Delivering Crew   uid fry   userPassword fry"},{"location":"3.0/config/authexplicit-ldap/#cnjohn-a-zoidbergoupeopledcplanetexpressdccom","title":"cn=John A. Zoidberg,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn John A. Zoidberg   sn Zoidberg   description Decapodian   displayName Zoidberg   employeeType Doctor   givenName John   jpegPhoto JPEG-Photo (343x280 Pixel, 26438 Bytes)   mail zoidberg@planetexpress.com   ou Staff   title Ph. D.   uid zoidberg   userPassword zoidberg"},{"location":"3.0/config/authexplicit-ldap/#cnhermes-conradoupeopledcplanetexpressdccom","title":"cn=Hermes Conrad,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Hermes Conrad   sn Conrad   description Human   employeeType Bureaucrat   employeeType Accountant   givenName Hermes   mail hermes@planetexpress.com   ou Office Management   uid hermes   userPassword hermes"},{"location":"3.0/config/authexplicit-ldap/#cnturanga-leelaoupeopledcplanetexpressdccom","title":"cn=Turanga Leela,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass inetOrgPerson   cn Turanga Leela   sn Turanga   description Mutant   employeeType Captain   employeeType Pilot   givenName Leela   jpegPhoto JPEG-Photo (429x350 Pixel, 26526 Bytes)   mail leela@planetexpress.com   ou Delivering Crew   uid leela   userPassword leela"},{"location":"3.0/config/authexplicit-ldap/#groups","title":"Groups","text":""},{"location":"3.0/config/authexplicit-ldap/#cnadmin_staffoupeopledcplanetexpressdccom","title":"cn=admin_staff,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass Group   cn admin_staff   member cn=Hubert J. Farnsworth,ou=people,dc=planetexpress,dc=com   member cn=Hermes Conrad,ou=people,dc=planetexpress,dc=com"},{"location":"3.0/config/authexplicit-ldap/#cnship_crewoupeopledcplanetexpressdccom","title":"cn=ship_crew,ou=people,dc=planetexpress,dc=com","text":"Attribute Value     objectClass Group   cn ship_crew   member cn=Turanga Leela,ou=people,dc=planetexpress,dc=com   member cn=Philip J. Fry,ou=people,dc=planetexpress,dc=com   member cn=Bender Bending Rodr\u00edguez,ou=people,dc=planetexpress,dc=com"},{"location":"3.0/config/authexplicit-ldap/#insert-the-user-credentials","title":"Insert the user credentials","text":"<p>Start your web browser and open the URL <code>http://localhost</code></p> <p>The Web home page contains the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p> <p>You can use for example on user of the list above.</p>    Credentials Value     Login Turanga Leela   Password leela     <p>Insert the login credentials :</p> <p><code>Turanga Leela</code> as login and <code>leela</code> as password, then click on the <code>Sign in</code> button.</p>  <p>Look at the top of the sreen. The user name is <code>Turanga Leela</code>:  </p>"},{"location":"3.0/config/authexplicit-ldap/#applications-remainted","title":"Applications remainted","text":"<p>Start LibreOffice Writer, and start a new file for your instructor.  Type few words for example :</p> <pre><code>I like this amazing project abcdesktop.io\n</code></pre> <p>Do not save your file and just close your web browser.</p> <p>Start your web browser again, and open the same URL <code>http://localhost</code>, and log in with the same account: <code>Turanga Leela</code> as login and <code>leela</code> as password, then click on the <code>Sign in</code> button.</p> <p>The application LibreOffice Writer is still running and the greeting message <code>I like this amazing project abcdesktop.io</code></p>   <p>All applications are maintained. </p>  <p>Great, you have check how the explicit Authentification configuration works, install an openldap directory service, and check that all sessions are maintained. </p>"},{"location":"3.0/config/authexplicit/","title":"Authentification <code>explicit</code>","text":""},{"location":"3.0/config/authexplicit/#authmanagers-explicit","title":"authmanagers <code>explicit</code>:","text":"<p><code>explicit</code> authentification use a directory service. The bind operation is used to authenticate clients to the directory server, to establish an authorization identity that will be used for subsequent operations processed on that connection.</p> <p>The <code>explicit</code> authentification configuration is defined as a dictionnary object and contains an <code>explicit</code> provider. </p> <p>The <code>explicit</code> authentification support the directory services <code>ldap</code>, <code>ldaps</code>, and <code>Microsoft Active Directory</code>.</p> <p>Configuration sample for <code>Microsoft Active Directory</code></p> <p>For example :</p> <pre><code>'explicit': {\n    'show_domains': True,\n    'providers': {\n      'AD': { \n        'config_ref': 'adconfig', \n        'enabled': True\n       }\n}\n</code></pre> <pre><code>adconfig : { 'AD': {   'default'       : True, \n                       'ldap_timeout'  : 15,\n                       'ldap_protocol' : 'ldap',\n                       'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                       'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                       'domain'        : 'AD',\n                       'domain_fqdn': 'AD.DOMAIN.LOCAL',\n                       'servers'    : [ '192.168.7.12' ],\n                        'kerberos_realm': 'AD.DOMAIN.LOCAL',\n                        'query_dcs' : True,\n                        'wins_servers'  : [ '192.168.1.12' ],\n                        'serviceaccount': { 'login': 'SVCACCOUNT', 'password': 'SVCACCOUNTPASSWORD' }\n     }\n}\n</code></pre>"},{"location":"3.0/config/authexplicit/#home-page-authentification","title":"Home page authentification","text":"<p>If the authmanagers <code>explicit</code> is enabled. The Web home page insert the new input values <code>Login</code> and <code>Password</code> to authenticate this user.</p>"},{"location":"3.0/config/authexplicit/#ldap-authmanagers","title":"LDAP authmanagers :","text":"<p>Read the specific chapter on LDAP LDAP and LDAPS explicit authmanagers</p>"},{"location":"3.0/config/authexplicit/#microsoft-active-directory-authmanagers","title":"Microsoft Active Directory authmanagers :","text":"<p>Microsoft Active Directory is implemented as a LDAP Server, start reading the chapter on LDAP LDAP and LDAPS explicit authmanagers, then read the specific chapter for Microsoft Active Director Microsoft Active Directory explicit authmanagers</p> <p>Great, you have check how the explicit Authentification configuration works.</p>"},{"location":"3.0/config/authexternal/","title":"Authentification <code>external</code>","text":""},{"location":"3.0/config/authexternal/#requirements","title":"Requirements","text":"<p>To use <code>external</code> Authentification OAuth 1.0 and or OAuth 2.0, you need an internet FQDN and a secured web site with https.</p>"},{"location":"3.0/config/authexternal/#library","title":"Library","text":"<p>abcdesktop uses requests_oauthlib python module. Requests-OAuthlib uses the Python Requests and OAuthlib libraries for building OAuth1 and OAuth2 clients.</p>"},{"location":"3.0/config/authexternal/#authmanagers-external","title":"authmanagers <code>external</code>:","text":"<p><code>external</code> authentification use OAuth 2.0 authenticaton.</p> <p>The <code>external</code> authentification configuration is defined as a dictionary object and contains a list of <code>external</code> provider. </p> <p>Sample providers entry using the Google OAuth 2.0 authentification service. </p> <pre><code>'external': {\n    'providers': {\n    'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id': 'XXX-YYY.apps.googleusercontent.com', \n        'client_secret': 'XXX',\n        'userinfo_auth': True,\n        'scope': [ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ],\n        'userinfo_url': 'https://www.googleapis.com/oauth2/v1/userinfo',\n        'redirect_uri_prefix' : 'https://host.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=google',\n        'authorization_base_url': 'https://accounts.google.com/o/oauth2/v2/auth',\n        'token_url': 'https://oauth2.googleapis.com/token'\n    }\n}\n</code></pre> <p>The variable values <code>client_id</code> and <code>client_secret</code> have been set to obfuscate value 'XXX'. The FQDN is refered to the public server FQDN. </p>    Variable name Type Description Sample     <code>displayname</code> string Display Name show in Web front <code>Google</code>   <code>enabled</code> boolean LDAP Base Distinguished Names <code>True</code>   <code>client_id</code> string client id <code>XXX-YYY.apps.googleusercontent.com</code>   <code>client_secret</code> string client secret <code>XXX</code>   <code>scope</code> list of string scope <code>[ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ]</code>   <code>userinfo_url</code> string dialog URL `https://www.googleapis.com/oauth2/v1/userinfo'   <code>redirect_uri_prefix</code> string redirect URL <code>https://hostname.domain.local/API/auth/oauth</code>   <code>redirect_uri_querystring</code> string URL query string <code>manager=external&amp;provider=google</code>   <code>authorization_base_url</code> string callback URL <code>https://accounts.google.com/o/oauth2/v2/auth</code>   <code>token_url</code> string token URL <code>https://oauth2.googleapis.com/token</code>    <p>The complete redirect url concats the two values <code>redirect_uri_prefix</code> and <code>redirect_uri_querystring</code>.</p>"},{"location":"3.0/config/authexternal/#orange-oauth-20","title":"Orange OAuth 2.0","text":"<p>Orange's OAuth is supported for authentication. This API is based on OpenID Connect, which combines end-user authentication with OAuth2 authorisation. </p>"},{"location":"3.0/config/authexternal/#orange-application","title":"Orange Application","text":"<p>Create your Orange Application here https://developer.orange.com/apis and set credentials for Orange Authentification API in the section </p> <pre><code>'orange': {       \n        'displayname': 'Orange', \n        'enabled': True,\n        'basic_auth': True,\n        'userinfo_auth': True,\n        'scope' : [ 'openid', 'form_filling' ],\n        'client_id': 'XXX',\n        'client_secret': 'YYY',\n        'redirect_uri_prefix' : 'https://hostname.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=orange',\n        'authorization_base_url': 'https://api.orange.com/openidconnect/fr/v1/authorize',\n        'token_url': 'https://api.orange.com/openidconnect/fr/v1/token', \n        'userinfo_url': 'https://api.orange.com/formfilling/fr/v1/userinfo',\n      }\n</code></pre>"},{"location":"3.0/config/authexternal/#facebook-oauth-20","title":"Facebook OAuth 2.0","text":"<p>Facebook's OAuth is supported for authentication. </p>"},{"location":"3.0/config/authexternal/#facebook-application","title":"Facebook Application","text":"<p>Create your Facebook Application credentials here : https://developers.facebook.com/apps/ and set the credentials for Facebook Authentification API  </p> <pre><code>'facebook': { \n        'displayname': 'Facebook', \n        'enabled': True,\n        'userinfo_auth': True,\n        'client_id': 'XXX', \n        'client_secret': 'YYY', \n        'redirect_uri_prefix' : 'https://hostname.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=facebook',\n        'authorization_base_url': 'https://www.facebook.com/dialog/oauth',\n        'userinfo_url': 'https://graph.facebook.com/v2.6/me?fields=picture.width(400),name',\n        'token_url': 'https://graph.facebook.com/v2.3/oauth/access_token',\n        'userinfomap': {\n            '*': '*',\n            'picture': 'picture.data.url'\n        }\n</code></pre>"},{"location":"3.0/config/authexternal/#google-oauth-20","title":"Google OAuth 2.0","text":"<p>Google's OAuth is supported for authentication. The client_id is the google's OAuth client ID, and the client_secret is the OAuth client secret. </p>"},{"location":"3.0/config/authexternal/#google-application","title":"Google Application","text":"<p>Create your Google credentials here : https://console.developers.google.com/apis/ and set the correct credentials for Google Authentification API in the section [gauth]</p> <pre><code>'google': { \n        'displayname': 'Google', \n        'enabled': True,\n        'client_id': 'XXX-YYY.apps.googleusercontent.com', \n        'client_secret': 'XXX',\n        'userinfo_auth': True,\n        'scope': [ 'https://www.googleapis.com/auth/userinfo.email',  'openid' ],\n        'userinfo_url': 'https://www.googleapis.com/oauth2/v1/userinfo',\n        'redirect_uri_prefix' : 'https://host.domain.local/API/auth/oauth',\n        'redirect_uri_querystring': 'manager=external&amp;provider=google',\n        'authorization_base_url': 'https://accounts.google.com/o/oauth2/v2/auth',\n        'token_url': 'https://oauth2.googleapis.com/token'\n    }\n</code></pre> <p>Great, you have check how the implicit Authentification configuration works.</p>"},{"location":"3.0/config/authimplicit/","title":"Authentification <code>implicit</code>","text":""},{"location":"3.0/config/authimplicit/#authmanagers-implicit","title":"authmanagers <code>implicit</code>:","text":"<p><code>implicit</code> is the easyest configuration mode, and is used as 'Anonymous' authentification. </p> <p>The provider is defined as a dictionnary object and contains an <code>anononymous</code> provider.</p> <p><code>anononymous</code> provider always permit authentification, and create a uuid as userid. <code>anononymous</code> provider is used to skip the authentification  process in a demonstration mode.</p> <pre><code>'implicit': {\n    'providers': {\n      'anonymous': {\n        'displayname': 'Anonymous',\n        'caption': 'Have a look !',\n        'userid': 'anonymous',\n        'username': 'Anonymous'\n      }     \n    }\n</code></pre> <p><code>anononymous</code> provider always permit authentification, and create a uuid as userid. </p> <p>Set in your configuration file the authmanagers dictionnary as described</p> <pre><code>authmanagers: {\n  'external': { },\n  'explicit': { },\n  'implicit': { \n     'providers': {\n         'anonymous': {\n           'displayname': 'Anonymous',\n           'caption': 'Anonymous',\n           'userid': 'anonymous',\n           'username': 'Anonymous'\n      } \n   }\n}\n</code></pre> <p>Update your configuration file and apply the new configuration file</p> <p>Open a new Web Browser and go to your abcdesktop URL. You should see the login HTML page with the Anonymous button :</p>  <p>Press the <code>Sign-In Anonymously</code> button.</p> <p>Then, choose the <code>settings</code> in the menu at the upper right corner </p>  <p>Choose the <code>System</code> in the settings control panel.</p>  <p>Then choose <code>User containers</code></p>  <p>This screen show you the <code>hostname</code>. </p> <p>You can read the hostname. In the example the hostname is <code>f097ab7aac57</code>, from the container id.</p> <p>Using a shell, run the command docker ps -a  </p> <pre><code>docker ps -a\n</code></pre> <p>Find a running container with the containerid previously  identified.</p> <p>In this example the containerid is <code>f097ab7aac57</code></p> <pre><code>f097ab7aac57   abcdesktopio/oc.user.18.04   \"/composer/docker-en\u2026\"   8 minutes ago    Up 8 minutes               4714/tcp, 6081/tcp, 29780-29781/tcp, 29783-29784/tcp, 29786/tcp, 55556-55557/tcp   g-06b686a5-c98d-4889-b73d-3455f692e6c2\n</code></pre> <p>Run the command <code>docker inspect CONTAINERID</code>, replace the string CONTAINERID with your container id value.</p>  <p>For example <code>docker inspect f097ab7aac57</code></p>  <pre><code>docker inspect f097ab7aac57\n</code></pre> <p>Locate the <code>Mounts</code> description. User's containers created with an implicit provider anonymous have only one volume type. Anonymous home directory DO NOT USE persistant volume data. Explicit and </p> <pre><code> \"Mounts\": [\n            {\n                \"Type\": \"volume\",\n                \"Name\": \"tmp-06b686a5-c98d-4889-b73d-3455f692e6c2\",\n                \"Source\": \"/var/lib/docker/volumes/tmp-06b686a5-c98d-4889-b73d-3455f692e6c2/_data\",\n                \"Destination\": \"/tmp\",\n                \"Driver\": \"local\",\n                \"Mode\": \"z\",\n                \"RW\": true,\n                \"Propagation\": \"\"\n            },\n            {\n                \"Type\": \"volume\",\n                \"Name\": \"home-06b686a5-c98d-4889-b73d-3455f692e6c2\",\n                \"Source\": \"/var/lib/docker/volumes/home-06b686a5-c98d-4889-b73d-3455f692e6c2/_data\",\n                \"Destination\": \"/home/balloon\",\n                \"Driver\": \"local\",\n                \"Mode\": \"z\",\n                \"RW\": true,\n                \"Propagation\": \"\"\n            }\n        ],\n\n</code></pre> <p>When the anonymous container is removed, the anonymous home directory is deleted.</p> <p>Great, you have check how the implicit Authentification configuration works.</p>"},{"location":"3.0/config/authmetaexplicit/","title":"Authentification <code>metaexplicit</code> for Microsoft Active Directory services with trust relationships","text":""},{"location":"3.0/config/authmetaexplicit/#authmanagers-metaexplicit-object","title":"authmanagers <code>metaexplicit</code> object","text":"<p>The <code>metaexplicit</code> authentification manager contains only one provider. The provider must be defined as <code>metadirectory</code>.</p> <pre><code>'metaexplicit': {\n    'providers': {\n      'metadirectory': { \n        'config_ref': 'coporateconfig', \n        'enabled': True\n       }\n}\n</code></pre>    Variable name Type Description     <code>providers</code> dictionary <code>{ 'metadirectory': {  'config_ref': 'coporateconfig',  'enabled': True  }}</code>"},{"location":"3.0/config/authmetaexplicit/#metadirectory-provider-configuration","title":"<code>metadirectory</code> provider configuration","text":"<p>The <code>metadirectory</code> provider is defined as a dictionnary object and must contain key name. The key name must be set as the name of a dictionaryin the <code>config_ref</code>.</p> <p>A <code>metadirectory</code> provider must contain a ldap attribut to describe the original DOMAIN and sAMaccountName. The ldap attribut is defined as <code>join_key_ldapattribut</code>.</p> <pre><code>coporateconfig : { 'metadirectory': {  \n                    'domain'        : 'CORPORATE',\n                    'ldap_basedn'   : 'DC=foo,DC=corporate,DC=local',\n                    'ldap_fqdn'     : '_ldap._tcp.foo.corporate.local',\n                    'servers'       : [ 'ldap://192.168.9.11', 'ldap://192.168.7.12', 'ldap://192.168.7.13' ],\n                    # join_key_ldapattribut must be defined for a metadirectory provider\n                    'join_key_ldapattribut' : 'description',\n                    'auth_type'  : 'KERBEROS',\n                    'domain_fqdn': 'foo.corporate.local',\n                    'kerberos_realm': 'FOO.CORPORATE.LOCAL',\n                    # serviceaccount must be defined for a metadirectory provider\n                    'serviceaccount': { 'login': 'svcaccount', 'password':'superpass' }\n                 } } \n</code></pre> <p>Pyos binds the metadirectory ldap server with serviceaccount credentials Pyos read the ldap attribut <code>description</code> value to get the user's trusted domain.</p> <p>For example :</p> <pre><code>description: AD\\john\n</code></pre> <p>Then pyos look for provider <code>AD</code> configuration and process authentification on domain <code>AD</code></p> <p>The <code>metadirectory</code> accounts can be disabled.  The ldap attribut <code>userAccountControl</code> is not read on metaDirectory provider. The account can have the bit <code>UF_ACCOUNT_DISABLE</code> set or not.</p> <p>A service account must defined for a <code>metadirectory</code> provider. The service account is used to bind the metadirectory.</p>"},{"location":"3.0/config/authmetaexplicit/#complete-example-with-a-metadirectory-provider-and-active-directory-user-domain","title":"Complete example with a <code>metadirectory</code> provider and active directory user domain","text":"<p>The user's domain mane is AD. The meta domain name is CORPORATE. The meta domain use a dedicated attribut <code>join_key_ldapattribut</code></p> <pre><code>authmanagers: {\n  #\n  # define the meta explicit manager\n  # This is the trusted external forest for the followed domain\n  #\n  'metaexplicit': {\n    'providers': {\n      # define the metadirectory provider\n      # only one metadirectory provider is supported \n      'metadirectory': { \n        'config_ref': 'coporateconfig', \n        'enabled': True } \n    }\n  },\n\n  #        \n  # define the Active Directory provider for each DOMAIN\n  # define two domains in two disctinct forest with a trust relationship \n  # \n  'explicit': { \n    # define an Active Directory provider AD \n    'AD': {  'config_ref': 'adconfig', 'enabled': True },\n    # define an Active Directory provider ANOTHER\n    'ANOTHER': { 'config_ref': 'anotherconfig', 'enabled': True }  \n  }\n} # end of authmanagers\n\n# In this example ldap attribut's description contains AD\\myuser or ANOTHER\\myuser \ncoporateconfig : { 'metadirectory': {  \n                    'domain'        : 'CORPORATE',\n                    'ldap_basedn'   : 'DC=foo,DC=corporate,DC=local',\n                    'ldap_fqdn'     : '_ldap._tcp.foo.corporate.local',\n                    'servers'       : [ 'ldap://192.168.9.11', 'ldap://192.168.7.12', 'ldap://192.168.7.13' ],\n                    # join_key_ldapattribut must be defined for a metadirectory provider\n                    'join_key_ldapattribut' : 'description',\n                    'auth_type'  : 'KERBEROS',\n                    'domain_fqdn': 'foo.corporate.local',\n                    'kerberos_realm': 'FOO.CORPORATE.LOCAL',\n                    # serviceaccount must be defined for a metadirectory provider\n                    'serviceaccount': { 'login': 'svcaccount', 'password':'superpass' }\n                 } }\n\n\n# \n# define the first DOMAIN AD\n# The adconfig ref for domain AD\n#\nadconfig : { 'AD': {  'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                      'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                      'domain'        : 'AD',\n                      'auth_type'     : 'NTLM',\n                      'domain_fqdn'   : 'AD.DOMAIN.LOCAL',\n                      'servers'       : [ 'ldap://192.168.7.12' ] } }\n\n#\n# define the second DOMAIN ANOTHER\n# The anotherconfig ref for domain ANOTHER\n#\nanotherconfig : { 'ANOTHER': {\n                      'ldap_basedn'   : 'DC=another,DC=super,DC=local',\n                      'ldap_fqdn'     : '_ldap._tcp.another.super.local',\n                      'domain'        : 'ANOTHER',\n                      'auth_type'     : 'KERBEROS',\n                      'domain_fqdn'   : 'ANOTHER.SUPER.LOCAL',\n                      'servers'       : [ 'ldap://192.168.10.12' ],\n                      'kerberos_realm': 'AD.SUPER.LOCAL' } }\n</code></pre>"},{"location":"3.0/config/authmetaexplicit/#metadirectorysupport","title":"<code>metadirectory</code>support","text":"<p><code>metadirectory</code> support the foreign security principal (FSP) to query security principal in the trusted external forest. These objects are created in the foreign security principals container of the domain. <code>metadirectory</code> support <code>isMemberOf</code> on foreign security principal. </p> <p>The user's <code>SID</code> of domain  'AD' or 'ANOTHER' is NOT read. A new ldap bind is done using the trusted domain on metadirectory provider and not unsing the service account.</p> <p>The ldap query is build : ( \"search_base={q.basedn}, search_scope={q.scope}, search_filter={filter}\" )</p> <p>To get more information about foreign security principal (FSP), read :</p> <ul> <li> <p>Foreign Security Principals Container</p> </li> <li> <p>Active Directory: Foreign Security Principals and Special Identities</p> </li> </ul>"},{"location":"3.0/config/balloon/","title":"balloon user entry in od.config","text":"<p><code>balloon</code> is the default generic user.</p> <p>The <code>balloon</code> user is created inside the oc.user container</p> <p>The default values are </p>    balloon Default Values     <code>name</code> <code>balloon</code>   <code>uid</code> <code>4096</code>   <code>gid</code> <code>4096</code>   <code>homedirectory</code> <code>/home/balloon</code>    <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre>"},{"location":"3.0/config/controllers/","title":"Controllers","text":""},{"location":"3.0/config/controllers/#controllers_1","title":"Controllers","text":"<p>abcdesktop.io use a Model\u2013view\u2013controller (usually known as MVC) is a software design pattern commonly used for developing user interfaces which divides the related program logic into three interconnected elements. This is done to separate internal representations of information from the ways information is presented to and accepted from the user.</p>    Controller Description     <code>AccountingController</code> accounting data json and ebnf format   <code>AuthController</code> authenticate user   <code>ComposerController</code> CRUD main services (like createDesktop, runApplication)   <code>CoreController</code> get configuration and user message info   <code>ManagerController</code> manage pyos   <code>PrinterController</code> CRUD printer object   <code>StoreController</code> CRUD key value data   <code>UserController</code> retrieve user information"},{"location":"3.0/config/controllers/#access-permission","title":"Access Permission","text":"<p>The <code>AccountingController</code> and <code>ManagerController</code> access is protected with a source ip address filter. The access control filter is defined in a dictionary. Each dictionary entry use the <code>controller</code> name and with an entry <code>permitip</code>. The <code>permitip</code> is a list of subnet, for example <code>[ '10.0.0.0/8', '172.16.0.0/12' ]</code>. If <code>permitip</code> is not set or the <code>controller</code> name is not set, all ip source address are allowed the send a request to the controller.</p> <p>The <code>controllers</code> dictionnary is defined in the <code>od.config</code> file.  By default the configuration permit private network defined in rfc1918 and rfc4193. Get more information about the private network.</p> <p>By default others controllers access is enabled, without ip restriction.</p> <pre><code>    controllers : { \n        'AccountingController': \n            { \n                'permitip': [ '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', 'fd00::/8', '169.254.0.0/16', '127.0.0.0/8' ] \n            },\n        'AuthController' :      { 'permitip': None },\n        'ComposerController' :  { 'permitip': None },\n        'CoreController' :      { 'permitip': None },\n        'ManagerController': \n            { \n                'permitip': [ '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', 'fd00::/8', '169.254.0.0/16', '127.0.0.0/8' ] \n            },\n        'PrinterController' :   { 'permitip': None },\n        'StoreController' :     { 'permitip': None },\n        'UserController' :      { 'permitip': None }\n    } \n</code></pre> <p>If the source ip address is not allowed, the response is a HTTP status <code>code 403 Forbidden</code></p> <pre><code>{\"status\": 403, \"status_message\": \"403 Forbidden\", \"message\": \"Request forbidden -- authorization will not help\"} \n</code></pre>"},{"location":"3.0/config/desktop/","title":"desktop options in od.config","text":"<p>The od.config contains options to describe how the oc.user and applications containers have to be created. Options differ if abcdesktop.io is running in <code>docker mode</code> or in <code>kubernetes mode</code>.</p>"},{"location":"3.0/config/desktop/#desktopoptions","title":"desktop.options","text":"<p>All desktop options are defined in od.config file. Desktop options start with the prefix <code>desktop.</code>, then add the name of the option.</p>    Option name Type Sample     <code>desktop.defaultbackgroundcolors</code> list [ '#6EC6F0', '#333333',  '#666666', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]   <code>desktop.homedirectorytype</code> string 'hostPath'   <code>desktop.remotehomedirectorytype</code> list []   <code>desktop.persistentvolumeclaim</code> string None   <code>desktop.envlocal</code> dictionary <code>{ 'DISPLAY': ':0.0', 'USER': 'balloon', 'LIBOVERLAY_SCROLLBAR': '0', 'UBUNTU_MENUPROXY': '0', 'HOME': '/home/balloon', 'LOGNAME': 'balloon' }</code>   <code>desktop.nodeselector</code> dictionary <code>{}</code>   <code>desktop.username</code> string 'balloon'   <code>desktop.userid</code> integer 4096   <code>desktop.groupid</code> integer 4096   <code>desktop.userhomedirectory</code> string <code>'/home/balloon'</code>   <code>desktop.useinternalfqdn</code> boolean False   <code>desktop.uselocaltime</code> boolean False   <code>desktop.host_config</code> dictionary <code>{  'auto_remove'   : True, 'ipc_mode'      : 'shareable', 'network_mode'  : 'container', 'shm_size'      : '128M', 'mem_limit'     : '512M', 'cpu_period'    : 100000, 'cpu_quota'     : 150000, 'security_opt'  : [ 'seccomp=unconfined' ] }</code>   <code>desktop.application_config</code> dictionary <code>{  'auto_remove'   : True, 'ipc_mode'      : 'shareable', 'pid_mode'      : True, 'network_mode'  : 'container', 'shm_size'      : '512M', 'mem_limit'     : '2G', 'cpu_period'    : 200000, 'cpu_quota'     : 150000, 'security_opt'  : [ 'seccomp=unconfined' ] }</code>   <code>desktop.policies</code> dictionary <code>{ 'rules':{}, 'max_app_counter':5 }</code>   <code>desktop.webhookdict</code> dictionary <code>{ 'firewall': '192.168.7.1' }</code>"},{"location":"3.0/config/desktop/#desktopshareipcnamespace","title":"desktop.shareipcnamespace","text":"<p>The type of desktop.shareipcnamespace is a string. The default value is 'shareable' This option permit user contain to share the ipc namespace with application</p>    Value Description     <code>''</code> Use daemon\u2019s default.   <code>'none'</code> Own private IPC namespace, with /dev/shm not mounted.   <code>'private'</code> Own private IPC namespace.   <code>'host'</code> Use the host system\u2019s IPC namespace.   <code>'shareable'</code> Own private IPC namespace, with a possibility to share it with other containers.    <p>If not specified, daemon default is used, which can either be <code>'private'</code> or <code>'shareable'</code>, depending on the daemon version and configuration. IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments, semaphores and message queues.</p> <p>Shared memory segments are used to accelerate inter-process communication at memory speed, rather than through pipes or through the network stack. Shared memory is commonly used by databases and custom-built (typically C/OpenMPI, C++/using boost libraries) high performance applications for scientific computing and financial services industries. </p> <p>If these types of applications are broken into multiple containers, you might need to share the IPC mechanisms of the containers, using \"shareable\" mode for the main (i.e. \u201cdonor\u201d) container, and containers can access <code>container:&lt;donor-name-or-ID&gt;</code>.</p> <p>The default value is <code>desktop.shareipcnamespace : 'shareable'</code></p>"},{"location":"3.0/config/desktop/#desktophomedirectory","title":"desktop.homedirectory","text":"<p>This option describes how the default home directory for user user ballon should be created. The value can be defined as :</p> <ul> <li> <p><code>'None'</code>: no dedicated volume is created, the oc.user container use an <code>emptyDir': { 'medium': 'Memory'}</code>. All user data will be removed at logout.</p> </li> <li> <p><code>'hostPath'</code>: In release 3.0, ONLY <code>'hostPath'</code> is supported to set a dedicated volume, the oc.user container and applications share this volume. User home data are persistent.</p> </li> </ul>"},{"location":"3.0/config/desktop/#desktopremotehomedirectorytype","title":"desktop.remotehomedirectorytype","text":"<p>desktop.remotehomedirectorytype is a list of string. Each string describe if the remount access to a directory is allowed. example [ 'cifs', 'webdav' ]</p> <p>For each entry in the desktop.remotehomedirectorytype list, abcdesktop.io try to mount the remote file system using data from the implicit auth provider.</p> <p>If <code>desktop.remotehomedirectorytype</code> contains 'cifs' and if the authentification provider get <code>homeDrive</code> and <code>homeDirectory</code> attributs then abcdesktop request the kubernetes abcdesktop/CIFS Driver to mount the remote filesystem. The user find a mount point named <code>homeDrive</code> value, and mounted to <code>homeDirectory</code>.</p>"},{"location":"3.0/config/desktop/#desktopdefaultbackgroundcolors","title":"desktop.defaultbackgroundcolors","text":"<p>The <code>desktop.defaultbackgroundcolors</code> allow you to change the default background color.</p> <p>The default value is a list of string <code>[ '#6EC6F0', '#333333',  '#666666', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]</code></p> <p>The <code>desktop.defaultbackgroundcolors</code> length can contain up to 8 entries. To see the color </p> <p>Open the url http://localhost:30443, in your web browser, to start a simple abcdesktop.io container. </p> <pre><code>http://localhost:30443\n</code></pre> <p>You should see the abcdesktop.io home page.</p> <p>Press the <code>Connect with Anonymous access, have look</code></p> <p>At the right top corner, click on the menu and choose <code>Settings</code>, then click on <code>Screen Colors</code></p> <p>You should see the default background colors, for example : </p>"},{"location":"3.0/config/desktop/#desktopenvlocal","title":"desktop.envlocal","text":"<p><code>desktop.envlocal</code> is a dictionary. <code>desktop.envlocal</code> contains a (key,value) added as environment variables to oc.user.</p> <p>The default value is :</p> <pre><code>{ \n  'DISPLAY': ':0.0', \n  'LIBOVERLAY_SCROLLBAR': '0',\n  'UBUNTU_MENUPROXY': '0',\n  'HOME': '/home/balloon',\n  'X11LISTEN': 'tcp'\n}\n</code></pre>"},{"location":"3.0/config/desktop/#reserved-variables","title":"Reserved variables","text":"Variable Values Description     <code>X11LISTEN</code> <code>tcp</code> permit X11 to listen on tcp port, default is <code>udp</code>   <code>ABCDESKTOP_RUN_DIR</code> <code>/var/run/desktop</code> directory to write pid services   <code>ABCDESKTOP_LOG_DIR</code> <code>/var/log/desktop</code> directory to write log files services   <code>DISABLE_REMOTEIP_FILTERING</code> <code>disabled</code> disabled remote ip filtering inside pod user, default is <code>disabled</code>, change to <code>enabled</code> to remove core ip filtering   <code>SET_DEFAULT_WALLPAPER</code> <code>myfile.jpeg</code> name of file to set the user wallpaper, this file must exist in <code>~/.wallpapers</code>   <code>SET_DEFAULT_COLOR</code> <code>#6EC6F0</code> Value of default colour saved in file <code>~/.store/currentColor</code>   <code>SENDCUTTEXT</code> <code>enabled</code> \u00a0Send clipboard changes to user. Set value to <code>disabled</code> to disable clipboard changes to user web browser. This value is overwrite by label <code>ABCDESKTOP_LABEL_sendcuttext</code> if exist <code>SENDCUTTEXT=${ABCDESKTOP_LABEL_sendcuttext:-$SENDCUTTEXT}</code>. The default value is <code>enabled</code>   <code>ACCEPTCUTTEXT</code> <code>enabled</code> \u00a0Accept clipboard updates from user. Set value to <code>disabled</code> to disable clipboard changes to user web browser.  This value is overwrite by label <code>ABCDESKTOP_LABEL_acceptcuttext</code> if exist <code>ACCEPTCUTTEXT=${ABCDESKTOP_LABEL_acceptcuttext:-$ACCEPTCUTTEXT}</code>. The default value is <code>enabled</code>"},{"location":"3.0/config/desktop/#desktopnodeselector","title":"desktop.nodeselector","text":"<p><code>desktop.nodeselector</code> is a dictionary. This option permits to assign user pods to nodes. It specifies a map of key-value pairs. For the pod to be eligible to run on a node, the node must have each of the indicated key-value pairs as labels (it can have additional labels as well).  The most common usage is one key-value pair.</p> <pre><code>{ 'disktype': 'ssd' }\n</code></pre>"},{"location":"3.0/config/desktop/#desktopusername","title":"desktop.username","text":"<p><code>desktop.username</code> describes the balloon user created inside the oc.user container. The type of desktop.username is string. The default value is 'balloon'.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"3.0/config/desktop/#desktopuserid","title":"desktop.userid","text":"<p><code>desktop.userid</code> describes the <code>uid</code> of the user created inside the oc.user container.</p> <p>The type of desktop.userid is integer. The default value is 4096.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"3.0/config/desktop/#desktopgroupid","title":"desktop.groupid","text":"<p><code>desktop.groupid</code> describes the <code>gid</code> of the user created inside the oc.user container. The type of desktop.userid is integer. The default value is 4096.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>RUN groupadd --gid 4096 $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"3.0/config/desktop/#desktopuserhomedirectory","title":"desktop.userhomedirectory","text":"<p><code>desktop.userhomedirectory</code> describes the <code>homedirectory</code> of the user created inside the oc.user container. The type of <code>desktop.userhomedirectory</code> is string. The default value is <code>/home/balloon</code>.</p> <p>If you change this value, you have to rebuild your own oc.user file The script oc.user in Dockerfile oc.user :</p> <pre><code>ENV BUSER balloon\nRUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre> <p>Read the dedicated page on balloon to gaet more information about user balloon, uid, and gid.</p>"},{"location":"3.0/config/desktop/#desktopuselocaltime","title":"desktop.uselocaltime","text":"<p>The <code>desktop.uselocaltime</code> is boolean, to use host value of <code>/etc/localtime</code>. The default value is <code>False</code>. If <code>desktop.uselocaltime</code> is True, this add a volume mapping from host file  <code>/etc/localtime</code> to container file <code>/etc/localtime</code>.</p>"},{"location":"3.0/config/desktop/#desktoppolicies","title":"desktop.policies","text":"<p>The <code>desktop.policies</code> is a dictionary.</p>    Entry Description     <code>max_app_counter</code> limit applications counter, without checking the docker container status   <code>rules</code> rules dictionary <code>'rules': { 'volumes': { 'domainuser':  { 'type': 'cifs', 'name': 'homedirectory', 'volumename': 'homedir' } }</code>   <code>acl</code> allow or denied desktop creation    <p>Example</p> <pre><code>desktop.policies: { \n  'rules': { \n    'volumes': { \n      'domainuser':   { 'type': 'cifs', 'name': 'homedirectory', 'volumename': 'homedir' },\n      'Mygroupteam':  { 'type': 'cifs', 'name': 'toto', 'unc': '//192.168.7.101/team', 'volumename': 'team' } \n      } \n  },\n  'acls' : {},\n  'max_app_counter' : 4  \n}\n</code></pre>"},{"location":"3.0/config/desktop/#desktopapplication_config","title":"desktop.application_config","text":"<p>Default application host_config dictionary, maps the dictionary as arguments from docker API  create_host_config</p> <p>Define how the application can be run, read host_config  description page to get more informations</p>"},{"location":"3.0/config/desktop/#desktophost_config","title":"desktop.host_config","text":"<p>Default desktop oc.user host_config dictionary, maps the dictionary as arguments from docker API  create_host_config</p> <p>Define how the oc.user container can be run, read host_config description page to get more informations</p>"},{"location":"3.0/config/desktop/#desktopwebhookdict","title":"desktop.webhookdict","text":"<p>desktop.webhookdict is a dictionary to add key/value to the command <code>create</code> and <code>destroy</code> in rules objects.</p>"},{"location":"3.0/config/desktop/#experimental-features","title":"Experimental features","text":""},{"location":"3.0/config/desktop/#desktopdesktopuseinternalfqdn","title":"desktop.desktopuseinternalfqdn","text":"<p>WARNING <code>desktop.desktopuseinternalfqdn</code> is an experimental feature, keep this value to False in production</p> <p><code>desktop.desktopuseinternalfqdn</code> describes the content of the payload data in the JWT Desktop Token. The default value is <code>False</code>. </p> <p>Nginx front end act as a reverse proxy. This reverse proxy use the FQDN of the user's pod to route http request. If this value is set to <code>False</code> the payload data in the JWT Desktop Token contains the IP Address of the user Pod. If this value is set to <code>True</code> the payload data in the JWT Desktop Token contains the FQDN of the user Pod.</p> <p>If you CAN NOT add <code>endpoint_pod_names</code> in the coredns configuration, you MUST set <code>desktop.desktopuseinternalfqdn</code> to <code>False</code>. This choice is less secure.</p> <p>To set <code>desktop.desktopuseinternalfqdn</code> to <code>True</code> value, you have to update the <code>coredns</code> ConfigMap.</p> <pre><code>kind: ConfigMap\napiVersion: v1\nmetadata:\n  name: coredns\n  namespace: kube-system\ndata:\n  Corefile: |\n    .:53 {\n        log\n        errors\n        health\n        ready\n        kubernetes cluster.local in-addr.arpa ip6.arpa {\n           endpoint_pod_names\n           pods insecure\n           fallthrough in-addr.arpa ip6.arpa\n           transfer to * \n           ttl 30\n        }\n        prometheus :9153\n        forward . /etc/resolv.conf\n        cache 30\n        loop\n        reload\n        loadbalance\n    }\n</code></pre>"},{"location":"3.0/config/desktop.pod/","title":"desktop.pod","text":"<p>abcdesktop defines a user desktop as a group of user's containers. This is a main features of abcdesktop. Each container offers a service. </p> <p>For example </p> <ul> <li><code>printer</code> is a service. <code>printer</code> service runs inside the user pod. </li> <li><code>graphical</code> is a service. <code>graphical</code> service runs inside the user pod and is the default service.</li> </ul>"},{"location":"3.0/config/desktop.pod/#containers-in-the-user-pod","title":"containers in the user pod","text":"<ul> <li><code>init</code> contains init command for user pod</li> <li><code>graphical</code> is the user graphical service (X11 and VNC)</li> <li><code>spawner</code> is the command service for graphical service</li> <li><code>broadcast</code> is the broadcast service for graphical service</li> <li><code>webshell</code> is the shell (bash) service for graphical service</li> <li><code>printer</code> is the printer service (cupsd)</li> <li><code>printerfile</code> is the file service to download generated PDF file (this file transfert service is dedicated for printer service)</li> <li><code>sound</code> is the sound service (pulseaudio) to send rtp stream from a container to the web browser via janus webrtc gateway</li> <li><code>filer</code> is the filer service to upload and download file into the user home directory</li> <li><code>storage</code> contains abcdesktop user secrets</li> </ul> <p>Each service :</p> <ul> <li>can be enable or disable <code>'enable': True</code></li> <li>can set dedicated <code>'resources'</code> limits resources for a container</li> <li>can set dedicated <code>'acl'</code> to start or not using rules </li> <li>can set dedicated <code>'securityContext'</code> or use the spec <code>securityContext</code> </li> <li>can set dedicated <code>'secrets_requirement</code>, a list of secrets to run example  <code>['abcdesktop/vnc', 'abcdesktop/kerberos']</code></li> </ul>"},{"location":"3.0/config/desktop.pod/#default-desktoppod","title":"default desktop.pod","text":"<pre><code>desktop.pod : { \n  'spec' : {\n    'shareProcessNamespace': True,\n    'shareProcessMemory': True,\n    'shareProcessMemorySize': '256Mi',\n    'securityContext': { \n      'supplementalGroups':  [ '{{ supplementalGroups }}' ],\n      'runAsUser': '{{ uidNumber }}',\n      'runAsGroup': '{{ gidNumber }}',\n      'readOnlyRootFilesystem': False, \n      'allowPrivilegeEscalation': True\n    }\n  },  \n  'graphical' : { \n    'image': { 'default': 'abcdesktopio/oc.user.kubernetes.18.04:3.0' },\n    'imagePullPolicy': 'IfNotPresent',\n    'enable': True,\n    'acl': { 'permit': [ 'all' ] },\n    'waitportbin': '/composer/node/wait-port/node_modules/.bin/wait-port',\n    'resources': { \n            'requests': { 'memory': \"320Mi\", 'cpu': \"250m\"  }, \n            'limits':   { 'memory': \"1Gi\",   'cpu': \"1000m\" } \n    },\n    'shareProcessNamespace': True,\n    'tcpport': 6081,\n    'secrets_requirement' : [ 'abcdesktop/vnc', 'abcdesktop/kerberos']\n  },\n  'spawner' : { \n    'enable': True,\n    'tcpport': 29786,\n    'waitportbin' : '/composer/node/wait-port/node_modules/.bin/wait-port',\n    'acl':  { 'permit': [ 'all' ] } \n  },\n  'broadcast' : { \n    'enable': True,\n    'tcpport': 29784,\n    'acl':  { 'permit': [ 'all' ] } \n  },\n  'webshell' : { \n    'enable': True,\n    'tcpport': 29781,\n    'acl':  { 'permit': [ 'all' ] } \n  },\n  'printer' : { \n    'image': 'abcdesktopio/oc.cupsd.18.04:3.0',\n    'imagePullPolicy': 'IfNotPresent',\n    'enable': True,\n    'tcpport': 681,\n    # cupsd need to start as root\n    'securityContext': { 'runAsUser': 0 },\n    'resources': { \n      'requests': { 'memory': \"64Mi\", 'cpu': \"125m\" },  \n      'limits'  : { 'memory': \"512Mi\",  'cpu': \"500m\" } \n    },\n    'acl':  { 'permit': [ 'all' ] } \n  },\n  'printerfile' : { \n    'enable': True,\n    'tcpport': 29782,\n    'acl':  { 'permit': [ 'all' ] } \n  },\n  'filer' : { \n    'image': 'abcdesktopio/oc.filer:3.0',\n    'imagePullPolicy':  'IfNotPresent',\n    'enable': True,\n    'tcpport': 29783,\n    'acl':  { 'permit': [ 'all' ] } \n    },\n  'storage' : { \n    'image': 'k8s.gcr.io/pause:3.8',\n    'imagePullPolicy':  'IfNotPresent',\n    'enable': True,\n    'acl': { 'permit': [ 'all' ] },\n    'resources': { \n      'requests': { 'memory': \"32Mi\",  'cpu': \"100m\" },  \n      'limits'  : { 'memory': \"128Mi\", 'cpu': \"250m\" } \n    }\n  },\n  'sound': { \n    'image': 'abcdesktopio/oc.pulseaudio.22.04:3.0',\n    'imagePullPolicy': 'IfNotPresent',\n    'enable': False,\n    'tcpport': 4714,\n    'acl':  { 'permit': [ 'all' ] },\n    'resources': { \n      'requests': { 'memory': \"8Mi\",  'cpu': \"50m\"  },  \n      'limits'  : { 'memory': \"64Mi\", 'cpu': \"250m\" } \n    } \n  },\n  'init': { \n    'image': 'busybox',\n    'enable': True,\n    # 'imagePullSecrets': [ { 'name': name_of_secret } ]\n    'imagePullPolicy': 'IfNotPresent',\n    'securityContext': { 'runAsUser': 0 },\n    'acl':  { 'permit': [ 'all' ] },\n    'command':  [ 'sh', '-c',  'chmod 750 ~ &amp;&amp; chown {{ uidNumber }}:{{ gidNumber }} ~' ] \n  },\n  'ephemeral_container': {\n    'enable': True,\n    'securityContext': { \n        'supplementalGroups': [ '{{ supplementalGroups }}' ] ,\n        'readOnlyRootFilesystem': False, \n        'allowPrivilegeEscalation': True, \n        'runAsUser':                '{{ uidNumber }}',\n        'runAsGroup':               '{{ gidNumber }}'\n     },\n    'acl':  { 'permit': [ 'all' ] }\n  },\n  'pod_application' : {\n    'enable': True,\n    'securityContext': { \n        'supplementalGroups': [ '{{ supplementalGroups }}' ] ,\n        'readOnlyRootFilesystem': False, \n        'allowPrivilegeEscalation': True, \n        'runAsUser':                '{{ uidNumber }}',\n        'runAsGroup':               '{{ gidNumber }}'\n    },\n    # 'imagePullSecrets': [ { 'name': name_of_secret } ]\n    'acl':  { 'permit': [ 'all' ] } } }\n\n</code></pre>"},{"location":"3.0/config/desktop.pod/#common-options","title":"common options","text":""},{"location":"3.0/config/desktop.pod/#enable","title":"enable","text":"<p>The container is added to the user pod if <code>'enable': True</code></p>"},{"location":"3.0/config/desktop.pod/#acl","title":"acl","text":"<p>The container is added to the user pod if <code>acl</code> matches. acl is based on tags and rules.  Read the authentification-rules abcdesktop documentation to defined tags.</p>"},{"location":"3.0/config/desktop.pod/#pullpolicy","title":"pullpolicy","text":"<p>The image use the kubernetes pull policy values :</p> <ul> <li><code>IfNotPresent</code> the image is pulled only if it is not already present locally.</li> <li><code>Always</code> kubelet queries the container image registry to resolve the name to an image digest.</li> <li><code>Never</code> the kubelet does not try fetching the image. If the image is somehow already present locally, the kubelet attempts to start the container; otherwise, startup fails. </li> </ul> <p>Read the pullpolicy kubernetes documentation to get more details.</p>"},{"location":"3.0/config/desktop.pod/#waitportbin","title":"waitportbin","text":"<p><code>waitportbin</code> is a binary command line, embedded inside the container, to check if the container is ready to run. Commonly it uses the <code>tcpport</code> value.</p> <p>The command is run with parameters :</p> <pre><code>/composer/node/wait-port/node_modules/.bin/wait-port -t {waitportbintimeout}*1000 {container_ipaddr}:{container_tcpport}\n</code></pre>"},{"location":"3.0/config/desktop.pod/#waitportbintimeout","title":"waitportbintimeout","text":"<p><code>waitportbintimeout</code> is the timeout in seconds for the <code>waitportbin</code> command. </p>"},{"location":"3.0/config/desktop.pod/#image","title":"image","text":"<p>Image describe the container image name ( by example <code>'image': 'abcdesktopio/oc.user.kubernetes.18.04:3.0'</code>)</p>"},{"location":"3.0/config/desktop.pod/#imagepullsecrets","title":"imagePullSecrets","text":"<p>The <code>imagePullSecret</code> entry is the list of the secret name used by kubernetes to access to the private registry. The type of <code>imagePullSecret</code> is a list. This option is used if you need to store the abcdesktop docker image on your a private registry.</p> <pre><code> imagePullSecret : [ { 'name': name_of_secret } ]\n</code></pre> <ul> <li>Example to build a registry Kubernetes secret named abcdesktopregistrysecret with the docker hub.</li> </ul> <pre><code>kubectl create secret docker-registry abcdesktopregistrysecret --docker-server=https://index.docker.io/v1/ --docker-username=XXXXXXX --docker-password=YYYYYYYU\n</code></pre> <ul> <li>Example to build a registry Kubernetes secret named abcdesktopregistrysecret with your own privateregistry</li> </ul> <pre><code>kubectl create secret docker-registry abcdesktopregistrysecret --docker-server=registry.mydomain.local:443 --docker-username=XXXXXXX --docker-password=YYYYYYYU\n</code></pre> <p>The <code>imagePullSecret</code> become in this sample</p> <pre><code> imagePullSecret : [ { 'name': 'abcdesktopregistrysecret' } ]\n</code></pre>"},{"location":"3.0/config/desktop.pod/#resources","title":"resources","text":"<p>resources come from the kubernetes resources containers management. Read the resources kubernetes documentation to get more details.</p>"},{"location":"3.0/config/desktop.pod/#spec-entry","title":"spec entry","text":"<p><code>spec</code> entry defines the spec entry for a pod. All kubernetes entries are supported. Some of them are overwrited by abcdesktop.</p> <ul> <li> <p><code>{{ uidNumber }}</code> is replaced by the user's <code>uidNumber</code> on ldap if the objectClass is posixAccount or if not set by the default user id set in option <code>desktop.userid</code> </p> </li> <li> <p><code>{{ gidNumber }}</code> is replaced by the user's <code>gidNumber</code> on ldap if the objectClass is posixAccount  is replaced by the ldap gidNumber or if not set by the default group id set in option <code>desktop.groupid</code> </p> </li> <li><code>{{ supplementalGroups }}</code> is replaced by the list of groups <code>gidNumber</code> is posixGroup</li> <li><code>shareProcessNamespace</code> When process namespace sharing is enabled, processes in a container are visible to all other containers in the same pod. Read the kubernetes shareProcessNamespace details, to get more details.</li> <li><code>shareProcessMemory</code> POSIX shared memory requires that a tmpfs be mounted at /dev/shm. The containers in a pod do not share their mount namespaces so we use volumes to provide the same /dev/shm into each container in a pod. To get more details, read shared_memory. It is defined as an emptyDir volume <code>{ 'name': 'shm',  { 'medium': 'Memory', 'sizeLimit': shareProcessMemorySize } }</code></li> <li><code>shareProcessMemorySize</code> is the size of <code>shareProcessMemory</code>. The size is set to the <code>shm</code> volume  <code>'sizeLimit': shareProcessMemorySize</code></li> </ul> <pre><code>'spec' : {\n    'shareProcessNamespace': True,\n    'shareProcessMemory': True,\n    'shareProcessMemorySize': '256Mi',\n    'securityContext': { \n      'supplementalGroups': [ '{{ supplementalGroups }}' ],\n      'runAsUser': '{{ uidNumber }}',\n      'runAsGroup': '{{ gidNumber }}',\n      'readOnlyRootFilesystem': False, \n      'allowPrivilegeEscalation': True\n    }\n</code></pre>"},{"location":"3.0/config/desktop.pod/#init-container","title":"init container","text":"<p>init container run the init command. It changes access right to the user home directory. The init command runs as root by default with a securityContext <code>'securityContext': {'runAsUser':0, 'runAsGroup':0 }</code>.</p> <p>The command support <code>{{ }}</code> values. Values can be </p> <ul> <li><code>'{{ uidNumber }}'</code></li> <li><code>'{{ gidNumber }}'</code></li> <li><code>'{{ uid }}'</code></li> </ul> <p>Values are read from the previous ldap authentification.</p> <ul> <li><code>'{{ uidNumber }}'</code> is replaced by the ldap <code>uidNumber</code> or if not set by the default user id set in option <code>desktop.userid</code> </li> <li><code>'{{ gidNumber }}'</code> is replaced by the ldap gidNumber or if not set by the default group id set in option <code>desktop.groupid</code> </li> <li><code>'{{ uid }}'</code> is replaced by the ldap <code>uid</code> or if not set by the default user name set in option <code>desktop.username</code></li> </ul> <p>Example</p> <pre><code> 'command':  [ 'sh', '-c',  'chmod 755 ~ &amp;&amp; chown {{ uidNumber }}:{{ gidNumber }} ~' ]\n</code></pre>"},{"location":"3.0/config/editconfig/","title":"How to edit <code>pyos</code> core service configuration file","text":""},{"location":"3.0/config/editconfig/#edit-your-configuration-file","title":"Edit your configuration file","text":"<p>Download the default od.config file and save it to your abcdesktop local directory.</p> <p>To make change, edit your own <code>od.config</code> file</p> <pre><code>vim od.config \n</code></pre> <p>Change the defaultbackgroundcolors option in the desktop options.</p> <p>Locate the line <code>desktop.defaultbackgroundcolors</code> and update the first entries with the values <code>'#FF0000', '#FFFFFF',  '#0000FF'</code></p> <pre><code>desktop.defaultbackgroundcolors : [ '#FF0000', '#FFFFFF',  '#0000FF', '#CD3C14', '#4BB4E6', '#50BE87', '#A885D8', '#FFB4E6' ]\n</code></pre> <p>Save your local <code>od.config</code> file.</p> <p>To apply changes, you can replace the <code>abcdesktop-config</code></p> <pre><code>kubectl delete configmap abcdesktop-config -n abcdesktop\nkubectl create --from-file=od.config -n abcdesktop\n</code></pre> <p>| you can also use the replace command <code>kubectl create configmap -n abcdesktop abcdesktop-config --from-file=od.config  -o yaml --dry-run | kubectl replace -n abcdesktop -f -</code></p> <p>Restart pyos daemonset</p> <pre><code>kubectl rollout restart daemonset daemonset-pyos -n abcdesktop\n</code></pre>"},{"location":"3.0/config/editconfig/#check-that-the-new-colours-are-presents-in-front","title":"Check that the new colours are presents in front :","text":"<p>Open the url <code>http://localhost:30443</code>, in your web browser, to start a simple abcdesktop.io container. </p> <pre><code>http://localhost:30443\n</code></pre> <p>You should see the abcdesktop.io home page.</p> <p>Press the <code>Sign-in Anonymously, have look</code></p> <p>At the right top corner, click on the menu and choose <code>Settings</code>, then click on <code>Screen Colors</code></p> <p>Choose your colour and you should have it as background colour :</p>  <p>Great, you can easily update your configuration file <code>od.config</code>. </p>"},{"location":"3.0/config/frontjs/","title":"dock configuration in od.config","text":""},{"location":"3.0/config/frontjs/#menu-setting","title":"Menu Setting","text":"<p>The menu can be changed using the dictionnary object <code>menuconfig</code></p> <pre><code>menuconfig : {\n    'settings'  : True, \n    'appstore'  : True, \n    'screenshot'    : True, \n    'download'  : True, \n    'logout'        : True, \n    'disconnect'    : True \n}\n</code></pre>"},{"location":"3.0/config/frontjs/#default-dock-config","title":"default dock config","text":"<p>The dock session in od.config file describe the default docker in abcdesktop.io. The default dock value contains the default applications. The <code>dock</code> option is a dictionnary read by the front web as a json object.</p>    docker entry Descriptions     <code>filemanager</code> FileManager application   <code>terminal</code> Terminal application   <code>webshell</code> HTML 5, terminal application based on xterm.js   <code>webshorcut</code> Web browser url launch inside the container    <pre><code>dock : {       \n    'filemanager':  {       'args': None,\n                            'showinview': u'dock',\n                            'name': u'FileManager',\n                            'keyword': u'files,file manager',\n                            'launch': u'nautilus.Nautilus',\n                            'displayname': u'FileManager',\n                            'execmode': u'builtin',\n                            'cat': u'utilities,office',\n                            'id': u'filemanager.d',\n                            'icon': u'pantheon-files-icons.svg' },\n    'terminal':     {       'args': '',\n                            'name': u'TerminalBuiltin',\n                            'keyword': u'terminal,shell,bash,builtin,pantheon',\n                            'launch': u'qterminal.qterminal',\n                            'displayname': u'Terminal Builtin',\n                            'execmode': u'builtin',\n                            'cat': u'utilities,development',\n                            'id': u'terminalbuiltin.d',\n                            'hideindock': True,\n                            'icon': u'pantheon-terminal-builtin-icons.svg' },\n\n    'webshell':     {       'name': u'WebShell',\n                            'keyword': u'terminal,shell,webshell,bash',\n                            'launch': u'frontendjs.webshell',\n                            'displayname': u'Web Shell',\n                            'execmode': u'frontendjs',\n                            'cat': u'utilities,development',\n                            'id': u'webshell.d',\n                            'icon': u'webshell.svg' }\n}\n</code></pre>"},{"location":"3.0/config/frontjs/#additional-applications","title":"Additional applications","text":"<p>This feature is deprecated. To run embeded application inside the oc.user image container, with specific attribut <code>{ 'execmode': 'builtin' }</code> add </p> <pre><code>'webshortcut':  {   'name': u'xlogo',\n                    'showinview': u'dock',\n                    'keyword': u'xlogo',\n                    'execmode': u'builtin',\n                    'launch': u'/usr/bin/xlogo',\n                    'displayname': u'xlogo',\n                    'execmode': u'builtin',\n                    'cat': u'utilities',\n                    'id': u'xlogo.d',\n                    'icon': u'xlogo.svg',\n                    'hideindock': False,\n                    'args': '' \n}\n</code></pre>"},{"location":"3.0/config/host_config/","title":"host_config resource description","text":"<p><code>host_config</code> resource description allows to change the running context for docker application. <code>host_config</code> is a dictionary and uses the same format in <code>applist.json</code> file and <code>od.config</code> file.</p> <p>The same <code>host_config</code> format is reused in a multiple configuration files. <code>host_config</code> is present in <code>applist.json</code> file to build application image, and in <code>od.config</code> to set default running values in desktop and in application.</p> <p>For example you can set low cpu and memory values to an application like the great X11 xeyes.</p> <pre><code>{   \n    \"mem_limit\":  \"32M\", \n    \"shm_size\":   \"OM\", \n    \"cpu_period\":  50000, \n    \"cpu_quota\":   50000, \n    \"pid_mode\":   false, \n    \"network_mode\": \"none\" \n}\n</code></pre>"},{"location":"3.0/config/host_config/#host_config-entries","title":"host_config entries","text":"Key name Type Description     <code>auto_remove</code> bool enable auto removal of the container on daemon side when the container\u2019s process exits.   <code>cpu_period</code> int The length of a CPU period in microseconds.   <code>cpu_quota</code> int Microseconds of CPU time that the container can get in a CPU period.   <code>cpu_shares</code> int CPU shares relative weight.   <code>cpuset_cpus</code> str CPUs in which to allow execution 0 3 0 1 .   <code>cpuset_mems</code> str Memory nodes    MEMs in which to allow execution 0 3 0 1. Only effective on NUMA systems.   <code>device_cgroup_rules</code> list A list of cgroup rules to apply to the container.   <code>device_read_bps</code> bytes per second Limit read rate from a device in the form of: [{\u201cPath\u201d: \u201cdevice_path\u201d \u201cRate\u201d: rate}]   <code>device_read_iops</code> IO per second Limit read rate from a device.   <code>device_write_bps</code> bytes per second Limit write rate from a device.   <code>device_write_iops</code> IO per second Limit write rate from a device.   <code>devices</code> list Expose host devices to the container as a list of strings in the form ::. For example /dev/sda:/dev/xvda:rwm allows the container to have read write access to the host\u2019s /dev/sda via a node named /dev/xvda inside the container.   <code>device_requests</code> list Expose host resources such as GPUs to the container as a list of docker.types.DeviceRequest instances.   <code>ipc_mode</code> str Set the IPC mode for the container.   <code>mem_limit</code> float or str Memory limit. Accepts float values which represent the memory limit of the created container in bytes or a string with a units identification char 100000b 1000k 128m 1g.   <code>mem_reservation</code> float or str Memory soft limit   <code>mem_swappiness</code> int Tune a container s memory swappiness behavior. Accepts number between 0 and 100.   <code>memswap_limit</code> str or int Maximum amount of memory + swap a container is allowed to consume.   <code>oom_kill_disable</code> bool Whether to disable OOM killer.   <code>oom_score_adj</code> int An integer value containing the score given to the container in order to tune OOM killer preferences.   <code>shm_size</code> str or int Size of /dev/shm e.g. 1G.   <code>cap_add</code> list of str Add kernel capabilities.  <code>{ 'add': [ 'SYS_ADMIN', 'SYS_PTRACE' ]}</code>for example to permit the call ptrace: <code>SYS_PTRACE</code>, trace arbitrary processes using ptrace, and <code>SYS_ADMIN</code>, perform a range of system administration operations. Read the docker run command informations https://docs.docker.com/engine/reference/run/ chapter Runtime privilege and Linux capabilities   <code>cap_drop</code> list of str Drop kernel capabilities.   <code>dns</code> list Set custom DNS servers.   <code>dns_opt</code> list Additional options to be added to the container\u2019s resolv.conf file   <code>dns_search</code> list DNS search domains.   <code>extra_hosts</code> dict Additional hostnames to resolve inside the container as a mapping of hostname to IP address.   <code>group_add</code> list List of additional group names and/or IDs that the container process will run as.   <code>isolation</code> str Isolation technology to use. Default: None.   <code>pid_mode</code> str  or bool If set to hostuse the host PID namespace inside the container. If set to host, use the host PID namespace inside the container.   <code>pids_limit</code> int Tune a container\u2019s pids limit. Set -1 for unlimited.   <code>privileged</code> bool Give extended privileges to this container.   <code>security_opt</code> list A list of string values to customize labels for MLS systems such as SELinux.   <code>storage_opt</code> dict Storage driver options per container as a key value mapping.   <code>sysctls</code> dict Kernel parameters to set in the container.   <code>ulimits</code> list Ulimits to set inside the container as a list of docker.types.Ulimit instances.   <code>userns_mode</code> str Sets the user namespace mode for the container when user namespace remapping option is enabled. Supported values are: host   <code>uts_mode</code> str Sets the UTS namespace mode for the container. Supported values are: host   <code>runtime</code> str Runtime to use with this container.   <code>network_mode</code> str One of: bridge Create a new network stack for the container on the bridge network. none No networking for this container. container: Reuse another container\u2019s network stack. host Use the host network stack. This mode is incompatible with port_bindings."},{"location":"3.0/config/host_config/#main-host_config-entries-descriptions","title":"Main host_config entries descriptions","text":""},{"location":"3.0/config/host_config/#auto_remove","title":"<code>auto_remove</code>","text":"<p>The <code>auto_remove</code> is use to remove or not remove an abcdesktop container application or desktop.</p>  <p>For example, when an application container is exited,  do we need to remove the container, by running the <code>docker rm</code> command ?</p>  <p>By default the auto_remove is <code>True</code>. But if you need to keep your application container to post-mortem debugging or to get some value, set this value to <code>False</code>. Set this value to <code>False</code> only to troubleshoot an application. </p> <p>In production this value MUST be set to <code>True</code></p>"},{"location":"3.0/config/host_config/#cpu_period-cpu_quota","title":"<code>cpu_period</code> <code>cpu_quota</code>","text":"<p><code>cpu_period</code> Specify the CPU CFS scheduler period, which is used alongside --cpu-quota. Defaults to 100000 microseconds (100 milliseconds). Most users do not change this from the default. </p> <p><code>cpu-quota</code> impose a CPU CFS quota on the container. The number of microseconds per --cpu-period that the container is limited to before throttled. As such acting as the effective ceiling. </p>"},{"location":"3.0/config/host_config/#privileged","title":"<code>privileged</code>","text":"<p>The <code>privileged</code> option runs a user container in <code>privileged</code> mode. When the operator executes docker run privileged, docker will enable access to all devices on the host as well as set some configuration in AppArmor or SELinux to allow the container nearly all the same access to the host as processes running outside containers on the host.allow a user to run a sudo command. The default value is <code>False</code>. You should only set privilege to True for troobleshooting. In production this value MUST be set to False.</p>"},{"location":"3.0/config/host_config/#ipc_mode","title":"<code>ipc_mode</code>","text":"<p>The <code>ipc_mode</code> value is a string, the default value is <code>'shareable'</code>. This option permits user's container to share the ipc namespace with application This option is used by pulseaudio service by default. </p>    value description     <code>''</code> Use daemon default.   <code>'none'</code> Own private IPC namespace.   <code>'private'</code> Own private IPC namespace.   <code>'shareable'</code> Own private IPC namespace, with a possibility to share it with other containers.   <code>'host'</code> Use the host system IPC namespace.    <p>If not specified, daemon default is used, which can either be \"private\" or \"shareable\", depending on the daemon version and configuration. IPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments, semaphores and message queues. Shared memory segments are used to accelerate inter-process communication at memory speed, rather than through pipes or through the network stack. Shared memory is commonly used by databases and custom-built.  If these types of applications are broken into multiple containers, you might need to share the IPC mechanisms of the containers, using shareable mode for the main (i.e. donor) container, and container: for other containers."},{"location":"3.0/config/host_config/#security_opt","title":"<code>security_opt</code>","text":"<p>The <code>securityopt</code> option allow to set the <code>security_opt</code> default value for a docker application container. <code>security_opt</code> is the docker parameter.</p> <ul> <li>To run without the default seccomp profile <code>seccomp=unconfined</code></li> <li>To disable sudo command add <code>no-new-privileges</code> to the list. For example: <code>[ 'no-new-privileges', 'seccomp=unconfined' ]</code></li> </ul> <p>Docker's default seccomp profile is a whitelist which specifies the calls that are allowed. The table below lists the significant (but not all) syscalls that are effectively blocked because they are not on the whitelist. The table includes the reason each syscall is blocked rather than white-listed.</p>    Syscall Description     <code>acct</code> Accounting syscall which could let containers disable their own resource limits or process accounting. Also gated by <code>CAP_SYS_PACCT</code>.   <code>add_key</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>bpf</code> Deny loading potentially persistent bpf programs into kernel, already gated by <code>CAP_SYS_ADMIN</code>.   <code>clock_adjtime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>clock_settime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>clone</code> Deny cloning new namespaces. Also gated by <code>CAP_SYS_ADMIN</code> for CLONE_* flags, except <code>CLONE_USERNS</code>.   <code>create_module</code> Deny manipulation and functions on kernel modules. Obsolete. Also gated by <code>CAP_SYS_MODULE</code>.   <code>delete_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>finit_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>get_kernel_syms</code> Deny retrieval of exported kernel and module symbols. Obsolete.   <code>get_mempolicy</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>init_module</code> Deny manipulation and functions on kernel modules. Also gated by <code>CAP_SYS_MODULE</code>.   <code>ioperm</code> Prevent containers from modifying kernel I/O privilege levels. Already gated by <code>CAP_SYS_RAWIO</code>.   <code>iopl</code> Prevent containers from modifying kernel I/O privilege levels. Already gated by <code>CAP_SYS_RAWIO</code>.   <code>kcmp</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>kexec_file_load</code> Sister syscall of <code>kexec_load</code> that does the same thing, slightly different arguments. Also gated by <code>CAP_SYS_BOOT</code>.   <code>kexec_load</code> Deny loading a new kernel for later execution. Also gated by <code>CAP_SYS_BOOT</code>.   <code>keyctl</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>lookup_dcookie</code> Tracing/profiling syscall, which could leak a lot of information on the host. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>mbind</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>mount</code> Deny mounting, already gated by <code>CAP_SYS_ADMIN</code>.   <code>move_pages</code> Syscall that modifies kernel memory and NUMA settings.   <code>name_to_handle_at</code> Sister syscall to <code>open_by_handle_at</code>. Already gated by <code>CAP_DAC_READ_SEARCH</code>.   <code>nfsservctl</code> Deny interaction with the kernel nfs daemon. Obsolete since Linux 3.1.   <code>open_by_handle_at</code> Cause of an old container breakout. Also gated by <code>CAP_DAC_READ_SEARCH</code>.   <code>perf_event_open</code> Tracing/profiling syscall, which could leak a lot of information on the host.   <code>personality</code> Prevent container from enabling BSD emulation. Not inherently dangerous, but poorly tested, potential for a lot of kernel vulns.   <code>pivot_root</code> Deny <code>pivot_root</code>, should be privileged operation.   <code>process_vm_readv</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>process_vm_writev</code> Restrict process inspection capabilities, already blocked by dropping <code>CAP_SYS_PTRACE</code>.   <code>ptrace</code> Tracing/profiling syscall. Blocked in Linux kernel versions before 4.8 to avoid seccomp bypass. Tracing/profiling arbitrary processes is already blocked by dropping <code>CAP_SYS_PTRACE</code>, because it could leak a lot of information on the host.   <code>query_module</code> Deny manipulation and functions on kernel modules. Obsolete.   <code>quotactl</code> Quota syscall which could let containers disable their own resource limits or process accounting. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>reboot</code> Don't let containers reboot the host. Also gated by <code>CAP_SYS_BOOT</code>.   <code>request_key</code> Prevent containers from using the kernel keyring, which is not namespaced.   <code>set_mempolicy</code> Syscall that modifies kernel memory and NUMA settings. Already gated by <code>CAP_SYS_NICE</code>.   <code>setns</code> Deny associating a thread with a namespace. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>settimeofday</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>stime</code> Time/date is not namespaced. Also gated by <code>CAP_SYS_TIME</code>.   <code>swapon</code> Deny start/stop swapping to file/device. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>swapoff</code> Deny start/stop swapping to file/device. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>sysfs</code> Obsolete syscall.   <code>_sysctl</code> Obsolete, replaced by /proc/sys.   <code>umount</code> Should be a privileged operation. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>umount2</code> Should be a privileged operation. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>unshare</code> Deny cloning new namespaces for processes. Also gated by <code>CAP_SYS_ADMIN</code>, with the exception of <code>unshare --user</code>.   <code>uselib</code> Older syscall related to shared libraries, unused for a long time.   <code>userfaultfd</code> Userspace page fault handling, largely needed for process migration.   <code>ustat</code> Obsolete syscall.   <code>vm86</code> In kernel x86 real mode virtual machine. Also gated by <code>CAP_SYS_ADMIN</code>.   <code>vm86old</code> In kernel x86 real mode virtual machine. Also gated by <code>CAP_SYS_ADMIN</code>.    <p>Read security_opt from the docker website.</p>"},{"location":"3.0/config/host_config/#capabilities-cap_add-cap_drop","title":"capabilities <code>cap_add</code> <code>cap_drop</code>","text":"<p>This value is added to the oc.user docker container, or as securityContext attribut in kubernetes mode :</p> <pre><code>securityContext:\n      capabilities:\n        desktop.capabilities\n</code></pre> <p>For example </p> <pre><code>    { \n        'add': [ \"SYS_ADMIN\", \"SYS_PTRACE\" ]\n    }\n</code></pre> <p>Permit a container  to call ptrace:</p> <ul> <li>\"SYS_PTRACE\": Trace arbitrary processes using ptrace</li> <li>\"SYS_ADMIN\": Perform a range of system administration operations.</li> </ul> <p>Read the docker run command informations Docker run reference </p> <p>By default, Docker has a default list of capabilities that are kept. The following table lists the Linux capability options which can be added or dropped.</p>    Capability Key Capability Description     SETPCAP Modify process capabilities.   SYS_MODULE Load and unload kernel modules.   SYS_RAWIO Perform I/O port operations (iopl(2) and ioperm(2)).   SYS_PACCT Use acct(2), switch process accounting on or off.   SYS_ADMIN Perform a range of system administration operations.   SYS_NICE Raise process nice value (nice(2), setpriority(2)) and change the nice value for arbitrary processes.   SYS_RESOURCE Override resource Limits.   SYS_TIME Set system clock (settimeofday(2), stime(2), adjtimex(2)); set real-time (hardware) clock.   SYS_TTY_CONFIG Use vhangup(2); employ various privileged ioctl(2) operations on virtual terminals.   MKNOD Create special files using mknod(2).   AUDIT_WRITE Write records to kernel auditing log.   AUDIT_CONTROL Enable and disable kernel auditing; change auditing filter rules; retrieve auditing status and filtering rules.   MAC_OVERRIDE Allow MAC configuration or state changes. Implemented for the Smack LSM.   MAC_ADMIN Override Mandatory Access Control (MAC). Implemented for the Smack Linux Security Module (LSM).   NET_ADMIN Perform various network-related operations.   SYSLOG Perform privileged syslog(2) operations.   CHOWN Make arbitrary changes to file UIDs and GIDs (see chown(2)).   NET_RAW Use RAW and PACKET sockets.   DAC_OVERRIDE Bypass file read, write, and execute permission checks.   FOWNER Bypass permission checks on operations that normally require the file system UID of the process to match the UID of the file.   DAC_READ_SEARCH Bypass file read permission checks and directory read and execute permission checks.   FSETID Don't clear set-user-ID and set-group-ID permission bits when a file is modified.   KILL Bypass permission checks for sending signals.   SETGID Make arbitrary manipulations of process GIDs and supplementary GID list.   SETUID Make arbitrary manipulations of process UIDs.   LINUX_IMMUTABLE Set the FS_APPEND_FL and FS_IMMUTABLE_FL i-node flags.   NET_BIND_SERVICE Bind a socket to internet domain privileged ports (port numbers less than 1024).   NET_BROADCAST Make socket broadcasts, and listen to multicasts.   IPC_LOCK Lock memory (mlock(2), mlockall(2), mmap(2), shmctl(2)).   IPC_OWNER Bypass permission checks for operations on System V IPC objects.   SYS_CHROOT Use chroot(2), change root directory.   SYS_PTRACE Trace arbitrary processes using ptrace(2).   SYS_BOOT Use reboot(2) and kexec_load(2), reboot and load a new kernel for later execution.   LEASE Establish leases on arbitrary files (see fcntl(2)).   SETFCAP Set file capabilities.   WAKE_ALARM Trigger something that will wake up the system.   BLOCK_SUSPEND Employ features that can block system suspend.    <p>Further reference information is available on the capabilities(7) - Linux man page</p>  <p>Set this value only to troubleshoot an application. </p>  <p>In production this value MUST be set to an empty dict <code>{}</code></p>"},{"location":"3.0/config/jira/","title":"JIRA configuration","text":"<p>abcdesktop.io support JIRA </p>"},{"location":"3.0/config/jira/#jira-option","title":"JIRA option","text":"<p>In <code>od.config</code> add the <code>jira</code> option. <code>jira</code> option is a dictionary with the entries :</p>    entry sample value               \u00a0\u00a0     url https://domainexample.atlassian.net/   project_id ABCD   username account@domain.local   apikey XXXXXXXXXXXXXXXXXXXX    <p>And fill the dictionary </p> <pre><code>jira : { \n            'url':          'https://domainexample.atlassian.net/',\n            'project_id':   'ABCD',\n            'username':     'account@domain.local',\n            'apikey' :      'XXXXXXXXXXXXXXXXXXXX' }\n</code></pre> <p>Then apply the new configuration file <code>od.config</code> by retrasting the daemon.</p> <p>When <code>jira</code> option is set, a new icon <code>issue</code> appears at the top.</p>  <p>Click on the <code>issue</code> icon, a new window is appear.</p>  <p>Fill <code>Summary</code> and <code>Your Report</code> values</p>  <p>Then press the <code>Send</code> button. A notification message appears on the left top corner.</p>  <p>Log into your jira server, and check your backlog </p>  <p>Great you added a new issue tracking.</p>"},{"location":"3.0/config/language/","title":"Language entry in od.config","text":"<p>The language option is a list of string. Each string is formatted as a locale variable. The locale is simply the language/country combination <code>en + US = en_US</code></p>"},{"location":"3.0/config/language/#language-in-abcdesktopio-ocuser","title":"Language in abcdesktop.io oc.user","text":"<p>The language list must match with the oc.user local packages all ready installed.</p> <p>If the language is not found, the default value is set to <code>en_US</code></p> <p>The oc.user.18.04 is built-in with the default language package :</p> <ul> <li><code>language-pack-en</code> </li> <li><code>language-pack-fr</code></li> </ul> <pre><code>apt-get install -y \\\n    language-pack-en \\\n    language-pack-fr \\\n    &amp;&amp; locale-gen    \\\n    &amp;&amp; apt-get clean\n</code></pre> <p>The full supported language list is set by default </p> <pre><code>language : [  'af_ZA', 'am_ET', 'an_ES', 'ar_AE', 'ar_BH', 'ar_DZ', 'ar_EG', 'ar_IN', 'ar_IQ', 'ar_JO', 'ar_KW','ar_LB', 'ar_LY', 'ar_MA', 'ar_OM', 'ar_QA', 'ar_SA', 'ar_SD', 'ar_SY', 'ar_TN', 'ar_YE', 'as_IN', 'ast_ES', 'az_AZ', 'be_BY', 'bg_BG', 'bn_BD', 'bn_IN', 'bo_CN', 'bo_IN', 'br_FR', 'bs_BA', 'ca_AD', 'ca_ES', 'ca_FR', 'ca_IT', 'crh_UA', 'cs_CZ', 'cy_GB', 'da_DK', 'de_AT', 'de_BE', 'de_CH', 'de_DE', 'de_LI', 'de_LU', 'dz_BT', 'el_CY', 'el_GR', 'en_AG', 'en_AU', 'en_BW', 'en_CA', 'en_DK', 'en_GB', 'en_HK', 'en_IE', 'en_IN', 'en_NG', 'en_NZ', 'en_PH', 'en_SG', 'en_US', 'en_ZA', 'en_ZM', 'en_ZW', 'eo', 'eo_US', 'es_AR', 'es_BO', 'es_CL', 'es_CO', 'es_CR', 'es_CU', 'es_DO', 'es_EC', 'es_ES', 'es_GT', 'es_HN', 'es_MX', 'es_NI', 'es_PA', 'es_PE', 'es_PR', 'es_PY', 'es_SV', 'es_US', 'es_UY', 'es_VE', 'et_EE', 'eu_ES', 'eu_FR', 'fa_IR', 'fi_FI', 'fr_BE', 'fr_CA', 'fr_CH', 'fr_FR', 'fr_LU', 'ga_IE', 'gd_GB', 'gl_ES', 'gu_IN', 'he_IL', 'hi_IN', 'hr_HR', 'hu_HU', 'id_ID', 'is_IS', 'it_CH', 'it_IT', 'ja_JP', 'ka_GE', 'kk_KZ', 'km_KH', 'kn_IN', 'ko_KR', 'ku_TR', 'lt_LT', 'lv_LV', 'mai_IN', 'mk_MK', 'ml_IN', 'mn_MN', 'mr_IN', 'ms_MY', 'my_MM', 'nb_NO', 'nds_DE', 'nds_NL', 'ne_NP', 'nl_AW', 'nl_BE', 'nl_NL', 'nn_NO', 'oc_FR', 'or_IN', 'pa_IN', 'pa_PK', 'pl_PL', 'pt_BR', 'pt_PT', 'ro_RO', 'ru_RU', 'ru_UA', 'si_LK', 'sk_SK', 'sl_SI', 'sq_AL', 'sq_MK', 'sr_ME', 'sr_RS', 'sv_FI', 'sv_SE', 'ta_IN', 'ta_LK', 'te_IN', 'tg_TJ', 'th_TH', 'tr_CY', 'tr_TR', 'ug_CN', 'uk_UA', 'uz_UZ', 'vi_VN', 'xh_ZA', 'zh_CN', 'zh_HK', 'zh_SG', 'zh_TW' ]\n</code></pre> <p>This list must match with the <code>Accept-Language</code> request HTTP header.</p>"},{"location":"3.0/config/language/#language-in-abcdesktopio-applications","title":"Language in abcdesktop.io Applications","text":"<p>abcdesktop.io use the web browser language property to set the application's language. This list must match with the <code>Accept-Language</code> request HTTP header. If the language is not found, the default value is set to <code>en_US</code>.</p>  <p>Hands-on: </p> <p>Change your web browser language, and run LibreOffice applications. The language setting use the web browser value. During this exercice you can keep the same abcdesktop.io users session. </p>"},{"location":"3.0/config/language/#set-the-web-browsers-default-language-to-en_us","title":"Set the web browser's default language to <code>en_US</code> :","text":"<p> The launch LibreOffice Writer. The menu is set to <code>en_US</code>  LibreOffice Writer use English/US <code>en_US</code> language.</p>"},{"location":"3.0/config/language/#set-the-web-browsers-default-language-to-fr_fr","title":"Set the web browser's default language to <code>fr_FR</code> :","text":"<p>You can keep the same abcdesktop.io users session, you do not need to logout.</p>  <p>The launch LibreOffice Writer. The menu is set to <code>fr_FR</code>  LibreOffice Writer use French <code>fr_FR</code>language.</p> <p>Great you have change the language settings of applications running inside an abcdesktop docker container</p>"},{"location":"3.0/config/linux_syslog_config/","title":"Linux syslog config","text":""},{"location":"3.0/config/linux_syslog_config/#modify-etcrsyslogconf","title":"Modify /etc/rsyslog.conf","text":"<p>By default syslog program is configured to log messages received over unix socket files. rsyslog configuration file need to be modified to accept messages over UDP.</p> <p>Edit /etc/rsyslog.conf file with your prefered linux text editor as sudo ou root:</p> <pre><code>sudo vi /etc/rsyslog.conf\n</code></pre>  <p>Uncomment the following lines and save file :</p> <pre><code>module(load=\"imudp\")\ninput(type=\"imudp\" port=\"514\")\n</code></pre>"},{"location":"3.0/config/linux_syslog_config/#restart-rsyslog","title":"Restart rsyslog","text":"<p>Now we have enabled rsyslog over UDP on 514 port in config file, we have to restart rsyslog to take new parameters into account. Execute the following command as sudo:</p> <pre><code>sudo systemctl restart rsyslog\n</code></pre>"},{"location":"3.0/config/logging/","title":"Logging configuration in od.config","text":"<p>The <code>logging</code> configuration is a dictionnary object. The logging configuration describes where and how log message information have to been send.</p> <p><code>logging</code> dict use the python logging module logging module</p> <p>The <code>syslog</code> and <code>graylog</code> protocol messaging are supported too.</p> <p>The default features for each handlers are : </p>    handler Features     <code>console</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>ext://sys.stdout</code> formated as standard   <code>cherrypy_console</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>ext://sys.stdout</code> formatted as access   <code>cherrypy_access</code> log message using a <code>logging.StreamHandler</code> to the file stream <code>logs/access.log</code> formatted as access   <code>cherrypy_trace</code> log message using a <code>logging.StreamHandler</code> to the stream:  <code>logs/trace.log</code> formatted as standard    <p>Sub modules used by od.py can log information too. </p>    Sub module Default Values     <code>docker.utils.config</code> <code>{ 'level': 'INFO' },</code>   <code>urllib3.connectionpool</code> <code>{ 'level': 'ERROR'},</code>    <p>The <code>logging</code> sample configuration :</p> <pre><code>#              \n# logging configuration \n# come from https://docs.python.org/3.8/library/logging.config.html\n# need double %% to escape %\n# \n# graylog https://github.com/severb/graypy\n# use handler class name as\n# graypy.GELFUDPHandler - UDP log forwarding\n# graypy.GELFTCPHandler - TCP log forwarding\n# graypy.GELFTLSHandler - TCP log forwarding with TLS support\n# graypy.GELFHTTPHandler - HTTP log forwarding\n# graypy.GELFRabbitHandler - RabbitMQ log forwarding\n\nlogging: {\n  'version': 1,\n  'disable_existing_loggers': False,\n  'formatters': {\n    'access': {\n      'format': '%%(message)s - user: %%(userid)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'standard': {\n      'format': '%%(asctime)s %%(module)s [%%(levelname)-7s] %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'syslog': {\n      'format': '%%(asctime)s %%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'graylog': {\n      'format': '%%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s'      \n    }\n  },\n  'filters': {\n    'odcontext': {\n      '()': 'oc.logging.OdContextFilter'\n    }\n  },\n  'handlers': {\n    'console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_access': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'filename': 'logs/access.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8'\n    },\n    'cherrypy_trace': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'filename': 'logs/trace.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8',\n      'mode': 'w'\n    }\n  },\n  'loggers': {\n    '': {\n      'handlers': [ 'console', 'cherrypy_trace'  ],\n      'level': 'DEBUG'\n    },\n    'docker.utils.config': {\n      'level': 'INFO'\n    },\n    'urllib3.connectionpool': {\n      'level': 'ERROR'\n    },\n    'cherrypy.access': {\n      'handlers': [ 'cherrypy_access' ],\n      'level': 'INFO',\n      'propagate': False\n    },\n    'cherrypy.error': {\n      'handlers': [ 'console', 'cherrypy_trace' ],\n      'level': 'ERROR',\n      'propagate': False\n    }\n  } }\n</code></pre>"},{"location":"3.0/config/stack/","title":"stack entry in od.config","text":""},{"location":"3.0/config/stack/#stackmode","title":"stack.mode","text":"<p><code>stack.mode</code> describes how abcdesktop.io can manage user's containers and application. </p> <ul> <li>If you run a docker only daemon, set the value to <code>standalone</code>.</li> <li>If you run a kubernetes cluster, set the value to <code>kubernetes</code>.</li> </ul>    stack.mode Description     <code>standalone</code> Use a dockerd only, this is for personal usage   <code>kubernetes</code> Use a kubernetes services"},{"location":"3.0/config/stack/#stackkubernetesdefaultdomain","title":"stack.kubernetesdefaultdomain","text":"<p><code>stack.kubernetesdefaultdomain</code> is the default domain name configured in kubernetes cluster. This value is type is string and only read if stack.mode is <code>kubernetes</code>.</p> <p>The default value is <code>abcdesktop.svc.cluster.local</code> </p> <p>If option value <code>mongodb</code> or <code>memcached</code> are set, the values are NOT overridden, and keep unchanged.</p> <p>If option value <code>mongodb</code> or <code>memcached</code> are set to <code>None</code> (by default), then <code>stack.kubernetesdefaultdomain</code> is used to complete the FQDN of <code>mongodb</code> and <code>memcached</code> servers name. This value is concatenated to the server hostname.</p>    Hostname FQDN     <code>mongodb</code> <code>mongodb.abcdesktop.svc.cluster.local</code>   <code>memcached</code> <code>memcached.abcdesktop.svc.cluster.local</code>    <p>The dns resolution need a running <code>core-dns</code>is the namespace <code>kube-system</code></p> <p><code>stack.kubernetesdefaultdomain</code> is used also if <code>desktop.desktopuseinternalfqdn: True</code></p> <p>The pod name FQDN is built using the <code>$podid</code>.desktop.<code>$stack.kubernetesdefaultdomain</code></p> <p>For example, by default :</p> <p><code>c8c7d38f-7621-40bb-a777-83f41b32733e.desktop.abcdesktop.svc.cluster.local</code></p>"},{"location":"3.0/config/sudo-kubernetes/","title":"Sudo kubernetes","text":""},{"location":"3.0/config/sudo-kubernetes/#how-to-get-a-root-access-inside-a-container-running-kubernetes-abcdesktop","title":"How to get a root access inside a container running kubernetes abcdesktop ?","text":"<p>run the sudo command inside the user kubernetes pods</p>   <pre><code>balloon@43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e:~$ sudo bash\nsudo: effective uid is not 0, is /usr/bin/sudo on a file system with the 'nosuid' option set or an NFS file system without root privileges?\n</code></pre> <ol> <li>Download the default abcdesktop.yaml</li> <li>Update the od.config file inside the <code>configmap/abcdesktop-config</code></li> <li>Allow in the od.config section, update the option desktop.allowPrivilegeEscalation value to True </li> </ol> <pre><code>    # desktop.allowPrivilegeEscalation\n    # value True or False\n    # This value is only avalaible in kubernetes mode,\n    # The desktop.allowPrivilegeEscalation allow a user to run a sudo command.\n    # This option set the runtime privilege and Linux capabilities\n    # The execve system call can grant a newly-started program privileges that its parent did not have,\n    # such as the setuid or setgid Linux flags.\n    # The default value is False\n    # You should only set desktop.allowPrivilegeEscalation to run sudo command.\n    # In production this value MUST be set to False\n\n    desktop.allowPrivilegeEscalation: True \n\n</code></pre> <ol> <li>Update the kubernetes config with the new abcdesktop.yaml  </li> </ol> <pre><code>% kubectl apply -f abcdesktop.yaml\n  configmap/abcdesktop-config configured\n</code></pre> <ol> <li>Restart the pyos pod </li> </ol> <p>List all pods </p> <pre><code>% kubectl get pods -n abcdesktop\nNAME                                   READY   STATUS    RESTARTS   AGE\n43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e   3/3     Running   0          17m\ndaemonset-nginx-bbbvj                  1/1     Running   0          37m\ndaemonset-pyos-ckqx6                   1/1     Running   0          39h\nmemcached-od-5bf65bf745-l62jr          1/1     Running   0          39h\nmongodb-od-656d85c49f-jx2zj            1/1     Running   0          39h\nopenldap-od-5945946767-82qh4           1/1     Running   0          39h\nspeedtest-od-58b9847b4b-gllrt          1/1     Running   0          39h\n</code></pre> <p>Delete the pyos pod</p> <pre><code>% kubectl delete pods daemonset-pyos-ckqx6  -n abcdesktop\npod \"daemonset-pyos-ckqx6\" deleted\n</code></pre> <p>Kubenestes restart the new pyos pod</p> <pre><code>kubectl get pods -n abcdesktop                         \nNAME                                   READY   STATUS    RESTARTS   AGE\n43c2ef50-a7b9-4e36-8a9d-8ac3ce80180e   3/3     Running   0          18m\ndaemonset-nginx-bbbvj                  1/1     Running   0          38m\ndaemonset-pyos-fhbx5                   1/1     Running   0          3s\nmemcached-od-5bf65bf745-l62jr          1/1     Running   0          39h\nmongodb-od-656d85c49f-jx2zj            1/1     Running   0          39h\nopenldap-od-5945946767-82qh4           1/1     Running   0          39h\nspeedtest-od-58b9847b4b-gllrt          1/1     Running   0          39h\n</code></pre> <ol> <li>Make sure that your user has done a logoff his pod, then login again and run terminal web shell </li> </ol> <p>The default balloon password is <code>lmdpocpetit</code></p> <pre><code>balloon@c182dc39-6a00-4869-8b01-2039f37c1eab:~$ sudo bash\n[sudo] password for balloon: \nroot@c182dc39-6a00-4869-8b01-2039f37c1eab:~# id\nuid=0(root) gid=0(root) groups=0(root),105(lpadmin)\nroot@c182dc39-6a00-4869-8b01-2039f37c1eab:~#  \n</code></pre> <p>After the sudo command, you get a root level inside the shell of the users's pod</p>   <p>In production this value should be set to False</p>"},{"location":"3.0/config/syslog/","title":"Syslog configuration in od.config","text":""},{"location":"3.0/config/syslog/#add-syslog-server-support","title":"Add syslog server support","text":"<pre><code>   'filters': [ 'odcontext' ],\n</code></pre> <p>syslog is a protocol for tracking and logging system messages in Linux. Applications use syslog to export all their error and status messages to the files in the /var/log directory.</p> <p>syslog uses the client-server model; a client transmits a text message to the server (receiver). The server is commonly called syslogd, syslog daemon, or syslog server. syslog uses the User Datagram Protocol (UDP) port 514 for communication. </p>"},{"location":"3.0/config/syslog/#start-syslog-container","title":"Start syslog container","text":"<p>Those running linux can simply modify their syslog configuration file following linux syslog config steps</p> <p>For others (Windows/Mac) or those that don't want to modify their syslog config, you can simply run the following command :</p> <pre><code>docker run -it -p 514:514/udp --name syslog-ng balabit/syslog-ng:latest -edv\n</code></pre> <pre><code>[2020-04-07T12:29:39.485318] Accepting connections; addr='AF_INET(0.0.0.0:514)'\n[2020-04-07T12:29:39.485752] You have a TLS enabled source without a X.509 keypair. Make sure you have tls(key-file() and cert-file()) options, TLS handshake to this source will fail; location='/etc/syslog-ng/syslog-ng.conf:21:2'\n[2020-04-07T12:29:39.485964] Accepting connections; addr='AF_INET(0.0.0.0:6514)'\n[2020-04-07T12:29:39.486179] Accepting connections; addr='AF_INET(0.0.0.0:601)'\n[2020-04-07T12:29:39.486600] Running application hooks; hook='1'\n[2020-04-07T12:29:39.486621] Running application hooks; hook='6'\n[2020-04-07T12:29:39.486674] syslog-ng starting up; version='3.26.1'\n[2020-04-07T12:29:39.486850] Running application hooks; hook='2'\n[2020-04-07T12:39:39.587220] Log statistics; processed='global(payload_reallocs)=0', processed='global(sdata_updates)=0', queued='global(scratch_buffers_bytes)=0', processed='src.internal(s_local#0)=0', stamp='src.internal(s_local#0)=0', processed='destination(d_local)=0', processed='source(s_local)=0', processed='source(s_network)=0', processed='global(msg_clones)=0', processed='center(received)=0', queued='global(scratch_buffers_count)=0', processed='center(queued)=0'\n</code></pre>"},{"location":"3.0/config/syslog/#modify-logging-entry","title":"Modify logging entry","text":"<p>To let abcdesktop log events in syslog trought UDP, we will have to modify abcdesktop configuration file to add  an handler and 'syslog' entry in general logger and cherrypy.error logger. (syslog formatter is already in sample file)</p>"},{"location":"3.0/config/syslog/#add-syslog-handler","title":"Add Syslog Handler","text":"<p>In handlers entry add the following lines:</p> <pre><code>        ,\n        'syslog': {\n          'class': 'logging.handlers.SysLogHandler',\n          'filters': [ 'odcontext' ],\n          'formatter': 'syslog',\n          'socktype': 2,\n          'address' : [ '192.168.0.52', 514 ]\n        }\n</code></pre> <p>Replace 192.168.0.52 ip address by your local IP Addresse.</p> <p>You can get your local IP address using the following command:</p> <pre><code>hostname -I | cut -d ' ' -f1\n</code></pre>"},{"location":"3.0/config/syslog/#add-loggers-handlers-entries","title":"Add loggers handlers entries","text":"<p>In general loggers (key '' in loggers entry) and 'cherrypy.error' add <code>syslog'</code> handler in handlers list:</p> <pre><code>        '': {\n          'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n          'level': 'INFO'\n        }\n\n       'cherrypy.error': {\n          'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n          'level': 'ERROR',\n          'propagate': False\n        }\n</code></pre>"},{"location":"3.0/config/syslog/#resulting-modified-sample-configuration-file","title":"Resulting Modified sample configuration file","text":"<pre><code>#              \n# logging configuration \n# come from https://docs.python.org/3.8/library/logging.config.html\n# need double %% to escape %\n# \n# graylog https://github.com/severb/graypy\n# use handler class name as\n# graypy.GELFUDPHandler - UDP log forwarding\n# graypy.GELFTCPHandler - TCP log forwarding\n# graypy.GELFTLSHandler - TCP log forwarding with TLS support\n# graypy.GELFHTTPHandler - HTTP log forwarding\n# graypy.GELFRabbitHandler - RabbitMQ log forwarding\n\nlogging: {\n  'version': 1,\n  'disable_existing_loggers': False,\n  'formatters': {\n    'access': {\n      'format': '%%(message)s - user: %%(userid)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'standard': {\n      'format': '%%(asctime)s %%(module)s [%%(levelname)-7s] %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'syslog': {\n      'format': '%%(asctime)s %%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s',\n      'datefmt': '%%Y-%%m-%%d %%H:%%M:%%S'\n    },\n    'graylog': {\n      'format': '%%(levelname)s %%(module)s %%(process)d %%(name)s.%%(funcName)s:%%(userid)s %%(message)s'      \n    }\n  },\n  'filters': {\n    'odcontext': {\n      '()': 'oc.logging.OdContextFilter'\n    }\n  },\n  'handlers': {\n    'console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_console': {\n      'class': 'logging.StreamHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'stream': 'ext://sys.stdout'\n    },\n    'cherrypy_access': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'access',\n      'filename': 'logs/access.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8'\n    },\n    'cherrypy_trace': {\n      'class': 'logging.handlers.RotatingFileHandler',\n      'filters': [ 'odcontext' ],\n      'formatter': 'standard',\n      'filename': 'logs/trace.log',\n      'maxBytes': 10485760,\n      'backupCount': 20,\n      'encoding': 'utf8',\n      'mode': 'w'\n    },\n    'syslog': {\n       'class': 'logging.handlers.SysLogHandler',\n       'filters': [ 'odcontext' ],\n       'formatter': 'syslog',\n       'socktype': 2,\n       'address' : [ '192.168.0.52', 514 ]\n    }\n  },\n  'loggers': {\n    '': {\n      'handlers': [ 'console', 'cherrypy_trace', 'syslog'  ],\n      'level': 'DEBUG'\n    },\n    'docker.utils.config': {\n      'level': 'INFO'\n    },\n    'urllib3.connectionpool': {\n      'level': 'ERROR'\n    },\n    'cherrypy.access': {\n      'handlers': [ 'cherrypy_access' ],\n      'level': 'INFO',\n      'propagate': False\n    },\n    'cherrypy.error': {\n      'handlers': [ 'console', 'cherrypy_trace', 'syslog' ],\n      'level': 'ERROR',\n      'propagate': False\n    }\n  } }\n</code></pre>"},{"location":"3.0/config/syslog/#restart-pods","title":"Restart Pods","text":"<p>To restart Pods, we will delete and recreate all pods</p>"},{"location":"3.0/config/syslog/#delete-pods","title":"Delete pods","text":"<p>To delete pods, execute the following command:</p> <pre><code>kubectl delete -f abcdesktop.yaml\n</code></pre>"},{"location":"3.0/config/syslog/#create-pods","title":"Create pods","text":"<p>To create pods, execute the following command:</p> <pre><code>kubectl create -f abcdesktop.yaml\n</code></pre>"},{"location":"3.0/config/syslog/#verify-syslogs","title":"Verify syslogs","text":"<p>At this state, new abcdesktop logging configuration should be applied. We can now verify syslog logs:</p> <pre><code>tail /var/log/syslog\n</code></pre>  <p>If you see some lines with 'INFO' Level, you probably see abcdesktop logs in syslog ! If not try to do actions in abcdesktop (open session, launch new application, close session) and apply the tail command again.</p>"},{"location":"3.0/config/webrtc/","title":"Sound server configuration","text":"<p>By default abcdesktop use the <code>module-http-protocol-tcp</code> from pulseaudio sound server to send wav data to the web browser</p>"},{"location":"3.0/config/webrtc/#pulseaudio-http-stream-by-default","title":"pulseaudio http stream (by default)","text":"<p>By default, abcdesktop uses the pulseaudio http stream and play wave data (poor sound quality but works in https only)</p>  <p>In terminal webshell run the command : </p> <pre><code>pactl -s /tmp/.pulse.sock list short modules\n</code></pre> <pre><code>balloon@bac345323f37:/var/log/desktop$ pactl -s /tmp/.pulse.sock list short modules\n0 module-augment-properties\n1 module-null-sink sink_name=u8_1_11025 format=u8 channels=1 rate=11025 sink_properties=\"device.description='default format=u8 c=1 rate=11025'\"\n2 module-null-sink sink_name=s16_1_22050 format=s16be channels=1 rate=22050 sink_properties=\"device.description='default format=s16be c=1 rate=22050'\"\n3 module-null-sink sink_name=s16_1_44100 format=s16be channels=1 rate=44100 sink_properties=\"device.description='default format=s16be c=1 rate=44100'\"\n4 module-null-sink sink_name=ulaw8_1_8000 format=ulaw channels=1 rate=8000 sink_properties=\"device.description='default format=ulaw c=1 rate=8000'\"\n5 module-null-sink sink_name=rtp format=alaw channels=1 rate=8000 sink_properties=\"device.description='RTP Multicast Sink'\"\n6 module-native-protocol-unix auth-group=balloon socket=/tmp/.pulse.sock\n7 module-http-protocol-tcp listen=172.21.0.5\n8 module-always-sink\n</code></pre>"},{"location":"3.0/config/webrtc/#webrtc-gateway-enable","title":"webrtc gateway enable","text":"<p>To get a better sound quality, you can use a webrtc gateway and send a rtp stream to the webrtc gateway. abcdesktop plays sound using the web browser webrtc stack (good sound quality)</p>  <p>abcdesktop update the pulseaudio configuration, and add <code>module-rtp-send</code>. The <code>module-rtp-send</code> pusleaudio send to the destination_ip (in this example 1.2.3.4) </p> <pre><code>pactl -s /tmp/.pulse.sock list short modules\n</code></pre> <pre><code>balloon@414e3db9-60d8-4f92-a356-a3a74833990c:~$ pactl -s /tmp/.pulse.sock list short modules\n0       module-augment-properties\n1       module-null-sink        sink_name=rtp  format=alaw channels=1 rate=8000 sink_properties=\"device.description='RTP Multicast Sink'\"\n2       module-native-protocol-unix     auth-group=balloon socket=/tmp/.pulse.sock\n3       module-always-sink\n4       module-rtp-send source=rtp.monitor destination_ip=1.2.3.4 port=5119 channels=1 format=alaw\n</code></pre> <p>The <code>sink_name</code> is rtp, and the <code>source</code> for the <code>module-rtp-send</code> is rtp.monitor.</p> <p>The default source is <code>rtp.monitor</code></p> <pre><code>Source #\n        State: RUNNING\n        Name: rtp.monitor\n        Description: Monitor of RTP Multicast Sink\n        Driver: module-null-sink.c\n        Sample Specification: aLaw 1ch 8000Hz\n        Channel Map: mono\n        Owner Module: 5\n        Mute: no\n        Volume: mono: 65536 / 100% / 0.00 dB\n                balance 0.00\n        Base Volume: 65536 / 100% / 0.00 dB\n        Monitor of Sink: rtp\n        Latency: 0 usec, configured 160000 usec\n        Flags: DECIBEL_VOLUME LATENCY \n        Properties:\n                device.description = \"Monitor of RTP Multicast Sink\"\n                device.class = \"monitor\"\n                device.icon_name = \"audio-input-microphone\"\n        Formats:\n                pcm\n</code></pre> <p>The default output is </p> <pre><code>\nSource Output #0\n        Driver: module-rtp-send.c\n        Owner Module: 9\n        Client: n/a\n        Source: 4\n        Sample Specification: aLaw 1ch 8000Hz\n        Channel Map: mono\n        Format: pcm, format.sample_format = \"\\\"aLaw\\\"\"  format.rate = \"8000\"  format.channels = \"1\"  format.channel_map = \"\\\"mono\\\"\"\n        Corked: no\n        Mute: no\n        Volume: mono: 65536 / 100% / 0.00 dB\n                balance 0.00\n        Buffer Latency: 0 usec\n        Source Latency: 0 usec\n        Resample method: n/a\n        Properties:\n                media.name = \"RTP Monitor Stream\"\n                rtp.source = \"0.0.0.0\"\n                rtp.destination = \"1.2.3.4\"\n                rtp.mtu = \"1280\"\n                rtp.port = \"5119\"\n                rtp.ttl = \"1\"\n</code></pre> <p>By default, the format is <code>pcm</code></p> <pre><code>Format: pcm, format.sample_format = \"\\\"aLaw\\\"\"  format.rate = \"8000\"  format.channels = \"1\"  format.channel_map = \"\\\"mono\\\"\"\n</code></pre> <p>To change the default format update the values in od.config file.</p> <pre><code> 'audiopt': 8,\n 'audiortpmap': 'PCMA/8000',\n</code></pre> <p>To get the 'audiopt' and 'audiortpmap' values, read the web pages</p> <ul> <li>meetecho streaming plugin documentation</li> <li>RTP payload formats</li> </ul>"},{"location":"3.0/config/webrtc/#requirements","title":"Requirements","text":"<ul> <li>a janus server  </li> <li>add webrtc configuration in od.config file</li> </ul>"},{"location":"3.0/config/webrtc/#install-a-janus-server","title":"Install a janus server","text":""},{"location":"3.0/config/webrtc/#install-janus","title":"Install janus","text":"<p>Install a janus service from meetecho.com on a server </p> <pre><code>apt-get install janus\n</code></pre>"},{"location":"3.0/config/webrtc/#add-x509-certificats","title":"Add X509 certificats","text":"<p>Add X509 certificats in your janus.jcfg configuration. Certificate and key to use for DTLS (and passphrase if needed). If missing, Janus will autogenerate a self-signed certificate to use. Notice that self-signed certificates are fine for the purpose of WebRTC DTLS connectivity, for the time being, at least until Identity Providers are standardized and implemented in browsers.</p> <pre><code>certificates: {\n    cert_pem = \"/etc/ssl/certs/ssl-cert-snakeoil.pem\"\n    cert_key = \"/etc/ssl/private/ssl-cert-snakeoil.key\"\n    cert_pwd = \"secretpassphrase\"\n}\n</code></pre>"},{"location":"3.0/config/webrtc/#add-the-webrtc-entry-in-odconfig","title":"add the webrtc entry in od.config","text":"<p>Update the od.config file, for example :</p> <pre><code># WebRTC Janus config\nwebrtc.enable : True\nwebrtc.server : {   'janus.domain.local' : { 'schema' : 'http',\n                                          'host': 'janus.domain.local',\n                                          'hostip': '1.2.3.4',\n                                          'port': 8088,\n                                          'audiopt': 8,\n                                          'audiortpmap': 'PCMA/8000',\n                                          'apisecret': 'janusrocks',\n                                          'adminkey': 'supersecret',\n                                          'startport': 5100 } }\n</code></pre>"},{"location":"3.0/config/webrtc/#webrtcenable","title":"webrtc.enable","text":"<p><code>webrtc.enable</code> is a boolean. The default value is <code>False</code>. Set this value to <code>True</code> to enable webrtc services for <code>pulseaudio</code>.</p>"},{"location":"3.0/config/webrtc/#webrtcserver","title":"webrtc.server","text":"<p><code>webrtc.server</code> is a dict. The default value is <code>None</code>.  Set all dictionnary values to enable webrtc access for <code>pulseaudio</code> and for the web browser client.</p> <p>The <code>hostip</code> value, is used by pluse audio to configure the rtp stream. This value must be an ip address (do not set the fqdn). This can be an internal ip address, and is only to configure pulseaudio module and describe how to send stream data to reach the webrtc gateway.</p> <pre><code>'hostip': '1.2.3.4'\n</code></pre> <p>The <code>host</code> value, is used by the browser to reach the webrtc gateway and get the rtp stream. This value must(should) be a <code>fqdn</code>. This <code>fqdn</code> is used by the web browser.</p> <pre><code>webrtc.server : {   'janus.domain.local' : { 'schema' : 'http',\n                                          'host': 'janus.domain.local',\n                                          'hostip': '1.2.3.4',\n                                          'port': 8088,\n                                          'audiopt': 8,\n                                          'audiortpmap': 'PCMA/8000',\n                                          'apisecret': 'janusrocks',\n                                          'adminkey': 'supersecret',\n                                          'startport': 5100 } }\n</code></pre>"},{"location":"3.0/config/controllers/manager/","title":"ManagerController","text":""},{"location":"3.0/config/controllers/manager/#http-request","title":"HTTP Request","text":"<p>The http request path is <code>/API/manager</code></p>    Path Params Response type     <code>/API/manager/buildapplist</code> None Json object   <code>/API/manager/updateactivedirectorysite</code> None Json object   <code>/API/manager/garbagecollector</code> expirein=, force=False Json object"},{"location":"3.0/config/controllers/manager/#buildapplist","title":"buildapplist","text":"<p><code>buildapplist</code> ask pyos to list all abcdesktop.io docker image. Each docker image must have the specified label <code>type=apps</code>. abcdesktop.io </p>    Params Type Description     None None None    <p>example :</p> <pre><code>curl http://localhost/API/manager/buildapplist\n</code></pre> <p>Return the complete array if json images objects ready to run.</p> <pre><code>\n{\"abcdesktopio/writer.d:latest\": {\"id\": \"abcdesktopio/writer.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-writer\", \"name\": \"Writer\", \"icon\": \"libreoffice-writer.svg\", \"keyword\": \"libre office writer,office,writer\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--writer\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Writer\", \"mimetype\": [\"application/vnd.oasis.opendocument.text\", \"application/vnd.oasis.opendocument.text-template\", \"application/vnd.oasis.opendocument.text-web\", \"application/vnd.oasis.opendocument.text-master\", \"application/vnd.oasis.opendocument.text-master-template\", \"application/vnd.sun.xml.writer\", \"application/vnd.sun.xml.writer.template\", \"application/vnd.sun.xml.writer.global\", \"application/msword\", \"application/vnd.ms-word\", \"application/x-doc\", \"application/x-hwp\", \"application/rtf\", \"text/rtf\", \"application/vnd.wordperfect\", \"application/wordperfect\", \"application/vnd.lotus-wordpro\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", \"application/vnd.ms-word.document.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.template\", \"application/vnd.ms-word.template.macroenabled.12\", \"application/vnd.stardivision.writer-global\", \"application/x-extension-txt\", \"application/x-t602\", \"application/vnd.oasis.opendocument.text-flat-xml\", \"application/x-fictionbook+xml\", \"application/macwriteii\", \"application/x-aportisdoc\", \"application/prs.plucker\", \"application/vnd.palm\", \"application/clarisworks\", \"application/x-sony-bbeb\", \"application/x-abiword\", \"application/x-iwork-pages-sffpages\", \"application/x-mswrite\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-writer.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"sxw\", \"stw\", \"doc\", \"dot\", \"wps\", \"rtf\", \"602\", \"wpd\", \"docx\", \"docm\", \"dotx\", \"dotm\", \"abw\", \"zabw\", \"pages\", \"dummy\", \"lrf\", \"cwk\", \"hqx\", \"fb2\", \"mw\", \"mcw\", \"mwd\", \"pdb\", \"wn\"], \"legacyfileextensions\": [\"odf\", \"ott\", \"fodt\", \"uot\"]}, \"abcdesktopio/math.d:latest\": {\"id\": \"abcdesktopio/math.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-math\", \"name\": \"Math\", \"icon\": \"libreoffice-math.svg\", \"keyword\": \"libre office math,office,math\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--math\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": null, \"displayname\": \"Math\", \"mimetype\": [\"application/vnd.oasis.opendocument.formula\", \"application/vnd.sun.xml.math\", \"application/vnd.oasis.opendocument.formula-template\", \"text/mathml\", \"application/mathml+xml\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-math.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odf\", \"odc\"], \"legacyfileextensions\": [\"odf\", \"odc\"]}, \"abcdesktopio/impress.d:latest\": {\"id\": \"abcdesktopio/impress.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-impress\", \"name\": \"Impress\", \"icon\": \"libreoffice-impress.svg\", \"keyword\": \"libre office impress,office,impress\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--impress\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Impress\", \"mimetype\": [\"application/vnd.oasis.opendocument.presentation\", \"application/vnd.oasis.opendocument.presentation-template\", \"application/vnd.sun.xml.impress\", \"application/vnd.sun.xml.impress.template\", \"application/mspowerpoint\", \"application/vnd.ms-powerpoint\", \"application/vnd.openxmlformats-officedocument.presentationml.presentation\", \"application/vnd.ms-powerpoint.presentation.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.presentationml.template\", \"application/vnd.ms-powerpoint.template.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.presentationml.slide\", \"application/vnd.openxmlformats-officedocument.presentationml.slideshow\", \"application/vnd.ms-powerpoint.slideshow.macroenabled.12\", \"application/vnd.oasis.opendocument.presentation-flat-xml\", \"application/x-iwork-keynote-sffkey\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-impress.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odp\", \"pot\", \"potm\", \"potx\", \"pps\", \"ppsx\", \"ppt\", \"pptx\", \"pptm\"], \"legacyfileextensions\": [\"odp\"]}, \"abcdesktopio/calc.d:latest\": {\"id\": \"abcdesktopio/calc.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-calc\", \"name\": \"Calc\", \"icon\": \"libreoffice-calc.svg\", \"keyword\": \"libre office calc,office,calc\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"office\", \"args\": \"--calc\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": \"dock\", \"displayname\": \"Calc\", \"mimetype\": [\"application/vnd.oasis.opendocument.spreadsheet\", \"application/vnd.oasis.opendocument.spreadsheet-template\", \"application/vnd.sun.xml.calc\", \"application/vnd.sun.xml.calc.template\", \"application/msexcel\", \"application/vnd.ms-excel\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", \"application/vnd.ms-excel.sheet.macroenabled.12\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.template\", \"application/vnd.ms-excel.template.macroenabled.12\", \"application/vnd.ms-excel.sheet.binary.macroenabled.12\", \"text/csv\", \"application/x-dbf\", \"text/spreadsheet\", \"application/csv\", \"application/excel\", \"application/tab-separated-values\", \"application/vnd.lotus-1-2-3\", \"application/vnd.oasis.opendocument.chart\", \"application/vnd.oasis.opendocument.chart-template\", \"application/x-dbase\", \"application/x-dos_ms_excel\", \"application/x-excel\", \"application/x-msexcel\", \"application/x-ms-excel\", \"application/x-quattropro\", \"application/x-123\", \"text/comma-separated-values\", \"text/tab-separated-values\", \"text/x-comma-separated-values\", \"text/x-csv\", \"application/vnd.oasis.opendocument.spreadsheet-flat-xml\", \"application/vnd.ms-works\", \"application/x-iwork-numbers-sffnumbers\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-calc.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"ods\", \"ots\", \"sxc\", \"stc\", \"fods\", \"uos\", \"uof\", \"xml\", \"xlsx\", \"xlsm\", \"xltm\", \"xltx\", \"xlsb\", \"xls\", \"xlm\", \"xlc\", \"xlw\", \"xlk\", \"xlt\", \"dif\", \"dbf\", \"htm\", \"html\", \"wk1\", \"wks\", \"123\", \"wb2\", \"rtf\", \"slk\", \"sylk\", \"csv\", \"numbers\", \"dummy\", \"cwk\", \"wps\", \"wk3\", \"wq1\", \"wq2\"], \"legacyfileextensions\": [\"ods\", \"ots\", \"csv\"]}, \"abcdesktopio/base.d:latest\": {\"id\": \"abcdesktopio/base.d:latest\", \"rules\": null, \"acl\": null, \"launch\": \"libreoffice.libreoffice-base\", \"name\": \"Base\", \"icon\": \"libreoffice-base.svg\", \"keyword\": \"libre office base,office,base\", \"uniquerunkey\": \"libreoffice\", \"cat\": \"development\", \"args\": \"--base\", \"execmode\": null, \"memory\": null, \"shm_size\": null, \"oomkilldisable\": null, \"showinview\": null, \"displayname\": \"Base\", \"mimetype\": [\"application/vnd.oasis.opendocument.database\", \"application/vnd.sun.xml.base\"], \"path\": \"/usr/lib/libreoffice/program/soffice\", \"desktopfile\": \"libreoffice-base.desktop\", \"executablefilename\": \"soffice\", \"usedefaultapplication\": true, \"fileextensions\": [\"odb\"], \"legacyfileextensions\": [\"odb\"]}}\n\n</code></pre>"},{"location":"3.0/config/controllers/manager/#updateactivedirectorysite","title":"updateactivedirectorysite","text":"Params Type Description     None None None    <p>example :</p> <p><code>curl http://localhost/API/manager/updateactivedirectorysite</code></p>"},{"location":"3.0/config/controllers/manager/#garbagecollector","title":"garbagecollector","text":"Params Type Description     <code>expirein</code> integer number in seconds since the container create date time   <code>force</code> boolean garbage the container even if a user is connected    <p>example :</p> <p><code>curl \"http://localhost/API/manager/garbagecollector?expirein=9473\" curl \"http://localhost/API/manager/garbagecollector?expirein=9473&amp;force=True\"</code></p>"},{"location":"3.0/setup/k8slinuxinstallation/","title":"Linux Requirements","text":""},{"location":"3.0/setup/k8slinuxinstallation/#packages-installation","title":"Packages installation","text":"<p>To install Kubernetes on your GNU/Linux, you can read the Kubernetes setup guide on the kubernetes.io web site.</p>"},{"location":"3.0/setup/k8slinuxinstallation/#install-kubernetes-on-linux","title":"Install Kubernetes on Linux","text":""},{"location":"3.0/setup/k8slinuxinstallation/#step-0-disable-swap","title":"Step 0: Disable swap","text":"<p>Execute command swapoff and sed command to disable swap.</p> <pre><code>swapoff -a\nsed -i '/ swap / s/^\\(.*\\)$/#\\1/g' /etc/fstab\n</code></pre> <p>Load the <code>overlay</code> and <code>br_netfilter</code> kernel modules</p> <pre><code>modprobe overlay\nmodprobe br_netfilter\n</code></pre> <p>Create the <code>containerd.conf</code> to load modules</p> <pre><code>cat &gt;&gt;/etc/modules-load.d/containerd.conf &lt;&lt;EOF\noverlay\nbr_netfilter\nEOF\n</code></pre>"},{"location":"3.0/setup/k8slinuxinstallation/#step-1-install-containerd","title":"Step 1: Install <code>containerd</code>","text":"<p>Install the containerd utility and required packages on node by running the following command as sudo in a Terminal :</p> <p>Install common packages</p> <pre><code>apt-get install -y curl gnupg2 software-properties-common apt-transport-https ca-certificates\n</code></pre> <p>Add source</p> <pre><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | gpg --dearmour -o /etc/apt/trusted.gpg.d/docker.gpg\nadd-apt-repository \"deb [arch=$(dpkg --print-architecture)] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\n</code></pre> <p>You will be prompted with a Y/n option in order to proceed with the installation. </p> <pre><code>apt update\napt install -y containerd.io\n</code></pre> <p><code>containerd</code> will then be installed on your system. </p>"},{"location":"3.0/setup/k8slinuxinstallation/#step-2-configure-containerd","title":"Step 2: Configure containerd","text":"<p>Configure <code>containerd</code> to use <code>systemd</code> as <code>cgroup</code>. </p> <pre><code>containerd config default &gt; /etc/containerd/config.toml\nsed -i 's/SystemdCgroup \\= false/SystemdCgroup \\= true/g' /etc/containerd/config.toml\n</code></pre> <p>Enable the containerd utility by running the following command :</p> <pre><code>systemctl restart containerd\nsystemctl enable containerd\n</code></pre>"},{"location":"3.0/setup/k8slinuxinstallation/#step-3-add-the-kubernetes-signing-key","title":"Step 3: Add the Kubernetes signing key","text":"<p>Run the following command in order to get the Kubernetes signing key:</p> <pre><code>curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add - \n</code></pre>"},{"location":"3.0/setup/k8slinuxinstallation/#step-4-add-xenial-kubernetes-repository","title":"Step 4: Add Xenial Kubernetes Repository","text":"<p>Run the following commands in order to add the Xenial Kubernetes repository:</p> <pre><code>echo \"deb https://apt.kubernetes.io/ kubernetes-xenial main\" | sudo tee -a /etc/apt/sources.list.d/kubernetes.list \napt-get update\n</code></pre>"},{"location":"3.0/setup/k8slinuxinstallation/#step-5-install-kubernetes","title":"Step 5: Install Kubernetes","text":"<p>Create <code>kubernetes.conf</code> for <code>sysctl.d</code></p> <pre><code>cat &gt;&gt;/etc/sysctl.d/kubernetes.conf &lt;&lt;EOF\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.ipv4.ip_forward = 1\nEOF\n</code></pre> <p>Reload your system <code>sysctl</code> changes </p> <pre><code>sysctl --system\n</code></pre> <p>Install the packages <code>kubelet</code> <code>kubeadm</code> <code>kubectl</code></p> <pre><code>apt install -y kubelet kubeadm kubectl\n</code></pre> <p>K8s utilities will then be installed on your system.</p> <p>You can check the version number of <code>kubeadm</code> and also verify the installation through the following command:</p> <pre><code> kubeadm version -o yaml\n</code></pre> <pre><code>clientVersion:\n  buildDate: \"2022-10-12T10:55:36Z\"\n  compiler: gc\n  gitCommit: 434bfd82814af038ad94d62ebe59b133fcb50506\n  gitTreeState: clean\n  gitVersion: v1.25.3\n  goVersion: go1.19.2\n  major: \"1\"\n  minor: \"25\"\n  platform: linux/amd64\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/","title":"abcdesktop in kubernetes mode","text":"<p>abcdesktop release 3.x support only kubernetes mode. All applications containers can be distributed on different hosts.</p> <p>The abcdesktop infrastructure is using the contianers : </p>    Container Role Image From     oc.pyos API Server abcdesktopio/oc.pyos:3.0 abcdesktopio   oc.nginx web server proxy abcdesktopio/oc.nginx:3.0 abcdesktopio   oc.speedtest http benchmarch abcdesktopio/oc.speedtest LibreSpeed   oc.mongo json database server mongo MongoDB   memcached cache server memcached Memcached"},{"location":"3.0/setup/kubernetes_abcdesktop/#requirements","title":"Requirements","text":"<p>You need to have a </p> <ul> <li>kubernetes cluster ready to run</li> <li><code>kubectl</code> or <code>microk8s</code> command-line tool must be configured to communicate with your cluster. </li> <li><code>openssl</code> and <code>curl</code> command line must be installed too.</li> <li><code>ctr</code> should be install to download abcdesktopio images from <code>docker.io/abcdesktopio</code></li> </ul> <p>You can run the Quick installation process or choose the Manually installation step by step</p>"},{"location":"3.0/setup/kubernetes_abcdesktop/#quick-installation-linux-or-macos","title":"Quick installation (Linux or macOS)","text":"<p>Quick installation can be run on Linux or macOS operation system. </p>  <p>Download and extract the latest release automatically (Linux or macOS):</p> <pre><code>curl -sL https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/install-3.0.sh | bash\n</code></pre> <p>The command above downloads the latest release (numerically) of abcdesktop.io.  The quick installation process runs the all commands step by step:</p> <ul> <li>create the <code>abcdesktop</code> namespace</li> <li>build all <code>rsa keys</code> pairs for jwt signing and payload encryption</li> <li>download the default configuration file <code>od.config</code></li> <li>create all <code>services</code>, <code>pods</code>, <code>secrets</code> and <code>configmaps</code></li> <li>download user's core images: <code>oc.user</code>, <code>oc.cupsd</code>, <code>oc.pulseaudio</code> ( if ctr command line exists )</li> </ul>"},{"location":"3.0/setup/kubernetes_abcdesktop/#manually-installation-step-by-step-linux-macos-or-windows","title":"Manually installation step by step (Linux, macOS or Windows)","text":"<p>The following commands will let you prepare and build abcdesktop plateform on the master node. All applications run on a single server.  </p>"},{"location":"3.0/setup/kubernetes_abcdesktop/#install-abcdesktop","title":"Install abcdesktop","text":""},{"location":"3.0/setup/kubernetes_abcdesktop/#step-1-create-abcdesktop-namespace","title":"Step 1: Create abcdesktop namespace","text":"<p>We will create abcdesktop namespace and set it as default :</p> <pre><code># First create the abcdesktop namespace\nkubectl create namespace abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>namespace/abcdesktop created\n</code></pre>  <p>Option : To use the namespace <code>abcdestkop</code> as default namespace  <code>kubectl config set-context $(kubectl config current-context) --namespace=abcdesktop</code></p> <p>All kubectl commands will be executed with abcdesktop namespace. This will avoid to add \"-n abcdesktop\" to all commands. </p>"},{"location":"3.0/setup/kubernetes_abcdesktop/#step-2-secure-abcdesktop-jwt-exchange","title":"Step 2: Secure abcdesktop JWT exchange","text":"<p>User JWT is signed. So we need to define a (private, public) RSA keys for signing.  Desktop JWT is encrypted AND signed. So we need to define a (private, public) RSA keys for signing, and a (private, public) RSA keys to encrypt data.</p> <ul> <li>The JWT payload is encrypted with the abcdesktop jwt desktop payload private by pyos</li> <li>The JWT payload is decrypted with the abcdesktop jwt desktop payload public keys by nginx.</li> </ul>  <p>Please use the payload private as private key, and the payload public as private key.  Do not publish the public key. This public key must stay private, this is a special case, this is not stupid, it's only a more secure option.</p>  <ul> <li>The JSON Web Tokens payload is signed with the abcdesktop jwt desktop signing private keys</li> <li> <p>The JSON Web Tokens payload is verified with the abcdesktop jwt desktop signing public keys.</p> </li> <li> <p>The JSON Web Tokens user is signed with the abcdesktop jwt user signing private keys by pyos.</p> </li> <li>The JSON Web Tokens user is verified with the abcdesktop jwt user signing public keys by pyos <p>As multiple pods of pyos can run simultaneously, the same private and public keys value are stored into kubernetes secret.</p>  </li> </ul> <p>The abcdesktop jwt desktop payload public key is read by <code>nginx lua script</code>. The exported the public key need the <code>RSAPublicKey_out</code> option, to use the <code>RSAPublicKey</code> format. The <code>RSAPublicKey</code> format make key file format compatible between <code>python 3.x jwt module</code> and <code>lua jwt lib</code>.</p> <p>The following commands will let you create all necessary keys :</p> <pre><code># build rsa kay pairs for jwt payload \n# 1024 bits is a smallest value, change here if need but use more than 1024\nopenssl genrsa  -out abcdesktop_jwt_desktop_payload_private_key.pem 1024\nopenssl rsa     -in  abcdesktop_jwt_desktop_payload_private_key.pem -outform PEM -pubout -out  _abcdesktop_jwt_desktop_payload_public_key.pem\nopenssl rsa -pubin -in _abcdesktop_jwt_desktop_payload_public_key.pem -RSAPublicKey_out -out abcdesktop_jwt_desktop_payload_public_key.pem\n\n# build rsa kay pairs for the desktop jwt signing \nopenssl genrsa -out abcdesktop_jwt_desktop_signing_private_key.pem 1024\nopenssl rsa     -in abcdesktop_jwt_desktop_signing_private_key.pem -outform PEM -pubout -out abcdesktop_jwt_desktop_signing_public_key.pem\n\n# build rsa kay pairs for the user jwt signing \nopenssl genrsa -out abcdesktop_jwt_user_signing_private_key.pem 1024\nopenssl rsa     -in abcdesktop_jwt_user_signing_private_key.pem -outform PEM -pubout -out abcdesktop_jwt_user_signing_public_key.pem\n\n</code></pre> <p>Then, create the kubernetes secrets from the new key files:</p> <pre><code># create the kubernetes rsa keys secret for abcdesktop\nkubectl create secret generic abcdesktopjwtdesktoppayload --from-file=abcdesktop_jwt_desktop_payload_private_key.pem --from-file=abcdesktop_jwt_desktop_payload_public_key.pem --namespace=abcdesktop\nkubectl create secret generic abcdesktopjwtdesktopsigning --from-file=abcdesktop_jwt_desktop_signing_private_key.pem --from-file=abcdesktop_jwt_desktop_signing_public_key.pem --namespace=abcdesktop\nkubectl create secret generic abcdesktopjwtusersigning --from-file=abcdesktop_jwt_user_signing_private_key.pem --from-file=abcdesktop_jwt_user_signing_public_key.pem --namespace=abcdesktop\n</code></pre> <p>You should read on the standard output :</p> <pre><code>secret/abcdesktopjwtdesktoppayload created\nsecret/abcdesktopjwtdesktopsigning created\nsecret/abcdesktopjwtusersigning created\n</code></pre>  <p>Only if you use a private registry or if the abcdesktop registry is private Create Secret to allow kubernetes to download abcdesktop images from docker registry. For this part you need to change docker-username and docker-password by credentials provided by project owner. If you don't have this values, you will have to build abcdesktop images by yourself.</p> <p>change docker.json path if need /root/.docker/config.json  <code>kubectl create secret generic abcdesktopregistrysecret --from-file=.dockerconfigjson=/root/.docker/config.json --type=kubernetes.io/dockerconfigjson -n abcdesktop</code></p>"},{"location":"3.0/setup/kubernetes_abcdesktop/#verify-secrets","title":"Verify Secrets","text":"<p>You can verify secrets creation with the following command :</p> <pre><code>kubectl get secrets -n abcdesktop\n</code></pre> <p>You should read on the standard output :</p> <pre><code>NAME                           TYPE                                  DATA   AGE\ndefault-token-5zknd            kubernetes.io/service-account-token   3      6m6s\nabcdesktopjwtdesktoppayload   Opaque                                2      68s\nabcdesktopjwtdesktopsigning   Opaque                                2      68s\nabcdesktopjwtusersigning      Opaque                                2      67s\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#step-3-download-user-pod-images","title":"Step 3: Download user pod images","text":"<p>Create a pod user to make sure that Kubernetes will find the docker images at startup time. </p> <pre><code>kubectl create -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/poduser.yaml\n</code></pre> <p>You should read on stdout</p> <pre><code>pod/anonymous-74bea267-8197-4b1d-acff-019b24e778c5 created\n</code></pre> <p>You can wait for user pod is <code>Ready</code>, this while take a while, for  container images are downloading.</p> <pre><code>kubectl wait --for=condition=Ready pod/anonymous-74bea267-8197-4b1d-acff-019b24e778c5  -n abcdesktop --timeout=-1s\n</code></pre> <pre><code>pod/anonymous-74bea267-8197-4b1d-acff-019b24e778c5 condition met\n</code></pre> <p>You can delete the user pod <code>anonymous-74bea267-8197-4b1d-acff-019b24e778c5</code>. This container images are downloaded.</p> <pre><code>kubectl delete -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/poduser.yaml\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#step-4-download-and-create-the-abcdesktop-config-file","title":"Step 4: Download and create the abcdesktop config file","text":"<p>Download the od.config file. This is the main file for <code>pyos</code> control plane.</p> <pre><code>curl https://raw.githubusercontent.com/abcdesktopio/conf/main/reference/od.config.3.0 --output od.config\n</code></pre> <p>Create the config map <code>abcdesktop-config</code> in the <code>abcdesktop</code> namespace</p> <pre><code>kubectl create configmap abcdesktop-config --from-file=od.config -n abcdesktop\n</code></pre> <p>You should read on sdtout</p> <pre><code>configmap/abcdesktop-config created\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#step-5-create-the-abcdesktop-pods-and-services","title":"Step 5: Create the abcdesktop pods and services","text":"<p>abcdesktop.yaml file contains declarations for all roles, service account, pods, and services required for abcdesktop.</p> <p>Run the command line</p> <pre><code>kubectl create -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop-3.0.yaml\n</code></pre> <p>You should read on the standard output</p> <pre><code>clusterrole.rbac.authorization.k8s.io/pyos-role created\nclusterrolebinding.rbac.authorization.k8s.io/pyos-rbac created\nserviceaccount/pyos-serviceaccount created\nstorageclass.storage.k8s.io/storage-local-abcdesktop created\nconfigmap/nginx-config created\ndeployment.apps/memcached-od created\nsecret/mongodb-secret created\nstatefulset.apps/mongodb-od created\ndaemonset.apps/daemonset-nginx created\ndeployment.apps/speedtest-od created\ndaemonset.apps/daemonset-pyos created\nendpoints/desktop created\nservice/desktop created\nservice/memcached created\nservice/mongodb created\nservice/speedtest created\nservice/nginx created\nservice/pyos created\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#verify-pods","title":"Verify Pods","text":"<p>Once the pods are created, all pods should be in <code>Running</code> status. For the first time, please wait for downloading all container images.  It can take a while.</p> <pre><code>kubectl get pods -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME                                   READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-nfsbm                  1/1     Running   0          29s\ndaemonset-pyos-8kvfp                   1/1     Running   0          29s\nmemcached-od-5bf65bf745-j69lh          1/1     Running   0          29s\nmongodb-od-6cbf8d74d-2rdmd             1/1     Running   0          29s\nopenldap-od-8dc9f56d8-wtlxl            1/1     Running   0          29s\nspeedtest-od-7cb7dd44f5-p947s          1/1     Running   0          29s\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#connect-your-local-abcdesktop","title":"Connect your local abcdesktop","text":"<p>Open your navigator to http://[your-ip-hostname]:30443/</p> <p>abcdesktop homepage should be available :</p>  <p>Click on the Connect with Anonymous access button. abcdesktop service pyos is creating a new desktop using the user container image <code>abcdesktopio/oc.user.kubernetes.18.04:3.0</code>.</p>  <p>Few seconds later, processes are ready to run. You should see the abcdesktop main screen, with only one application File Manager.</p>  <p>Great you have installed abcdesktop.io in Kubernetes mode. You just need a web browser to reach your web workspace. It' now time to add some container applications. Read the chapter add kubernetes contain</p>"},{"location":"3.0/setup/kubernetes_abcdesktop/#troubleshoot","title":"Troubleshoot","text":"<p>All kubernetes resources can be inspected to get more informations.</p> <p>First list elements you want to verify, in the following case, we will inspect pods :</p> <pre><code>    kubectl get pods -n abcdesktop\n\n    NAME                            READY   STATUS             RESTARTS   AGE\n    daemonset-nginx-qnd4n           1/1     Running            0          92s\n    daemonset-pyos-6mgq4            1/1     Running            0          92s\n    memcached-od-db69c45fb-mqt4n    1/1     Running            0          92s\n    mongodb-od-ff874fcb5-sm6f7      1/1     Running            0          92s\n    speedtest-od-55c58fdd69-5znpr   0/1     ImagePullBackOff   0          92s\n</code></pre> <p>As we can see, status is \"ImagePullBackOff\" for speedtest-od pod. We will then ask kubernetes to describe the pod with the following command :</p> <p><code>kubectl describe pod speedtest-od-55c58fdd69-t99ck -n abcdesktop</code></p> <p>In this case, the important information part is at the end (it's not always the case, you can also look at \"Conditions:\" section) :</p> <pre><code>    Events:\n      Type     Reason   Age                    From             Message\n      ----     ------   ----                   ----             -------\n      Warning  Failed   7m6s (x4837 over 18h)  kubelet, cube05  Error: ImagePullBackOff\n      Normal   BackOff  2m9s (x4860 over 18h)  kubelet, cube05  Back-off pulling image \"registry.mydomain.local:443/oc.speedtest\"\n</code></pre> <p>As we can see, in this case, Kubernetes had a problem to pull oc.speedtest image from registry.</p>"},{"location":"3.0/setup/kubernetes_abcdesktop/#verify-daemonsets","title":"Verify Daemonsets","text":"<pre><code>kubectl get daemonsets -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME              DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE\ndaemonset-nginx   1         1         1       1            1           &lt;none&gt;          166m\ndaemonset-pyos    1         1         1       1            1           &lt;none&gt;          166m\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#verify-service-ports","title":"Verify service ports","text":"<pre><code>kubectl get services -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>NAME        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)           AGE\ndesktop     ClusterIP   None             &lt;none&gt;        &lt;none&gt;            166m\nmemcached   ClusterIP   10.97.84.163     &lt;none&gt;        11211/TCP         166m\nmongodb     ClusterIP   10.97.119.76     &lt;none&gt;        27017/TCP         166m\nnginx       NodePort    10.108.80.216    &lt;none&gt;        80:30443/TCP      166m\nopenldap    ClusterIP   10.104.244.6     &lt;none&gt;        389/TCP,636/TCP   166m\npyos        ClusterIP   10.111.15.51     &lt;none&gt;        8000/TCP          166m\nspeedtest   ClusterIP   10.106.254.126   &lt;none&gt;        80/TCP            166m\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#verify-cluster-roles","title":"Verify cluster roles","text":"<pre><code>kubectl describe ClusterRole pyos-role -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>Name:         pyos-role\nLabels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\nPolicyRule:\n  Resources                 Non-Resource URLs  Resource Names  Verbs\n  ---------                 -----------------  --------------  -----\n  pods/ephemeralcontainers  []                 []              [create get list watch update patch delete]\n  pods/exec                 []                 []              [create get list watch update patch delete]\n  configmaps                []                 []              [get list watch create update patch delete]\n  pods                      []                 []              [get list watch create update patch delete]\n  secrets                   []                 []              [get list watch create update patch delete]\n  events                    []                 []              [get list watch]\n  pods/log                  []                 []              [get list watch]\n  endpoints                 []                 []              [get list]\n  nodes                     []                 []              [get watch list]\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#verify-cluster-role-bindind","title":"Verify Cluster Role Bindind","text":"<pre><code>kubectl describe ClusterRoleBinding pyos-rbac -n abcdesktop\n</code></pre> <p>You should read on the standard output</p> <pre><code>Labels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\nRole:\n  Kind:  ClusterRole\n  Name:  pyos-role\nSubjects:\n  Kind            Name                 Namespace\n  ----            ----                 ---------\n  ServiceAccount  pyos-serviceaccount  abcdesktop\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#read-pyos-logs","title":"Read pyos logs","text":"<pre><code>kubectl logs daemonset-pyos-tklg8 --follow -n abcdesktop\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop/#rollout-daemonset","title":"Rollout daemonset","text":"<p>To rollout restart the abcdesktop daemonset</p> <pre><code>kubectl rollout restart daemonset -n abcdesktop\n</code></pre> <p>You should read on the standard output </p> <pre><code>daemonset.apps/daemonset-nginx restarted\ndaemonset.apps/daemonset-pyos restarted\n</code></pre> <p>Check the pods status  </p> <pre><code>kubectl get pods  -n abcdesktop\nNAME                            READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-dh2xd           1/1     Running   0          4m22s\ndaemonset-pyos-9xn26            1/1     Running   0          3m52s\nmemcached-od-5bf65bf745-xpvvr   1/1     Running   3          45h\nmongodb-od-656d85c49f-242jh     1/1     Running   4          45h\nopenldap-od-5945946767-qf2hn    1/1     Running   0          45m\nspeedtest-od-d94b8cb5c-52wf5    1/1     Running   0          45m\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop_applications/","title":"Setup applications for abcdesktop","text":""},{"location":"3.0/setup/kubernetes_abcdesktop_applications/#quick-application-install","title":"Quick application install","text":"<p>Quick installation can be run on Linux or macOS operation system. </p>  <p>Download and execute the <code>pullapps-3.0.sh</code> script :</p> <pre><code>curl -sL https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/pullapps-3.0.sh | bash\n</code></pre> <p>This script starts abcdesktop application on an empty desktop. Pods is created to ask Kubernetes for pulling containers image.</p> <pre><code>NAME                                                             READY   STATUS              RESTARTS   AGE\ndaemonset-nginx-dqxzx                                            1/1     Running             0          100m\ndaemonset-pyos-rdwws                                             1/1     Running             0          100m\nmemcached-od-bdcbbcb74-xbg8x                                     1/1     Running             0          100m\nmongodb-od-6484d8bc67-9xsgm                                      1/1     Running             0          100m\nopenldap-od-795c55f6db-pb68k                                     1/1     Running             0          100m\npull-2048-abcinst-9fd80f22ad6b0750cb3d248bda04de25444bab2cf274   1/1     Running             0          5s\npull-calc-abcinst-57622131ac1ce4b37d5cec51ee7f0071c460293158a4   1/1     Running             0          3s\npull-firefox-abcinst-d2872d0d272a3a02606b4877c12e832755ba1a378   0/1     ContainerCreating   0          1s\npull-gimp-abcinst-051fefa55d97338653a58e86ccdd5f1a3e66f7f05017   0/1     ContainerCreating   0          0s\npull-impress-abcinst-f74fed932051c2760b3fd69f4ef475e34ad1a8a49   0/1     ContainerCreating   0          2s\npull-writer-abcinst-cfe1a4f74d19fbe49d86d211f99d005532b6cf7c87   1/1     Running             0          3s\npull-xterm-abcinst-0e802cfa8addb4648f843869325f3413d544bb9eae8   1/1     Running             0          4s\nspeedtest-od-5565dfdc67-vdwcl                                    1/1     Running             0          100m\n</code></pre> <p>list of created pods for pulling is pull-2048-abcinst-9fd80f22ad6b0750cb3d248bda04de25444bab2cf274</p> <pre><code>pull-calc-abcinst-57622131ac1ce4b37d5cec51ee7f0071c460293158a4\npull-firefox-abcinst-d2872d0d272a3a02606b4877c12e832755ba1a378\npull-gimp-abcinst-051fefa55d97338653a58e86ccdd5f1a3e66f7f05017\npull-impress-abcinst-f74fed932051c2760b3fd69f4ef475e34ad1a8a49\npull-writer-abcinst-cfe1a4f74d19fbe49d86d211f99d005532b6cf7c87\npull-xterm-abcinst-0e802cfa8addb4648f843869325f3413d544bb9eae8\npod/pull-2048-abcinst-9fd80f22ad6b0750cb3d248bda04de25444bab2cf274 condition met\npod/pull-calc-abcinst-57622131ac1ce4b37d5cec51ee7f0071c460293158a4 condition met\npod/pull-firefox-abcinst-d2872d0d272a3a02606b4877c12e832755ba1a378 condition met\npod/pull-gimp-abcinst-051fefa55d97338653a58e86ccdd5f1a3e66f7f05017 condition met\npod/pull-impress-abcinst-f74fed932051c2760b3fd69f4ef475e34ad1a8a49 condition met\npod/pull-writer-abcinst-cfe1a4f74d19fbe49d86d211f99d005532b6cf7c87 condition met\npod/pull-xterm-abcinst-0e802cfa8addb4648f843869325f3413d544bb9eae8 condition met\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop_applications/#connect-to-your-abcdesktop","title":"Connect to your abcdesktop","text":"<p>The API server receives a new image event from docker daemon. To run the new applications just refresh you web browser page.</p> <p>Now reconnect to your abcdesktop. </p> <p>Open your navigator to http://[your-ip-hostname]:30443/</p> <pre><code>http://localhost:30443/\n</code></pre> <p>The new applications are installed, and ready to run.</p>"},{"location":"3.0/setup/kubernetes_abcdesktop_applications/#mannualy-install-application","title":"Mannualy install application","text":"<p>Add new application, require to send an application json document to the control-plane <code>pyos</code>.</p>"},{"location":"3.0/setup/kubernetes_abcdesktop_applications/#download-a-json-application-document-format","title":"Download a json application document format","text":"<p>In this example, we install the application <code>2048</code> game as sample, but you can choose another one from https://github.com/abcdesktopio/conf/tree/main/apps</p> <pre><code>curl https://raw.githubusercontent.com/abcdesktopio/conf/main/apps/2048.d.3.0.json --output 2048.json\n</code></pre>  <p>To inspect image json you can also run crictl <code>inspecti</code> or <code>docker inspect</code> command. <code>crictl inspecti abcdesktopio/2048.d:3.0 &gt; 2048.json</code> <code>docker inspect abcdesktopio/2048.d:3.0 &gt; 2048.json</code></p>  <p>The image manager endpoint REST API is <code>http://[your-ip-hostname]:30443/API/manager/image</code></p> <p>Replace <code>[your-ip-hostname]</code> by your own server ip, by default with localhost, the url become <code>http://localhost:30443/API/manager/image</code></p> <p>Send the 2048.json file to the images REST API</p> <pre><code>curl -X PUT -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image -d @2048.json\n</code></pre> <p>The response is the json document.</p> <pre><code>[{\"home\": null, \"cmd\": [\"/composer/appli-docker-entrypoint.sh\"], \"workingdir\": \"/home/balloon\", \"user\": \"balloon\", \"sha_id\": \"sha256:1897dd8f22453ae01c72d4975d43e5505b6faae3f4a41611108c2e3beb2ab4bd\", \"id\": \"abcdesktopio/2048.d:3.0\", \"rules\": {\"homedir\": {\"default\": true}}, \"acl\": {\"permit\": [\"all\"]}, \"launch\": \"2048-qt.2048-qt\", \"name\": \"2048\", \"icon\": \"circle_2048.svg\", \"icondata\": \"PHN2ZyBpZD0ic3ZnMzIiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KIDxkZWZzIGlkPSJkZWZzMTgiPgogIDxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjQwOC4yNSIgeDI9IjQwNy45NCIgeTE9IjU0Ny42IiB5Mj0iNDk4Ljg5IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEuMzI3NiAwIDAgMS4zMjc2IC01MTAuNjQgLTY2My41MikiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KICAgPHN0b3AgaWQ9InN0b3AyIiBzdG9wLWNvbG9yPSIjZmZmIiBvZmZzZXQ9IjAiLz4KICAgPHN0b3AgaWQ9InN0b3A0IiBzdG9wLWNvbG9yPSIjZTZlNmU2IiBvZmZzZXQ9IjEiLz4KICA8L2xpbmVhckdyYWRpZW50PgogIDxmaWx0ZXIgaWQ9ImQiIHg9Ii0uMDU4ODgzIiB5PSItLjA2MTE2MSIgd2lkdGg9IjEuMTE3OCIgaGVpZ2h0PSIxLjEyMjMiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CiAgIDxmZUdhdXNzaWFuQmx1ciBpZD0iZmVHYXVzc2lhbkJsdXIxMiIgc3RkRGV2aWF0aW9uPSIxMC41NjIzNzkiLz4KICA8L2ZpbHRlcj4KICA8ZmlsdGVyIGlkPSJjIiB4PSItLjAzNiIgeT0iLS4wMzYiIHdpZHRoPSIxLjA3MiIgaGVpZ2h0PSIxLjA3MiIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KICAgPGZlR2F1c3NpYW5CbHVyIGlkPSJmZUdhdXNzaWFuQmx1cjE1IiBzdGREZXZpYXRpb249IjAuODg5NzI0NDkiLz4KICA8L2ZpbHRlcj4KICA8bGluZWFyR3JhZGllbnQgaWQ9ImxpbmVhckdyYWRpZW50OTA1IiB4MT0iMjUuMDkzIiB4Mj0iMjUuMDM0IiB5MT0iNTkuMjMzIiB5Mj0iMi44MjYzIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgIDxzdG9wIGlkPSJzdG9wODk5IiBzdG9wLWNvbG9yPSIjZmY1NDAwIiBvZmZzZXQ9IjAiLz4KICAgPHN0b3AgaWQ9InN0b3A5MDEiIHN0b3AtY29sb3I9IiNmYjAiIG9mZnNldD0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXJHcmFkaWVudDkxMyIgeDE9IjI2LjUwMiIgeDI9IjI2LjU5IiB5MT0iNTkuNjAyIiB5Mj0iMTguOTQ5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgIDxzdG9wIGlkPSJzdG9wOTA3IiBzdG9wLWNvbG9yPSIjMzVlODcyIiBvZmZzZXQ9IjAiLz4KICAgPHN0b3AgaWQ9InN0b3A5MDkiIHN0b3AtY29sb3I9IiMzNGU5ZDgiIG9mZnNldD0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXJHcmFkaWVudDkyMSIgeDE9IjQzLjA2NyIgeDI9IjQyLjU3OSIgeTE9IjU5LjQxIiB5Mj0iMjguMzQ2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgIDxzdG9wIGlkPSJzdG9wOTE1IiBzdG9wLWNvbG9yPSIjMzU1M2U0IiBvZmZzZXQ9IjAiLz4KICAgPHN0b3AgaWQ9InN0b3A5MTciIHN0b3AtY29sb3I9IiM1NmNlZjMiIG9mZnNldD0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPGZpbHRlciBpZD0iZmlsdGVyMTAyNSIgeD0iLS4xMjQ2MiIgeT0iLS4xMjQ2MiIgd2lkdGg9IjEuMjQ5MiIgaGVpZ2h0PSIxLjI0OTIiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CiAgIDxmZUdhdXNzaWFuQmx1ciBpZD0iZmVHYXVzc2lhbkJsdXIxMDI3IiBzdGREZXZpYXRpb249IjEuMzQ4NzMwNSIvPgogIDwvZmlsdGVyPgogIDxmaWx0ZXIgaWQ9ImZpbHRlcjEwMjkiIHg9Ii0uMTI0NjIiIHk9Ii0uMTI0NjIiIHdpZHRoPSIxLjI0OTIiIGhlaWdodD0iMS4yNDkyIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgogICA8ZmVHYXVzc2lhbkJsdXIgaWQ9ImZlR2F1c3NpYW5CbHVyMTAzMSIgc3RkRGV2aWF0aW9uPSIxLjM0ODczMDUiLz4KICA8L2ZpbHRlcj4KICA8ZmlsdGVyIGlkPSJmaWx0ZXIxMDMzIiB4PSItLjEyNDYyIiB5PSItLjEyNDYyIiB3aWR0aD0iMS4yNDkyIiBoZWlnaHQ9IjEuMjQ5MiIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KICAgPGZlR2F1c3NpYW5CbHVyIGlkPSJmZUdhdXNzaWFuQmx1cjEwMzUiIHN0ZERldmlhdGlvbj0iMS4zNDg3MzA1Ii8+CiAgPC9maWx0ZXI+CiAgPGZpbHRlciBpZD0iZmlsdGVyMTEzOSIgeD0iLS4yNDk0IiB5PSItLjE4NjM0IiB3aWR0aD0iMS40OTg4IiBoZWlnaHQ9IjEuMzcyNyIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KICAgPGZlR2F1c3NpYW5CbHVyIGlkPSJmZUdhdXNzaWFuQmx1cjExNDEiIHN0ZERldmlhdGlvbj0iMC43NzY0MjE3NiIvPgogIDwvZmlsdGVyPgogIDxmaWx0ZXIgaWQ9ImZpbHRlcjExNDMiIHg9Ii0uMjM5NzIiIHk9Ii0uMTg2MzQiIHdpZHRoPSIxLjQ3OTQiIGhlaWdodD0iMS4zNzI3IiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgogICA8ZmVHYXVzc2lhbkJsdXIgaWQ9ImZlR2F1c3NpYW5CbHVyMTE0NSIgc3RkRGV2aWF0aW9uPSIwLjc3NjQyMTc2Ii8+CiAgPC9maWx0ZXI+CiAgPGZpbHRlciBpZD0iZmlsdGVyMTE0NyIgeD0iLS4yMjM0MiIgeT0iLS4xODYzNCIgd2lkdGg9IjEuNDQ2OCIgaGVpZ2h0PSIxLjM3MjciIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CiAgIDxmZUdhdXNzaWFuQmx1ciBpZD0iZmVHYXVzc2lhbkJsdXIxMTQ5IiBzdGREZXZpYXRpb249IjAuNzc2NDIxNzYiLz4KICA8L2ZpbHRlcj4KIDwvZGVmcz4KIDxyZWN0IGlkPSJyZWN0MjAiIHRyYW5zZm9ybT0ibWF0cml4KDEuMDExNSAwIDAgMS4wMTE1IC0zODkuMzIgLTQ4OS45MikiIHg9IjM4Ni44NSIgeT0iNDg2LjMxIiB3aWR0aD0iNTkuMzE1IiBoZWlnaHQ9IjU5LjMxNSIgcnk9IjI5LjY1NyIgZmlsdGVyPSJ1cmwoI2MpIiBvcGFjaXR5PSIuMjUiLz4KIDxyZWN0IGlkPSJyZWN0MjIiIHg9IjEuOTgyNiIgeT0iMS45Nzg0IiB3aWR0aD0iNTkuOTk3IiBoZWlnaHQ9IjU5Ljk5NyIgcnk9IjI5Ljk5OCIgZmlsbD0idXJsKCNiKSIgc3Ryb2tlLXdpZHRoPSIxLjAxMTUiLz4KIDxnIHN0cm9rZS13aWR0aD0iLjUzMDcyIj4KICA8cGF0aCBpZD0icGF0aDkyMyIgZD0ibTMxIDUuMDI1NGMtMTQuMTU4IDAuNTExMTMtMjUuNDYzIDExLjgxNi0yNS45NzUgMjUuOTc1aDI1Ljk3NXoiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXciIGZpbHRlcj0idXJsKCNmaWx0ZXIxMDI1KSIgb3BhY2l0eT0iLjE1Ii8+CiAgPHBhdGggaWQ9InBhdGgzODY3MyIgZD0ibTMxIDUuMDI1NGMtMTQuMTU4IDAuNTExMTMtMjUuNDYzIDExLjgxNi0yNS45NzUgMjUuOTc1aDI1Ljk3NXoiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXciIGZpbGw9InVybCgjbGluZWFyR3JhZGllbnQ5MDUpIi8+CiAgPHBhdGggaWQ9InBhdGg5MjUiIGQ9Im0zMyAzM3YyNS45NzVjMTQuMTU4LTAuNTExMTIgMjUuNDYzLTExLjgxNiAyNS45NzUtMjUuOTc1eiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyIgZmlsdGVyPSJ1cmwoI2ZpbHRlcjEwMjkpIiBvcGFjaXR5PSIuMTUiLz4KICA8cGF0aCBpZD0icGF0aDM4NjcxIiBkPSJtMzMgMzN2MjUuOTc1YzE0LjE1OC0wLjUxMTEyIDI1LjQ2My0xMS44MTYgMjUuOTc1LTI1Ljk3NXoiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXciIGZpbGw9InVybCgjbGluZWFyR3JhZGllbnQ5MjEpIi8+CiAgPHBhdGggaWQ9InBhdGg5MjciIGQ9Im01LjAyNTQgMzNjMC41MTExMyAxNC4xNTggMTEuODE2IDI1LjQ2MyAyNS45NzUgMjUuOTc1di0yNS45NzV6IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IiBmaWx0ZXI9InVybCgjZmlsdGVyMTAzMykiIG9wYWNpdHk9Ii4xNSIvPgogIDxwYXRoIGlkPSJyZWN0MzgxMTUiIGQ9Im01LjAyNTQgMzNjMC41MTExMyAxNC4xNTggMTEuODE2IDI1LjQ2MyAyNS45NzUgMjUuOTc1di0yNS45NzV6IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IiBmaWxsPSJ1cmwoI2xpbmVhckdyYWRpZW50OTEzKSIvPgogPC9nPgogPHBhdGggaWQ9InBhdGgxMDM3IiBkPSJtMjEuNjkgMjMuODY5YzEuOTMxOS0xLjM3NzkgMy4wMzk4LTIuOTY4OCAzLjAzOTgtNC43MDE2IDAtMS45ODg3LTEuNDIwNS0zLjE2NzctMy44MDY4LTMuMTY3Ny0xLjIwNzQgMC0yLjM3MjIgMC4yOTgzLTMuMzk1IDAuODUyMjlsMC41NTM5OCAxLjg2MDhjMC45Mzc1MS0wLjQyNjE0IDEuNjQ3OC0wLjYxMDgyIDIuMzI5Ni0wLjYxMDgyIDEuMTIyMiAwIDEuNzYxNCAwLjQ5NzE4IDEuNzYxNCAxLjM5MjEgMCAxLjEzNjQtMC45OTQzNSAyLjQwMDYtNC4yNzU1IDQuOTU3M3YxLjU0ODNoNy4xMDIzdi0yLjEzMDd6IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IiBmaWx0ZXI9InVybCgjZmlsdGVyMTEzOSkiIG9wYWNpdHk9Ii4xNSIgc3Ryb2tlLXdpZHRoPSIuMzgwNDVweCIgc3R5bGU9ImZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7Zm9udC12YXJpYW50LWNhcHM6bm9ybWFsO2ZvbnQtdmFyaWFudC1saWdhdHVyZXM6bm9ybWFsO2ZvbnQtdmFyaWFudC1udW1lcmljOm5vcm1hbCIvPgogPHBhdGggaWQ9InBhdGgzODcwOCIgZD0ibTIxLjY5IDIzLjg2OWMxLjkzMTktMS4zNzc5IDMuMDM5OC0yLjk2ODggMy4wMzk4LTQuNzAxNiAwLTEuOTg4Ny0xLjQyMDUtMy4xNjc3LTMuODA2OC0zLjE2NzctMS4yMDc0IDAtMi4zNzIyIDAuMjk4My0zLjM5NSAwLjg1MjI5bDAuNTUzOTggMS44NjA4YzAuOTM3NTEtMC40MjYxNCAxLjY0NzgtMC42MTA4MiAyLjMyOTYtMC42MTA4MiAxLjEyMjIgMCAxLjc2MTQgMC40OTcxOCAxLjc2MTQgMS4zOTIxIDAgMS4xMzY0LTAuOTk0MzUgMi40MDA2LTQuMjc1NSA0Ljk1NzN2MS41NDgzaDcuMTAyM3YtMi4xMzA3eiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyIgZmlsbD0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIuMzgwNDVweCIgc3R5bGU9ImZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7Zm9udC12YXJpYW50LWNhcHM6bm9ybWFsO2ZvbnQtdmFyaWFudC1saWdhdHVyZXM6bm9ybWFsO2ZvbnQtdmFyaWFudC1udW1lcmljOm5vcm1hbCIvPgogPHBhdGggaWQ9InBhdGgxMDM5IiBkPSJtNDQuOTM4IDQyLjYwOGMwLjk4MDQtMC41MDQxOSAxLjUxMjYtMS4yNjA1IDEuNTEyNi0yLjE1NjggMC0xLjQ3MDYtMS40MTQ2LTIuNDUxLTMuNTAxNC0yLjQ1MS0yLjIxMjkgMC0zLjY4MzUgMS4xOTA1LTMuNjgzNSAyLjk2OTIgMCAxLjA3ODQgMC41NDYyMSAxLjcyMjcgMS4yODg1IDIuMTcwOS0wLjk5NDQgMC40MjAxNy0xLjU1NDYgMS4xNzY1LTEuNTU0NiAyLjEyODkgMCAxLjYzODcgMS41NDA2IDIuNzMxMSAzLjg1MTcgMi43MzExIDIuMzUzIDAgMy45MjE1LTEuMjA0NSAzLjkyMTUtMy4wMjUyIDAtMS4yNzQ1LTAuODQwMzQtMS45MzI4LTEuODM0Ny0yLjM2Njl6bS0yLjA3MjgtMi41MzVjMC42NTgyNSAwIDEuMDkyNSAwLjMyMjEzIDEuMDkyNSAwLjgyNjM0IDAgMC41MDQxOS0wLjM2NDE0IDAuOTEwMzctMC45MjQzNiAxLjA1MDQtMC43MjgyOS0wLjI2NjEtMS4yNzQ1LTAuNTQ2MjEtMS4yNzQ1LTEuMDY0NCAwLTAuNDkwMiAwLjQzNDE2LTAuODEyMzEgMS4xMDY0LTAuODEyMzF6bTAuMTEyMDQgNS44NTQ0Yy0wLjg5NjM0IDAtMS40ODQ2LTAuNDM0MTYtMS40ODQ2LTEuMDc4NCAwLTAuNDYyMTggMC4yOTQxMi0wLjgyNjM0IDAuNzk4MzItMC45OTQ0IDEuMDUwNCAwLjMzNjEzIDEuOTg4OCAwLjU4ODIyIDEuOTg4OCAxLjI0NjUgMCAwLjQ5MDItMC41MzIyMSAwLjgyNjM0LTEuMzAyNSAwLjgyNjM0eiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyIgZmlsdGVyPSJ1cmwoI2ZpbHRlcjExNDMpIiBvcGFjaXR5PSIuMTUiIHN0cm9rZS13aWR0aD0iLjM3NTEycHgiIHN0eWxlPSJmb250LWZlYXR1cmUtc2V0dGluZ3M6bm9ybWFsO2ZvbnQtdmFyaWFudC1jYXBzOm5vcm1hbDtmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtbnVtZXJpYzpub3JtYWwiLz4KIDxwYXRoIGlkPSJwYXRoMzg3MTEiIGQ9Im00NC45MzggNDIuNjA4YzAuOTgwNC0wLjUwNDE5IDEuNTEyNi0xLjI2MDUgMS41MTI2LTIuMTU2OCAwLTEuNDcwNi0xLjQxNDYtMi40NTEtMy41MDE0LTIuNDUxLTIuMjEyOSAwLTMuNjgzNSAxLjE5MDUtMy42ODM1IDIuOTY5MiAwIDEuMDc4NCAwLjU0NjIxIDEuNzIyNyAxLjI4ODUgMi4xNzA5LTAuOTk0NCAwLjQyMDE3LTEuNTU0NiAxLjE3NjUtMS41NTQ2IDIuMTI4OSAwIDEuNjM4NyAxLjU0MDYgMi43MzExIDMuODUxNyAyLjczMTEgMi4zNTMgMCAzLjkyMTUtMS4yMDQ1IDMuOTIxNS0zLjAyNTIgMC0xLjI3NDUtMC44NDAzNC0xLjkzMjgtMS44MzQ3LTIuMzY2OXptLTIuMDcyOC0yLjUzNWMwLjY1ODI1IDAgMS4wOTI1IDAuMzIyMTMgMS4wOTI1IDAuODI2MzQgMCAwLjUwNDE5LTAuMzY0MTQgMC45MTAzNy0wLjkyNDM2IDEuMDUwNC0wLjcyODI5LTAuMjY2MS0xLjI3NDUtMC41NDYyMS0xLjI3NDUtMS4wNjQ0IDAtMC40OTAyIDAuNDM0MTYtMC44MTIzMSAxLjEwNjQtMC44MTIzMXptMC4xMTIwNCA1Ljg1NDRjLTAuODk2MzQgMC0xLjQ4NDYtMC40MzQxNi0xLjQ4NDYtMS4wNzg0IDAtMC40NjIxOCAwLjI5NDEyLTAuODI2MzQgMC43OTgzMi0wLjk5NDQgMS4wNTA0IDAuMzM2MTMgMS45ODg4IDAuNTg4MjIgMS45ODg4IDEuMjQ2NSAwIDAuNDkwMi0wLjUzMjIxIDAuODI2MzQtMS4zMDI1IDAuODI2MzR6IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IiBmaWxsPSIjZmZmIiBzdHJva2Utd2lkdGg9Ii4zNzUxMnB4IiBzdHlsZT0iZm9udC1mZWF0dXJlLXNldHRpbmdzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LWxpZ2F0dXJlczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsIi8+CiA8cGF0aCBpZD0icGF0aDEwNDEiIGQ9Im0yNSA0My45MDhoLTEuMzQ0OHYtNS45MDg0aC0yLjM3NDhsLTQuNjIxIDUuOTA4NHYyLjE0NTloNC41MDY0djEuOTQ1NmgyLjQ4OTN2LTEuOTQ1NmgxLjM0NDh6bS02LjA4MDEtMC4wMjg2MiAyLjI0NjEtMi45MzI4djIuOTQ3MXoiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXciIGZpbHRlcj0idXJsKCNmaWx0ZXIxMTQ3KSIgb3BhY2l0eT0iLjE1IiBzdHJva2Utd2lkdGg9Ii4zODMxN3B4IiBzdHlsZT0iZm9udC1mZWF0dXJlLXNldHRpbmdzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LWxpZ2F0dXJlczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsIi8+CiA8cGF0aCBpZD0icGF0aDM4NzE0IiBkPSJtMjUgNDMuOTA4aC0xLjM0NDh2LTUuOTA4NGgtMi4zNzQ4bC00LjYyMSA1LjkwODR2Mi4xNDU5aDQuNTA2NHYxLjk0NTZoMi40ODkzdi0xLjk0NTZoMS4zNDQ4em0tNi4wODAxLTAuMDI4NjIgMi4yNDYxLTIuOTMyOHYyLjk0NzF6IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IiBmaWxsPSIjZmZmIiBzdHJva2Utd2lkdGg9Ii4zODMxN3B4IiBzdHlsZT0iZm9udC1mZWF0dXJlLXNldHRpbmdzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LWxpZ2F0dXJlczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsIi8+Cjwvc3ZnPgo=\", \"keyword\": \"2048,2048\", \"uniquerunkey\": null, \"cat\": \"games\", \"args\": null, \"execmode\": null, \"security_opt\": null, \"showinview\": null, \"displayname\": \"2048\", \"mimetype\": [], \"path\": \"/usr/games/2048-qt\", \"desktopfile\": \"2048-qt.desktop\", \"executablefilename\": \"2048-qt\", \"usedefaultapplication\": null, \"fileextensions\": [], \"legacyfileextensions\": [], \"host_config\": {\"mem_limit\": \"256M\", \"shm_size\": \"64M\", \"pid_mode\": false, \"network_mode\": \"none\"}, \"secrets_requirement\": null, \"run_inside_pod\": false, \"image_pull_policy\": \"IfNotPresent\", \"image_pull_secrets\": null\n</code></pre>"},{"location":"3.0/setup/kubernetes_abcdesktop_applications/#rest-api-methods-description-for-apimanagerimage","title":"REST API <code>methods</code> description for <code>/API/manager/image</code>","text":"Method Type     <code>GET</code> http request list images in mongo db <code>image</code> collection   <code>PUT</code> http request update or insert images in mongo db <code>image</code> collection, then create a pull pod to fetch images   <code>POST</code> http request update or insert images in mongo db <code>image</code> collection. This method does not pull images.   <code>DELETE</code> http request delete images in mongo db <code>image</code> collection       Method Sample     <code>GET</code> <code>curl -X GET -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image</code>   <code>PUT</code> <code>curl -X PUT -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image -d@xterm.d.json</code>   <code>POST</code> <code>curl -X POST -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image -d@xterm.d.json</code>   <code>DELETE</code> <code>curl -X DELETE -H 'Content-Type: text/javascript' http://localhost:30443/API/manager/image/efbb56e0c579d1945fd8f4a4d955e08d7801208c953e03fe6d4d274edd1904c9</code>    <p>The <code>PUT</code> method create a pull pod to fetch application images. Check that a new <code>pull-2048-*-UUID</code> pod exists</p> <pre><code>kubectl get pods -n abcdesktop\n</code></pre> <p>The pod <code>pull-2048-abcinst-9fd80f22ad6b0750cb3d248bda04de25444bab2cf274</code> is <code>ContainerCreating</code>. </p> <pre><code>NAME                                                             READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-dqxzx                                            1/1     Running   0          32m\ndaemonset-pyos-rdwws                                             1/1     Running   0          32m\nmemcached-od-bdcbbcb74-xbg8x                                     1/1     Running   0          32m\nmongodb-od-6484d8bc67-9xsgm                                      1/1     Running   0          32m\nopenldap-od-795c55f6db-pb68k                                     1/1     Running   0          32m\npull-2048-abcinst-9fd80f22ad6b0750cb3d248bda04de25444bab2cf274   0/1     ContainerCreating   0          2s\nspeedtest-od-5565dfdc67-vdwcl                                    1/1     Running   0          32m\n</code></pre> <p>Then the pod <code>STATUS</code> become <code>Running</code> during <code>42 seconds</code>.</p> <pre><code>NAME                                                             READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-dqxzx                                            1/1     Running   0          32m\ndaemonset-pyos-rdwws                                             1/1     Running   0          32m\nmemcached-od-bdcbbcb74-xbg8x                                     1/1     Running   0          32m\nmongodb-od-6484d8bc67-9xsgm                                      1/1     Running   0          32m\nopenldap-od-795c55f6db-pb68k                                     1/1     Running   0          32m\npull-2048-abcinst-9fd80f22ad6b0750cb3d248bda04de25444bab2cf274   1/1     Running   0          80s\nspeedtest-od-5565dfdc67-vdwcl                                    1/1     Running   0          32m\n</code></pre> <p>This pod is created to ask Kubernetes for pulling the container image.</p>"},{"location":"3.0/setup/kubernetes_abcdesktop_applications/#connect-to-your-abcdesktop_1","title":"Connect to your abcdesktop","text":"<p>The API server receives a new image event from docker daemon. To run the new applications just refresh you web browser page.</p> <p>Now reconnect to your abcdesktop. </p> <p>Open your navigator to http://[your-ip-hostname]:30443/</p> <pre><code>http://localhost:30443/\n</code></pre> <p>The new applications are installed, and ready to run.</p>"},{"location":"3.0/setup/kubernetesmode/","title":"Setup kubernetes for GNU/Linux","text":"<p>This section apply only to configure kubernetes for GNU/Linux.</p> <p>abcdesktop.io support docker mode and kubernetes mode. In this section we will study how abcdesktop.io is working in kubernetes mode. The abcdesktop.io kubernetes mode is recommended for enterprise use, all user containers can be distributed on different hosts.</p>"},{"location":"3.0/setup/kubernetesmode/#requirements","title":"Requirements","text":"<p>Linux Requierements</p>"},{"location":"3.0/setup/kubernetesmode/#installation","title":"Installation","text":"<p>The following commands will let you prepare kubernetes on one node. In this case, all applications run on a single node.  It's recommended to start with a single node.</p>"},{"location":"3.0/setup/kubernetesmode/#kubernetes-master-node","title":"Kubernetes Master Node","text":""},{"location":"3.0/setup/kubernetesmode/#step-1-disable-swap-memory-if-running","title":"Step 1: Disable swap memory (if running)","text":"<p>You need to disable swap memory on nodes as Kubernetes does not perform properly on a system that is using swap memory. Run the following command in order to disable swap memory.  </p> <pre><code>swapoff -a\n</code></pre> <p>If you have some swaps in /etc/fstab, just comment them out. <code>swapoff -a</code> will disable all swaps temporarily.</p> <ul> <li>disable by masking it with sysctl:</li> </ul> <pre><code>systemctl mask dev-zram1.swap\nCreated symlink /etc/systemd/system/dev-zram1.swap \u2192 /dev/null.\n</code></pre>"},{"location":"3.0/setup/kubernetesmode/#step-2-init-kubernetes","title":"Step 2: init kubernetes","text":"<p>Run the following command as sudo on the master node:</p> <pre><code>kubeadm init --pod-network-cidr=10.244.0.0/16\n</code></pre> <p>The process might take a minute or more depending on your internet connection.  </p> <p>To be able to manage your kubernetes server, you need to run the following commands as a regular user:</p> <pre><code>mkdir -p $HOME/.kube\ncp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nchown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre>"},{"location":"3.0/setup/kubernetesmode/#step-3-permit-schedule","title":"Step 3: Permit Schedule","text":"<p>Taints are Kubernetes flags to prevent Pod Scheduling. Remove the taints on the master so that you can schedule pods on it.</p> <pre><code>kubectl taint node `hostname` node-role.kubernetes.io/control-plane:NoSchedule-\n</code></pre> <p>It should return the following string.</p> <pre><code>node/&lt;your-hostname&gt; untainted\n</code></pre> <p>Taints are Kubernetes flags to prevent Pod Scheduling.</p> <p>Confirm that you now have a node in your cluster with the following command.</p> <pre><code>kubectl get nodes -o wide\n</code></pre> <p>It should return something like the following.</p> <pre><code>NAME      STATUS     ROLES           AGE     VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION      CONTAINER-RUNTIME\nhostname  NotReady   control-plane   3m17s   v1.25.3   192.168.7.187   &lt;none&gt;        Ubuntu 22.04.1 LTS   5.15.0-52-generic   containerd://1.6.9\n</code></pre>"},{"location":"3.0/setup/kubernetesmode/#step-4-deploy-flannel-through-the-master-node","title":"Step 4: Deploy flannel through the master node","text":"<p>A pod network is a medium of communication between the nodes of a network. We are deploying flannel network on our cluster through the following command:</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n</code></pre> <p>It should return the following strings.</p> <pre><code>namespace/kube-flannel created\nclusterrole.rbac.authorization.k8s.io/flannel created\nclusterrolebinding.rbac.authorization.k8s.io/flannel created\nserviceaccount/flannel created\nconfigmap/kube-flannel-cfg created\ndaemonset.apps/kube-flannel-ds created\n</code></pre>"},{"location":"3.0/setup/kubernetesmode/#check-node-status","title":"Check node status","text":"<p>Now when you see the status of the nodes, you will see that the master-node is ready :</p> <pre><code>kubectl get nodes -o wide\n</code></pre> <pre><code>NAME      STATUS   ROLES           AGE     VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION      CONTAINER-RUNTIME\nHostname  Ready    control-plane   4m12s   v1.25.3   192.168.7.187   &lt;none&gt;        Ubuntu 22.04.1 LTS   5.15.0-52-generic   containerd://1.6.9\n</code></pre> <p>At this step, there is no more <code>Taints</code> and your node is <code>Ready</code>. </p> <p>Next step, continue with the setup abcdesktop for kubernetes.</p>"},{"location":"3.0/setup/requirements/","title":"Requirements","text":""},{"location":"3.0/setup/requirements/#prerequisites-for-abcdesktop-setup-in-release-3x","title":"Prerequisites for abcdesktop setup in release 3.x","text":"<ul> <li>Architecture <code>x86-64</code> (<code>arm-64</code> is not yet available)</li> <li>16 GB of free space to store sample applications (<code>gimp</code>, <code>libreoffice writer</code>, <code>libreoffice calc</code>, <code>libreoffice math</code>, <code>libreoffice impress</code>, <code>firefox</code>) and core image services.</li> </ul>"},{"location":"3.0/setup/requirements/#release-3x","title":"Release 3.x","text":"<ul> <li>kubernetes release must be greater or equal to 1.24</li> </ul> <pre><code>$ kubectl version --output=yaml\n</code></pre> <pre><code>serverVersion:\n  buildDate: \"2022-05-24T12:18:48Z\"\n  compiler: gc\n  gitCommit: 3ddd0f45aa91e2f30c70734b175631bec5b5825a\n  gitTreeState: clean\n  gitVersion: v1.24.1\n  goVersion: go1.18.2\n  major: \"1\"\n  minor: \"24\"\n  platform: linux/amd64\n</code></pre> <ul> <li>You do not need to install dockerd. </li> <li>There is no depend to dockerd anymore. In this release and all next releases, application can run as : </li> <li><code>kubernetes pod</code> </li> <li><code>ephemeral container</code>. Read more informations about on <code>ephermeral container</code></li> <li>All container-runtimes are supported. containerd is recommended py default.</li> </ul>"},{"location":"3.0/setup/requirements/#microk8s-support","title":"microk8s support","text":"<p>microk8s is supported in abcdesktop release 3.0. The reverse proxy service need to enable dns service.</p>"},{"location":"3.0/setup/requirements/#microk8s-kubectl-version","title":"microk8s kubectl version","text":"<ul> <li>kubernetes release must be greater or equal to 1.24</li> </ul> <pre><code>$ microk8s kubectl version --output=yaml\nclientVersion:\n  buildDate: \"2022-09-28T14:42:45Z\"\n  compiler: gc\n  gitCommit: 949b88ddc8b8cc540684c90c176f92ac9676e07c\n  gitTreeState: clean\n  gitVersion: v1.24.6-2+949b88ddc8b8cc\n  goVersion: go1.18.5\n  major: \"1\"\n  minor: 24+\n  platform: linux/amd64\nkustomizeVersion: v4.5.4\nserverVersion:\n  buildDate: \"2022-09-28T14:40:13Z\"\n  compiler: gc\n  gitCommit: 949b88ddc8b8cc540684c90c176f92ac9676e07c\n  gitTreeState: clean\n  gitVersion: v1.24.6-2+949b88ddc8b8cc\n  goVersion: go1.18.5\n  major: \"1\"\n  minor: 24+\n  platform: linux/amd64\n</code></pre>"},{"location":"3.0/setup/requirements/#enable-dns-add-one-to-microk8s","title":"enable <code>dns</code> add one to <code>microk8s</code>","text":"<pre><code>$ microk8s enable dns\n</code></pre> <p>You should ready on stdout</p> <pre><code>$ microk8s enable dns\nInfer repository core for addon dns\nEnabling DNS\nApplying manifest\nserviceaccount/coredns created\nconfigmap/coredns created\ndeployment.apps/coredns created\nservice/kube-dns created\nclusterrole.rbac.authorization.k8s.io/coredns created\nclusterrolebinding.rbac.authorization.k8s.io/coredns created\nRestarting kubelet\nDNS is enabled\n</code></pre> <p>Check microk8s status</p> <pre><code>$ microk8s status\nmicrok8s is running\nhigh-availability: no\n  datastore master nodes: 127.0.0.1:19001\n  datastore standby nodes: none\naddons:\n  enabled:\n    dns                  # (core) CoreDNS\n    ha-cluster           # (core) Configure high availability on the current node\n</code></pre>"},{"location":"3.0/setup/requirements/#supported-architectures","title":"Supported Architectures","text":"<p>images support only architectures <code>x86-64</code>. The architectures supported by this image is:</p>    Architecture Tag     x86-64 amd64-latest"},{"location":"3.0/setup/requirements/#gnulinux","title":"GNU/Linux","text":"<p>The recommended distribution is Ubuntu 22.04.1 LTS (Jammy Jellyfish)</p>"},{"location":"3.0/setup/uninstall_kubernetes/","title":"Uninstall abcdesktop","text":"<p>Uninstall abcdesktop for kubernetes</p>"},{"location":"3.0/setup/uninstall_kubernetes/#commands-to-uninstall-abcdesktop-release-30","title":"Commands to uninstall abcdesktop release 3.0","text":"<p>To uninstall abcdesktop. Choose run run the <code>uninstall-3.0.sh</code> bash script using a curl or run step by step uninstall commands manually.</p>"},{"location":"3.0/setup/uninstall_kubernetes/#quick-uninstallation-abcdesktop-linux-or-macos","title":"Quick uninstallation abcdesktop (Linux or macOS)","text":"<p>Quick uninstallation can be run on Linux or macOS operation system. </p>  <p>Download and extract the uninstall bash script (Linux or macOS):</p> <pre><code>curl -sL https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/uninstall-3.0.sh | bash\n</code></pre> <p>You should read on stdout </p> <pre><code>starting abcdesktop uninstall commands start at 1669824908 epoch seconds\nstop and remove abcdesktop user pods\npod \"anonymous-33c30478-5cc0-4e18-b128-735694c98f3c\" deleted\nremove all services, pods\nclusterrole.rbac.authorization.k8s.io \"pyos-role\" deleted\nclusterrolebinding.rbac.authorization.k8s.io \"pyos-rbac\" deleted\nserviceaccount \"pyos-serviceaccount\" deleted\nstorageclass.storage.k8s.io \"storage-local-abcdesktop\" deleted\nconfigmap \"nginx-config\" deleted\ndeployment.apps \"memcached-od\" deleted\nsecret \"mongodb-secret\" deleted\ndeployment.apps \"mongodb-od\" deleted\ndaemonset.apps \"daemonset-nginx\" deleted\ndeployment.apps \"speedtest-od\" deleted\ndaemonset.apps \"daemonset-pyos\" deleted\nendpoints \"desktop\" deleted\nservice \"desktop\" deleted\nservice \"memcached\" deleted\nservice \"mongodb\" deleted\nservice \"speedtest\" deleted\nservice \"nginx\" deleted\nservice \"pyos\" deleted\ndeployment.apps \"openldap-od\" deleted\nservice \"openldap\" deleted\nremove all secrets\nsecret \"abcdesktopjwtdesktoppayload\" deleted\nsecret \"abcdesktopjwtdesktopsigning\" deleted\nsecret \"abcdesktopjwtusersigning\" deleted\nremove all configmaps\nconfigmap \"abcdesktop-config\" deleted\nconfigmap \"kube-root-ca.crt\" deleted\nremove all pvc\nNo resources found\nremove all pv\nNo resources found\nremove namespace\nnamespace \"abcdesktop\" deleted\nabcdesktop is uninstalled, in 48 seconds\n</code></pre>"},{"location":"3.0/setup/uninstall_kubernetes/#run-step-by-step-uninstall-commands","title":"Run step by step uninstall commands","text":"<p>Run the bash commands from the <code>uninstall-3.0.sh</code> main content : </p> <pre><code>echo \"stop and remove abcdesktop user pods\"\nkubectl delete pods --selector=\"type=x11server\" -n abcdesktop\necho \"remove all services, pods\"\nkubectl delete -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/abcdesktop-3.0.yaml \necho \"remove all secrets\"\nkubectl delete secrets --all -n abcdesktop\necho \"remove all configmaps\"\nkubectl delete cm --all -n abcdesktop\necho \"remove all pvc\"\nkubectl delete pvc --all -n abcdesktop 2&gt;/dev/null\necho \"remove all pv\"\nkubectl delete pv --all -n abcdesktop  2&gt;/dev/null\necho \"remove namespace\"\nkubectl delete namespace abcdesktop\necho \"abcdesktop is uninstalled\"\n</code></pre> <p>The last command <code>kubectl delete namespace</code> can take few minutes.</p> <p>Please wait for the output message: </p> <pre><code>abcdesktop is uninstalled\n</code></pre> <p>Great, you have uninstalled abcdesktop for kubernetes.</p>"},{"location":"about/authors/","title":"Authors and Contributors","text":""},{"location":"about/authors/#primary-authors","title":"Primary Authors","text":"<ul> <li> <p>Alexandre DEVELY : Project owner, architect, developer, containers and security design, all components, maintainer of the code and has written much of the current code base</p> </li> <li> <p>Cedric HAUWEL : Control Plane <code>PyOS</code> and authentification, included a complete refactor of the control plane</p> </li> <li> <p>Jeremy PETIT : HTML, CSS, Javascript, nodejs: Full Stack Javascript Developer</p> </li> <li> <p>Kevin VOYER :  HTML, CSS, Javascript, Firefox clipboard extension, nodejs : Full Stack Javascript Developer</p> </li> <li> <p>Vincent PENVERN : Python, Ansible, Firefox clipboard extension, Pyos and embedded applications </p> </li> <li> <p>Jean-Philippe XAVIER: Architect, design and network policies with calico</p> </li> </ul>"},{"location":"about/authors/#other-contributors","title":"Other Contributors","text":"<p>The incomplete list of individuals below have provided patches or otherwise contribute to the project prior to the project being hosted on GitHub. See the GitHub <code>commit log</code> for a list of recent contributors. We would like to thank everyone who has contributed to the project in any way.</p>"},{"location":"about/gnu-gpl-v2.0/","title":"GNU General Public License","text":"<p>Version 2, June 1991 Copyright \u00a9 1989, 1991 Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</p> <p>Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.</p>"},{"location":"about/gnu-gpl-v2.0/#preamble","title":"Preamble","text":"<p>The licenses for most software are designed to take away your freedom to share and change it.  By contrast, the GNU General Public License is intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users.  This General Public License applies to most of the Free Software Foundation's software and to any other program whose authors commit to using it.  (Some other Free Software Foundation software is covered by the GNU Lesser General Public License instead.)  You can apply it to your programs, too.</p> <p>When we speak of free software, we are referring to freedom, not price.  Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs; and that you know you can do these things.</p> <p>To protect your rights, we need to make restrictions that forbid anyone to deny you these rights or to ask you to surrender the rights. These restrictions translate to certain responsibilities for you if you distribute copies of the software, or if you modify it.</p> <p>For example, if you distribute copies of such a program, whether gratis or for a fee, you must give the recipients all the rights that you have.  You must make sure that they, too, receive or can get the source code.  And you must show them these terms so they know their rights.</p> <p>We protect your rights with two steps: (1) copyright the software, and (2) offer you this license which gives you legal permission to copy, distribute and/or modify the software.</p> <p>Also, for each author's protection and ours, we want to make certain that everyone understands that there is no warranty for this free software.  If the software is modified by someone else and passed on, we want its recipients to know that what they have is not the original, so that any problems introduced by others will not reflect on the original authors' reputations.</p> <p>Finally, any free program is threatened constantly by software patents.  We wish to avoid the danger that redistributors of a free program will individually obtain patent licenses, in effect making the program proprietary.  To prevent this, we have made it clear that any patent must be licensed for everyone's free use or not licensed at all.</p> <p>The precise terms and conditions for copying, distribution and modification follow.</p>"},{"location":"about/gnu-gpl-v2.0/#terms-and-conditions-for-copying-distribution-and-modification","title":"TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION","text":"<p>0. This License applies to any program or other work which contains a notice placed by the copyright holder saying it may be distributed under the terms of this General Public License.  The \u201cProgram\u201d, below, refers to any such program or work, and a \u201cwork based on the Program\u201d means either the Program or any derivative work under copyright law: that is to say, a work containing the Program or a portion of it, either verbatim or with modifications and/or translated into another language.  (Hereinafter, translation is included without limitation in the term \u201cmodification\u201d.)  Each licensee is addressed as \u201cyou\u201d.</p> <p>Activities other than copying, distribution and modification are not covered by this License; they are outside its scope.  The act of running the Program is not restricted, and the output from the Program is covered only if its contents constitute a work based on the Program (independent of having been made by running the Program). Whether that is true depends on what the Program does.</p> <p>1. You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program.</p> <p>You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.</p> <p>2. You may modify your copy or copies of the Program or any portion of it, thus forming a work based on the Program, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:</p> <ul> <li>a) You must cause the modified files to carry prominent notices stating that you changed the files and the date of any change.</li> <li>b) You must cause any work that you distribute or publish, that in whole or in part contains or is derived from the Program or any part thereof, to be licensed as a whole at no charge to all third parties under the terms of this License.</li> <li>c) If the modified program normally reads commands interactively when run, you must cause it, when started running for such interactive use in the most ordinary way, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty) and that users may redistribute the program under these conditions, and telling the user how to view a copy of this License.  (Exception: if the Program itself is interactive but does not normally print such an announcement, your work based on the Program is not required to print an announcement.)</li> </ul> <p>These requirements apply to the modified work as a whole.  If identifiable sections of that work are not derived from the Program, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works.  But when you distribute the same sections as part of a whole which is a work based on the Program, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.</p> <p>Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Program.</p> <p>In addition, mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.</p> <p>3. You may copy and distribute the Program (or a work based on it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you also do one of the following:</p> <ul> <li>a) Accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,</li> <li>b) Accompany it with a written offer, valid for at least three years, to give any third party, for a charge no more than your cost of physically performing source distribution, a complete machine-readable copy of the corresponding source code, to be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,</li> <li>c) Accompany it with the information you received as to the offer to distribute corresponding source code.  (This alternative is allowed only for noncommercial distribution and only if you received the program in object code or executable form with such an offer, in accord with Subsection b above.)</li> </ul> <p>The source code for a work means the preferred form of the work for making modifications to it.  For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable.  However, as a special exception, the source code distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.</p> <p>If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.</p> <p>4. You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License.  Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.</p> <p>5. You are not required to accept this License, since you have not signed it.  However, nothing else grants you permission to modify or distribute the Program or its derivative works.  These actions are prohibited by law if you do not accept this License.  Therefore, by modifying or distributing the Program (or any work based on the Program), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Program or works based on it.</p> <p>6. Each time you redistribute the Program (or any work based on the Program), the recipient automatically receives a license from the original licensor to copy, distribute or modify the Program subject to these terms and conditions.  You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties to this License.</p> <p>7. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License.  If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Program at all.  For example, if a patent license would not permit royalty-free redistribution of the Program by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Program.</p> <p>If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply and the section as a whole is intended to apply in other circumstances.</p> <p>It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system, which is implemented by public license practices.  Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.</p> <p>This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.</p> <p>8. If the distribution and/or use of the Program is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Program under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded.  In such case, this License incorporates the limitation as if written in the body of this License.</p> <p>9. The Free Software Foundation may publish revised and/or new versions of the General Public License from time to time.  Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.</p> <p>Each version is given a distinguishing version number.  If the Program specifies a version number of this License which applies to it and \u201cany later version\u201d, you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation.  If the Program does not specify a version number of this License, you may choose any version ever published by the Free Software Foundation.</p> <p>10. If you wish to incorporate parts of the Program into other free programs whose distribution conditions are different, write to the author to ask for permission.  For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this.  Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.</p>"},{"location":"about/gnu-gpl-v2.0/#no-warranty","title":"NO WARRANTY","text":"<p>11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM \u201cAS IS\u201d WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.</p> <p>12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p> <p>END OF TERMS AND CONDITIONS</p>"},{"location":"about/gnu-gpl-v2.0/#how-to-apply-these-terms-to-your-new-programs","title":"How to Apply These Terms to Your New Programs","text":"<p>If you develop a new program, and you want it to be of the greatest possible use to the public, the best way to achieve this is to make it free software which everyone can redistribute and change under these terms.</p> <p>To do so, attach the following notices to the program.  It is safest to attach them to the start of each source file to most effectively convey the exclusion of warranty; and each file should have at least the \u201ccopyright\u201d line and a pointer to where the full notice is found.</p> <pre><code>&lt;one line to give the program's name and a brief idea of what it does.&gt;\nCopyright (C) &lt;year&gt;  &lt;name of author&gt;\n\nThis program is free software; you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation; either version 2 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License along\nwith this program; if not, write to the Free Software Foundation, Inc.,\n51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n</code></pre> <p>Also add information on how to contact you by electronic and paper mail.</p> <p>If the program is interactive, make it output a short notice like this when it starts in an interactive mode:</p> <pre><code>Gnomovision version 69, Copyright (C) year name of author\nGnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\nThis is free software, and you are welcome to redistribute it\nunder certain conditions; type `show c' for details.\n</code></pre> <p>The hypothetical commands <code>show w</code> and <code>show c</code> should show the appropriate parts of the General Public License.  Of course, the commands you use may be called something other than <code>show w</code> and <code>show c</code>; they could even be mouse-clicks or menu items--whatever suits your program.</p> <p>You should also get your employer (if you work as a programmer) or your school, if any, to sign a \u201ccopyright disclaimer\u201d for the program, if necessary.  Here is a sample; alter the names:</p> <pre><code>Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n`Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n&lt;signature of Ty Coon&gt;, 1 April 1989\nTy Coon, President of Vice\n</code></pre> <p>This General Public License does not permit incorporating your program into proprietary programs.  If your program is a subroutine library, you may consider it more useful to permit linking proprietary applications with the library.  If this is what you want to do, use the GNU Lesser General Public License instead of this License.</p>"},{"location":"about/howreadthisdoc/","title":"How to read the abcdesktop.io documentation","text":""},{"location":"about/howreadthisdoc/#abcdesktopio-documentation","title":"abcdesktop.io documentation","text":"<p>The abcdesktop.io documentation brings you labs and tutorials that help you get hands-on experience using abcdesktop.io. You will find a mix of labs and tutorials that will help abcdesktop.io users, including sysadmins, IT Pros, and developers. There is a mix of hands-on tutorials right in the browser, instructions on setting up and using abcdesktop.io in your own environment (docker and kubernetes), and resources about best practices for developing and deploying your own abcdesktop.io applications.</p> <p>We recommend you to start in <code>docker mode</code> first with the Setup Guide in docker mode.</p> <p>Then explore the individual labs that explore many advanced features of abcdesktop.io, in <code>Configuration Guide</code></p> <p>You can also, read the genesis chapters <code>GUI apps on Docker</code>.</p> <p>Learn more about abcdesktop.io, how it can help you deploy secure, scalable applications and save money along the way.</p>"},{"location":"about/howreadthisdoc/#the-basics-of-abcdesktopio","title":"The Basics of abcdesktop.io","text":"<p>Learn more about the core concepts of abcdesktop.io and what it can do for your operations team, and help you understand the fundamental value proposition for abcdesktop.io. </p> <p>Topics include:</p> <ul> <li>Fundamentals of abcdesktop.io</li> <li>Deploy abcdesktop.io using docker-composer</li> <li>Defined docker image application </li> <li>Build your own application <ul> <li>Use standard GNU/Linux Application</li> <li>Use Microsoft Windows Application with Wine</li> </ul> </li> </ul>"},{"location":"about/howreadthisdoc/#the-advanced-of-abcdesktopio","title":"The Advanced of abcdesktop.io","text":"<p>This stage will help you learn more about some of the advanced topics of abcdesktop.io using Kubernetes. </p> <p>Topics include:</p> <ul> <li>Deploy abcdesktop.io using Kubernetes</li> <li>Storage and Kubernetes drivers<ul> <li>Legacy Files server (CIFS, NFS, WebDav) </li> <li>Amazon/S3, Ceph</li> </ul> </li> <li>Roles</li> <li>Security</li> <li>Networking Policies</li> <li>Orchestration</li> <li>LoadBalancing</li> <li>Logging with GrayLog </li> <li>Garbage collector</li> </ul>"},{"location":"about/howtodolabsexercices/","title":"How to do the labs and exercices","text":"<p>abcdesktop labs and tutorials are written using a desktop host. The supported operating system are :</p>    Operating System Recommended version     <code>GNU/Linux</code> Ubuntu 18.04.4 LTS (Bionic Beaver)   <code>macOS/X</code> Catalina version 10.15.3 (and above)   <code>Windows 10</code> Version 1703 (and above)"},{"location":"about/howtodolabsexercices/#choose-desktop-or-server","title":"Choose <code>desktop</code> or <code>server</code>","text":"<ul> <li>If you choose <code>server</code>, please translate the <code>URL</code> request <code>http://localhost</code> with the hostname of your server. </li> </ul> <p>For example, if you are doing the exercice on a hostname 'server01.labs.domain.local', you have to translate the <code>URL</code> request <code>http://localhost</code> with  <code>http://server01.labs.domain.local</code></p>  <p>Your web browser (like Google Chrome) may refuse unsecure websocket (ws) connections to localhost or your FQDN (only wss, so you should setup a TLS certificate for your local web/websocket server). It should work without any issues in Mozilla Firefox on localhost.</p>  <ul> <li>If you choose <code>desktop</code>, the <code>URL</code> request <code>http://localhost</code> will reach your local services.</li> </ul>"},{"location":"about/opensource/","title":"Open Source","text":""},{"location":"about/opensource/#abcdesktopio-is-an-open-source-project","title":"abcdesktop.io is an open source project","text":"<p>abcdesktop.io is an open source project and is a volunteer effort. This means that it depends on people to give some of their free time to improve it and make it even better.</p> <p>Follow the Fork me on github links, to get access to each repository.</p> <p>If you are reading this, then you are probably curious or want to contribute in some way. Read on to see how you can do so.</p>"},{"location":"about/opensource/#open-source-packages-dependencies","title":"Open Source packages dependencies","text":"<p>abcdesktop.io deplend on a lot of open source diffrents projets.</p>"},{"location":"about/opensource/#webmodules","title":"WebModules","text":"Package Licence Authors Source     novnc MPL-2.0 Joel Martin https://kanaka.github.io/noVNC/   os.js BSD license Anders Evenrud https://github.com/os-js/OS.js/   dropzone.js MIT license Matias Meno, www.colorglare.com https://github.com/enyo/dropzone/   hammer.js MIT license Jorik Tangelder http://hammerjs.github.io/   jquery MIT license jQuery Team https://jquery.com/         jqueryui MIT license jQuery Team https://jqueryui.com/         js-cookie MIT license Klaus Hartl &amp; Fagner Brack https://github.com/js-cookie/         UAParser GPLv2 &amp; MIT Faisal Salman https://github.com/faisalman/ua-parser-js   Angular FileManager MIT license Jonas Sciangula Street https://github.com/joni2back/angular-filemanager   Bootstrap MIT license Bootstrap team https://getbootstrap.com/   webaudio-wav-stream-player MIT license Julien Bouquillon https://github.com/revolunet/webaudio-wav-stream-player   bootbox MIT license Nick Payne makeusabrew https://github.com/makeusabrew/bootbox"},{"location":"about/opensource/#container-components","title":"Container components","text":""},{"location":"about/opensource/#nginx","title":"nginx","text":"Package Licence Authors Source     nginx BSD licence Igor Sysoev http://nginx.org/   lua GPL-Compatible Free Software Licenses team at PUC-Rio in Brazil https://www.lua.org/"},{"location":"about/opensource/#ocpyos","title":"oc.pyos","text":"Package Version License     CherryPy 18.5.0 BSD License   Jinja2 2.11.1 BSD-3-Clause   PyJWT 1.7.1 MIT   PyNaCl 1.3.0 Apache License 2.0   PyYAML 5.3 MIT   bcrypt 3.1.7 Apache License, Version 2.0   certifi 2020.4.5.1 MPL-2.0   cffi 1.14.0 MIT   chardet 3.0.4 LGPL   cryptography 2.9 BSD or Apache License, Version 2.0   dnspython 1.16.0 BSD-like   docker 4.2.0 Apache License 2.0   future 0.18.2 MIT   google-auth 1.13.1 Apache 2.0   graypy 2.1.0 BSD License   idna 2.9 BSD-like   iso8601 0.1.12 MIT   isort 4.3.21 MIT   kubernetes 11.0.0 Apache License Version 2.0   netaddr 0.7.19 BSD License   oauthlib 3.1.0 BSD   paramiko 2.7.1 LGPL   pyasn1 0.4.8 BSD   pyasn1-modules 0.2.8 BSD-2-Clause   pycrypto 2.6.1 Public Domain   pymongo 3.10.1 Apache License, Version 2.0   python-dateutil 2.8.1 Dual License   python-geoip 1.2 GNU LESSER GENERAL PUBLIC LICENSE   python-ldap 3.2.0 Python style   python-subprocess2 2.0.2 LGPLv3   pytz 2019.3 MIT   requests 2.23.0 Apache 2.0   requests-oauthlib 1.3.0 ISC   rsa 4.0 ASL 2   shellescape 3.8.1 MIT license   urllib3 1.25.8 MIT       Package Version License     ntlm_auth 2.0 GNU Lesser General Public License   kerberos 1.16-2 MIT   cntlm 0.92.3 GNU General Public License version 2.0 (GPLv2)"},{"location":"about/opensource/#ocuser","title":"oc.user","text":"Package Licence Authors Source     novnc MPL-2.0 Joel Martin (github@martintribe.org) https://kanaka.github.io/noVNC/   supervisor LICENCES.TXT Chris McDonough http://supervisord.org/   tigervnc MIT licence Tiger Dev Tea https://tigervnc.org/   openbox GNU license Mikael Magnusson http://openbox.org/   cupds GNU &amp; LGPL Apple Inc. https://www.cups.org/   xsettingsd COPYING Daniel Erat https://github.com/derat/xsettingsd   angular-filemanager AGPL-3.0 Maestro Alubia https://www.npmjs.com/package/angular-filemanager-nodejs-bridge"},{"location":"about/opensource/#daemons","title":"Daemons","text":""},{"location":"about/opensource/#spawner-service","title":"Spawner-Service","text":"Package Licence Authors Source     accept-language-parser@1.5.0 MIT Andy Royle https://github.com/opentable/accept-language-parser   accept-language@3.0.18 MIT Tingan Ho https://github.com/tinganho/node-accept-language   accepts@1.3.7 MIT no Author https://github.com/jshttp/accepts   create-symlink@1.0.0 MIT Shinnosuke Watanabe https://github.com/shinnn/create-symlink   diacritics@1.3.0 MIT Andrew Kelley https://github.com/andrewrk/node-diacritics   dominant-color@0.0.1 ISC Hrvoje Simic https://github.com/shime/dominant-color   event-stream@4.0.1 MIT Dominic Tarr https://github.com/dominictarr/event-stream   express-validator@6.4.0 MIT Christoph Tavan https://github.com/express-validator/express-validator   express@4.17.1 MIT TJ Holowaychuk https://github.com/expressjs/express   find-process@1.4.3 MIT zoujie https://github.com/yibn2008/find-process   geoip-lite@1.4.1 Apache-2.0 Philip Tellis https://github.com/bluesmoon/node-geoip   helmet@3.22.0 MIT Adam Baldwin https://github.com/helmetjs/helmet   hex-rgb@4.1.0 MIT Sindre Sorhus https://github.com/sindresorhus/hex-rgb   imagemagick@0.1.3 MIT Rasmus Andersson https://github.com/rsms/node-imagemagick   ini@1.3.5 ISC Isaac Z. Schlueter https://github.com/isaacs/ini   ipaddr.js@1.9.1 MIT whitequark https://github.com/whitequark/ipaddr.js   jsonfile@6.0.1 MIT JP Richardson https://github.com/jprichardson/node-jsonfile   mime-types@2.1.26 MIT no Author https://github.com/jshttp/mime-types   mmmagic@0.5.3 MIT Brian White https://github.com/mscdex/mmmagic   npid@0.4.0 MIT* Mathieu Turcotte https://github.com/MathieuTurcotte/node-pid   ps-node@0.1.6 MIT no Author https://github.com/neekey/ps   simple-parser@0.0.0 ISC no Author no Repository   walk@2.3.14 (MIT OR Apache-2.0) AJ ONeal https://git.coolaj86.com/coolaj86/fs-walk.js   which@2.0.2 ISC Isaac Z. Schlueter https://github.com/isaacs/node-which   wmctrljs@1.1.9 ISC kevin.voyer.developpeur@gmail.com https://github.com/Kmynes/wmctrljs   ws@7.2.3 MIT Einar Otto Stangvik https://github.com/websockets/ws   xwininfo@0.0.0 ISC ashaffer https://github.com/ashaffer/node-xwininfo"},{"location":"about/opensource/#broadcast-service","title":"Broadcast-service","text":"Package Licence Authors Source     http-proxy@1.18.0 MIT Charlie Robbins https://github.com/http-party/node-http-proxy   ws@7.2.3 MIT Einar Otto Stangvik https://github.com/websockets/ws"},{"location":"about/opensource/#file-service","title":"File-Service","text":"Package Licence Authors Source     busboy@0.3.1 MIT Brian White https://github.com/mscdex/busboy   express@4.17.1 MIT TJ Holowaychuk https://github.com/expressjs/express   fs-extra@9.0.0 MIT JP Richardson https://github.com/jprichardson/node-fs-extra   helmet@3.22.0 MIT Adam Baldwin https://github.com/helmetjs/helmet   mime-types@2.1.26 MIT no Author https://github.com/jshttp/mime-types   mkdirp@1.0.4 MIT no Author https://github.com/isaacs/node-mkdirp   urlencode@1.1.0 MIT fengmk2 https://github.com/node-modules/urlencode"},{"location":"about/opensource/#printer-service","title":"Printer-Service","text":"Package Licence Authors Source     chokidar@3.3.1 MIT Paul Miller https://github.com/paulmillr/chokidar   ws@7.2.3 MIT Einar Otto Stangvik https://github.com/websockets/ws"},{"location":"about/opensource/#xterm-service","title":"Xterm-Service","text":"Package Licence Authors Source     xterm.js MIT xtermjs team https://github.com/xtermjs/xterm.js"},{"location":"about/opensource/#filemanager-service","title":"FileManager-Service","text":"Package Licence Authors Source     angular-filemanager-nodejs-bridge@0.1.3 AGPL-3.0 Fabian K\u00f6ster no Repository"},{"location":"about/otherrelatedprojects/","title":"Others related projets","text":"<p>Welcome to the others related projects section, where you can find some projects related to use cloud application inside a web browser. </p> <ul> <li>http://wiki.ros.org/docker/Tutorials/GUI</li> <li>https://github.com/mviereck/x11docker x11docker allows to run graphical desktop applications (and entire desktops) in Docker Linux containers.</li> <li>https://www.digitalocean.com/community/tutorials/how-to-remotely-access-gui-applications-using-docker-and-caddy-on-ubuntu-18-04 By using noVNC and TigerVNC, you can run native applications inside a Docker container and access them remotely using a web browser. </li> <li>HW accelerated GUI apps on Docker Describe How to containerizing a GUI app. Really easy to understand, a good article.</li> <li>https://www.kasmweb.com</li> <li>https://github.com/fcwu/docker-ubuntu-vnc-desktop docker-ubuntu-vnc-desktop is a Docker image to provide web VNC interface to access Ubuntu LXDE/LxQT desktop environment.</li> <li>Dockerize GUI app This project dockerize typical GUI app so that you can visit it in browser. Really good technical solutions.</li> </ul>"},{"location":"about/play_sound_in_docker/","title":"Play sound inside a docker to a web browser","text":""},{"location":"about/play_sound_in_docker/#sound-in-docker-is-the-big-challenge","title":"Sound in docker is the big challenge","text":"<p>As VNC does not support sound, we have to forward a <code>Pulseaudio null-sink</code> output to the user browser, with no latency. </p> <ul> <li> <p>Release 1.0 : use the pulseaudio http stream and play wave data (poor sound quality but works in https only) </p> </li> <li> <p>Release 2.0 : use janus webrtc gateway, send pulseaudio rtp stream to janus, and play sound using the web browser webrtc stack (good sound quality) </p> </li> <li> <p>Release 3.0 : use virtual microphone using gstreamer and pulseaudio</p> </li> </ul> <p>Realy fun projets: use virtual microphone using gstreamer and pulseaudio and Get Pulseaduio sink from webrtc To be implemented</p>"},{"location":"about/play_sound_in_docker/#release-10-pulseaudio-with-a-simple-module-http-protocol-tcp-and-a-javascript-no-latency-wav-stream-player","title":"Release 1.0: Pulseaudio with a simple module-http-protocol-tcp and a javascript no latency wav stream player","text":"<ul> <li> <p>webaudio-wav-stream-player No latency wav stream player using browser fetch streaming API and WebAudio</p> </li> <li> <p>Pulseaudio with module-http-protocol-tcp A proof-of-concept HTTP module, which can be used to introspect the current status of the PulseAudio daemon using HTTP. Just load this module and point your browser to http://localhost:4714/. This module takes the same arguments as module-cli-protocol-tcp.</p> </li> <li> <p>Create Pulseaudio null-sink</p> </li> </ul> <pre><code># defined with desktop 1.0\nload-module module-null-sink sink_name=u8_1_11025 format=u8 channels=1 rate=11025 sink_properties=\"device.description='default format=u8 c=1 ra\nte=11025'\"\n</code></pre> <p>Then use </p> <pre><code>load-module module-http-protocol-tcp\n</code></pre> <p>Read the http stream data, using fetch call :</p> <ul> <li><code>$target</code> is the container Ip Address</li> <li><code>$pulseaudio_http_port</code> is the pulseaudio http port ( by default, the http port vallue is</li> </ul> <pre><code>http://$target:$pulseaudio_http_port/listen/source/u8_1_11025.monitor;\n</code></pre> <p>Pulseaudio module-http-protocol-tcp does not send wav formated header. We need to build a new wav header for each receved fragment. This is done in <code>wavify.js</code> file :</p> <pre><code>//\n// Write a proper WAVE header for the given buffer.\n// format ULAW or ALAW \n// Offset is hardcoded \nfunction wavify_law(data, numberOfChannels, sampleRate, bitsPerSample, format ) {\n\n    // // total header : 4 + 26 + 12 + 8 = 50 \n    // // and the data and size: 50 + 8 ( data + 32 bits for the size )\n    var header_length = 58; // 4 + 26 + 12 + 8 + 8 = 58 \n    var total_length =  header_length + data.byteLength;\n\n    // bitsPerSample MUST BE  8 bits\n\n    // The default byte ordering assumed for WAVE data files is little-endian.\n    var header = new ArrayBuffer(header_length); \n    var d = new DataView(header);\n\n    d.setUint8(0, \"R\".charCodeAt(0)); \n    d.setUint8(1, \"I\".charCodeAt(0));\n    d.setUint8(2, \"F\".charCodeAt(0));\n    d.setUint8(3, \"F\".charCodeAt(0));\n\n    // All integers MUST be set in bigEndian format\n    // Wave chunks containing format information and sampled data\n    // cksize   4   Chunk size: 4+n  \n    // 4: for sizeof( 'WAVE' ) + n \n    // n: Wave chunks containing format information and sampled data\n    //var data_length = d.setUint32(4, data.byteLength / 2 + 44, true);\n    //bitsPerSample data.byteLength + 8+16+12\n    d.setUint32(4, total_length, true); \n\n    // write 4 bytes\n    d.setUint8(8,  \"W\".charCodeAt(0)); \n    d.setUint8(9,  \"A\".charCodeAt(0)); \n    d.setUint8(10, \"V\".charCodeAt(0)); \n    d.setUint8(11, \"E\".charCodeAt(0)); \n\n\n    // write 4 bytes\n    d.setUint8(12, \"f\".charCodeAt(0));\n    d.setUint8(13, \"m\".charCodeAt(0));\n    d.setUint8(14, \"t\".charCodeAt(0));\n    d.setUint8(15, \" \".charCodeAt(0));\n\n\n    // All integers MUST be set in bigEndian format\n\n\n    // Subchunk1Size 16 for PCM.  \n    // Offset 16    \n    // Size 4\n    // This is the size of the rest of the Subchunk which follows this number.\n    // The size of the rest of this subchunk.\n    // All integers MUST be set in bigEndian format\n    // d.setUint32(16, 16, true);\n    // cksize   4   Chunk size: 16, 18 or 40 \n    var chunksize = 18;\n    d.setUint32(16, chunksize, true);\n\n    // The format of the wave data, which will be 1 for uncompressed PCM data.\n    // All integers MUST be set in bigEndian format\n    // FORMAT must be WAVE_FORMAT_ULAW or WAVE_FORMAT_ALAW\n    d.setUint16(20, format, true);\n\n    // Indicates if the data is mono, stereo, or something else.\n    // NumChannels Mono = 1, Stereo = 2, etc.\n    // All integers MUST be set in bigEndian format\n    d.setUint16(22, numberOfChannels, true);\n\n    // The sample rate per second.\n    // SampleRate 8000, 44100, etc.\n    // All integers MUST be set in bigEndian format\n    d.setUint32(24, sampleRate, true);\n\n    // byteRate == SampleRate * NumChannels * BitsPerSample/8\n    // All integers MUST be set in bigEndian format\n    var byteRate = sampleRate * numberOfChannels * bitsPerSample/8;\n    d.setUint32(28, byteRate, true ); \n\n    // blockAlign       == NumChannels * BitsPerSample/8\n    // The number of bytes for one sample including all channels.\n    var blockAlign = numberOfChannels * bitsPerSample / 8; \n     // All integers MUST be set in bigEndian format\n    d.setUint16(32, blockAlign, true ); \n\n    // BitsPerSample    8 bits = 8, 16 bits = 16, etc.\n    d.setUint16(34, bitsPerSample, true);\n\n    // Wave files may include an additional field, usually reserved for non-PCM formats:\n    // bits per Sample \n    // Size of the extension \n    // 2 bytes\n    // Offset \n    var cbSize = 0;\n    d.setUint16(36, cbSize, true);\n\n    d.setUint8(38, \"f\".charCodeAt(0));\n    d.setUint8(39, \"a\".charCodeAt(0));\n    d.setUint8(40, \"c\".charCodeAt(0));\n    d.setUint8(41, \"t\".charCodeAt(0));\n    var cksize = 4;\n    d.setUint32(42, cksize, true);\n    var dwSampleLength = data.byteLength; // Number of samples ( per channel )\n    d.setUint32(46, dwSampleLength, true);\n\n// 50\n    d.setUint8(50, \"d\".charCodeAt(0));\n    d.setUint8(51, \"a\".charCodeAt(0));\n    d.setUint8(52, \"t\".charCodeAt(0));\n    d.setUint8(53, \"a\".charCodeAt(0));\n\n    d.setUint32(54, data.byteLength, true);\n\n//58\n    // data must pad byte 0 or 1 if n is odd\n    return concat(header, data);\n}\n</code></pre> <p>Then use the <code>WavPlayer.js</code> from Julien Bouquillon https://github.com/revolunet/webaudio-wav-stream-player to read data and send to javascript <code>AudioContext()</code></p> <p>This Release is getting glitchy audio. In Chrome, the stream plays with a slight crackle. Read the issue https://github.com/revolunet/webaudio-wav-stream-player/issues/10</p> <p>It works, uses only HTTP protocol but i can't fix the glitchy audio. We find another way to stream sound to web browser device, using the WebRTC stack and RTP pulseaudio.</p>"},{"location":"about/play_sound_in_docker/#release-20-pulseaudio-with-a-webrtc-gateway","title":"Release 2.0: Pulseaudio with a WebRTC gateway","text":""},{"location":"about/play_sound_in_docker/#architecture","title":"Architecture","text":"<ul> <li> <p>Janus WebRTC Gateway with ICE server. Janus act as WebRTC gateway, listen for udp RTP stream from Pulseaudio and forward it to user web browser.</p> </li> <li> <p>Pulseaudio with module-rtp-send Create a null-sink formated alaw and send it to the WebRTC gateway udp port on localhost.</p> </li> </ul> <pre><code>### Load the RTP sender module (also configured via paprefs, see above)\nload-module module-null-sink sink_name=rtp_alaw format=alaw channels=1 rate=8000 sink_properties=\"device.description='RTP Multicast Sink alaw'\"\nload-module module-rtp-send source=rtp_alaw.monitor destination_ip=127.0.0.1 port=5000 channels=1 format=alaw\n</code></pre> <p>Add a RTP stream to Janus WebRTC gateway</p> <pre><code>[pulseaudio-rtp-pcma-8000]\ntype = rtp\nid = 1\ndescription = pcam/8000 live stream coming from pulseaudio\naudio = yes\nvideo = no\naudioport = 5000\naudiopt = 8\naudiortpmap = PCMA/8000\n</code></pre> <p>Read the dedicated webrtc chapter to configure and get more informations about the janus WebRTC</p>"},{"location":"about/version/","title":"Documentation","text":""},{"location":"about/version/#version","title":"Version","text":"<p>The current documentation version is 0.1</p>"},{"location":"about/version/#location","title":"Location","text":"<p>This documentation is located at https://github.com/abcdesktopio/docs</p>"},{"location":"about/version/#installing-make","title":"Installing Make","text":"<p>Install the Make package using apt-get</p> <pre><code>sudo apt-get install make\n</code></pre>"},{"location":"about/version/#installing-mkdocs","title":"Installing MkDocs","text":"<p>Install the mkdocs package using the <code>Makefile</code>:</p> <pre><code>make install\n</code></pre> <p><code>make install</code> command runs :</p> <ul> <li>pip install mkdocs </li> <li>pip install mkdocs-material</li> </ul> <p>Make sure that the pip command is installed on you system.</p>"},{"location":"about/version/#how-to-build-the-documentation","title":"How to build the documentation","text":""},{"location":"about/version/#build-documentation-files","title":"Build documentation files","text":"<pre><code>git clone https://github.com/abcdesktopio/docs\ncd docs\nmake docs\nINFO    -  Cleaning site directory \nINFO    -  Building documentation to directory: /home/alex/src/docs/opsdocs/site \n</code></pre> <p>All HTML files are located in the building documentation directory</p>"},{"location":"about/version/#how-to-view-the-documentation","title":"How to view the documentation","text":""},{"location":"about/version/#serve-documentation-files","title":"Serve documentation files","text":"<pre><code>make serve\nINFO    -  Serving on http://127.0.0.1:8000\nINFO    -  Start watching changes\nINFO    -  Start detecting changes\n</code></pre> <p>Now connect http://127.0.0.1:8000 with any Web Navigator to browse through the documentation.</p>"},{"location":"api/backend/launchdesktop/","title":"Launchdesktop","text":"<p>{\"status\": 200, \"result\": {\"userid\": \"7d2ecad7-2154-4529-85b4-1ab037c29fed\", \"jwt_user_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJleHAiOjE2NjM2ODYyMzEsImF1dGgiOnsicHJvdmlkZXIiOiJhbm9ueW1vdXMiLCJwcm92aWRlcnR5cGUiOiJhbm9ueW1vdXMiLCJkYXRhIjp7ImxhYmVscyI6eyJtYWlzb25hbGV4IjoidHJ1ZSJ9fX0sInVzZXIiOnsibmFtZSI6IkFub255bW91cyIsInVzZXJpZCI6IjdkMmVjYWQ3LTIxNTQtNDUyOS04NWI0LTFhYjAzN2MyOWZlZCIsIm5vZGVob3N0bmFtZSI6bnVsbH0sInJvbGVzIjp7fX0.Lz6PbYz-KPPXJWyBaWuXF60YCQEv9z9Hsr8Ik2rHELBhSAd00eeqrZ0js9aLJ4uHsU1YJQQ2mfupHOpUEgo7AZCJm3HgjJRseWI-ftDV3NJKo2U76Q7RsIZQlSu9O1gK42XL_IkZmB3kLwTv0-Q-3EO6cmL5aP2Nu0nc9gVgxPA\", \"name\": \"Anonymous\", \"provider\": \"anonymous\", \"expire_in\": 14400}, \"message\": \"Authentication successful in 0.01 s\"}</p> <p>https://ocv5.pepins.net/API/composer/launchdesktop</p> <p>{\"status\": 200, \"result\": {\"target_ip\": \"ocv5.pepins.net\", \"vncpassword\": \"gCalVYJoJdI15sI\", \"authorization\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJrZXkiOjAsImhhc2giOiJSdTJmWDAwZW5hSU5OT2dOZ2dCVU1pQ01nQkdrQmZRTnRJSzAweWFXU1FSbUc5dkpiYUFHUXJ5ekpPY0h1QmIyZTRyOXgrMzdINDZZZFlTcThESlZUczdDTXZnamxGajFIZVJ2Y25YNFFCOENkcWFBeE5xTW5XdkMxNVlpNkNtaXlRRmpFYkJlZFlPMWtEazZPNjB6R2wxN3RZZ0kvQ0ZJejdQcVJyL1BHM3c9IiwiZXhwIjoxNjYzNjg1OTI2fQ.is9k5bdUy10_u2MP4Z5tecKFUsdCcS4v_CsnEB6y4dDt4SuKebYz8MA4zCHDpP_Hi13RXVZDW9ax4Crzj0q-WvD_IgPjiz2qdjf7e-2TQ4TbnrqzEngHo6BVkd8vm1vvBE11RGRgufxu6oreGfPxnTtU9ly53sn-j2O3DVR5glA\", \"websocketrouting\": \"http_origin\", \"websockettcpport\": 6081, \"expire_in\": 14400}, \"message\": \"ok\"}</p>"},{"location":"applications/","title":"oc.apps","text":""},{"location":"applications/#to-get-more-informations","title":"To get more informations","text":"<p>Please, read the public documentation web site: * https://www.abcdesktop.io * https://abcdesktopio.github.io/</p>"},{"location":"applications/#abcdesktop-application-dockerfiles","title":"abcdesktop application dockerfiles","text":"<p>DockerFile generator from json file to build applications images  run commands</p> <pre><code>$ make dockerfile\n$ make build\n</code></pre> <p>this command build all generated Dockerfile </p> <p>To build documentation files </p> <pre><code>$ make docs\n</code></pre> <p>this command build all md files, and build list.md</p>"},{"location":"applications/2048-alpine-error/","title":"2048-alpine-error","text":""},{"location":"applications/2048-alpine-error/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine.gtk</p>"},{"location":"applications/2048-alpine-error/#display-name","title":"Display name","text":"<p>\"2048 (alpine gtk) with error\"</p>"},{"location":"applications/2048-alpine-error/#path","title":"path","text":"<p>\"/usr/bin/gnome-2048\"</p>"},{"location":"applications/2048-alpine/","title":"2048-alpine","text":""},{"location":"applications/2048-alpine/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine.gtk</p>"},{"location":"applications/2048-alpine/#display-name","title":"Display name","text":"<p>\"2048 (alpine gtk)\"</p>"},{"location":"applications/2048-alpine/#path","title":"path","text":"<p>\"/usr/bin/gnome-2048\"</p>"},{"location":"applications/2048-ubuntu/","title":"2048-ubuntu","text":""},{"location":"applications/2048-ubuntu/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/2048-ubuntu/#use-ubuntu-package","title":"use ubuntu package","text":"<p>2048-qt</p>"},{"location":"applications/2048-ubuntu/#display-name","title":"Display name","text":"<p>\"2048 (ubuntu qt)\"</p>"},{"location":"applications/2048-ubuntu/#path","title":"path","text":"<p>\"/usr/games/2048-qt\"</p>"},{"location":"applications/2048-ubuntu/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/2048/","title":"2048","text":""},{"location":"applications/2048/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/2048/#use-ubuntu-package","title":"use ubuntu package","text":"<p>2048-qt</p>"},{"location":"applications/2048/#display-name","title":"Display name","text":"<p>\"2048\"</p>"},{"location":"applications/2048/#path","title":"path","text":"<p>\"/usr/games/2048-qt\"</p>"},{"location":"applications/apachedirectorystudio/","title":"apachedirectorystudio","text":""},{"location":"applications/apachedirectorystudio/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.22.04</p>"},{"location":"applications/apachedirectorystudio/#use-ubuntu-package","title":"use ubuntu package","text":"<p>openjdk-11-jre libswt-gtk-4-jni libswt-webkit-gtk-4-jni libswt-cairo-gtk-4-jni libswt-gtk-4-java</p>"},{"location":"applications/apachedirectorystudio/#arguments","title":"Arguments","text":"<p>\"-configuration .eclipse/1988419495_linux_gtk_x86_64\"</p>"},{"location":"applications/apachedirectorystudio/#display-name","title":"Display name","text":"<p>\"Apache Directory Studio\"</p>"},{"location":"applications/apachedirectorystudio/#path","title":"path","text":"<p>\"/usr/local/ApacheDirectoryStudio/ApacheDirectoryStudio\"</p>"},{"location":"applications/apachedirectorystudio/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN curl -sL --output /tmp/ApacheDirectoryStudio.tar.gz https://dlcdn.apache.org/directory/studio/2.0.0.v20210717-M17/ApacheDirectoryStudio-2.0.0.v20210717-M17-linux.gtk.x86_64.tar.gz &amp;&amp; cd /usr/local &amp;&amp; tar -xvf /tmp/ApacheDirectoryStudio.tar.gz &amp;&amp; rm -rf /tmp/ApacheDirectoryStudio.tar.gz,RUN mkdir /.ApacheDirectoryStudio &amp;&amp; chmod 777 /.ApacheDirectoryStudio,COPY composer/init.d/init.ApacheDirectoryStudio /composer/init.d/\n</code></pre>"},{"location":"applications/astromenace/","title":"astromenace","text":""},{"location":"applications/astromenace/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/astromenace/#use-ubuntu-package","title":"use ubuntu package","text":"<p>astromenace</p>"},{"location":"applications/astromenace/#display-name","title":"Display name","text":"<p>\"astromenace\"</p>"},{"location":"applications/astromenace/#path","title":"path","text":"<p>\"/usr/games/AstroMenace\"</p>"},{"location":"applications/atom/","title":"Atom","text":""},{"location":"applications/atom/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/atom/#use-ubuntu-package","title":"use ubuntu package","text":"<p>libxss1 atom aspell</p>"},{"location":"applications/atom/#arguments","title":"Arguments","text":"<p>\"-f\"</p>"},{"location":"applications/atom/#display-name","title":"Display name","text":"<p>\"Atom\"</p>"},{"location":"applications/atom/#path","title":"path","text":"<p>\"/usr/bin/atom\"</p>"},{"location":"applications/atom/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes wget &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install                          --yes libxss1 &amp;&amp; apt-get clean,RUN wget -qO - https://packagecloud.io/AtomEditor/atom/gpgkey | apt-key add -,RUN echo \"deb [arch=amd64] https://packagecloud.io/AtomEditor/atom/any/ any main\" &gt; /etc/apt/sources.list.d/atom.list,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes $(apt-cache search aspell- | awk '{print $1 }') &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>"},{"location":"applications/base/","title":"Base","text":""},{"location":"applications/base/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.libreoffice</p>"},{"location":"applications/base/#arguments","title":"Arguments","text":"<p>\"--base\"</p>"},{"location":"applications/base/#display-name","title":"Display name","text":"<p>\"Base\"</p>"},{"location":"applications/base/#path","title":"path","text":"<p>\"/usr/lib/libreoffice/program/soffice\"</p>"},{"location":"applications/base/#uniquerunkey","title":"uniquerunkey","text":"<p>\"libreoffice\"</p>"},{"location":"applications/base/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.oasis.opendocument.database;application/vnd.sun.xml.base;\"</p>"},{"location":"applications/base/#file-extensions","title":"File extensions","text":"<p>\"odb\"</p>"},{"location":"applications/base/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"odb\"</p>"},{"location":"applications/beekeeperstudio/","title":"beekeeperstudio","text":""},{"location":"applications/beekeeperstudio/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/beekeeperstudio/#arguments","title":"Arguments","text":"<p>\"--no-sandbox\"</p>"},{"location":"applications/beekeeperstudio/#display-name","title":"Display name","text":"<p>\"Beekeeper-studio\"</p>"},{"location":"applications/beekeeperstudio/#path","title":"path","text":"<p>\"/opt/Beekeeper-Studio/beekeeper-studio\"</p>"},{"location":"applications/beekeeperstudio/#file-extensions","title":"File extensions","text":"<p>\"sql\"</p>"},{"location":"applications/beekeeperstudio/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"sql\"</p>"},{"location":"applications/beekeeperstudio/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes libxss1 libasound2 libx11-xcb1 libxcb-dri3-0 libdrm2  libdrm-common libgbm1 &amp;&amp; apt-get clean,RUN curl -Ls https://deb.beekeeperstudio.io/beekeeper.key | apt-key add -,RUN echo \"deb https://deb.beekeeperstudio.io stable main\" | tee /etc/apt/sources.list.d/beekeeper-studio-app.list,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes beekeeper-studio libxshmfence1 &amp;&amp; apt-get clean,RUN mv \"/opt/Beekeeper Studio/\" /opt/Beekeeper-Studio,ENV ELECTRON_ENABLE_LOGGING=true,ENV QT_X11_NO_MITSHM=1\n</code></pre>"},{"location":"applications/blender/","title":"blender","text":""},{"location":"applications/blender/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/blender/#display-name","title":"Display name","text":"<p>\"Blender\"</p>"},{"location":"applications/blender/#path","title":"path","text":"<p>\"/usr/local/blender-2.90.0-linux64/blender\"</p>"},{"location":"applications/blender/#mime-type","title":"Mime Type","text":"<p>\"application/x-blender\"</p>"},{"location":"applications/blender/#file-extensions","title":"File extensions","text":"<p>\"blend,obj,fbx,3ds,ply,stl\"</p>"},{"location":"applications/blender/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes xz-utils wget &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install                          --yes libx11-6 libxi6 libxxf86vm1 libxfixes3 libxrender1 libgl1 &amp;&amp; apt-get clean,RUN wget -O /tmp/blender.tar.xz https://download.blender.org/release/Blender2.90/blender-2.90.0-linux64.tar.xz &amp;&amp; xz -d /tmp/blender.tar.xz &amp;&amp; cd /usr/local &amp;&amp; tar -xvf /tmp/blender.tar &amp;&amp; rm -rf /tmp/blender.tar\n</code></pre>"},{"location":"applications/bless/","title":"Bless","text":""},{"location":"applications/bless/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/bless/#use-ubuntu-package","title":"use ubuntu package","text":"<p>bless</p>"},{"location":"applications/bless/#display-name","title":"Display name","text":"<p>\"Bless\"</p>"},{"location":"applications/bless/#path","title":"path","text":"<p>\"/usr/bin/bless\"</p>"},{"location":"applications/blobby/","title":"blobby","text":""},{"location":"applications/blobby/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/blobby/#use-ubuntu-package","title":"use ubuntu package","text":"<p>blobby</p>"},{"location":"applications/blobby/#display-name","title":"Display name","text":"<p>\"blobby\"</p>"},{"location":"applications/blobby/#path","title":"path","text":"<p>\"/usr/games/blobby\"</p>"},{"location":"applications/brackets/","title":"Brackets","text":""},{"location":"applications/brackets/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.18.04</p>"},{"location":"applications/brackets/#arguments","title":"Arguments","text":"<p>\"--no-sandbox  --disable-gpu\"</p>"},{"location":"applications/brackets/#display-name","title":"Display name","text":"<p>\"Brackets\"</p>"},{"location":"applications/brackets/#path","title":"path","text":"<p>\"/opt/brackets/Brackets\"</p>"},{"location":"applications/brackets/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN curl -Ls -o /tmp/bracket.deb https://github.com/adobe/brackets/releases/download/release-1.14.1/Brackets.Release.1.14.1.64-bit.deb,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes libgtk-3-0 libatk-bridge2.0-0 libx11-6 libxi6 libxxf86vm1 libxfixes3 libxrender1 libgl1 libnss3 qt5dxcb-plugin libxss1 libasound2 libx11-xcb1 libxcb-dri3-0 libdrm2  libdrm-common libgbm1 libasound2-plugins libgail-common libgtk2.0-bin libcurl3 libxss1 &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes /tmp/bracket.deb &amp;&amp; rm /tmp/bracket.deb  &amp;&amp; apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>"},{"location":"applications/calc/","title":"Calc","text":""},{"location":"applications/calc/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.libreoffice</p>"},{"location":"applications/calc/#arguments","title":"Arguments","text":"<p>\"--calc\"</p>"},{"location":"applications/calc/#display-name","title":"Display name","text":"<p>\"Calc\"</p>"},{"location":"applications/calc/#path","title":"path","text":"<p>\"/usr/lib/libreoffice/program/soffice\"</p>"},{"location":"applications/calc/#uniquerunkey","title":"uniquerunkey","text":"<p>\"libreoffice\"</p>"},{"location":"applications/calc/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/calc/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.oasis.opendocument.spreadsheet;application/vnd.oasis.opendocument.spreadsheet-template;application/vnd.sun.xml.calc;application/vnd.sun.xml.calc.template;application/msexcel;application/vnd.ms-excel;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;application/vnd.ms-excel.sheet.macroenabled.12;application/vnd.openxmlformats-officedocument.spreadsheetml.template;application/vnd.ms-excel.template.macroenabled.12;application/vnd.ms-excel.sheet.binary.macroenabled.12;text/csv;application/x-dbf;text/spreadsheet;application/csv;application/excel;application/tab-separated-values;application/vnd.lotus-1-2-3;application/vnd.oasis.opendocument.chart;application/vnd.oasis.opendocument.chart-template;application/x-dbase;application/x-dos_ms_excel;application/x-excel;application/x-msexcel;application/x-ms-excel;application/x-quattropro;application/x-123;text/comma-separated-values;text/tab-separated-values;text/x-comma-separated-values;text/x-csv;application/vnd.oasis.opendocument.spreadsheet-flat-xml;application/vnd.ms-works;application/x-iwork-numbers-sffnumbers;\"</p>"},{"location":"applications/calc/#file-extensions","title":"File extensions","text":"<p>\"ods;ots;sxc;stc;fods;uos;uof;xml;xlsx;xlsm;xltm;xltx;xlsb;xls;xlm;xlc;xlw;xlk;xlt;dif;dbf;htm;html;wk1;wks;123;wb2;rtf;slk;sylk;csv;numbers;dummy;cwk;wps;wk3;wq1;wq2\"</p>"},{"location":"applications/calc/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"ods;ots;csv\"</p>"},{"location":"applications/calculator/","title":"Calculator","text":""},{"location":"applications/calculator/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.elementary</p>"},{"location":"applications/calculator/#use-ubuntu-package","title":"use ubuntu package","text":"<p>pantheon-calculator</p>"},{"location":"applications/calculator/#display-name","title":"Display name","text":"<p>\"Calculator\"</p>"},{"location":"applications/calculator/#path","title":"path","text":"<p>\"/usr/bin/io.elementary.calculator\"</p>"},{"location":"applications/calculator/#mount-home-volume","title":"Mount Home volume","text":"<p>\"False\"</p>"},{"location":"applications/chess/","title":"Chess","text":""},{"location":"applications/chess/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/chess/#use-ubuntu-package","title":"use ubuntu package","text":"<p>dbus-x11 stockfish gnuchess sjeng crafty gnome-chess</p>"},{"location":"applications/chess/#display-name","title":"Display name","text":"<p>\"Chess\"</p>"},{"location":"applications/chess/#path","title":"path","text":"<p>\"/usr/games/gnome-chess\"</p>"},{"location":"applications/chess/#mime-type","title":"Mime Type","text":"<p>\"application/x-chess-pgn\"</p>"},{"location":"applications/chrome/","title":"chrome","text":""},{"location":"applications/chrome/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/chrome/#use-ubuntu-package","title":"use ubuntu package","text":"<p>google-chrome-stable</p>"},{"location":"applications/chrome/#arguments","title":"Arguments","text":"<p>\"-no-sandbox --disable-gpu\"</p>"},{"location":"applications/chrome/#display-name","title":"Display name","text":"<p>\"Chrome\"</p>"},{"location":"applications/chrome/#path","title":"path","text":"<p>\"/usr/bin/google-chrome-stable\"</p>"},{"location":"applications/chrome/#mime-type","title":"Mime Type","text":"<p>\"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;video/webm;\"</p>"},{"location":"applications/chrome/#file-extensions","title":"File extensions","text":"<p>\"html;xml;gif\"</p>"},{"location":"applications/chrome/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"html;xml\"</p>"},{"location":"applications/chrome/#share-size","title":"Share size","text":"<p>\"2gb\"</p>"},{"location":"applications/chrome/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes  wget  &amp;&amp; apt-get clean,RUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -,RUN echo 'deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main' | tee /etc/apt/sources.list.d/google-chrome.list\n</code></pre>"},{"location":"applications/chromium/","title":"chromium","text":""},{"location":"applications/chromium/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/chromium/#use-ubuntu-package","title":"use ubuntu package","text":"<p>krb5-user fonts-noto fonts-roboto xfonts-100dpi fonts-ubuntu fonts-freefont-ttf dbus-x11 fonts-wine chromium-browser</p>"},{"location":"applications/chromium/#arguments","title":"Arguments","text":"<p>\"-no-sandbox --disable-gpu --disable-dev-shm-usage\"</p>"},{"location":"applications/chromium/#display-name","title":"Display name","text":"<p>\"Chromium\"</p>"},{"location":"applications/chromium/#path","title":"path","text":"<p>\"/usr/bin/chromium-browser\"</p>"},{"location":"applications/chromium/#mime-type","title":"Mime Type","text":"<p>\"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;video/webm;\"</p>"},{"location":"applications/chromium/#file-extensions","title":"File extensions","text":"<p>\"html;xml;gif\"</p>"},{"location":"applications/chromium/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"html;xml\"</p>"},{"location":"applications/citrix/","title":"citrix","text":""},{"location":"applications/citrix/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.18.04</p>"},{"location":"applications/citrix/#arguments","title":"Arguments","text":"<p>\"-icaroot /opt/Citrix/ICAClient\"</p>"},{"location":"applications/citrix/#display-name","title":"Display name","text":"<p>\"citrix-client\"</p>"},{"location":"applications/citrix/#path","title":"path","text":"<p>\"/opt/Citrix/ICAClient/wfica\"</p>"},{"location":"applications/citrix/#mime-type","title":"Mime Type","text":"<p>\"application/x-ica;\"</p>"},{"location":"applications/citrix/#pre-run-command","title":"Pre run command","text":"<pre><code>\nCOPY icaclient_amd64.deb /tmp/icaclient_amd64.deb,RUN apt-get install  --no-install-recommends --yes /tmp/icaclient_amd64.deb &amp;&amp; apt-get clean &amp;&amp; rm /tmp/icaclient_amd64.deb\n</code></pre>"},{"location":"applications/cloudfoundry/","title":"cloudFoundry","text":""},{"location":"applications/cloudfoundry/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.fulldev</p>"},{"location":"applications/cloudfoundry/#arguments","title":"Arguments","text":"<p>\"--disable-factory --class pivotalio.cf\"</p>"},{"location":"applications/cloudfoundry/#display-name","title":"Display name","text":"<p>\"Cloud Foundry cli\"</p>"},{"location":"applications/cloudfoundry/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/cmd.exe/","title":"cmd.exe","text":""},{"location":"applications/cmd.exe/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine.minimal</p>"},{"location":"applications/cmd.exe/#display-name","title":"Display name","text":"<p>\"cmd.exe wine (alpine)\"</p>"},{"location":"applications/cmd.exe/#path","title":"path","text":"<p>\"/usr/bin/wineconsole\"</p>"},{"location":"applications/cntlm/","title":"cntlm","text":""},{"location":"applications/cntlm/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/cntlm/#use-ubuntu-package","title":"use ubuntu package","text":"<p>ruby-mustache gnome-terminal dbus-x11 cntlm net-tools vim curl wget</p>"},{"location":"applications/cntlm/#arguments","title":"Arguments","text":"<p>\"--class cntlm -- bash -c '/usr/sbin/cntlm -f -v; exec bash'\"</p>"},{"location":"applications/cntlm/#display-name","title":"Display name","text":"<p>\"cntlm\"</p>"},{"location":"applications/cntlm/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/cntlm/#pre-run-command","title":"PRE run command","text":"<pre><code>\nCOPY cntlm/cntlm.mustache  cntlm/init.cntlm.sh /composer/,COPY composer/init.d/init.gnome-terminal /composer/init.d/\n</code></pre>"},{"location":"applications/cntlm/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/corsix-th/","title":"corsix-th","text":""},{"location":"applications/corsix-th/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.language-pack-all</p>"},{"location":"applications/corsix-th/#use-ubuntu-package","title":"use ubuntu package","text":"<p>libgl1 corsix-th</p>"},{"location":"applications/corsix-th/#display-name","title":"Display name","text":"<p>\"corsix-th\"</p>"},{"location":"applications/corsix-th/#path","title":"path","text":"<p>\"/usr/games/corsix-th\"</p>"},{"location":"applications/corsix-th/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes unzip &amp;&amp; apt-get clean,RUN cd /composer &amp;&amp;  curl -Ls https://th.corsix.org/Demo.zip -o Demo.zip &amp;&amp; unzip Demo.zip &amp;&amp; rm -rf Demo.zip,COPY corsix-th.config.txt /composer/corsix-th.config.txt\n</code></pre>"},{"location":"applications/cuda/","title":"cuda","text":""},{"location":"applications/cuda/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.nvidia.22.04</p>"},{"location":"applications/cuda/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-terminal dbus-x11 git</p>"},{"location":"applications/cuda/#arguments","title":"Arguments","text":"<p>\"--disable-factory  --class=cuda\"</p>"},{"location":"applications/cuda/#display-name","title":"Display name","text":"<p>\"cuda\"</p>"},{"location":"applications/cuda/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/cuda/#pre-run-command","title":"PRE run command","text":""},{"location":"applications/cuda/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/cudademo/","title":"cudademo","text":""},{"location":"applications/cudademo/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.nvidia.22.04</p>"},{"location":"applications/cudademo/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-terminal dbus-x11 git cuda-demo-suite-12-0 libglu1-mesa libxi6 libxinerama1 libxmu6 libglu1-mesa mesa-utils freeglut3 x11-xserver-utils</p>"},{"location":"applications/cudademo/#arguments","title":"Arguments","text":"<p>\"--disable-factory  --class=cudademo -- cd /usr/local/cuda/extras/demo_suite\"</p>"},{"location":"applications/cudademo/#display-name","title":"Display name","text":"<p>\"cuda demo\"</p>"},{"location":"applications/cudademo/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/cudademo/#pre-run-command","title":"PRE run command","text":""},{"location":"applications/cudademo/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/cudadev/","title":"cudadev","text":""},{"location":"applications/cudadev/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.nvidia.22.04</p>"},{"location":"applications/cudadev/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-terminal dbus-x11 git cuda libnvidia-cfg1-525 libnvidia-common-525 libnvidia-compute-525 libnvidia-decode-525 libnvidia-encode-525 libnvidia-extra-525 libnvidia-fbc1-525 git libglu1-mesa libxi6 libxinerama1 libxmu6 libglu1-mesa mesa-utils freeglut3 x11-xserver-utils</p>"},{"location":"applications/cudadev/#arguments","title":"Arguments","text":"<p>\"--disable-factory  --class=cudadev\"</p>"},{"location":"applications/cudadev/#display-name","title":"Display name","text":"<p>\"cuda developper\"</p>"},{"location":"applications/cudadev/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/cudadev/#pre-run-command","title":"PRE run command","text":""},{"location":"applications/cudadev/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/dia/","title":"Dia","text":""},{"location":"applications/dia/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/dia/#use-ubuntu-package","title":"use ubuntu package","text":"<p>dia dia-shapes</p>"},{"location":"applications/dia/#display-name","title":"Display name","text":"<p>\"Dia\"</p>"},{"location":"applications/dia/#path","title":"path","text":"<p>\"/usr/bin/dia\"</p>"},{"location":"applications/dia/#mime-type","title":"Mime Type","text":"<p>\"application/x-dia-diagram;\"</p>"},{"location":"applications/dia/#file-extensions","title":"File extensions","text":"<p>\"dia\"</p>"},{"location":"applications/dia/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"dia\"</p>"},{"location":"applications/doom/","title":"doom","text":""},{"location":"applications/doom/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/doom/#use-ubuntu-package","title":"use ubuntu package","text":"<p>chocolate-doom doom-wad-shareware prboom-plus freedoom prboom-plus</p>"},{"location":"applications/doom/#display-name","title":"Display name","text":"<p>\"Doom\"</p>"},{"location":"applications/doom/#path","title":"path","text":"<p>\"/usr/games/doom\"</p>"},{"location":"applications/draw/","title":"Draw","text":""},{"location":"applications/draw/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.libreoffice</p>"},{"location":"applications/draw/#arguments","title":"Arguments","text":"<p>\"--draw\"</p>"},{"location":"applications/draw/#display-name","title":"Display name","text":"<p>\"Draw\"</p>"},{"location":"applications/draw/#path","title":"path","text":"<p>\"/usr/lib/libreoffice/program/soffice\"</p>"},{"location":"applications/draw/#uniquerunkey","title":"uniquerunkey","text":"<p>\"libreoffice\"</p>"},{"location":"applications/draw/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/draw/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.oasis.opendocument.graphics;application/vnd.oasis.opendocument.graphics-flat-xml;application/vnd.oasis.opendocument.graphics-template;application/vnd.sun.xml.draw;application/vnd.sun.xml.draw.template;application/vnd.visio;application/x-wpg;application/vnd.ms-publisher;image/x-freehand;application/x-pagemaker;\"</p>"},{"location":"applications/draw/#file-extensions","title":"File extensions","text":"<p>\"odp;otg\"</p>"},{"location":"applications/draw/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"odp;otg\"</p>"},{"location":"applications/drawio/","title":"drawio","text":""},{"location":"applications/drawio/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.language-pack-all</p>"},{"location":"applications/drawio/#display-name","title":"Display name","text":"<p>\"drawio\"</p>"},{"location":"applications/drawio/#path","title":"path","text":"<p>\"/opt/drawio/drawio\"</p>"},{"location":"applications/drawio/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.jgraph.mxfile;application/vnd.visio;\"</p>"},{"location":"applications/drawio/#file-extensions","title":"File extensions","text":"<p>\"drawio\"</p>"},{"location":"applications/drawio/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"drawio\"</p>"},{"location":"applications/drawio/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; curl -Ls 'https://github.com/jgraph/drawio-desktop/releases/download/v20.3.0/drawio-amd64-20.3.0.deb' -o /tmp/drawio-amd64.deb &amp;&amp; apt-get install --yes --no-install-recommends /tmp/drawio-amd64.deb &amp;&amp; rm /tmp/drawio-amd64.deb &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>"},{"location":"applications/dummy/","title":"Dummy","text":"<p>dummy</p>"},{"location":"applications/eclipse/","title":"Eclipse","text":""},{"location":"applications/eclipse/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.java.eclipse</p>"},{"location":"applications/eclipse/#display-name","title":"Display name","text":"<p>\"Eclipse\"</p>"},{"location":"applications/eclipse/#path","title":"path","text":"<p>\"/usr/bin/eclipse\"</p>"},{"location":"applications/eclipse_sts4/","title":"Eclipse_Sts4","text":""},{"location":"applications/eclipse_sts4/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.java.sts4</p>"},{"location":"applications/eclipse_sts4/#display-name","title":"Display name","text":"<p>\"Eclipse Sts4\"</p>"},{"location":"applications/eclipse_sts4/#path","title":"path","text":"<p>\"/opt/sts/SpringToolSuite4\"</p>"},{"location":"applications/edge/","title":"edge","text":""},{"location":"applications/edge/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/edge/#use-ubuntu-package","title":"use ubuntu package","text":"<p>fonts-noto fonts-roboto xfonts-100dpi fonts-ubuntu fonts-freefont-ttf fonts-wine</p>"},{"location":"applications/edge/#arguments","title":"Arguments","text":"<p>\"--no-sandbox --disable-gpu --disable-dev-shm-usage\"</p>"},{"location":"applications/edge/#display-name","title":"Display name","text":"<p>\"MicrosoftEdge\"</p>"},{"location":"applications/edge/#path","title":"path","text":"<p>\"/usr/bin/microsoft-edge\"</p>"},{"location":"applications/edge/#mime-type","title":"Mime Type","text":"<p>\"application/pdf;application/rdf+xml;application/rss+xml;application/xhtml+xml;application/xhtml_xml;application/xml;image/gif;image/jpeg;image/png;image/webp;text/html;text/xml;x-scheme-handler/http;x-scheme-handler/https;\"</p>"},{"location":"applications/edge/#file-extensions","title":"File extensions","text":"<p>\"html;xml;gif\"</p>"},{"location":"applications/edge/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"html;xml\"</p>"},{"location":"applications/edge/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN curl https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o /usr/share/keyrings/microsoft-archive-keyring.gpg,RUN echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/microsoft-archive-keyring.gpg] https://packages.microsoft.com/repos/edge stable main\" &gt; /etc/apt/sources.list.d/edge.list,RUN apt update &amp;&amp; apt install -y microsoft-edge-stable &amp;&amp; apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>"},{"location":"applications/elementary.terminal/","title":"elementary.terminal","text":""},{"location":"applications/elementary.terminal/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.elementary</p>"},{"location":"applications/elementary.terminal/#use-ubuntu-package","title":"use ubuntu package","text":"<p>io.elementary.terminal io.elementary.stylesheet</p>"},{"location":"applications/elementary.terminal/#display-name","title":"Display name","text":"<p>\"elementary.terminal\"</p>"},{"location":"applications/elementary.terminal/#path","title":"path","text":"<p>\"/usr/bin/io.elementary.terminal\"</p>"},{"location":"applications/eog/","title":"eog","text":""},{"location":"applications/eog/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/eog/#use-ubuntu-package","title":"use ubuntu package","text":"<p>eog</p>"},{"location":"applications/eog/#display-name","title":"Display name","text":"<p>\"eog\"</p>"},{"location":"applications/eog/#path","title":"path","text":"<p>\"/usr/bin/eog\"</p>"},{"location":"applications/eog/#mime-type","title":"Mime Type","text":"<p>\"image/bmp;image/gif;image/x-pcx;image/x-portable-anymap;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-tga;image/x-xbitmap;image/jpeg;image/png;image/x-icon;image/x-xpixmap;image/x-xcursor;\"</p>"},{"location":"applications/eog/#file-extensions","title":"File extensions","text":"<p>\"ani;bmp;gif;ico;jpg;jpeg;pcx;png;pnm;ras;svg;tga;tif;tiff;wbmp;xbm;xpm\"</p>"},{"location":"applications/eog/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"ani;bmp;gif;ico;jpg;jpeg;pcx;png;pnm;ras;svg;tga;tif;tiff;wbmp;xbm;xpm\"</p>"},{"location":"applications/evince/","title":"Evince","text":""},{"location":"applications/evince/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/evince/#use-ubuntu-package","title":"use ubuntu package","text":"<p>evince</p>"},{"location":"applications/evince/#display-name","title":"Display name","text":"<p>\"Evince\"</p>"},{"location":"applications/evince/#path","title":"path","text":"<p>\"/usr/bin/evince\"</p>"},{"location":"applications/evince/#mime-type","title":"Mime Type","text":"<p>\"application/pdf;application/x-bzpdf;application/x-gzpdf;application/x-xzpdf;application/x-ext-pdf;application/postscript;application/x-bzpostscript;application/x-gzpostscript;image/x-eps;image/x-bzeps;image/x-gzeps;application/x-ext-ps;application/x-ext-eps;application/x-dvi;application/x-bzdvi;application/x-gzdvi;application/x-ext-dvi;image/vnd.djvu;application/x-ext-djv;application/x-ext-djvu;image/tiff;application/x-cbr;application/x-cbz;application/x-cb7;application/x-cbt;application/x-ext-cbr;application/x-ext-cbz;application/x-ext-cb7;application/x-ext-cbt;application/oxps;application/vnd.ms-xpsdocument;\"</p>"},{"location":"applications/evince/#file-extensions","title":"File extensions","text":"<p>\"pdf;ps;dvi;eps;cbt;cbr;cb7;xps\"</p>"},{"location":"applications/evince/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"pdf;ps;dvi\"</p>"},{"location":"applications/evolution/","title":"Evolution","text":""},{"location":"applications/evolution/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/evolution/#use-ubuntu-package","title":"use ubuntu package","text":"<p>evolution</p>"},{"location":"applications/evolution/#display-name","title":"Display name","text":"<p>\"Evolution\"</p>"},{"location":"applications/evolution/#path","title":"path","text":"<p>\"/usr/bin/evolution\"</p>"},{"location":"applications/evolution/#mime-type","title":"Mime Type","text":"<p>\"text/calendar;text/x-vcard;text/directory;application/mbox;message/rfc822;x-scheme-handler/mailto;\"</p>"},{"location":"applications/file-roller/","title":"file-roller","text":""},{"location":"applications/file-roller/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/file-roller/#use-ubuntu-package","title":"use ubuntu package","text":"<p>file-roller</p>"},{"location":"applications/file-roller/#display-name","title":"Display name","text":"<p>\"file-roller\"</p>"},{"location":"applications/file-roller/#path","title":"path","text":"<p>\"/usr/bin/file-roller\"</p>"},{"location":"applications/file-roller/#mime-type","title":"Mime Type","text":"<p>\"application/x-7z-compressed;application/gzip;application/gtar;application/tar;application/zip;application/x-compress;application/x-compressed;application/x-zip-compressed;multipart/x-zip;application/gnutar;application/x-lzx;application/lzx;application/x-gzip;application/x-gtar;application/x-bzip2;application/x-bzip;application/x-bzip2;\"</p>"},{"location":"applications/file-roller/#file-extensions","title":"File extensions","text":"<p>\"7z;7zip;Z;unzip;zip;tar;tgz;war;tar.gz;ar;bcz;cpio;ear;jar;iso;tar.Z;tar.gz;tar.lz;tar.lzma;tar.lzo;tar.xz\"</p>"},{"location":"applications/filelight/","title":"filelight","text":""},{"location":"applications/filelight/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/filelight/#use-ubuntu-package","title":"use ubuntu package","text":"<p>filelight</p>"},{"location":"applications/filelight/#display-name","title":"Display name","text":"<p>\"Filelight\"</p>"},{"location":"applications/filelight/#path","title":"path","text":"<p>\"/usr/bin/filelight\"</p>"},{"location":"applications/filelight/#mime-type","title":"Mime Type","text":"<p>\"inode/directory;\"</p>"},{"location":"applications/filezilla/","title":"filezilla","text":""},{"location":"applications/filezilla/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine.gtk</p>"},{"location":"applications/filezilla/#display-name","title":"Display name","text":"<p>\"filezilla (alpine)\"</p>"},{"location":"applications/filezilla/#path","title":"path","text":"<p>\"/usr/bin/filezilla\"</p>"},{"location":"applications/firefox-esr/","title":"firefox-esr","text":""},{"location":"applications/firefox-esr/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/firefox-esr/#arguments","title":"Arguments","text":"<p>\"-new-instance -P abcdesktop-firefox-esr --class firefox-esr\"</p>"},{"location":"applications/firefox-esr/#display-name","title":"Display name","text":"<p>\"Firefox-esr\"</p>"},{"location":"applications/firefox-esr/#path","title":"path","text":"<p>\"/usr/bin/firefox-esr\"</p>"},{"location":"applications/firefox-esr/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/firefox-esr/#mime-type","title":"Mime Type","text":"<p>\"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;x-scheme-handler/http;x-scheme-handler/https;x-scheme-handler/ftp;video/webm;application/x-xpinstall;\"</p>"},{"location":"applications/firefox-esr/#file-extensions","title":"File extensions","text":"<p>\"htm;html;xml;gif\"</p>"},{"location":"applications/firefox-esr/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"htm;html;xml\"</p>"},{"location":"applications/firefox-esr/#share-size","title":"Share size","text":"<p>\"2gb\"</p>"},{"location":"applications/firefox-esr/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN add-apt-repository -y ppa:mozillateam/ppa,RUN DEBIAN_FRONTEND=noninteractive echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | debconf-set-selections,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes ttf-mscorefonts-installer ttf-bitstream-vera ttf-dejavu ttf-xfree86-nonfree,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes winbind firefox-esr $(apt-cache search firefox-esr-locale | awk '{print $1 }') &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes flashplugin-installer ubuntu-restricted-extras libavc1394-0 &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes libasound2-plugins libgail-common libgtk2.0-bin chromium-codecs-ffmpeg-extra gstreamer1.0-libav gstreamer1.0-plugins-ugly gstreamer1.0-vaapi libavcodec-extra &amp;&amp; apt-get clean,COPY composer/init.d/init.firefox-esr /composer/init.d/init.firefox-esr,COPY policies.json /usr/lib/firefox-esr/distribution,COPY /ntlm_auth /usr/bin/ntlm_auth.desktop,RUN chown root:root /usr/bin/ntlm_auth.desktop &amp;&amp; chmod 111 /usr/bin/ntlm_auth.desktop\n</code></pre>"},{"location":"applications/firefox/","title":"Firefox","text":""},{"location":"applications/firefox/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/firefox/#display-name","title":"Display name","text":"<p>\"Firefox\"</p>"},{"location":"applications/firefox/#path","title":"path","text":"<p>\"/usr/bin/firefox\"</p>"},{"location":"applications/firefox/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/firefox/#mime-type","title":"Mime Type","text":"<p>\"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;x-scheme-handler/http;x-scheme-handler/https;x-scheme-handler/ftp;video/webm;application/x-xpinstall;\"</p>"},{"location":"applications/firefox/#file-extensions","title":"File extensions","text":"<p>\"htm;html;xml;gif\"</p>"},{"location":"applications/firefox/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"htm;html;xml\"</p>"},{"location":"applications/firefox/#share-size","title":"Share size","text":"<p>\"2gb\"</p>"},{"location":"applications/firefox/#memory-size","title":"Memory size","text":"<p>\"16gb\"</p>"},{"location":"applications/firefox/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN DEBIAN_FRONTEND=noninteractive echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | debconf-set-selections,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes ttf-mscorefonts-installer ttf-bitstream-vera ttf-dejavu ttf-xfree86-nonfree &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes winbind firefox $(apt-cache search firefox-locale | awk '{print $1 }') &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes flashplugin-installer ubuntu-restricted-extras libavc1394-0 &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes libasound2-plugins libgail-common libgtk2.0-bin chromium-codecs-ffmpeg-extra gstreamer1.0-libav gstreamer1.0-plugins-ugly gstreamer1.0-vaapi libavcodec-extra &amp;&amp; apt-get clean,COPY composer/init.d/init.firefox /composer/init.d/init.firefox,COPY policies.json /usr/lib/firefox/distribution,COPY /ntlm_auth /usr/bin/ntlm_auth.desktop,RUN chown root:root /usr/bin/ntlm_auth.desktop &amp;&amp; chmod 111 /usr/bin/ntlm_auth.desktop,ENV NSS_SDB_USE_CACHE=yes\n</code></pre>"},{"location":"applications/firefoxrest/","title":"FirefoxRest","text":""},{"location":"applications/firefoxrest/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.firefox.rest</p>"},{"location":"applications/firefoxrest/#use-ubuntu-package","title":"use ubuntu package","text":"<p>firefox winbind</p>"},{"location":"applications/firefoxrest/#arguments","title":"Arguments","text":"<p>\"--class=Rest.Firefox\"</p>"},{"location":"applications/firefoxrest/#display-name","title":"Display name","text":"<p>\"Firefox-Rest\"</p>"},{"location":"applications/firefoxrest/#path","title":"path","text":"<p>\"/usr/bin/firefox\"</p>"},{"location":"applications/firefoxrest/#mime-type","title":"Mime Type","text":"<p>\"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;x-scheme-handler/http;x-scheme-handler/https;x-scheme-handler/ftp;video/webm;application/x-xpinstall;\"</p>"},{"location":"applications/firefoxrest/#file-extensions","title":"File extensions","text":"<p>\"html;xml;gif\"</p>"},{"location":"applications/firefoxrest/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"html;xml\"</p>"},{"location":"applications/firefoxrest/#pre-run-command","title":"Pre run command","text":"<pre><code>\nCOPY composer/init.d/init.firefox /composer/init.d/init.firefox\n</code></pre>"},{"location":"applications/flare/","title":"flare","text":""},{"location":"applications/flare/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.language-pack-all</p>"},{"location":"applications/flare/#use-ubuntu-package","title":"use ubuntu package","text":"<p>flare-game</p>"},{"location":"applications/flare/#arguments","title":"Arguments","text":"<p>\"--game=flare-game\"</p>"},{"location":"applications/flare/#display-name","title":"Display name","text":"<p>\"flare\"</p>"},{"location":"applications/flare/#path","title":"path","text":"<p>\"/usr/games/flare\"</p>"},{"location":"applications/frozen-bubble/","title":"frozen-bubble","text":""},{"location":"applications/frozen-bubble/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/frozen-bubble/#use-ubuntu-package","title":"use ubuntu package","text":"<p>frozen-bubble</p>"},{"location":"applications/frozen-bubble/#display-name","title":"Display name","text":"<p>\"frozen-bubble\"</p>"},{"location":"applications/frozen-bubble/#path","title":"path","text":"<p>\"/usr/games/frozen-bubble\"</p>"},{"location":"applications/gcompris/","title":"GCompris","text":""},{"location":"applications/gcompris/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/gcompris/#use-ubuntu-package","title":"use ubuntu package","text":"<p>qt5-default qml-module-qtquick-controls libqt5svg5 libqt5xmlpatterns5 libqt5sensors5 qml-module-qtquick-particles2 qml-module-qtmultimedia libqt5multimedia5-plugins gcompris-qt</p>"},{"location":"applications/gcompris/#display-name","title":"Display name","text":"<p>\"GCompris\"</p>"},{"location":"applications/gcompris/#path","title":"path","text":"<p>\"/usr/games/gcompris-qt\"</p>"},{"location":"applications/gedit/","title":"Gedit","text":""},{"location":"applications/gedit/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/gedit/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gedit</p>"},{"location":"applications/gedit/#display-name","title":"Display name","text":"<p>\"Gedit\"</p>"},{"location":"applications/gedit/#path","title":"path","text":"<p>\"/usr/bin/gedit\"</p>"},{"location":"applications/gedit/#mime-type","title":"Mime Type","text":"<p>\"text/plain;\"</p>"},{"location":"applications/gedit/#file-extensions","title":"File extensions","text":"<p>\"txt\"</p>"},{"location":"applications/gedit/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"txt\"</p>"},{"location":"applications/gelemental/","title":"gElemental","text":""},{"location":"applications/gelemental/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/gelemental/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gelemental</p>"},{"location":"applications/gelemental/#display-name","title":"Display name","text":"<p>\"gElemental\"</p>"},{"location":"applications/gelemental/#path","title":"path","text":"<p>\"/usr/bin/gelemental\"</p>"},{"location":"applications/geogebra/","title":"Geogebra","text":""},{"location":"applications/geogebra/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/geogebra/#use-ubuntu-package","title":"use ubuntu package","text":"<p>geogebra</p>"},{"location":"applications/geogebra/#display-name","title":"Display name","text":"<p>\"Geogebra\"</p>"},{"location":"applications/geogebra/#path","title":"path","text":"<p>\"/usr/bin/geogebra\"</p>"},{"location":"applications/geogebra/#file-extensions","title":"File extensions","text":"<p>\"ggb;ggt\"</p>"},{"location":"applications/geogebra/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"ggb;ggt\"</p>"},{"location":"applications/gephi/","title":"gephi","text":""},{"location":"applications/gephi/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.java.gephi</p>"},{"location":"applications/gephi/#display-name","title":"Display name","text":"<p>\"Gephi\"</p>"},{"location":"applications/gephi/#path","title":"path","text":"<p>\"/opt/gephi-0.9.1/bin/gephi\"</p>"},{"location":"applications/gimagereader/","title":"gimagereader","text":""},{"location":"applications/gimagereader/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.gimagereader</p>"},{"location":"applications/gimagereader/#display-name","title":"Display name","text":"<p>\"OCR-gimagereader\"</p>"},{"location":"applications/gimagereader/#path","title":"path","text":"<p>\"/usr/bin/gimagereader-gtk\"</p>"},{"location":"applications/gimagereader/#mime-type","title":"Mime Type","text":"<p>\"image/bmp;image/jpeg;image/gif;image/png;image/tiff;image/x-bmp;image/x-ico;image/x-png;image/x-pcx;image/x-tga;image/xpm;image/svg+xml;\"</p>"},{"location":"applications/gimagereader/#file-extensions","title":"File extensions","text":"<p>\"bmp;jpeg;png,tiff,tga\"</p>"},{"location":"applications/gimp/","title":"Gimp","text":""},{"location":"applications/gimp/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/gimp/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gimp</p>"},{"location":"applications/gimp/#display-name","title":"Display name","text":"<p>\"Gimp\"</p>"},{"location":"applications/gimp/#path","title":"path","text":"<p>\"/usr/bin/gimp\"</p>"},{"location":"applications/gimp/#mime-type","title":"Mime Type","text":"<p>\"image/bmp;image/g3fax;image/gif;image/x-fits;image/x-pcx;image/x-portable-anymap;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-psd;image/x-sgi;image/x-tga;image/x-xbitmap;image/x-xwindowdump;image/x-xcf;image/x-compressed-xcf;image/x-gimp-gbr;image/x-gimp-pat;image/x-gimp-gih;image/jpeg;image/x-psp;image/png;image/x-icon;image/x-xpixmap;image/x-wmf;image/jp2;image/jpeg2000;image/jpx;image/x-xcursor;\"</p>"},{"location":"applications/gimp/#file-extensions","title":"File extensions","text":"<p>\"dds\"</p>"},{"location":"applications/gimp/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"dds\"</p>"},{"location":"applications/gnumeric/","title":"Gnumeric","text":""},{"location":"applications/gnumeric/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/gnumeric/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnumeric</p>"},{"location":"applications/gnumeric/#display-name","title":"Display name","text":"<p>\"Gnumeric\"</p>"},{"location":"applications/gnumeric/#path","title":"path","text":"<p>\"/usr/bin/gnumeric\"</p>"},{"location":"applications/gnumeric/#mime-type","title":"Mime Type","text":"<p>\"application/x-gnumeric;application/x-oleo;application/x-planperfect;application/x-sc;application/x-sylk;application/x-xbase;\"</p>"},{"location":"applications/gnumeric/#file-extensions","title":"File extensions","text":"<p>\"gnm\"</p>"},{"location":"applications/gnumeric/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"gnm\"</p>"},{"location":"applications/golly/","title":"Golly","text":""},{"location":"applications/golly/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/golly/#use-ubuntu-package","title":"use ubuntu package","text":"<p>golly</p>"},{"location":"applications/golly/#display-name","title":"Display name","text":"<p>\"Golly\"</p>"},{"location":"applications/golly/#path","title":"path","text":"<p>\"/usr/games/golly\"</p>"},{"location":"applications/gretl/","title":"Gretl","text":""},{"location":"applications/gretl/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/gretl/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gretl</p>"},{"location":"applications/gretl/#display-name","title":"Display name","text":"<p>\"Gretl\"</p>"},{"location":"applications/gretl/#path","title":"path","text":"<p>\"/usr/bin/gretl\"</p>"},{"location":"applications/hyper/","title":"hyper","text":""},{"location":"applications/hyper/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/hyper/#display-name","title":"Display name","text":"<p>\"hyper\"</p>"},{"location":"applications/hyper/#path","title":"path","text":"<p>\"/opt/Hyper/hyper\"</p>"},{"location":"applications/hyper/#mime-type","title":"Mime Type","text":"<p>\"x-scheme-handler/ssh\"</p>"},{"location":"applications/hyper/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes wget &amp;&amp; apt-get clean,RUN wget -O /tmp/hyper.deb  https://releases.hyper.is/download/deb &amp;&amp; apt-get install  --no-install-recommends --yes /tmp/hyper.deb &amp;&amp; apt-get clean &amp;&amp; rm -rf /tmp/hyper.deb\n</code></pre>"},{"location":"applications/impress/","title":"Impress","text":""},{"location":"applications/impress/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.libreoffice</p>"},{"location":"applications/impress/#arguments","title":"Arguments","text":"<p>\"--impress\"</p>"},{"location":"applications/impress/#display-name","title":"Display name","text":"<p>\"Impress\"</p>"},{"location":"applications/impress/#path","title":"path","text":"<p>\"/usr/lib/libreoffice/program/soffice\"</p>"},{"location":"applications/impress/#uniquerunkey","title":"uniquerunkey","text":"<p>\"libreoffice\"</p>"},{"location":"applications/impress/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/impress/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.oasis.opendocument.presentation;application/vnd.oasis.opendocument.presentation-template;application/vnd.sun.xml.impress;application/vnd.sun.xml.impress.template;application/mspowerpoint;application/vnd.ms-powerpoint;application/vnd.openxmlformats-officedocument.presentationml.presentation;application/vnd.ms-powerpoint.presentation.macroenabled.12;application/vnd.openxmlformats-officedocument.presentationml.template;application/vnd.ms-powerpoint.template.macroenabled.12;application/vnd.openxmlformats-officedocument.presentationml.slide;application/vnd.openxmlformats-officedocument.presentationml.slideshow;application/vnd.ms-powerpoint.slideshow.macroenabled.12;application/vnd.oasis.opendocument.presentation-flat-xml;application/x-iwork-keynote-sffkey;\"</p>"},{"location":"applications/impress/#file-extensions","title":"File extensions","text":"<p>\"odp;pot;potm;potx;pps;ppsx;ppt;pptx;pptm\"</p>"},{"location":"applications/impress/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"odp\"</p>"},{"location":"applications/inkscape/","title":"Inkscape","text":""},{"location":"applications/inkscape/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/inkscape/#use-ubuntu-package","title":"use ubuntu package","text":"<p>numix-gtk-theme gtk2-engines gtk2-engines-pixbuf libgtk2.0-0 inkscape</p>"},{"location":"applications/inkscape/#display-name","title":"Display name","text":"<p>\"Inkscape\"</p>"},{"location":"applications/inkscape/#path","title":"path","text":"<p>\"/usr/bin/inkscape\"</p>"},{"location":"applications/inkscape/#mime-type","title":"Mime Type","text":"<p>\"image/svg+xml;image/svg+xml-compressed;application/vnd.corel-draw;application/illustrator;\"</p>"},{"location":"applications/inkscape/#file-extensions","title":"File extensions","text":"<p>\"ai;cdr\"</p>"},{"location":"applications/inkscape/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"ai;cdr\"</p>"},{"location":"applications/jupyter/","title":"jupyter","text":""},{"location":"applications/jupyter/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.20.04</p>"},{"location":"applications/jupyter/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-terminal openssh-client telnet netcat sshcommand sshfs ftp-ssl wput curl wget tftp ncftp git git-ftp ftp dbus-x11</p>"},{"location":"applications/jupyter/#arguments","title":"Arguments","text":"<p>\"--disable-factory  --class=jupyter -- /usr/local/bin/startjupyter.sh\"</p>"},{"location":"applications/jupyter/#display-name","title":"Display name","text":"<p>\"jupyter\"</p>"},{"location":"applications/jupyter/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/jupyter/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/jupyter/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN add-apt-repository ppa:mozillateam/ppa,COPY etc/apt/preferences.d/mozilla-firefox /etc/apt/preferences.d/mozilla-firefox,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes firefox &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes sudo &amp;&amp; apt-get clean,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes build-essential python3.9 python3-pip python-is-python3 curl libcurl4-openssl-dev libssl-dev firefox wget &amp;&amp; apt-get clean,RUN pip3 install torch,RUN pip3 install jupyterlab,RUN pip install jupyterlab-nvdashboard,RUN # jupyter labextension install jupyterlab-nvdashboard\n</code></pre>"},{"location":"applications/jupyter/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/jupyternvidia/","title":"jupyternvidia","text":""},{"location":"applications/jupyternvidia/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.nvidia.22.04</p>"},{"location":"applications/jupyternvidia/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-terminal openssh-client telnet netcat sshcommand sshfs ftp-ssl wput curl wget tftp ncftp git git-ftp ftp dbus-x11</p>"},{"location":"applications/jupyternvidia/#arguments","title":"Arguments","text":"<p>\"--disable-factory  --class=jupyternvidia -- /usr/local/bin/startjupyter.sh\"</p>"},{"location":"applications/jupyternvidia/#display-name","title":"Display name","text":"<p>\"jupyter nvidia\"</p>"},{"location":"applications/jupyternvidia/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/jupyternvidia/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/jupyternvidia/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN add-apt-repository ppa:mozillateam/ppa,COPY etc/apt/preferences.d/mozilla-firefox /etc/apt/preferences.d/mozilla-firefox,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes firefox wget sudo &amp;&amp; apt-get clean,COPY cudnn-local-repo-ubuntu2204-8.7.0.84_1.0-1_amd64.deb /tmp,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes -f /tmp/cudnn-local-repo-ubuntu2204-8.7.0.84_1.0-1_amd64.deb &amp;&amp; apt-get clean,RUN cp /var/cudnn-local-repo-ubuntu2204-8.7.0.84/cudnn-local-BF23AD8A-keyring.gpg /usr/share/keyrings/,ENV PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin,ENV LD_LIBRARY_PATH=/usr/local/cuda-12.0/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes build-essential python3.9 python3-pip python-is-python3 libcurl4-openssl-dev libssl-dev wget &amp;&amp; apt-get clean,RUN # wget https://repo.anaconda.com/archive/Anaconda3-2022.10-Linux-x86_64.sh -O /tmp/anaconda3.sh &amp;&amp; bash /tmp/anaconda3.sh -b -p /usr/local/anaconda,RUN pip3 install torch,RUN pip3 install tensorflow-gpu,RUN pip3 install jupyter notebook,RUN pip3 install jupyterlab,RUN pip3 install jupyterlab-nvdashboard,RUN # jupyter labextension install jupyterlab-nvdashboard\n</code></pre>"},{"location":"applications/jupyternvidia/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/kalzium/","title":"Kalzium","text":""},{"location":"applications/kalzium/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/kalzium/#use-ubuntu-package","title":"use ubuntu package","text":"<p>kalzium</p>"},{"location":"applications/kalzium/#display-name","title":"Display name","text":"<p>\"Kalzium\"</p>"},{"location":"applications/kalzium/#path","title":"path","text":"<p>\"/usr/bin/kalzium\"</p>"},{"location":"applications/kdiamond/","title":"kDiamond","text":""},{"location":"applications/kdiamond/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/kdiamond/#use-ubuntu-package","title":"use ubuntu package","text":"<p>dbus-x11 dbus-user-session kdiamond</p>"},{"location":"applications/kdiamond/#display-name","title":"Display name","text":"<p>\"kDiamond\"</p>"},{"location":"applications/kdiamond/#path","title":"path","text":"<p>\"/usr/games/kdiamond\"</p>"},{"location":"applications/kgeography/","title":"Kgeography","text":""},{"location":"applications/kgeography/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/kgeography/#use-ubuntu-package","title":"use ubuntu package","text":"<p>kgeography</p>"},{"location":"applications/kgeography/#display-name","title":"Display name","text":"<p>\"Kgeography\"</p>"},{"location":"applications/kgeography/#path","title":"path","text":"<p>\"/usr/bin/kgeography\"</p>"},{"location":"applications/kigo/","title":"kigo","text":""},{"location":"applications/kigo/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/kigo/#use-ubuntu-package","title":"use ubuntu package","text":"<p>dbus-x11 dbus-user-session gnugo kigo</p>"},{"location":"applications/kigo/#display-name","title":"Display name","text":"<p>\"kigo\"</p>"},{"location":"applications/kigo/#path","title":"path","text":"<p>\"/usr/games/kigo\"</p>"},{"location":"applications/kigo/#mime-type","title":"Mime Type","text":"<p>\"application/x-go-sgf;\"</p>"},{"location":"applications/kigo/#pre-run-command","title":"Pre run command","text":"<pre><code>\nCOPY composer/init.d/init.kigo /composer/init.d/init.kigo\n</code></pre>"},{"location":"applications/klickety/","title":"Klickety","text":""},{"location":"applications/klickety/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/klickety/#use-ubuntu-package","title":"use ubuntu package","text":"<p>breeze-icon-theme dbus-x11 dbus-user-session klickety</p>"},{"location":"applications/klickety/#display-name","title":"Display name","text":"<p>\"Klickety\"</p>"},{"location":"applications/klickety/#path","title":"path","text":"<p>\"/usr/games/klickety\"</p>"},{"location":"applications/klotski/","title":"Klotski","text":""},{"location":"applications/klotski/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/klotski/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-klotski</p>"},{"location":"applications/klotski/#display-name","title":"Display name","text":"<p>\"Klotski\"</p>"},{"location":"applications/klotski/#path","title":"path","text":"<p>\"/usr/games/gnome-klotski\"</p>"},{"location":"applications/konsole/","title":"konsole","text":""},{"location":"applications/konsole/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine</p>"},{"location":"applications/konsole/#display-name","title":"Display name","text":"<p>\"konsole\"</p>"},{"location":"applications/konsole/#path","title":"path","text":"<p>\"/usr/bin/konsole\"</p>"},{"location":"applications/konsole/#post-run-command","title":"POST run command","text":"<pre><code>\nundefined\n</code></pre>"},{"location":"applications/ksquares/","title":"kSquares","text":""},{"location":"applications/ksquares/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/ksquares/#use-ubuntu-package","title":"use ubuntu package","text":"<p>dbus-x11 dbus-user-session ksquares</p>"},{"location":"applications/ksquares/#display-name","title":"Display name","text":"<p>\"kSquares\"</p>"},{"location":"applications/ksquares/#path","title":"path","text":"<p>\"/usr/games/ksquares\"</p>"},{"location":"applications/kturtle/","title":"kTurtle","text":""},{"location":"applications/kturtle/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/kturtle/#use-ubuntu-package","title":"use ubuntu package","text":"<p>kturtle</p>"},{"location":"applications/kturtle/#display-name","title":"Display name","text":"<p>\"kTurtle\"</p>"},{"location":"applications/kturtle/#path","title":"path","text":"<p>\"/usr/bin/kturtle\"</p>"},{"location":"applications/leocad/","title":"Leocad","text":""},{"location":"applications/leocad/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/leocad/#use-ubuntu-package","title":"use ubuntu package","text":"<p>leocad</p>"},{"location":"applications/leocad/#arguments","title":"Arguments","text":"<p>\"-l /usr/bin/leocad.library.bin\"</p>"},{"location":"applications/leocad/#display-name","title":"Display name","text":"<p>\"Leocad\"</p>"},{"location":"applications/leocad/#path","title":"path","text":"<p>\"/usr/bin/leocad\"</p>"},{"location":"applications/leocad/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.leocad;application/x-ldraw;application/x-multi-part-ldraw;application/x-ldlite;\"</p>"},{"location":"applications/leocad/#file-extensions","title":"File extensions","text":"<p>\"lcd\"</p>"},{"location":"applications/leocad/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"lcd\"</p>"},{"location":"applications/librecad/","title":"LibreCAD","text":""},{"location":"applications/librecad/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/librecad/#use-ubuntu-package","title":"use ubuntu package","text":"<p>librecad</p>"},{"location":"applications/librecad/#display-name","title":"Display name","text":"<p>\"LibreCAD\"</p>"},{"location":"applications/librecad/#path","title":"path","text":"<p>\"/usr/bin/librecad\"</p>"},{"location":"applications/librecad/#mime-type","title":"Mime Type","text":"<p>\"image/vnd.dxf;\"</p>"},{"location":"applications/librecad/#file-extensions","title":"File extensions","text":"<p>\"dxf;dwg\"</p>"},{"location":"applications/librecad/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"dxf;dwg\"</p>"},{"location":"applications/list/","title":"Application list","text":"<p>This array describe the application list ready to use with abcdesktop.</p>    icon displayname description file md      2048 no description found 2048.md    astromenace hardcore 3D space shooter with spaceship upgrade possibilities astromenace.md    Atom A hackable text editor for the 21st Century. atom.md    Base Manage databases, create queries and reports to track and manage your information by using Base. base.md    Blender 3D modeling, animation, rendering and post-production blender.md    Calc Perform calculations, analyze information and manage lists in spreadsheets by using Calc. calc.md    Calculator no description found calculator.md    Chess no description found chess.md    Chrome no description found chrome.md    Cloud Foundry cli no description found cloudfoundry.md    Dia no description found dia.md    Doom no description found doom.md    Draw Create and edit drawings, flow charts and logos by using Draw. draw.md    Eclipse no description found eclipse.md    Eclipse Sts4 no description found eclipse_sts4.md    eog no description found eog.md    Evince no description found evince.md    Evolution no description found evolution.md    file-roller Create and modify an archive file-roller.md    Filelight View disk usage information filelight.md    Firefox Browse the World Wide Web firefox.md    Firefox-Rest Browse the World Wide Web firefoxrest.md    GCompris no description found gcompris.md    Gedit no description found gedit.md    gElemental no description found gelemental.md    Geogebra no description found geogebra.md    Gephi no description found gephi.md    OCR-gimagereader no description found gimagereader.md    Gimp Create images and edit photographs gimp.md    Gnumeric Calculation, Analysis, and Visualization of Information gnumeric.md    Golly no description found golly.md    Gretl no description found gretl.md    Impress Create and edit presentations for slideshows, meeting and Web pages by using Impress. impress.md    Inkscape Create and edit Scalable Vector Graphics images inkscape.md    Kalzium no description found kalzium.md    kDiamond no description found kdiamond.md    Kgeography no description found kgeography.md    kigo no description found kigo.md    Klickety no description found klickety.md    Klotski no description found klotski.md    kSquares no description found ksquares.md    kTurtle no description found kturtle.md    Leocad no description found leocad.md    LibreCAD no description found librecad.md    Mahjongg no description found mahjongg.md    Math Create and edit scientific formulas and equations by using Math. math.md    Mathwar no description found mathwar.md    Mines no description found mines.md    Netbeans no description found netbeans.md    Notepad Wine no description found notepad-wine.md    OnlyOffice Edit office documents onlyoffice.md    OpenShift cli no description found openshift.md    Planner no description found planner.md    Postman no description found postman.md    Putty Unix no description found putty-unix.md    Putty Wine no description found putty-wine.md    qElectrotech no description found qelectrotech.md    Remarkable A free, fully featured markdown editor for Linux. remarkable.md    Robots no description found robots.md    Stellarium no description found stellarium.md    Step no description found step.md    Sublime-Text Sophisticated text editor for code, markup and prose sublime-text.md    supertux2 Play a classic 2D platform game supertux2.md    swell-foop no description found swell-foop.md    Terminal no description found terminal.md    Shell AI no description found terminalai.md    Tetravex no description found tetravex.md    Thunderbird Send and receive mail with Thunderbird thunderbird.md    videolan Read, capture, broadcast your multimedia streams vlc.md    VSCode Code Editing. Redefined. vscode.md    Winefile Wine no description found winefile-wine.md    WineMine Wine no description found winemine-wine.md    Winhelp Wine no description found winhelp-wine.md    Writer Create and edit text and graphics in letters, reports, documents and Web pages by using Writer. writer.md    Xedit no description found xedit.md    xeyes no description found xeyes.md    Xman no description found xman.md    Xterm no description found xterm.md    Youtube Browse the World Wide Web youtube.md"},{"location":"applications/mahjongg/","title":"Mahjongg","text":""},{"location":"applications/mahjongg/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/mahjongg/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-mahjongg</p>"},{"location":"applications/mahjongg/#display-name","title":"Display name","text":"<p>\"Mahjongg\"</p>"},{"location":"applications/mahjongg/#path","title":"path","text":"<p>\"/usr/games/gnome-mahjongg\"</p>"},{"location":"applications/math/","title":"Math","text":""},{"location":"applications/math/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.libreoffice</p>"},{"location":"applications/math/#arguments","title":"Arguments","text":"<p>\"--math\"</p>"},{"location":"applications/math/#display-name","title":"Display name","text":"<p>\"Math\"</p>"},{"location":"applications/math/#path","title":"path","text":"<p>\"/usr/lib/libreoffice/program/soffice\"</p>"},{"location":"applications/math/#uniquerunkey","title":"uniquerunkey","text":"<p>\"libreoffice\"</p>"},{"location":"applications/math/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.oasis.opendocument.formula;application/vnd.sun.xml.math;application/vnd.oasis.opendocument.formula-template;text/mathml;application/mathml+xml;\"</p>"},{"location":"applications/math/#file-extensions","title":"File extensions","text":"<p>\"odf;odc\"</p>"},{"location":"applications/math/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"odf;odc\"</p>"},{"location":"applications/mathwar/","title":"Mathwar","text":""},{"location":"applications/mathwar/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/mathwar/#use-ubuntu-package","title":"use ubuntu package","text":"<p>mathwar</p>"},{"location":"applications/mathwar/#display-name","title":"Display name","text":"<p>\"Mathwar\"</p>"},{"location":"applications/mathwar/#path","title":"path","text":"<p>\"/usr/games/mathwar\"</p>"},{"location":"applications/minecraft/","title":"minecraft","text":""},{"location":"applications/minecraft/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/minecraft/#display-name","title":"Display name","text":"<p>\"minecraft\"</p>"},{"location":"applications/minecraft/#path","title":"path","text":"<p>\"/usr/bin/minecraft-launcher\"</p>"},{"location":"applications/minecraft/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes libflite1 openjdk-8-jre at-spi2-core dbus-x11 orca libsecret-1-0 &amp;&amp; curl -Ls 'https://launcher.mojang.com/download/Minecraft.deb' -o /tmp/Minecraft.deb &amp;&amp; apt-get install --yes /tmp/Minecraft.deb &amp;&amp; rm /tmp/Minecraft.deb &amp;&amp; rm -rf /var/lib/apt/lists/*,COPY composer/init.d/init.minecraft-launcher /composer/init.d\n</code></pre>"},{"location":"applications/mines/","title":"Mines","text":""},{"location":"applications/mines/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/mines/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-mines</p>"},{"location":"applications/mines/#display-name","title":"Display name","text":"<p>\"Mines\"</p>"},{"location":"applications/mines/#path","title":"path","text":"<p>\"/usr/games/gnome-mines\"</p>"},{"location":"applications/nautilus/","title":"nautilus","text":""},{"location":"applications/nautilus/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/nautilus/#use-ubuntu-package","title":"use ubuntu package","text":"<p>dbus gnome-icon-theme gnome-icon-theme-symbolic numix-gtk-theme numix-icon-theme gnome-font-viewer dbus-x11 python3-nautilus python3-shellescape nautilus desktop-file-utils shared-mime-info xdg-user-dirs</p>"},{"location":"applications/nautilus/#display-name","title":"Display name","text":"<p>\"FileManager\"</p>"},{"location":"applications/nautilus/#path","title":"path","text":"<p>\"/usr/bin/nautilus\"</p>"},{"location":"applications/nautilus/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/nautilus/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN mkdir -p /run/user/4096 /var/run/dbus/ chown balloon:balloon /run/user/4096 /var/run/dbus,COPY composer/node /composer/node,RUN cd /composer/node/ocdownload &amp;&amp; npm install,COPY composer/init.d/init.nautilus /composer/init.d/init.nautilus,COPY composer/desktop_download.py /composer/desktop_download.py,ENV NAUTILUS_PYTHON_DEBUG=misc\n</code></pre>"},{"location":"applications/netbeans/","title":"Netbeans","text":""},{"location":"applications/netbeans/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/netbeans/#use-ubuntu-package","title":"use ubuntu package","text":"<p>netbeans</p>"},{"location":"applications/netbeans/#display-name","title":"Display name","text":"<p>\"Netbeans\"</p>"},{"location":"applications/netbeans/#path","title":"path","text":"<p>\"/usr/bin/netbeans\"</p>"},{"location":"applications/notepad-wine/","title":"notepad-wine","text":""},{"location":"applications/notepad-wine/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.mswindows</p>"},{"location":"applications/notepad-wine/#arguments","title":"Arguments","text":"<p>\"notepad\"</p>"},{"location":"applications/notepad-wine/#display-name","title":"Display name","text":"<p>\"Notepad Wine\"</p>"},{"location":"applications/notepad-wine/#path","title":"path","text":"<p>\"/usr/bin/wine\"</p>"},{"location":"applications/notepad-wine/#mime-type","title":"Mime Type","text":"<p>\"application/text;\"</p>"},{"location":"applications/notepad-wine/#file-extensions","title":"File extensions","text":"<p>\"txt;log;\"</p>"},{"location":"applications/notepadqq/","title":"notepadqq","text":""},{"location":"applications/notepadqq/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.language-pack-all</p>"},{"location":"applications/notepadqq/#use-ubuntu-package","title":"use ubuntu package","text":"<p>notepadqq</p>"},{"location":"applications/notepadqq/#display-name","title":"Display name","text":"<p>\"notepadqq\"</p>"},{"location":"applications/notepadqq/#path","title":"path","text":"<p>\"/usr/bin/notepadqq\"</p>"},{"location":"applications/notepadqq/#mime-type","title":"Mime Type","text":"<p>\"text/plain;text/html;text/x-php;text/x-c;text/x-shellscript;\"</p>"},{"location":"applications/octave/","title":"octave","text":""},{"location":"applications/octave/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/octave/#use-ubuntu-package","title":"use ubuntu package","text":"<p>octave</p>"},{"location":"applications/octave/#display-name","title":"Display name","text":"<p>\"octave\"</p>"},{"location":"applications/octave/#path","title":"path","text":"<p>\"/usr/bin/octave\"</p>"},{"location":"applications/onlyoffice/","title":"onlyoffice","text":""},{"location":"applications/onlyoffice/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/onlyoffice/#use-ubuntu-package","title":"use ubuntu package","text":"<p>onlyoffice-desktopeditors</p>"},{"location":"applications/onlyoffice/#display-name","title":"Display name","text":"<p>\"OnlyOffice\"</p>"},{"location":"applications/onlyoffice/#path","title":"path","text":"<p>\"/usr/bin/desktopeditors\"</p>"},{"location":"applications/onlyoffice/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.oasis.opendocument.text;application/vnd.oasis.opendocument.text-template;application/vnd.oasis.opendocument.text-web;application/vnd.oasis.opendocument.text-master;application/vnd.sun.xml.writer;application/vnd.sun.xml.writer.template;application/vnd.sun.xml.writer.global;application/msword;application/vnd.ms-word;application/x-doc;application/rtf;text/rtf;application/vnd.wordperfect;application/wordperfect;application/vnd.openxmlformats-officedocument.wordprocessingml.document;application/vnd.ms-word.document.macroenabled.12;application/vnd.openxmlformats-officedocument.wordprocessingml.template;application/vnd.ms-word.template.macroenabled.12;application/vnd.oasis.opendocument.spreadsheet;application/vnd.oasis.opendocument.spreadsheet-template;application/vnd.sun.xml.calc;application/vnd.sun.xml.calc.template;application/msexcel;application/vnd.ms-excel;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;application/vnd.ms-excel.sheet.macroenabled.12;application/vnd.openxmlformats-officedocument.spreadsheetml.template;application/vnd.ms-excel.template.macroenabled.12;application/vnd.ms-excel.sheet.binary.macroenabled.12;text/csv;text/spreadsheet;application/csv;application/excel;application/x-excel;application/x-msexcel;application/x-ms-excel;text/comma-separated-values;text/tab-separated-values;text/x-comma-separated-values;text/x-csv;application/vnd.oasis.opendocument.presentation;application/vnd.oasis.opendocument.presentation-template;application/vnd.sun.xml.impress;application/vnd.sun.xml.impress.template;application/mspowerpoint;application/vnd.ms-powerpoint;application/vnd.openxmlformats-officedocument.presentationml.presentation;application/vnd.ms-powerpoint.presentation.macroenabled.12;application/vnd.openxmlformats-officedocument.presentationml.template;application/vnd.ms-powerpoint.template.macroenabled.12;application/vnd.openxmlformats-officedocument.presentationml.slide;application/vnd.openxmlformats-officedocument.presentationml.slideshow;application/vnd.ms-powerpoint.slideshow.macroEnabled.12;\"</p>"},{"location":"applications/onlyoffice/#file-extensions","title":"File extensions","text":"<p>\"doc;docx;odt;rtf;txt;xls;xlsx;ods;csv;ppt;pptx;odp\"</p>"},{"location":"applications/onlyoffice/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys CB2DE8E5,RUN echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | debconf-set-selections,RUN echo \"deb [arch=amd64] https://download.onlyoffice.com/repo/debian squeeze main\" &gt; /etc/apt/sources.list.d/onlyoffice.list,RUN apt-get update &amp;&amp; apt-get install  --yes libgl1 libnss3 qt5dxcb-plugin &amp;&amp; apt-get clean\n</code></pre>"},{"location":"applications/openshift/","title":"openshift","text":""},{"location":"applications/openshift/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.fulldev</p>"},{"location":"applications/openshift/#use-ubuntu-package","title":"use ubuntu package","text":"<p>rhc</p>"},{"location":"applications/openshift/#arguments","title":"Arguments","text":"<p>\"--disable-factory --class openshift.cli\"</p>"},{"location":"applications/openshift/#display-name","title":"Display name","text":"<p>\"OpenShift cli\"</p>"},{"location":"applications/openshift/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/pinta/","title":"Pinta","text":""},{"location":"applications/pinta/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine.minimal</p>"},{"location":"applications/pinta/#display-name","title":"Display name","text":"<p>\"Pinta (alpine)\"</p>"},{"location":"applications/pinta/#path","title":"path","text":"<p>\"/usr/bin/pinta\"</p>"},{"location":"applications/pinta/#mime-type","title":"Mime Type","text":"<p>\"image/bmp;image/gif;image/jpeg;image/jpg;image/pjpeg;image/png;image/svg+xml;image/tiff;image/x-bmp;image/x-gray;image/x-icb;image/x-ico;image/x-png;image/x-portable-anymap;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-xbitmap;image/x-xpixmap;image/x-pcx;image/x-targa;image/x-tga;image/openraster;\" tga;image/openraster;\"</p>"},{"location":"applications/planner/","title":"Planner","text":""},{"location":"applications/planner/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/planner/#use-ubuntu-package","title":"use ubuntu package","text":"<p>planner</p>"},{"location":"applications/planner/#display-name","title":"Display name","text":"<p>\"Planner\"</p>"},{"location":"applications/planner/#path","title":"path","text":"<p>\"/usr/bin/planner\"</p>"},{"location":"applications/planner/#mime-type","title":"Mime Type","text":"<p>\"application/x-planner;\"</p>"},{"location":"applications/planner/#file-extensions","title":"File extensions","text":"<p>\"mpp;mpx\"</p>"},{"location":"applications/planner/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"mpp;mpx\"</p>"},{"location":"applications/postman/","title":"postman","text":""},{"location":"applications/postman/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.postman</p>"},{"location":"applications/postman/#display-name","title":"Display name","text":"<p>\"Postman\"</p>"},{"location":"applications/postman/#path","title":"path","text":"<p>\"/usr/local/bin/Postman/app/Postman\"</p>"},{"location":"applications/putty-unix/","title":"putty-unix","text":""},{"location":"applications/putty-unix/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/putty-unix/#use-ubuntu-package","title":"use ubuntu package","text":"<p>putty dbus-x11</p>"},{"location":"applications/putty-unix/#display-name","title":"Display name","text":"<p>\"Putty Unix\"</p>"},{"location":"applications/putty-unix/#path","title":"path","text":"<p>\"/usr/bin/putty\"</p>"},{"location":"applications/putty-wine/","title":"putty-wine","text":""},{"location":"applications/putty-wine/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.wine</p>"},{"location":"applications/putty-wine/#arguments","title":"Arguments","text":"<p>\"/composer/bin/putty.exe\"</p>"},{"location":"applications/putty-wine/#display-name","title":"Display name","text":"<p>\"Putty Wine\"</p>"},{"location":"applications/putty-wine/#path","title":"path","text":"<p>\"/usr/bin/wine\"</p>"},{"location":"applications/putty-wine/#pre-run-command","title":"Pre run command","text":"<pre><code>\nENV WINEARCH=win64,USER $BUSER,RUN wineboot --init,RUN wget -O /composer/bin/putty.exe https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe,RUN echo disable &gt; $WINEPREFIX/.update-timestamp,COPY --chown=$BUSER:$BUSER user.reg system.reg /composer/.wine/\n</code></pre>"},{"location":"applications/qelectrotech/","title":"qElectrotech","text":""},{"location":"applications/qelectrotech/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/qelectrotech/#use-ubuntu-package","title":"use ubuntu package","text":"<p>qelectrotech</p>"},{"location":"applications/qelectrotech/#display-name","title":"Display name","text":"<p>\"qElectrotech\"</p>"},{"location":"applications/qelectrotech/#path","title":"path","text":"<p>\"/usr/bin/qelectrotech\"</p>"},{"location":"applications/remarkable/","title":"remarkable","text":""},{"location":"applications/remarkable/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.18.04</p>"},{"location":"applications/remarkable/#display-name","title":"Display name","text":"<p>\"Remarkable\"</p>"},{"location":"applications/remarkable/#path","title":"path","text":"<p>\"/usr/bin/remarkable\"</p>"},{"location":"applications/remarkable/#mime-type","title":"Mime Type","text":"<p>\"text/x-markdown;text/markdown;\"</p>"},{"location":"applications/remarkable/#file-extensions","title":"File extensions","text":"<p>\"md;markdown\"</p>"},{"location":"applications/remarkable/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"md;markdown\"</p>"},{"location":"applications/remarkable/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes wget python3-gtkspellcheck wkhtmltopdf python3-markdown gir1.2-gtksource-3.0 yelp gir1.2-webkit-3.0 python3-bs4 &amp;&amp; apt-get clean,RUN wget -O /tmp/remarkable_1.87_all.deb https://remarkableapp.github.io/files/remarkable_1.87_all.deb &amp;&amp; apt-get install  --no-install-recommends --yes /tmp/remarkable_1.87_all.deb &amp;&amp; apt-get clean &amp;&amp; rm -rf /tmp/remarkable_1.87_all.deb\n</code></pre>"},{"location":"applications/remmina/","title":"remmina","text":""},{"location":"applications/remmina/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/remmina/#use-ubuntu-package","title":"use ubuntu package","text":"<p>remmina libsecret-1-0 remmina-plugin-rdp remmina-plugin-secret remmina-plugin-vnc remmina-plugin-exec remmina-plugin-nx remmina-plugin-spice</p>"},{"location":"applications/remmina/#display-name","title":"Display name","text":"<p>\"Remmina\"</p>"},{"location":"applications/remmina/#path","title":"path","text":"<p>\"/usr/bin/remmina\"</p>"},{"location":"applications/remmina/#mime-type","title":"Mime Type","text":"<p>\"application/x-remmina;\"</p>"},{"location":"applications/remotedesktopmanager/","title":"remotedesktopmanager","text":""},{"location":"applications/remotedesktopmanager/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/remotedesktopmanager/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gir1.2-gdkpixbuf-2.0 gtk2-engines-pixbuf libssl3 libgdk-pixbuf2.0-0 adwaita-icon-theme libgdk-pixbuf2.0-bin librsvg2-2 librsvg2-common</p>"},{"location":"applications/remotedesktopmanager/#display-name","title":"Display name","text":"<p>\"RemoteDesktop\"</p>"},{"location":"applications/remotedesktopmanager/#path","title":"path","text":"<p>\"/bin/remotedesktopmanager.free\"</p>"},{"location":"applications/remotedesktopmanager/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN curl -Ls -o /tmp/RemoteDesktopManager.Free_amd64.deb https://cdn.devolutions.net/download/Linux/RDM/2022.1.2.5/RemoteDesktopManager.Free_2022.1.2.5_amd64.deb,RUN apt-get update &amp;&amp; apt-get install --yes /tmp/RemoteDesktopManager.Free_amd64.deb &amp;&amp; apt-get clean,COPY composer/init.d/init.RemoteDesktopManager.Free /composer/init.d/init.RemoteDesktopManager.Free\n</code></pre>"},{"location":"applications/rhythmbox/","title":"rhythmbox","text":""},{"location":"applications/rhythmbox/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/rhythmbox/#use-ubuntu-package","title":"use ubuntu package","text":"<p>rhythmbox</p>"},{"location":"applications/rhythmbox/#display-name","title":"Display name","text":"<p>\"rhythmbox\"</p>"},{"location":"applications/rhythmbox/#path","title":"path","text":"<p>\"/usr/bin/rhythmbox\"</p>"},{"location":"applications/rhythmbox/#mime-type","title":"Mime Type","text":"<p>\"application/x-ogg;application/ogg;audio/x-vorbis+ogg;audio/vorbis;audio/x-vorbis;audio/x-scpls;audio/x-mp3;audio/x-mpeg;audio/mpeg;audio/x-mpegurl;audio/x-flac;audio/mp4;audio/x-it;audio/x-mod;audio/x-s3m;audio/x-stm;audio/x-xm;\"</p>"},{"location":"applications/robots/","title":"Robots","text":""},{"location":"applications/robots/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/robots/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-robots</p>"},{"location":"applications/robots/#display-name","title":"Display name","text":"<p>\"Robots\"</p>"},{"location":"applications/robots/#path","title":"path","text":"<p>\"/usr/games/gnome-robots\"</p>"},{"location":"applications/shotcut/","title":"Shotcut","text":""},{"location":"applications/shotcut/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine.gtk</p>"},{"location":"applications/shotcut/#use-ubuntu-package","title":"use ubuntu package","text":"<p>shotcut</p>"},{"location":"applications/shotcut/#display-name","title":"Display name","text":"<p>\"Shotcut\"</p>"},{"location":"applications/shotcut/#path","title":"path","text":"<p>\"/usr/bin/shotcut\"</p>"},{"location":"applications/shotcut/#mime-type","title":"Mime Type","text":"<p>\"image/bmp;image/g3fax;image/gif;image/x-fits;image/x-pcx;image/x-portable-anymap;image/x-portable-bitmap;image/x-portable-graymap;image/x-portable-pixmap;image/x-psd;image/x-sgi;image/x-tga;image/x-xbitmap;image/x-xwindowdump;image/x-xcf;image/x-compressed-xcf;image/x-gimp-gbr;image/x-gimp-pat;image/x-gimp-gih;image/jpeg;image/x-psp;image/png;image/x-icon;image/x-xpixmap;image/x-wmf;image/jp2;image/jpeg2000;image/jpx;image/x-xcursor;application/vnd.mlt+xml;application/ogg;application/x-ogg;audio/ogg;audio/x-vorbis;audio/x-vorbis+ogg;video/ogg;video/x-ogm+ogg;video/x-theora+ogg;video/x-theora;audio/x-speex;audio/opus;application/x-flac;audio/flac;audio/x-flac;audio/x-ms-asf;audio/x-ms-asx;audio/x-ms-wax;audio/x-ms-wma;video/x-ms-asf;video/x-ms-asf-plugin;video/x-ms-asx;video/x-ms-wm;video/x-ms-wmv;video/x-ms-wmx;video/x-ms-wvx;video/x-msvideo;audio/x-pn-windows-acm;video/divx;video/msvideo;video/vnd.divx;video/x-avi;application/vnd.rn-realmedia;application/vnd.rn-realmedia-vbr;audio/vnd.rn-realaudio;audio/x-pn-realaudio;audio/x-pn-realaudio-plugin;audio/x-real-audio;audio/x-realaudio;video/vnd.rn-realvideo;audio/mpeg;audio/mpg;audio/mp1;audio/mp2;audio/mp3;audio/x-mp1;audio/x-mp2;audio/x-mp3;audio/x-mpeg;audio/x-mpg;video/mp2t;video/mpeg;video/mpeg-system;video/x-mpeg;video/x-mpeg2;video/x-mpeg-system;application/mpeg4-iod;application/mpeg4-muxcodetable;application/x-extension-m4a;application/x-extension-mp4;audio/aac;audio/m4a;audio/mp4;audio/x-m4a;audio/x-aac;video/mp4;video/mp4v-es;video/x-m4v;application/x-quicktime-media-link;application/x-quicktimeplayer;video/quicktime;application/x-matroska;audio/x-matroska;video/x-matroska;video/webm;audio/webm;audio/3gpp;audio/3gpp2;audio/AMR;audio/AMR-WB;audio/amr;audio/amr-wb;video/3gp;video/3gpp;video/3gpp2;x-scheme-handler/mms;x-scheme-handler/mmsh;x-scheme-handler/rtsp;x-scheme-handler/rtp;x-scheme-handler/rtmp;x-scheme-handler/icy;x-scheme-handler/icyx;x-content/video-vcd;x-content/video-svcd;x-content/video-dvd;x-content/audio-cdda;x-content/audio-player;application/x-cd-image;application/ram;application/xspf+xml;audio/mpegurl;audio/x-mpegurl;audio/scpls;audio/x-scpls;text/google-video-pointer;text/x-google-video-pointer;video/vnd.mpegurl;application/vnd.apple.mpegurl;application/vnd.ms-asf;application/vnd.ms-wpl;application/sdp;audio/dv;video/dv;audio/x-aiff;audio/x-pn-aiff;video/x-anim;video/x-nsv;video/fli;video/flv;video/x-flc;video/x-fli;video/x-flv;audio/wav;audio/x-pn-au;audio/x-pn-wav;audio/x-wav;audio/ac3;audio/eac3;audio/vnd.dts;audio/vnd.dts.hd;audio/vnd.dolby.heaac.1;audio/vnd.dolby.heaac.2;audio/vnd.dolby.mlp;audio/basic;audio/midi;audio/x-ape;audio/x-gsm;audio/x-musepack;audio/x-tta;audio/x-wavpack;audio/x-shorten;application/x-shockwave-flash;application/x-flash-video;misc/ultravox;image/vnd.rn-realpix;audio/x-it;audio/x-mod;audio/x-s3m;audio/x-xm;application/mxf;\"</p>"},{"location":"applications/shotcut/#file-extensions","title":"File extensions","text":"<p>\"mlt\"</p>"},{"location":"applications/shotcut/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"mlt\"</p>"},{"location":"applications/stellarium/","title":"Stellarium","text":""},{"location":"applications/stellarium/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/stellarium/#use-ubuntu-package","title":"use ubuntu package","text":"<p>stellarium</p>"},{"location":"applications/stellarium/#display-name","title":"Display name","text":"<p>\"Stellarium\"</p>"},{"location":"applications/stellarium/#path","title":"path","text":"<p>\"/usr/bin/stellarium\"</p>"},{"location":"applications/step/","title":"Step","text":""},{"location":"applications/step/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/step/#use-ubuntu-package","title":"use ubuntu package","text":"<p>step</p>"},{"location":"applications/step/#display-name","title":"Display name","text":"<p>\"Step\"</p>"},{"location":"applications/step/#path","title":"path","text":"<p>\"/usr/bin/step\"</p>"},{"location":"applications/stress/","title":"stress","text":""},{"location":"applications/stress/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.language-pack-all</p>"},{"location":"applications/stress/#use-ubuntu-package","title":"use ubuntu package","text":"<p>at-spi2-core gnome-terminal dbus-x11 stress</p>"},{"location":"applications/stress/#arguments","title":"Arguments","text":"<p>\"--disable-factory --class=stress\"</p>"},{"location":"applications/stress/#display-name","title":"Display name","text":"<p>\"stress\"</p>"},{"location":"applications/stress/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/sublime-text/","title":"Sublime-Text","text":""},{"location":"applications/sublime-text/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/sublime-text/#use-ubuntu-package","title":"use ubuntu package","text":"<p>sublime-text</p>"},{"location":"applications/sublime-text/#display-name","title":"Display name","text":"<p>\"Sublime-Text\"</p>"},{"location":"applications/sublime-text/#path","title":"path","text":"<p>\"/opt/sublime_text/sublime_text\"</p>"},{"location":"applications/sublime-text/#pre-run-command","title":"Pre run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes wget &amp;&amp; apt-get clean,RUN wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | apt-key add -a,RUN echo \"deb https://download.sublimetext.com/ apt/stable/\" | tee /etc/apt/sources.list.d/sublime-text.list\n</code></pre>"},{"location":"applications/supertux2/","title":"supertux2","text":""},{"location":"applications/supertux2/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/supertux2/#use-ubuntu-package","title":"use ubuntu package","text":"<p>supertux</p>"},{"location":"applications/supertux2/#display-name","title":"Display name","text":"<p>\"supertux2\"</p>"},{"location":"applications/supertux2/#path","title":"path","text":"<p>\"/usr/games/supertux2\"</p>"},{"location":"applications/swell-foop/","title":"swell-foop","text":""},{"location":"applications/swell-foop/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/swell-foop/#use-ubuntu-package","title":"use ubuntu package","text":"<p>swell-foop</p>"},{"location":"applications/swell-foop/#display-name","title":"Display name","text":"<p>\"swell-foop\"</p>"},{"location":"applications/swell-foop/#path","title":"path","text":"<p>\"/usr/games/swell-foop\"</p>"},{"location":"applications/teams/","title":"teams","text":""},{"location":"applications/teams/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.minimal.22.04</p>"},{"location":"applications/teams/#arguments","title":"Arguments","text":"<p>\"--disable-namespace-sandbox --disable-setuid-sandbox\"</p>"},{"location":"applications/teams/#display-name","title":"Display name","text":"<p>\"Microsoft Teams\"</p>"},{"location":"applications/teams/#path","title":"path","text":"<p>\"/usr/bin/teams\"</p>"},{"location":"applications/teams/#mime-type","title":"Mime Type","text":"<p>\"x-scheme-handler/msteams;\"</p>"},{"location":"applications/teams/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN curl https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o /usr/share/keyrings/microsoft-archive-keyring.gpg,RUN echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/microsoft-archive-keyring.gpg] https://packages.microsoft.com/repos/ms-teams stable main\" &gt; /etc/apt/sources.list.d/teams.list,RUN apt update &amp;&amp; apt install -y teams &amp;&amp; apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>"},{"location":"applications/terminal/","title":"Terminal","text":""},{"location":"applications/terminal/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/terminal/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-terminal dbus-x11</p>"},{"location":"applications/terminal/#arguments","title":"Arguments","text":"<p>\"--disable-factory\"</p>"},{"location":"applications/terminal/#display-name","title":"Display name","text":"<p>\"Terminal\"</p>"},{"location":"applications/terminal/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/terminalai/","title":"terminalai","text":""},{"location":"applications/terminalai/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.fulldev.ia</p>"},{"location":"applications/terminalai/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-terminal dbus-x11</p>"},{"location":"applications/terminalai/#arguments","title":"Arguments","text":"<p>\"--disable-factory --class=terminalai\"</p>"},{"location":"applications/terminalai/#display-name","title":"Display name","text":"<p>\"Shell AI\"</p>"},{"location":"applications/terminalai/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/terminalpod/","title":"terminalpod","text":""},{"location":"applications/terminalpod/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.language-pack-all</p>"},{"location":"applications/terminalpod/#use-ubuntu-package","title":"use ubuntu package","text":"<p>at-spi2-core gnome-terminal dbus-x11</p>"},{"location":"applications/terminalpod/#arguments","title":"Arguments","text":"<p>\"--disable-factory --class=pod\"</p>"},{"location":"applications/terminalpod/#display-name","title":"Display name","text":"<p>\"Terminal [Pod]\"</p>"},{"location":"applications/terminalpod/#path","title":"path","text":"<p>\"/usr/bin/gnome-terminal\"</p>"},{"location":"applications/tetravex/","title":"Tetravex","text":""},{"location":"applications/tetravex/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/tetravex/#use-ubuntu-package","title":"use ubuntu package","text":"<p>gnome-tetravex</p>"},{"location":"applications/tetravex/#display-name","title":"Display name","text":"<p>\"Tetravex\"</p>"},{"location":"applications/tetravex/#path","title":"path","text":"<p>\"/usr/games/gnome-tetravex\"</p>"},{"location":"applications/thunderbird/","title":"Thunderbird","text":""},{"location":"applications/thunderbird/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.language-pack-all</p>"},{"location":"applications/thunderbird/#use-ubuntu-package","title":"use ubuntu package","text":"<p>tk thunderbird gnome-keyring</p>"},{"location":"applications/thunderbird/#display-name","title":"Display name","text":"<p>\"Thunderbird\"</p>"},{"location":"applications/thunderbird/#path","title":"path","text":"<p>\"/usr/bin/thunderbird\"</p>"},{"location":"applications/thunderbird/#mime-type","title":"Mime Type","text":"<p>\"x-scheme-handler/mailto\"</p>"},{"location":"applications/vice/","title":"vice","text":""},{"location":"applications/vice/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.18.04</p>"},{"location":"applications/vice/#display-name","title":"Display name","text":"<p>\"Commodore64\"</p>"},{"location":"applications/vice/#path","title":"path","text":"<p>\"/usr/bin/x64\"</p>"},{"location":"applications/vice/#file-extensions","title":"File extensions","text":"<p>\"crt;bin\"</p>"},{"location":"applications/vice/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes vice libmp3lame0 git wget &amp;&amp; apt-get clean,RUN git clone https://github.com/stuartcarnie/vice-emu/ &amp;&amp; mv vice-emu/vice/data/DRIVES/* /usr/lib/vice/C64 &amp;&amp; cd /vice-emu/vice/data/C64 &amp;&amp; mv chargen kernal basic /usr/lib/vice/C64,RUN mkdir /usr/lib/vice/C64/cartridge,RUN wget http://www.zimmers.net/anonftp/pub/cbm/firmware/misc/c64carts/Super_Games_1-8000.bin -O /usr/lib/vice/C64/cartridge/Super_Games_1-8000.bin,RUN wget http://www.zimmers.net/anonftp/pub/cbm/firmware/misc/c64carts/Super_Games_2-8000.bin -O /usr/lib/vice/C64/cartridge/Super_Games_2-8000.bin,RUN wget http://www.zimmers.net/anonftp/pub/cbm/firmware/misc/c64carts/Super_Games_3-8000.bin -O /usr/lib/vice/C64/cartridge/Super_Games_3-8000.bin,RUN wget http://www.zimmers.net/anonftp/pub/cbm/firmware/misc/c64carts/Super_Games_4-8000.bin -O /usr/lib/vice/C64/cartridge/Super_Games_4-8000.bin,RUN wget http://www.zimmers.net/anonftp/pub/cbm/firmware/misc/c64carts/C64638_Jack_Attack-8000.bin -O /usr/lib/vice/C64/cartridge/C64638_Jack_Attack-8000.bin,RUN wget http://www.zimmers.net/anonftp/pub/cbm/firmware/misc/c64carts/315102-01.bin -O /usr/lib/vice/C64/cartridge/315102-01.bin,RUN wget http://www.zimmers.net/anonftp/pub/cbm/firmware/misc/c64carts/315103-01.bin -O /usr/lib/vice/C64/cartridge/315103-01.bin\n</code></pre>"},{"location":"applications/vlc/","title":"vlc","text":""},{"location":"applications/vlc/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/vlc/#use-ubuntu-package","title":"use ubuntu package","text":"<p>ffmpeg vlc</p>"},{"location":"applications/vlc/#display-name","title":"Display name","text":"<p>\"videolan\"</p>"},{"location":"applications/vlc/#path","title":"path","text":"<p>\"/usr/bin/vlc\"</p>"},{"location":"applications/vlc/#mime-type","title":"Mime Type","text":"<p>\"video/3gpp;video/dv;video/fli;video/flv;video/mp2t;video/mp4;video/mp4v-es;video/mpeg;video/msvideo;video/ogg;video/quicktime;video/vivo;video/vnd.divx;video/vnd.rn-realvideo;video/vnd.vivo;video/webm;video/x-anim;video/x-avi;video/x-flc;video/x-fli;video/x-flic;video/x-flv;video/x-m4v;video/x-matroska;video/x-mpeg;video/x-ms-asf;video/x-ms-asx;video/x-msvideo;video/x-ms-wm;video/x-ms-wmv;video/x-ms-wmx;video/x-ms-wvx;video/x-nsv;video/x-ogm+ogg;video/x-theora+ogg;\"</p>"},{"location":"applications/vlc/#file-extensions","title":"File extensions","text":"<p>\"asx;dts;gxf;m2v;m3u;m4v;mpeg1;mpeg2;mts;mxf;ogm;pls;bup;a52;aac;b4s;cue;divx;dv;flv;m1v;m2ts;mkv;mov;mpeg4;oma;spx;ts,vlc,vob,xspf;dat;bin;ifo;part;3g2;avi;mpeg;mpg;flac;m4a;mp1;ogg;wav;xm;3gp;srt;wmv;ac3;asf;mod;mp2;mp3;mp4;wma;mka;m4p\"</p>"},{"location":"applications/vmmacos/","title":"vmmacos","text":""},{"location":"applications/vmmacos/#inherite-from","title":"inherite from","text":"<p>abcdesktop/docker-osx</p>"},{"location":"applications/vmmacos/#display-name","title":"Display name","text":"<p>\"vmmacos\"</p>"},{"location":"applications/vmmacos/#path","title":"path","text":"<p>undefined</p>"},{"location":"applications/vmmacos/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN yes | sudo pacman -S xorg-xauth\n</code></pre>"},{"location":"applications/vmrc/","title":"vmrc","text":""},{"location":"applications/vmrc/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/vmrc/#display-name","title":"Display name","text":"<p>\"VMRC\"</p>"},{"location":"applications/vmrc/#path","title":"path","text":"<p>\"/usr/bin/vmrc\"</p>"},{"location":"applications/vmrc/#mime-type","title":"Mime Type","text":"<p>\"x-scheme-handler/vmrc;\"</p>"},{"location":"applications/vmrc/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes libaio1 &amp;&amp; apt-get clean,COPY VMware-Remote-Console-12.0.1-18113358.x86_64.bundle /tmp,RUN chmod o+x /tmp/VMware-Remote-Console-12.0.1-18113358.x86_64.bundle,RUN /tmp/VMware-Remote-Console-12.0.1-18113358.x86_64.bundle --eulas-agreed --console --required --ignore-errors\n</code></pre>"},{"location":"applications/vmubuntu/","title":"vmubuntu","text":""},{"location":"applications/vmubuntu/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.vm.ubuntu:22.04</p>"},{"location":"applications/vmubuntu/#display-name","title":"Display name","text":"<p>\"vmubuntu\"</p>"},{"location":"applications/vmubuntu/#path","title":"path","text":"<p>undefined</p>"},{"location":"applications/vscode/","title":"VSCode","text":""},{"location":"applications/vscode/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.fulldev.vscode</p>"},{"location":"applications/vscode/#arguments","title":"Arguments","text":"<p>\"--extensions-dir /usr/share/code/extensions --disable-gpu --verbose\"</p>"},{"location":"applications/vscode/#display-name","title":"Display name","text":"<p>\"VSCode\"</p>"},{"location":"applications/vscode/#path","title":"path","text":"<p>\"/usr/bin/code\"</p>"},{"location":"applications/vscode/#mime-type","title":"Mime Type","text":"<p>\"text/x-c;application/json;application/javascript;application/xml;text/xml;application/java-archive;text/x-java-source;text/plain;image/svg+xml;application/x-csh;text/x-yaml;application/x-yaml;application/x-python;\"</p>"},{"location":"applications/vscode/#file-extensions","title":"File extensions","text":"<p>\"c;cpp;py;json;js;java;jav;md;xml;txt;svg;html;htm;sh;csh;css;jsx;tsx;vue;yml;yaml;\"</p>"},{"location":"applications/vscode/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"c;cpp;py;json;java;md;yml;yaml;\"</p>"},{"location":"applications/vscode/#share-size","title":"Share size","text":"<p>\"2gb\"</p>"},{"location":"applications/whatsdesk/","title":"whatsdesk","text":""},{"location":"applications/whatsdesk/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk.20.04</p>"},{"location":"applications/whatsdesk/#use-ubuntu-package","title":"use ubuntu package","text":"<p>dbus-x11</p>"},{"location":"applications/whatsdesk/#display-name","title":"Display name","text":"<p>\"whatsdesk\"</p>"},{"location":"applications/whatsdesk/#path","title":"path","text":"<p>\"/opt/whatsdesk/whatsdesk\"</p>"},{"location":"applications/whatsdesk/#mime-type","title":"Mime Type","text":"<p>\"x-scheme-handler/whatsapp;\"</p>"},{"location":"applications/whatsdesk/#pre-run-command","title":"PRE run command","text":"<pre><code>\nRUN curl -Ls -o /tmp/whatsdesk.deb https://zerkc.gitlab.io/whatsdesk/whatsdesk_0.3.9_amd64.deb,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes desktop-file-utils libasound2 &amp;&amp; apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*,RUN apt-get update &amp;&amp; apt-get install --no-install-recommends --yes /tmp/whatsdesk.deb &amp;&amp; apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>"},{"location":"applications/winefile-wine/","title":"winefile-wine","text":""},{"location":"applications/winefile-wine/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.mswindows</p>"},{"location":"applications/winefile-wine/#arguments","title":"Arguments","text":"<p>\"winefile\"</p>"},{"location":"applications/winefile-wine/#display-name","title":"Display name","text":"<p>\"Winefile Wine\"</p>"},{"location":"applications/winefile-wine/#path","title":"path","text":"<p>\"/usr/bin/wine\"</p>"},{"location":"applications/winemine-wine/","title":"winemine-wine","text":""},{"location":"applications/winemine-wine/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.mswindows</p>"},{"location":"applications/winemine-wine/#arguments","title":"Arguments","text":"<p>\"winemine\"</p>"},{"location":"applications/winemine-wine/#display-name","title":"Display name","text":"<p>\"WineMine Wine\"</p>"},{"location":"applications/winemine-wine/#path","title":"path","text":"<p>\"/usr/bin/wine\"</p>"},{"location":"applications/winhelp-wine/","title":"winhelp-wine","text":""},{"location":"applications/winhelp-wine/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.mswindows</p>"},{"location":"applications/winhelp-wine/#arguments","title":"Arguments","text":"<p>\"winhelp\"</p>"},{"location":"applications/winhelp-wine/#display-name","title":"Display name","text":"<p>\"Winhelp Wine\"</p>"},{"location":"applications/winhelp-wine/#path","title":"path","text":"<p>\"/usr/bin/wine\"</p>"},{"location":"applications/winhelp-wine/#mime-type","title":"Mime Type","text":"<p>\"application/hlp;\"</p>"},{"location":"applications/winhelp-wine/#file-extensions","title":"File extensions","text":"<p>\"hlp;\"</p>"},{"location":"applications/winscp-wine/","title":"winscp-wine","text":""},{"location":"applications/winscp-wine/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.wine</p>"},{"location":"applications/winscp-wine/#arguments","title":"Arguments","text":"<p>\"/composer/bin/winscp.exe\"</p>"},{"location":"applications/winscp-wine/#display-name","title":"Display name","text":"<p>\"WinSCP\"</p>"},{"location":"applications/winscp-wine/#path","title":"path","text":"<p>\"/usr/bin/wine\"</p>"},{"location":"applications/winscp-wine/#pre-run-command","title":"PRE run command","text":"<pre><code>\nENV WINEARCH=win64,ENV WINEDLLOVERRIDES=\"mscoree,mshtml=\",USER $BUSER,RUN wineboot --init,RUN curl -Ls -o /tmp/winscp553.zip http://winscp.net/download/winscp553.zip &amp;&amp; unzip /tmp/winscp553.zip -d /composer/bin/ &amp;&amp; rm /tmp/winscp553.zip,RUN echo disable &gt; $WINEPREFIX/.update-timestamp,COPY --chown=$BUSER:$BUSER user.reg system.reg /composer/.wine/\n</code></pre>"},{"location":"applications/wireshark/","title":"wireshark","text":""},{"location":"applications/wireshark/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.alpine.gtk</p>"},{"location":"applications/wireshark/#display-name","title":"Display name","text":"<p>\"wireshark (alpine)\"</p>"},{"location":"applications/wireshark/#path","title":"path","text":"<p>\"/usr/bin/wireshark\"</p>"},{"location":"applications/wireshark/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.tcpdump.pcap;application/x-pcapng;application/x-snoop;application/x-iptrace;application/x-lanalyzer;application/x-nettl;application/x-radcom;application/x-etherpeek;application/x-visualnetworks;application/x-netinstobserver;application/x-5view;application/x-tektronix-rf5;\"</p>"},{"location":"applications/wireshark/#file-extensions","title":"File extensions","text":"<p>\"cap,pcap\"</p>"},{"location":"applications/wireshark/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"cap\"</p>"},{"location":"applications/wireshark/#pre-run-command","title":"PRE run command","text":"<pre><code>\nENV QT_XCB_NO_MITSHM=1\n</code></pre>"},{"location":"applications/writer/","title":"Writer","text":""},{"location":"applications/writer/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.libreoffice</p>"},{"location":"applications/writer/#arguments","title":"Arguments","text":"<p>\"--writer\"</p>"},{"location":"applications/writer/#display-name","title":"Display name","text":"<p>\"Writer\"</p>"},{"location":"applications/writer/#path","title":"path","text":"<p>\"/usr/lib/libreoffice/program/soffice\"</p>"},{"location":"applications/writer/#uniquerunkey","title":"uniquerunkey","text":"<p>\"libreoffice\"</p>"},{"location":"applications/writer/#showinview","title":"showinview","text":"<p>\"dock\"</p>"},{"location":"applications/writer/#mime-type","title":"Mime Type","text":"<p>\"application/vnd.oasis.opendocument.text;application/vnd.oasis.opendocument.text-template;application/vnd.oasis.opendocument.text-web;application/vnd.oasis.opendocument.text-master;application/vnd.oasis.opendocument.text-master-template;application/vnd.sun.xml.writer;application/vnd.sun.xml.writer.template;application/vnd.sun.xml.writer.global;application/msword;application/vnd.ms-word;application/x-doc;application/x-hwp;application/rtf;text/rtf;application/vnd.wordperfect;application/wordperfect;application/vnd.lotus-wordpro;application/vnd.openxmlformats-officedocument.wordprocessingml.document;application/vnd.ms-word.document.macroenabled.12;application/vnd.openxmlformats-officedocument.wordprocessingml.template;application/vnd.ms-word.template.macroenabled.12;application/vnd.stardivision.writer-global;application/x-extension-txt;application/x-t602;application/vnd.oasis.opendocument.text-flat-xml;application/x-fictionbook+xml;application/macwriteii;application/x-aportisdoc;application/prs.plucker;application/vnd.palm;application/clarisworks;application/x-sony-bbeb;application/x-abiword;application/x-iwork-pages-sffpages;application/x-mswrite;\"</p>"},{"location":"applications/writer/#file-extensions","title":"File extensions","text":"<p>\"sxw;stw;doc;dot;wps;rtf;602;wpd;docx;docm;dotx;dotm;abw;zabw;pages;dummy;lrf;cwk;hqx;fb2;mw;mcw;mwd;pdb;wn\"</p>"},{"location":"applications/writer/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"odf;ott;fodt;uot\"</p>"},{"location":"applications/xedit/","title":"xedit","text":""},{"location":"applications/xedit/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/xedit/#use-ubuntu-package","title":"use ubuntu package","text":"<p>x11-apps</p>"},{"location":"applications/xedit/#display-name","title":"Display name","text":"<p>\"Xedit\"</p>"},{"location":"applications/xedit/#path","title":"path","text":"<p>\"/usr/bin/xedit\"</p>"},{"location":"applications/xedit/#mime-type","title":"Mime Type","text":"<p>\"application/text;\"</p>"},{"location":"applications/xedit/#file-extensions","title":"File extensions","text":"<p>\"txt;log;md\"</p>"},{"location":"applications/xeyes/","title":"xeyes","text":""},{"location":"applications/xeyes/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/xeyes/#use-ubuntu-package","title":"use ubuntu package","text":"<p>x11-apps</p>"},{"location":"applications/xeyes/#display-name","title":"Display name","text":"<p>\"xeyes\"</p>"},{"location":"applications/xeyes/#path","title":"path","text":"<p>\"/usr/bin/xeyes\"</p>"},{"location":"applications/xman/","title":"xman","text":""},{"location":"applications/xman/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk.18.04</p>"},{"location":"applications/xman/#use-ubuntu-package","title":"use ubuntu package","text":"<p>x11-apps man-db manpages manpages-posix manpages-dev manpages-posix-dev</p>"},{"location":"applications/xman/#display-name","title":"Display name","text":"<p>\"Xman\"</p>"},{"location":"applications/xman/#path","title":"path","text":"<p>\"/usr/bin/xman\"</p>"},{"location":"applications/xman/#mime-type","title":"Mime Type","text":"<p>\"application/x-troff;application/x-troff-man;\"</p>"},{"location":"applications/xman/#file-extensions","title":"File extensions","text":"<p>\"man;roff\"</p>"},{"location":"applications/xpad/","title":"xpad","text":""},{"location":"applications/xpad/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.ubuntu.gtk</p>"},{"location":"applications/xpad/#use-ubuntu-package","title":"use ubuntu package","text":"<p>xpad</p>"},{"location":"applications/xpad/#display-name","title":"Display name","text":"<p>\"Xpad\"</p>"},{"location":"applications/xpad/#path","title":"path","text":"<p>\"/usr/bin/xpad\"</p>"},{"location":"applications/xpad/#pre-run-command","title":"PRE run command","text":"<pre><code>\nCOPY composer/init.d/init.xpad /composer/init.d/init.xpad\n</code></pre>"},{"location":"applications/xterm/","title":"Xterm","text":""},{"location":"applications/xterm/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/xterm/#use-ubuntu-package","title":"use ubuntu package","text":"<p>xterm</p>"},{"location":"applications/xterm/#display-name","title":"Display name","text":"<p>\"Xterm\"</p>"},{"location":"applications/xterm/#path","title":"path","text":"<p>\"/usr/bin/xterm\"</p>"},{"location":"applications/youtube/","title":"youtube","text":""},{"location":"applications/youtube/#inherite-from","title":"inherite from","text":"<p>abcdesktopio/oc.template.gtk</p>"},{"location":"applications/youtube/#use-ubuntu-package","title":"use ubuntu package","text":"<p>firefox</p>"},{"location":"applications/youtube/#arguments","title":"Arguments","text":"<p>\"-P youtube --class=youtube https://www.youtube.com/\"</p>"},{"location":"applications/youtube/#display-name","title":"Display name","text":"<p>\"Youtube\"</p>"},{"location":"applications/youtube/#path","title":"path","text":"<p>\"/usr/bin/firefox\"</p>"},{"location":"applications/youtube/#mime-type","title":"Mime Type","text":"<p>\"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;x-scheme-handler/http;x-scheme-handler/https;x-scheme-handler/ftp;video/webm;application/x-xpinstall;\"</p>"},{"location":"applications/youtube/#file-extensions","title":"File extensions","text":"<p>\"html;xml;gif\"</p>"},{"location":"applications/youtube/#legacy-file-extensions","title":"Legacy file extensions","text":"<p>\"html;xml\"</p>"},{"location":"applications/youtube/#pre-run-command","title":"Pre run command","text":"<pre><code>\nCOPY composer/init.d/init.firefox.youtube /composer/init.d/init.firefox\n</code></pre>"},{"location":"cheatsheets/bash/","title":"Bash scripting","text":"","tags":["Featured"]},{"location":"cheatsheets/bash/#getting-started","title":"Getting started","text":"<p>{: .-three-column}</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#example","title":"Example","text":"<pre><code>#!/usr/bin/env bash\n\nNAME=\"John\"\necho \"Hello $NAME!\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#variables","title":"Variables","text":"<pre><code>NAME=\"John\"\necho $NAME\necho \"$NAME\"\necho \"${NAME}!\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#string-quotes","title":"String quotes","text":"<pre><code>NAME=\"John\"\necho \"Hi $NAME\"  #=&gt; Hi John\necho 'Hi $NAME'  #=&gt; Hi $NAME\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#shell-execution","title":"Shell execution","text":"<pre><code>echo \"I'm in $(pwd)\"\necho \"I'm in `pwd`\"\n# Same\n</code></pre> <p>See Command substitution</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#conditional-execution","title":"Conditional execution","text":"<pre><code>git commit &amp;&amp; git push\ngit commit || echo \"Commit failed\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#functions","title":"Functions","text":"<p>{: id='functions-example'}</p> <pre><code>get_name() {\n  echo \"John\"\n}\n\necho \"You are $(get_name)\"\n</code></pre> <p>See: Functions</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#conditionals","title":"Conditionals","text":"<p>{: id='conditionals-example'}</p> <pre><code>if [[ -z \"$string\" ]]; then\n  echo \"String is empty\"\nelif [[ -n \"$string\" ]]; then\n  echo \"String is not empty\"\nfi\n</code></pre> <p>See: Conditionals</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#strict-mode","title":"Strict mode","text":"<pre><code>set -euo pipefail\nIFS=$'\\n\\t'\n</code></pre> <p>See: Unofficial bash strict mode</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#brace-expansion","title":"Brace expansion","text":"<pre><code>echo {A,B}.js\n</code></pre> <p>| <code>{A,B}</code> | Same as <code>A B</code> | | <code>{A,B}.js</code> | Same as <code>A.js B.js</code> | | <code>{1..5}</code> | Same as <code>1 2 3 4 5</code> |</p> <p>See: Brace expansion</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#parameter-expansions","title":"Parameter expansions","text":"<p>{: .-three-column}</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#basics","title":"Basics","text":"<pre><code>name=\"John\"\necho ${name}\necho ${name/J/j}    #=&gt; \"john\" (substitution)\necho ${name:0:2}    #=&gt; \"Jo\" (slicing)\necho ${name::2}     #=&gt; \"Jo\" (slicing)\necho ${name::-1}    #=&gt; \"Joh\" (slicing)\necho ${name:(-1)}   #=&gt; \"n\" (slicing from right)\necho ${name:(-2):1} #=&gt; \"h\" (slicing from right)\necho ${food:-Cake}  #=&gt; $food or \"Cake\"\n</code></pre> <pre><code>length=2\necho ${name:0:length}  #=&gt; \"Jo\"\n</code></pre> <p>See: Parameter expansion</p> <pre><code>STR=\"/path/to/foo.cpp\"\necho ${STR%.cpp}    # /path/to/foo\necho ${STR%.cpp}.o  # /path/to/foo.o\n\necho ${STR##*.}     # cpp (extension)\necho ${STR##*/}     # foo.cpp (basepath)\n\necho ${STR#*/}      # path/to/foo.cpp\necho ${STR##*/}     # foo.cpp\n\necho ${STR/foo/bar} # /path/to/bar.cpp\n</code></pre> <pre><code>STR=\"Hello world\"\necho ${STR:6:5}   # \"world\"\necho ${STR:-5:5}  # \"world\"\n</code></pre> <pre><code>SRC=\"/path/to/foo.cpp\"\nBASE=${SRC##*/}   #=&gt; \"foo.cpp\" (basepath)\nDIR=${SRC%$BASE}  #=&gt; \"/path/to/\" (dirpath)\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#substitution","title":"Substitution","text":"Code Description     <code>${FOO%suffix}</code> Remove suffix   <code>${FOO#prefix}</code> Remove prefix   --- ---   <code>${FOO%%suffix}</code> Remove long suffix   <code>${FOO##prefix}</code> Remove long prefix   --- ---   <code>${FOO/from/to}</code> Replace first match   <code>${FOO//from/to}</code> Replace all   --- ---   <code>${FOO/%from/to}</code> Replace suffix   <code>${FOO/#from/to}</code> Replace prefix","tags":["Featured"]},{"location":"cheatsheets/bash/#comments","title":"Comments","text":"<pre><code># Single line comment\n</code></pre> <pre><code>: '\nThis is a\nmulti line\ncomment\n'\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#substrings","title":"Substrings","text":"<p>| <code>${FOO:0:3}</code>  | Substring (position, length) | | <code>${FOO:-3:3}</code> | Substring from the right |</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#length","title":"Length","text":"<p>| <code>${#FOO}</code> | Length of <code>$FOO</code> |</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#manipulation","title":"Manipulation","text":"<pre><code>STR=\"HELLO WORLD!\"\necho ${STR,}   #=&gt; \"hELLO WORLD!\" (lowercase 1st letter)\necho ${STR,,}  #=&gt; \"hello world!\" (all lowercase)\n\nSTR=\"hello world!\"\necho ${STR^}   #=&gt; \"Hello world!\" (uppercase 1st letter)\necho ${STR^^}  #=&gt; \"HELLO WORLD!\" (all uppercase)\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#default-values","title":"Default values","text":"<p>| <code>${FOO:-val}</code>        | <code>$FOO</code>, or <code>val</code> if not set | | <code>${FOO:=val}</code>        | Set <code>$FOO</code> to <code>val</code> if not set | | <code>${FOO:+val}</code>        | <code>val</code> if <code>$FOO</code> is set | | <code>${FOO:?message}</code>    | Show error message and exit if <code>$FOO</code> is not set |</p> <p>The <code>:</code> is optional (eg, <code>${FOO=word}</code> works)</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#loops","title":"Loops","text":"<p>{: .-three-column}</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#basic-for-loop","title":"Basic for loop","text":"<pre><code>for i in /etc/rc.*; do\n  echo $i\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#c-like-for-loop","title":"C-like for loop","text":"<pre><code>for ((i = 0 ; i &lt; 100 ; i++)); do\n  echo $i\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#ranges","title":"Ranges","text":"<pre><code>for i in {1..5}; do\n    echo \"Welcome $i\"\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#with-step-size","title":"With step size","text":"<pre><code>for i in {5..50..5}; do\n    echo \"Welcome $i\"\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#reading-lines","title":"Reading lines","text":"<pre><code>cat file.txt | while read line; do\n  echo $line\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#forever","title":"Forever","text":"<pre><code>while true; do\n  \u00b7\u00b7\u00b7\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#functions_1","title":"Functions","text":"<p>{: .-three-column}</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#defining-functions","title":"Defining functions","text":"<pre><code>myfunc() {\n    echo \"hello $1\"\n}\n</code></pre> <pre><code># Same as above (alternate syntax)\nfunction myfunc() {\n    echo \"hello $1\"\n}\n</code></pre> <pre><code>myfunc \"John\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#returning-values","title":"Returning values","text":"<pre><code>myfunc() {\n    local myresult='some value'\n    echo $myresult\n}\n</code></pre> <pre><code>result=\"$(myfunc)\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#raising-errors","title":"Raising errors","text":"<pre><code>myfunc() {\n  return 1\n}\n</code></pre> <pre><code>if myfunc; then\n  echo \"success\"\nelse\n  echo \"failure\"\nfi\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#arguments","title":"Arguments","text":"Expression Description     <code>$#</code> Number of arguments   <code>$*</code> All arguments   <code>$@</code> All arguments, starting from first   <code>$1</code> First argument   <code>$_</code> Last argument of the previous command    <p>See Special parameters.</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#conditionals_1","title":"Conditionals","text":"<p>{: .-three-column}</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#conditions","title":"Conditions","text":"<p>Note that <code>[[</code> is actually a command/program that returns either <code>0</code> (true) or <code>1</code> (false). Any program that obeys the same logic (like all base utils, such as <code>grep(1)</code> or <code>ping(1)</code>) can be used as condition, see examples.</p>    Condition Description     <code>[[ -z STRING ]]</code> Empty string   <code>[[ -n STRING ]]</code> Not empty string   <code>[[ STRING == STRING ]]</code> Equal   <code>[[ STRING != STRING ]]</code> Not Equal   --- ---   <code>[[ NUM -eq NUM ]]</code> Equal   <code>[[ NUM -ne NUM ]]</code> Not equal   <code>[[ NUM -lt NUM ]]</code> Less than   <code>[[ NUM -le NUM ]]</code> Less than or equal   <code>[[ NUM -gt NUM ]]</code> Greater than   <code>[[ NUM -ge NUM ]]</code> Greater than or equal   --- ---   <code>[[ STRING =~ STRING ]]</code> Regexp   --- ---   <code>(( NUM &lt; NUM ))</code> Numeric conditions       Condition Description     <code>[[ -o noclobber ]]</code> If OPTIONNAME is enabled   --- ---   <code>[[ ! EXPR ]]</code> Not   <code>[[ X ]] &amp;&amp; [[ Y ]]</code> And   <code>[[ X ]] || [[ Y ]]</code> Or","tags":["Featured"]},{"location":"cheatsheets/bash/#file-conditions","title":"File conditions","text":"Condition Description     <code>[[ -e FILE ]]</code> Exists   <code>[[ -r FILE ]]</code> Readable   <code>[[ -h FILE ]]</code> Symlink   <code>[[ -d FILE ]]</code> Directory   <code>[[ -w FILE ]]</code> Writable   <code>[[ -s FILE ]]</code> Size is &gt; 0 bytes   <code>[[ -f FILE ]]</code> File   <code>[[ -x FILE ]]</code> Executable   --- ---   <code>[[ FILE1 -nt FILE2 ]]</code> 1 is more recent than 2   <code>[[ FILE1 -ot FILE2 ]]</code> 2 is more recent than 1   <code>[[ FILE1 -ef FILE2 ]]</code> Same files","tags":["Featured"]},{"location":"cheatsheets/bash/#example_1","title":"Example","text":"<pre><code># String\nif [[ -z \"$string\" ]]; then\n  echo \"String is empty\"\nelif [[ -n \"$string\" ]]; then\n  echo \"String is not empty\"\nfi\n</code></pre> <pre><code># Combinations\nif [[ X ]] &amp;&amp; [[ Y ]]; then\n  ...\nfi\n</code></pre> <pre><code># Equal\nif [[ \"$A\" == \"$B\" ]]\n</code></pre> <pre><code># Regex\nif [[ \"A\" =~ . ]]\n</code></pre> <pre><code>if (( $a &lt; $b )); then\n   echo \"$a is smaller than $b\"\nfi\n</code></pre> <pre><code>if [[ -e \"file.txt\" ]]; then\n  echo \"file exists\"\nfi\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#arrays","title":"Arrays","text":"","tags":["Featured"]},{"location":"cheatsheets/bash/#defining-arrays","title":"Defining arrays","text":"<pre><code>Fruits=('Apple' 'Banana' 'Orange')\n</code></pre> <pre><code>Fruits[0]=\"Apple\"\nFruits[1]=\"Banana\"\nFruits[2]=\"Orange\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#working-with-arrays","title":"Working with arrays","text":"<pre><code>echo ${Fruits[0]}           # Element #0\necho ${Fruits[@]}           # All elements, space-separated\necho ${#Fruits[@]}          # Number of elements\necho ${#Fruits}             # String length of the 1st element\necho ${#Fruits[3]}          # String length of the Nth element\necho ${Fruits[@]:3:2}       # Range (from position 3, length 2)\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#operations","title":"Operations","text":"<pre><code>Fruits=(\"${Fruits[@]}\" \"Watermelon\")    # Push\nFruits+=('Watermelon')                  # Also Push\nFruits=( ${Fruits[@]/Ap*/} )            # Remove by regex match\nunset Fruits[2]                         # Remove one item\nFruits=(\"${Fruits[@]}\")                 # Duplicate\nFruits=(\"${Fruits[@]}\" \"${Veggies[@]}\") # Concatenate\nlines=(`cat \"logfile\"`)                 # Read from file\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#iteration","title":"Iteration","text":"<pre><code>for i in \"${arrayName[@]}\"; do\n  echo $i\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#dictionaries","title":"Dictionaries","text":"<p>{: .-three-column}</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#defining","title":"Defining","text":"<pre><code>declare -A sounds\n</code></pre> <pre><code>sounds[dog]=\"bark\"\nsounds[cow]=\"moo\"\nsounds[bird]=\"tweet\"\nsounds[wolf]=\"howl\"\n</code></pre> <p>Declares <code>sound</code> as a Dictionary object (aka associative array).</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#working-with-dictionaries","title":"Working with dictionaries","text":"<pre><code>echo ${sounds[dog]} # Dog's sound\necho ${sounds[@]}   # All values\necho ${!sounds[@]}  # All keys\necho ${#sounds[@]}  # Number of elements\nunset sounds[dog]   # Delete dog\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#iteration_1","title":"Iteration","text":"","tags":["Featured"]},{"location":"cheatsheets/bash/#iterate-over-values","title":"Iterate over values","text":"<pre><code>for val in \"${sounds[@]}\"; do\n  echo $val\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#iterate-over-keys","title":"Iterate over keys","text":"<pre><code>for key in \"${!sounds[@]}\"; do\n  echo $key\ndone\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#options","title":"Options","text":"","tags":["Featured"]},{"location":"cheatsheets/bash/#options_1","title":"Options","text":"<pre><code>set -o noclobber  # Avoid overlay files (echo \"hi\" &gt; foo)\nset -o errexit    # Used to exit upon error, avoiding cascading errors\nset -o pipefail   # Unveils hidden failures\nset -o nounset    # Exposes unset variables\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#glob-options","title":"Glob options","text":"<pre><code>shopt -s nullglob    # Non-matching globs are removed  ('*.foo' =&gt; '')\nshopt -s failglob    # Non-matching globs throw errors\nshopt -s nocaseglob  # Case insensitive globs\nshopt -s dotglob     # Wildcards match dotfiles (\"*.sh\" =&gt; \".foo.sh\")\nshopt -s globstar    # Allow ** for recursive matches ('lib/**/*.rb' =&gt; 'lib/a/b/c.rb')\n</code></pre> <p>Set <code>GLOBIGNORE</code> as a colon-separated list of patterns to be removed from glob matches.</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#history","title":"History","text":"","tags":["Featured"]},{"location":"cheatsheets/bash/#commands","title":"Commands","text":"<p>| <code>history</code> | Show history | | <code>shopt -s histverify</code> | Don't execute expanded result immediately |</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#expansions","title":"Expansions","text":"<p>| <code>!$</code> | Expand last parameter of most recent command | | <code>!*</code> | Expand all parameters of most recent command | | <code>!-n</code> | Expand <code>n</code>th most recent command | | <code>!n</code> | Expand <code>n</code>th command in history | | <code>!&lt;command&gt;</code> | Expand most recent invocation of command <code>&lt;command&gt;</code> |</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#operations_1","title":"Operations","text":"<p>| <code>!!</code> | Execute last command again |        | <code>!!:s/&lt;FROM&gt;/&lt;TO&gt;/</code> | Replace first occurrence of <code>&lt;FROM&gt;</code> to <code>&lt;TO&gt;</code> in most recent command | | <code>!!:gs/&lt;FROM&gt;/&lt;TO&gt;/</code> | Replace all occurrences of <code>&lt;FROM&gt;</code> to <code>&lt;TO&gt;</code> in most recent command | | <code>!$:t</code> | Expand only basename from last parameter of most recent command | | <code>!$:h</code> | Expand only directory from last parameter of most recent command |</p> <p><code>!!</code> and <code>!$</code> can be replaced with any valid expansion.</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#slices","title":"Slices","text":"<p>| <code>!!:n</code> | Expand only <code>n</code>th token from most recent command (command is <code>0</code>; first argument is <code>1</code>) | | <code>!^</code> | Expand first argument from most recent command | | <code>!$</code> | Expand last token from most recent command | | <code>!!:n-m</code> | Expand range of tokens from most recent command | | <code>!!:n-$</code> | Expand <code>n</code>th token to last from most recent command |</p> <p><code>!!</code> can be replaced with any valid expansion i.e. <code>!cat</code>, <code>!-2</code>, <code>!42</code>, etc.</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#miscellaneous","title":"Miscellaneous","text":"","tags":["Featured"]},{"location":"cheatsheets/bash/#numeric-calculations","title":"Numeric calculations","text":"<pre><code>$((a + 200))      # Add 200 to $a\n</code></pre> <pre><code>$((RANDOM%=200))  # Random number 0..200\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#subshells","title":"Subshells","text":"<pre><code>(cd somedir; echo \"I'm now in $PWD\")\npwd # still in first directory\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#redirection","title":"Redirection","text":"<pre><code>python hello.py &gt; output.txt   # stdout to (file)\npython hello.py &gt;&gt; output.txt  # stdout to (file), append\npython hello.py 2&gt; error.log   # stderr to (file)\npython hello.py 2&gt;&amp;1           # stderr to stdout\npython hello.py 2&gt;/dev/null    # stderr to (null)\npython hello.py &amp;&gt;/dev/null    # stdout and stderr to (null)\n</code></pre> <pre><code>python hello.py &lt; foo.txt      # feed foo.txt to stdin for python\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#inspecting-commands","title":"Inspecting commands","text":"<pre><code>command -V cd\n#=&gt; \"cd is a function/alias/whatever\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#trap-errors","title":"Trap errors","text":"<pre><code>trap 'echo Error at about $LINENO' ERR\n</code></pre> <p>or</p> <pre><code>traperr() {\n  echo \"ERROR: ${BASH_SOURCE[1]} at about ${BASH_LINENO[0]}\"\n}\n\nset -o errtrace\ntrap traperr ERR\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#caseswitch","title":"Case/switch","text":"<pre><code>case \"$1\" in\n  start | up)\n    vagrant up\n    ;;\n\n  *)\n    echo \"Usage: $0 {start|stop|ssh}\"\n    ;;\nesac\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#source-relative","title":"Source relative","text":"<pre><code>source \"${0%/*}/../share/foo.sh\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#printf","title":"printf","text":"<pre><code>printf \"Hello %s, I'm %s\" Sven Olga\n#=&gt; \"Hello Sven, I'm Olga\n\nprintf \"1 + 1 = %d\" 2\n#=&gt; \"1 + 1 = 2\"\n\nprintf \"This is how you print a float: %f\" 2\n#=&gt; \"This is how you print a float: 2.000000\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#directory-of-script","title":"Directory of script","text":"<pre><code>DIR=\"${0%/*}\"\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#getting-options","title":"Getting options","text":"<pre><code>while [[ \"$1\" =~ ^- &amp;&amp; ! \"$1\" == \"--\" ]]; do case $1 in\n  -V | --version )\n    echo $version\n    exit\n    ;;\n  -s | --string )\n    shift; string=$1\n    ;;\n  -f | --flag )\n    flag=1\n    ;;\nesac; shift; done\nif [[ \"$1\" == '--' ]]; then shift; fi\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#heredoc","title":"Heredoc","text":"<pre><code>cat &lt;&lt;END\nhello world\nEND\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#reading-input","title":"Reading input","text":"<pre><code>echo -n \"Proceed? [y/n]: \"\nread ans\necho $ans\n</code></pre> <pre><code>read -n 1 ans    # Just one character\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#special-variables","title":"Special variables","text":"<p>| <code>$?</code> | Exit status of last task | | <code>$!</code> | PID of last background task | | <code>$$</code> | PID of shell | | <code>$0</code> | Filename of the shell script |</p> <p>See Special parameters.</p>","tags":["Featured"]},{"location":"cheatsheets/bash/#go-to-previous-directory","title":"Go to previous directory","text":"<pre><code>pwd # /home/user/foo\ncd bar/\npwd # /home/user/foo/bar\ncd -\npwd # /home/user/foo\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#check-for-commands-result","title":"Check for command's result","text":"<pre><code>if ping -c 1 google.com; then\n  echo \"It appears you have a working internet connection\"\nfi\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#grep-check","title":"Grep check","text":"<pre><code>if grep -q 'foo' ~/.bash_history; then\n  echo \"You appear to have typed 'foo' in the past\"\nfi\n</code></pre>","tags":["Featured"]},{"location":"cheatsheets/bash/#also-see","title":"Also see","text":"<p>{: .-one-column}</p> <ul> <li>Bash-hackers wiki (bash-hackers.org)</li> <li>Shell vars (bash-hackers.org)</li> <li>Learn bash in y minutes (learnxinyminutes.com)</li> <li>Bash Guide (mywiki.wooledge.org)</li> <li>ShellCheck (shellcheck.net)</li> </ul>","tags":["Featured"]},{"location":"cheatsheets/docker/","title":"Docker scripting cheatsheets","text":""},{"location":"cheatsheets/docker/#common-docker-commands","title":"Common Docker commands","text":""},{"location":"cheatsheets/docker/#update-all-images","title":"update all images","text":"<pre><code>docker images |grep -v REPOSITORY|awk '{print $1}'|xargs -L1 docker pull\n</code></pre>"},{"location":"cheatsheets/docker/#remove-exited-container","title":"Remove exited container","text":"<pre><code>docker rm `docker ps -a -q -f \"status=exited\"`\n</code></pre>"},{"location":"cheatsheets/docker/#remove-dangling-images","title":"Remove dangling images","text":"<pre><code>docker rmi `docker images -q --filter \"dangling=true\"`\n</code></pre>"},{"location":"common/acl/","title":"Define access control list for application","text":""},{"location":"common/acl/#goals","title":"Goals","text":"<ul> <li>restrict access to applications using authentication label </li> </ul>"},{"location":"common/acl/#requirements","title":"Requirements","text":"<ul> <li>A running dockerd last version </li> <li>An access to the docker public registry</li> <li>An access to the ubuntu repository</li> <li>Nodejs installed on your host.  </li> </ul>"},{"location":"common/acl/#update-applistjson-file","title":"Update applist.json file","text":"<p>To restrict access to applications using authentication label, you need to define an <code>acl</code> entry in the application dictionary object.</p> <pre><code>    \"acl\": { \"permit\": [ \"tag\" ] },\n</code></pre> <p>For example using the application <code>xedit</code></p> <p><code>all</code> is a special label for everything. The <code>xedit</code> application can be run for all tags.</p> <pre><code>{\n    \"acl\": { \"permit\": [ \"all\" ] },\n    \"cat\": \"utilities\",\n    \"debpackage\": \"x11-apps\",\n    \"icon\": \"xedit.svg\",\n    \"keyword\": \"text,notepad,edit,txt,editor,xedit\",\n    \"launch\": \"xedit.Xedit\",\n    \"name\": \"xedit\",\n    \"displayname\": \"Xedit\",\n    \"path\": \"/usr/bin/xedit\",\n    \"template\": \"abcdesktopio/oc.template.gtk\",\n    \"mimetype\": \"application/text;\",\n    \"fileextensions\":\"txt;log;md\"\n}\n</code></pre> <p>To restrict access to applications using authentication label, you have to define label using rules during authentification step, and define label to the application.</p>"},{"location":"common/acl/#define-authenticated-label-using-rules","title":"Define authenticated label using rules","text":"<p>You can read the chapter authentification-rules to define some autenticated labels.</p> <p>Update the od.config file, to add a label <code>mylocal</code> if the source ip address is in local network <code>192.168.0.0/16</code></p> <pre><code>authmanagers: {\n 'external': {},\n 'explicit': {},\n 'implicit': {\n   'providers': {\n     'anonymous': {\n        'displayname': 'Anonymous',\n        'caption': 'Have a look !',\n        'userid': 'anonymous',\n        'username': 'Anonymous',\n        'policies': { \n          'acl'   : { 'permit': [ 'all' ] }, \n            'rules' : \n                { 'rule-net-home': {  \n                    'conditions' : [ { 'network': '192.168.0.0/16', 'expected' : True } ],\n                    'expected'   : True,\n                    'label'      : 'localnet'\n                   } \n                } \n        } \n     } \n    } \n  } \n} \n\n</code></pre> <p>Restart the pyos service </p>  <p>Using kubernetes run </p> <p><code>kubectl rollout restart daemonset daemonset-pyos -n abcdesktop</code></p> <p>Using docker only, run </p> <p><code>docker-compose restart</code> </p>  <p>When your services are restarted, launch your web browser</p>  <p>Login to your abcdesktop service and choose anonymous authentication</p>  <p>Check the label set during the authentication process</p> <p>Goto the menu option at the right up corner, choose <code>Settings</code> | <code>User</code> | <code>Session</code> </p>  <p>You should read the label <code>localnet</code> in the Anonymous user information.</p>"},{"location":"common/acl/#define-the-acl-label-to-the-application","title":"Define the acl label to the application","text":"<p>You can read the chapter Build your own application image , if your are building user docker abcdsktop application image for the first time.</p>"},{"location":"common/acl/#create-a-xeditjson-file","title":"Create a xedit.json file","text":"<p>Create a edit.json file with the content :</p> <pre><code>{\n    \"acl\": { \"permit\": [ \"localhost\", \"localnet\"  ] },\n    \"cat\": \"utilities\",\n    \"debpackage\": \"x11-apps\",\n    \"icon\": \"xedit.svg\",\n    \"keyword\": \"text,notepad,edit,txt,editor,xedit\",\n    \"launch\": \"xedit.Xedit\",\n    \"name\": \"xedit\",\n    \"displayname\": \"Xedit\",\n    \"path\": \"/usr/bin/xedit\",\n    \"template\": \"abcdesktopio/oc.template.gtk\",\n    \"mimetype\": \"application/text;\",\n    \"fileextensions\":\"txt;log;md\"\n}\n</code></pre> <p>To build your new image, download the make.js script file. <code>make.js</code> is located in the <code>oc.apps</code> repository. Look at https://github.com/abcdesktopio/oc.apps if you can't download this file. </p> <p>Make sure that you have installed <code>nodejs</code></p> <p>To install <code>make.js</code> command </p> <pre><code>wget https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/make.js\n</code></pre> <p>Create <code>icons</code> directory</p> <pre><code>mkdir -p icons\ncurl --output icons/xedit.svg https://raw.githubusercontent.com/abcdesktopio/oc.apps/main/icons/xedit.svg \n</code></pre> <p>Run the make command </p> <pre><code>node make.js -f xedit.json Dockerfile\n</code></pre> <p>You should read on standard output </p> <pre><code>myArgs:  [ '-f', 'xedit.json', 'Dockerfile' ]\nopening file xedit.json\napplist.json entries: 1\nmyArgs:  [ '-f', 'xedit.json', 'Dockerfile' ]\nBuilding file Dockerfile as output\n{\n  acl: { permit: [ 'all' ] },\n  cat: 'utilities',\n  debpackage: 'x11-apps',\n  icon: 'xedit.svg',\n  keyword: 'text,notepad,edit,txt,editor,xedit',\n  launch: 'xedit.Xedit',\n  name: 'xedit',\n  displayname: 'Xedit',\n  path: '/usr/bin/xedit',\n  template: 'abcdesktopio/oc.template.gtk',\n  mimetype: 'application/text;',\n  fileextensions: 'txt;log;md'\n}\nBuilding xedit.Xedit\n</code></pre> <p>Look at the new <code>Dockerfile</code>, and build the new docker image for <code>xedit</code> </p> <pre><code>docker build -t xedit.d .\n</code></pre> <p>You should read on standard output</p> <pre><code>[+] Building 13.0s (11/11) FINISHED                                                                                                                                                                     \n =&gt; [internal] load build definition from Dockerfile                                                                                                                                               0.0s\n =&gt; =&gt; transferring dockerfile: 2.01kB                                                                                                                                                             0.0s\n =&gt; [internal] load .dockerignore                                                                                                                                                                  0.0s\n =&gt; =&gt; transferring context: 2B                                                                                                                                                                    0.0s\n =&gt; [internal] load metadata for docker.io/abcdesktopio/oc.template.gtk:dev                                                                                                                        2.3s\n =&gt; [auth] abcdesktopio/oc.template.gtk:pull token for registry-1.docker.io                                                                                                                        0.0s\n =&gt; [1/6] FROM docker.io/abcdesktopio/oc.template.gtk:dev@sha256:4aac32209c27a3e88906f39aecdfee6833bed022871366356bfd5518e2248b79                                                                  0.4s\n =&gt; =&gt; resolve docker.io/abcdesktopio/oc.template.gtk:dev@sha256:4aac32209c27a3e88906f39aecdfee6833bed022871366356bfd5518e2248b79                                                                  0.0s\n =&gt; =&gt; sha256:4aac32209c27a3e88906f39aecdfee6833bed022871366356bfd5518e2248b79 3.88kB / 3.88kB                                                                                                     0.0s\n =&gt; =&gt; sha256:fe01ec1c214baf8b3e86255ac7dbca3157be4932ae19dfe07bbcf7d8c8839b07 7.80kB / 7.80kB                                                                                                     0.0s\n =&gt; [2/6] RUN DEBIAN_FRONTEND=noninteractive apt-get update &amp;&amp; apt-get install -y  --no-install-recommends x11-apps &amp;&amp; apt-get clean                                                               8.7s\n =&gt; [3/6] RUN echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections                                                                                                       0.4s\n =&gt; [4/6] RUN  if [ -d /usr/share/icons ];   then cd /usr/share/icons;    /composer/safelinks.sh; fi                                                                                               0.3s \n =&gt; [5/6] RUN  if [ -d /usr/share/pixmaps ]; then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi                                                                                               0.3s \n =&gt; [6/6] WORKDIR /home/balloon                                                                                                                                                                    0.0s \n =&gt; exporting to image                                                                                                                                                                             0.3s \n =&gt; =&gt; exporting layers                                                                                                                                                                            0.3s \n =&gt; =&gt; writing image sha256:0b7cb908c88bf6301eb0555e558e99436e40bd5604e7ffebd12f137e9b5f9878                                                                                                       0.0s\n =&gt; =&gt; naming to docker.io/library/xedit.d  \n</code></pre> <p>Then look at the acl label</p> <pre><code>docker inspect xedit.d | grep oc.acl\n</code></pre> <pre><code>                \"oc.acl\": \"{\\\"permit\\\":[\\\"localhost\\\",\\\"localnet\\\"]}\",\n                \"oc.acl\": \"{\\\"permit\\\":[\\\"localhost\\\",\\\"localnet\\\"]}\",\n</code></pre> <p>The acl is stringified json object.</p>"},{"location":"common/acl/#run-the-xedit-application-from-your-local-network","title":"Run the xedit application from your local network","text":"<p>The xedit application is listed only if your are connected from a local network matching the previous rules.</p> <p>Look for the application <code>xedit</code>, using the quick launch search text area on the bottom right corner. Insert the first character of xedit :</p>  <p>Launch the <code>xedit</code> application</p>"},{"location":"common/acl/#run-the-application-from-another-source-ip-address-or-update-the-acl-application","title":"Run the application from another source IP address or update the acl application","text":""},{"location":"common/acl/#update-acl-of-xedit-application","title":"Update acl of xedit application","text":"<p>To update the <code>acl</code> of <code>xedit</code> application, edit the edit.json file with the content, and set <code>nowhere</code> tag in <code>acl</code> array :</p> <pre><code>{\n    \"acl\": { \"permit\": [ \"nowhere\"  ] },\n    \"cat\": \"utilities\",\n    \"debpackage\": \"x11-apps\",\n    \"icon\": \"xedit.svg\",\n    \"keyword\": \"text,notepad,edit,txt,editor,xedit\",\n    \"launch\": \"xedit.Xedit\",\n    \"name\": \"xedit\",\n    \"displayname\": \"Xedit\",\n    \"path\": \"/usr/bin/xedit\",\n    \"template\": \"abcdesktopio/oc.template.gtk\",\n    \"mimetype\": \"application/text;\",\n    \"fileextensions\":\"txt;log;md\"\n}\n</code></pre> <p>Then, rebuild <code>Dockerfile</code> and the <code>docker image</code> of the xedit application</p> <pre><code>node make.js -f xedit.json Dockerfile\ndocker build -t xedit.d .\n</code></pre> <pre><code>% node make.js -f xedit.json Dockerfile\nmyArgs:  [ '-f', 'xedit.json', 'Dockerfile' ]\nopening file xedit.json\napplist.json entries: 1\nmyArgs:  [ '-f', 'xedit.json', 'Dockerfile' ]\nBuilding file Dockerfile as output\n{\n  acl: { permit: [ 'nowhere' ] },\n  cat: 'utilities',\n  debpackage: 'x11-apps',\n  icon: 'xedit.svg',\n  keyword: 'text,notepad,edit,txt,editor,xedit',\n  launch: 'xedit.Xedit',\n  name: 'xedit',\n  displayname: 'Xedit',\n  path: '/usr/bin/xedit',\n  template: 'abcdesktopio/oc.template.gtk',\n  mimetype: 'application/text;',\n  fileextensions: 'txt;log;md'\n}\nBuilding xedit.Xedit\n\n% docker build -t xedit.d .\n[+] Building 1.5s (11/11) FINISHED                                                                                                                                                                      \n =&gt; [internal] load build definition from Dockerfile                                                                                                                                               0.0s\n =&gt; =&gt; transferring dockerfile: 4.19kB                                                                                                                                                             0.0s\n =&gt; [internal] load .dockerignore                                                                                                                                                                  0.0s\n =&gt; =&gt; transferring context: 2B                                                                                                                                                                    0.0s\n =&gt; [internal] load metadata for docker.io/abcdesktopio/oc.template.gtk:dev                                                                                                                        1.4s\n =&gt; [auth] abcdesktopio/oc.template.gtk:pull token for registry-1.docker.io                                                                                                                        0.0s\n =&gt; [1/6] FROM docker.io/abcdesktopio/oc.template.gtk:dev@sha256:4aac32209c27a3e88906f39aecdfee6833bed022871366356bfd5518e2248b79                                                                  0.0s\n =&gt; CACHED [2/6] RUN DEBIAN_FRONTEND=noninteractive apt-get update &amp;&amp; apt-get install -y  --no-install-recommends x11-apps &amp;&amp; apt-get clean                                                        0.0s\n =&gt; CACHED [3/6] RUN echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections                                                                                                0.0s\n =&gt; CACHED [4/6] RUN  if [ -d /usr/share/icons ];   then cd /usr/share/icons;    /composer/safelinks.sh; fi                                                                                        0.0s\n =&gt; CACHED [5/6] RUN  if [ -d /usr/share/pixmaps ]; then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi                                                                                        0.0s\n =&gt; CACHED [6/6] WORKDIR /home/balloon                                                                                                                                                             0.0s\n =&gt; exporting to image                                                                                                                                                                             0.0s\n =&gt; =&gt; exporting layers                                                                                                                                                                            0.0s\n =&gt; =&gt; writing image sha256:640a4dd66b03420c4128e2fcd920dc5749cc5b687abc62b68e52f3c562943903                                                                                                       0.0s\n =&gt; =&gt; naming to docker.io/library/xedit.d       \n</code></pre> <p>Launch your web browser, and log in to your abcdesktop service</p> <p>Check that <code>xedit</code> is not found and not listed.</p>  <p>The new <code>acl</code> does not allow the <code>xedit</code> application to be run and show. You can now define your own rules, add set the access control list to your applications.</p>"},{"location":"common/custom-wallpaper/","title":"Customize default wallpaper","text":""},{"location":"common/custom-wallpaper/#requirements","title":"Requirements","text":""},{"location":"common/custom-wallpaper/#goals","title":"Goals","text":"<ul> <li>Change the default wallpaper and use your own</li> </ul>"},{"location":"common/custom-wallpaper/#change-odconfig-file","title":"Change od.config file","text":"<p>To update the default wallpaper file, add a <code>ENV</code> variable in the <code>desktop.envlocal</code> dictionary.</p> <ul> <li>Add the new entry <code>SET_DEFAULT_WALLPAPER</code> to the value like <code>welcometoabcdesktop.png</code>. The file <code>welcometoabcdesktop.png</code> already exists in the <code>/composer/wallpapers</code> directory of your abcdesktopio/oc.user.XX.YY container image.</li> </ul> <pre><code>desktop.envlocal :  {   'DISPLAY'               : ':0.0',\n                        'USER'                  : 'balloon',\n                        'LOGNAME'               : 'balloon',\n                        'LIBOVERLAY_SCROLLBAR'  : '0',\n                        'UBUNTU_MENUPROXY'      : '0',\n                        'HOME'                  : '/home/balloon',\n                          'SET_DEFAULT_WALLPAPER' : 'welcometoabcdesktop.png'\n                    } \n</code></pre> <ul> <li>Restart your pyos daemon, to make sure that the <code>ENV</code> dictionary will be use to start a new user container.</li> <li>Login on your abcdesktop service, your should see the wallpaper file:</li> </ul>"},{"location":"common/custom-wallpaper/#update-ocuser-image-to-add-your-own-wallpaper","title":"Update oc.user image to add your own wallpaper","text":""},{"location":"common/custom-wallpaper/#find-a-new-wallpaper-image","title":"Find a new wallpaper image","text":"<ul> <li>Download a new wallpaper image, for example I choose the file on unsplash.com web site wallpaper unsplash from Silas Baisch</li> <li>Rename the downloaded file as silas-baisch-unsplash.jpg</li> </ul>"},{"location":"common/custom-wallpaper/#create-a-new-ocuser-image","title":"Create a new oc.user image","text":"<ul> <li>Create a Dockerfile to copy the new wallpaper file in <code>/composer/wallpapers</code> directory</li> </ul> <p>Not For a development environment, add the TAG dev</p> <pre><code>FROM abcdesktopio/oc.user.18.04:dev \nUSER root\nCOPY silas-baisch-unsplash.jpg /composer/wallpapers\nUSER balloon\n</code></pre> <ul> <li>Build the new docker image</li> </ul> <p>To build the new docker image, run the command line</p> <pre><code>docker build -t abcdesktopio/oc.user.18.04 .\n</code></pre> <p>You should read on the standard output :</p> <pre><code>Sending build context to Docker daemon  3.184MB\nStep 1/4 : FROM abcdesktopio/oc.user.18.04:dev\n ---&gt; 61bfdb4e71d4\nStep 2/4 : USER root\n ---&gt; Using cache\n ---&gt; c1aa17b9999c\nStep 3/4 : COPY silas-baisch-unsplash.jpg /composer/wallpapers\n ---&gt; 73c786ecca04\nStep 4/4 : USER balloon\n ---&gt; Running in 1e0ad794c0cb\nRemoving intermediate container 1e0ad794c0cb\n ---&gt; a0b12a183b47\nSuccessfully built a0b12a183b47\nSuccessfully tagged abcdesktopio/oc.user.18.04:dev\n</code></pre>"},{"location":"common/custom-wallpaper/#change-odconfig-file_1","title":"Change od.config file","text":"<p>To update the default wallpaper file, add a <code>ENV</code> variable in the <code>desktop.envlocal</code> dictionary.</p> <ul> <li>Add the new entry <code>SET_DEFAULT_WALLPAPER</code> to the value like <code>silas-baisch-unsplash.jpg</code>. The file <code>silas-baisch-unsplash.jpg</code> exists in the <code>/composer/wallpapers</code> directory of your new <code>abcdesktopio/oc.user.18.04</code> container image.</li> </ul> <pre><code>desktop.envlocal :  {   'DISPLAY'               : ':0.0',\n                        'USER'                  : 'balloon',\n                        'LOGNAME'               : 'balloon',\n                        'LIBOVERLAY_SCROLLBAR'  : '0',\n                        'UBUNTU_MENUPROXY'      : '0',\n                        'HOME'                  : '/home/balloon',\n                          'SET_DEFAULT_WALLPAPER' : 'silas-baisch-unsplash.jpg'\n                    } \n</code></pre> <ul> <li>Restart your pyos daemon, to make sure that the <code>ENV</code> dictionary will be use to start a new user container.</li> <li>Login on your abcdesktop service, your should see the wallpaper :</li> </ul>"},{"location":"common/debug_application/","title":"How to debug containerised application","text":""},{"location":"common/debug_application/#requirements","title":"Requirements","text":"<ul> <li>abcdesktop ready to run</li> <li><code>docker</code> or <code>ctr</code> package should be install on your Linux (optional)</li> </ul>"},{"location":"common/debug_application/#goals","title":"Goals","text":"<ul> <li>Read log from web interface</li> <li>Read log from daemon interface (optionnal)</li> <li>Read stdout and stderr, dump all environment variables, and entrypoint log, to troubleshoot application error and get quick informations</li> </ul>"},{"location":"common/debug_application/#read-log-from-web-interface","title":"Read log from web interface","text":"<p>Start an containerised application, I choose <code>2048</code> application, for example.</p>  <p>Using the web browser, choose <code>Settings</code> in the menu.</p>  <p>Choose <code>Tasks</code> to list all running containers</p>  <p>Choose <code>Logs</code> to read the stdout log file of an application</p>  <p>This application write on <code>stdout</code></p> <pre><code>Error setting cipher RC4\n40F7D1D5D07F0000:error:0308010C:digital envelope routines:inner_evp_generic_fetch:unsupported:../crypto/evp/evp_fetch.c:349:Global default library context, Algorithm (RC4 : 37), Properties ()\nQStandardPaths: XDG_RUNTIME_DIR not set, defaulting to '/tmp/runtime-balloon'\nqml: Started a new game\n</code></pre>"},{"location":"common/debug_application/#read-log-from-daemon-interface-optionnal","title":"Read log from daemon interface (optionnal)","text":"<p>You will read the sample stdout line, using a <code>docker logs</code> command, open a shell on you host.</p> <p>In a shell on your host, look for the <code>container id</code> of the <code>2048</code> containerised application</p> <pre><code>$ docker ps -a|grep 2048\n01579054a1f6   abcdesktopio/ubuntu-2048.d:3.0   \"/composer/appli-doc\u2026\"   21 minutes ago     Up 21 minutes                                                                   anonymous-ubuntu-2048-37830ad00d9f473aa4d0c7872089c6b8\n</code></pre> <p>Read the log file form the <code>docker logs</code> command</p> <pre><code>$ docker logs 01579054a1f6\n</code></pre> <p>You should read on output the same lines written on the web interface</p> <pre><code>Error setting cipher RC4\n40F7D1D5D07F0000:error:0308010C:digital envelope routines:inner_evp_generic_fetch:unsupported:../crypto/evp/evp_fetch.c:349:Global default library context, Algorithm (RC4 : 37), Properties ()\nQStandardPaths: XDG_RUNTIME_DIR not set, defaulting to '/tmp/runtime-balloon'\nqml: Started a new game\n</code></pre>"},{"location":"common/debug_application/#read-log-files-from-an-application-using-the-redirected-stderr-and-stdout","title":"Read log files from an application using the redirected <code>stderr</code> and <code>stdout</code>","text":"<p>The main log files are <code>lastcmd.log</code> <code>lastcmdenv.log</code> and <code>$APPBIN.log</code>:</p> <ul> <li><code>/tmp/lastcmd.log</code> : contains the stdout file of the init script command <code>/composer/appli-docker-entrypoint.sh</code> for latest running application</li> <li><code>/tmp/lastcmdenv.log</code>: contains the dump of all environment variables for latest running application</li> <li><code>/tmp/$APPBIN.log</code>: contains <code>stderr</code> and <code>stdout</code> of the application <code>$APPBIN</code>. <code>$APPBIN</code> should be replace by the name of your binary application filename.</li> </ul> <p>By default, with all abcdesktop templates, applications redirect <code>stderr</code> to <code>stdout</code> and pipe to a tee.</p> <pre><code>${APP} ${ARGS} \"${APPARGS}\" 2&gt;&amp;1 | tee /tmp/$BASENAME_APP.log\n</code></pre> <p>By default, the <code>/tmp</code> volume is shared with all containers. So to debug and read log applications, you can run a <code>webshell</code> to have an access to <code>stdout</code> and <code>stderr</code> content.</p> <p>The var <code>$BASENAME_APP</code> is the name of your application</p> <pre><code>BASENAME_APP=$(basename \"$APPBIN\")\n</code></pre> <p>and <code>APPBIN</code> is <code>path</code> to the binary</p> <p>Example with the <code>2048-qt</code> application</p> <pre><code>APPBIN=/usr/games/2048-qt\n</code></pre>  <p>The <code>/tmp</code> directory, you can read the log file '/tmp/2048-qt.log'. Look at the <code>/tmp</code> directory</p> <pre><code>balloon:~$ ls -la /tmp/\ntotal 20\ndrwxrwxrwt 5 root    root     260 Dec  1 09:58 .\ndrwxr-xr-x 1 root    root    4096 Dec  1 09:55 ..\n-rw-r--r-- 1 balloon balloon  102 Dec  1 09:58 2048-qt.log\nsrwxrwxrwx 1 root    root       0 Dec  1 09:55 .cups.sock\n-rw-r--r-- 1 balloon balloon    0 Dec  1 09:57 gnome-2048.log\n-rw-r--r-- 1 balloon balloon 1175 Dec  1 09:58 lastcmdenv.log\n-rw-r--r-- 1 balloon balloon  437 Dec  1 09:58 lastcmd.log\ndrwx------ 2 balloon balloon   60 Dec  1 09:55 pulse-jkzlygT9Y7lT\nsrwxrwxrwx 1 balloon balloon    0 Dec  1 09:55 .pulse.sock\ndrwx------ 2 balloon balloon   40 Dec  1 09:58 runtime-balloon\n-r--r--r-- 1 balloon balloon   11 Dec  1 09:55 .X0-lock\ndrwxrwxrwt 2 root    root      60 Dec  1 09:55 .X11-unix\nsrw------- 1 balloon balloon    0 Dec  1 09:55 .x11vnc\nballoon:~$\n</code></pre> <p>The files are <code>/tmp/lastcmd.log</code>, <code>/tmp/lastcmdenv.log</code> and  <code>/tmp/2048-qt.log</code>.</p> <ul> <li><code>/tmp/lastcmd.log</code> the init command log file created by  <code>/composer/appli-docker-entrypoint.sh</code></li> <li><code>/tmp/lastcmdenv.log</code> the last environment variables file</li> <li><code>/tmp/2048-qt.log</code> the command log file for the application</li> </ul> <p>Dump the <code>/tmp/2048-qt.log</code>, with a cat command <code>cat /tmp/2048-qt.log</code>. Replace <code>/tmp/2048-qt.log</code> by your own application (binary) if you choose another application.</p> <p>You can run all bash commands inside the <code>webshell</code>.</p> <pre><code>balloon:~$ cat /tmp/2048-qt.log \nQStandardPaths: XDG_RUNTIME_DIR not set, defaulting to '/tmp/runtime-balloon'\nqml: Started a new game\n</code></pre> <p>Dump the <code>/composer/appli-docker-entrypoint.sh</code> result in <code>/tmp/lastcmd.log</code>, with a cat command <code>cat /tmp/lastcmd.log</code>.</p> <pre><code>balloon:~$ cat /tmp/lastcmd.log \nAPP=/usr/bin/gnome-2048\nARGS=\nAPPARGS=\nrun previous init overlay stack\nrun init app if exists\nBASENAME_APP=gnome-2048\nxauth add :0.0 MIT-MAGIC-COOKIE-1 55dd9838e9404e3b13b635153365d3\nsetting pulseaudio cookie\nend of app exit_code=0\n</code></pre> <p>Dump all environment variables in file <code>/tmp/lastcmdenv.log</code>.</p> <pre><code>balloon:/tmp$ cat /tmp/lastcmdenv.log \nBUSER=balloon\nSENDCUTTEXT=enabled\nPARENT_ID=2eecb67f5408c2552e7ee78b4fa2c9a419e9af9557c12c4d2f9f5c4fd1af70f4\nAPPBIN=/usr/games/2048-qt\nHOSTNAME=c477d8983486\nLANGUAGE=en_US\nSTDOUT_LOGFILE=/tmp/lastcmd.log\nLC_ADDRESS=en_US.UTF-8\nCUPS_SERVER=/tmp/.cups.sock\nLIBOVERLAY_SCROLLBAR=0\nLC_MONETARY=en_US.UTF-8\nPULSEAUDIO_COOKIE=17de4db317fbf10624911dbe28c528bd\nPWD=/home/balloon\nLOGNAME=balloon\nXAUTH_KEY=55dd9838e9404e3b13b635153365d3\nTZ=Europe/Paris\nHOME=/home/balloon\nLC_PAPER=en_US.UTF-8\nLANG=en_US.UTF-8\nACCEPTCUTTEXT=enabled\nAPP=/usr/games/2048-qt\nAPPNAME=ubuntu-2048\nDEBCONF_FRONTEND=noninteractive\nSET_DEFAULT_WALLPAPER=welcometoabcdesktop.png\nTERM=linux\nLC_IDENTIFICATION=en_US.UTF-8\nUSER=balloon\nDISPLAY=:0.0\nSHLVL=1\nLC_TELEPHONE=en_US.UTF-8\nLC_MEASUREMENT=en_US.UTF-8\nUBUNTU_MENUPROXY=0\nSTDOUT_ENVLOGFILE=/tmp/lastcmdenv.log\nBROADCAST_COOKIE=b7bc93457df5aa6bedb5ad2fe972268fa268bf3439b4024c\nLC_TIME=en_US.UTF-8\nLC_ALL=en_US.UTF-8\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPULSE_SERVER=/tmp/.pulse.sock\nLC_NUMERIC=en_US.UTF-8\n</code></pre> <p>We describe how to read the environment variables, the stdout file and the stderr file, to get some information and error for a containerised application.</p> <p>In next chapter we will start an application from a fresh ubuntu image, to get more details.</p>"},{"location":"common/firefox-extension/","title":"Mozilla Firefox clipboard extension","text":""},{"location":"common/firefox-extension/#install-firefox-extension-file","title":"Install Firefox Extension file","text":""},{"location":"common/firefox-extension/#download-the-mozilla-firefox-clipboard-extension-for-abcdesktop","title":"Download the Mozilla Firefox clipboard extension for abcdesktop","text":"<ol> <li> <p>Download the firefox clipboard extension abcdesktop_clipboard_helper.xpi and press <code>Continue to Installation</code> button. </p> </li> <li> <p>Choose <code>Add</code> as a response to the question <code>Add abcdesktop Clipboad Helper ?</code> </p> </li> <li> <p>Press <code>OKay, Got it</code> to confirm the <code>abcdesktop Clipboad helper</code> insallation </p> </li> </ol>"},{"location":"common/firefox-extension/#use-fully-qualified-domain-name-filter","title":"Use fully qualified domain name filter","text":"<p>Firefox clipboard extension runs ONLY if the hostname contains <code>desktop</code> string.</p> <p>The URL must matches <code>*://*desktop*/*\"</code> to run the clipboard extension.</p> <ul> <li><code>https://demo.abcdesktop.io</code> matches, the firefox clipboard extension is running.</li> <li><code>https://desktop.domain.io</code> matches, the firefox clipboard extension is running.</li> <li><code>https://abcdesktop.mydomain.local</code> matches, the firefox clipboard extension is running.</li> <li><code>https://demo.domain.com</code> does not match, the firefox clipboard extension is not running.</li> </ul>"},{"location":"common/firefox-extension/#run-firefox-clipboard-extension-for-abcdesktop","title":"Run firefox clipboard extension for abcdesktop","text":"<p>Firefox clipboard extension syncs only text data, binary data like images are not yet supported. </p>  <ul> <li> <p>Firefox clipboard extension syncs your clipboard data selected from your abcdesktop desktop to your local desktop environment. </p> </li> <li> <p>Firefox clipboard extension syncs your local desktop environment clipboard to your abcdesktop desktop clipboard.</p> </li> </ul>"},{"location":"common/flash-firefox-esr/","title":"How to build and run abcdesktop firefox-esr image to run flash application","text":"<p>Adobe no longer supports Flash Player after December 31, 2020 and blocked Flash content from running in Flash Player beginning January 12, 2021.</p> <p>Lot of applications need to be rewrite, this can take time to rewrite application using HTML5. </p> <p>Abcdesktop can be use to run Abode Flash application, using Firefox ESR web browser. </p> <p>Firefox Extended Support Release (ESR) is an official version of Firefox developed for large organizations like universities and businesses that need to set up and maintain Firefox on a large scale. Firefox ESR does not come with the latest features but it has the latest security and stability fixes.</p>"},{"location":"common/flash-firefox-esr/#goals","title":"Goals","text":"<ul> <li>use Flash Player for own web site</li> </ul>"},{"location":"common/flash-firefox-esr/#requirements","title":"Requirements","text":"<ul> <li>A running dockerd last version </li> <li>An access to the docker public registry</li> <li>Nodejs installed on your host.  </li> </ul>"},{"location":"common/flash-firefox-esr/#edit-the-mmscfg-file","title":"Edit the mms.cfg file","text":"<p>Edit the mms.cfg file, and add your own website url</p> <pre><code>EOLUninstallDisable=1\nSilentAutoUpdateEnable=0\nAutoUpdateDisable=1\nEnableAllowList=1\nAllowListURLPattern=*://*.adobe.com\nAllowListURLPattern=https://*.abcdesktop.io\n</code></pre> <p>Add the a new line and replace <code>https://www.domain.com</code>by your own web site</p> <pre><code>AllowListURLPattern=https://www.domain.com\n</code></pre>"},{"location":"common/flash-firefox-esr/#create-file-firefox-esrd","title":"Create file firefox-esr.d","text":"<p>Create a Dockerfile <code>firefox-esr.d</code></p> <ul> <li>to copy your new <code>mms.cfg</code> into the directory <code>/etc/adobe</code> of your container image</li> </ul> <pre><code>FROM abcdesktopio/firefox-esr.d\nUSER 0\nCOPY mms.cfg /etc/adobe/mms.cfg\nUSER balloon\n</code></pre>"},{"location":"common/flash-firefox-esr/#build-the-new-firefox-esr-abcdesktop-image","title":"Build the new firefox-esr abcdesktop image","text":"<p>Run the docker build command </p> <pre><code>docker build -t firefox-esr.d -f firefox-esr.d .\n</code></pre>"},{"location":"common/flash-firefox-esr/#run-the-firefox-esr-application","title":"Run the firefox-esr application","text":""},{"location":"common/flash-firefox-esr/#login-to-your-abcdesktop-service","title":"Login to your abcdesktop service","text":"<p>Using you web browser, log in to your abcdesktop service</p>  <p>Look at the twice firefox icon for <code>Firefox</code> and <code>Firefox-esr</code> application.</p> <p>Start the application <code>Firefox-esr</code></p>  <p>Open you own flash website, or go to https://www.abcdesktop.io/flash sample web site</p>  <p>Click to the <code>Run Adobe Flash</code> plugins </p>  <p>And Allow the <code>Adobe Flash to run</code> </p>  <p>Great, you can run the Adobe Flash plugins.</p>"},{"location":"common/non-free-applications/","title":"Install non-free applications","text":""},{"location":"common/non-free-applications/#install-and-build-citrix-receiver-for-abcdesktop","title":"Install and build <code>Citrix Receiver</code> for abcdesktop","text":"<p><code>Citrix Workspace App</code> or <code>Citrix Receiver</code> does not exist in official debian repository. You need to download the <code>deb package</code> from the www.citrix.com website manually.</p> <ul> <li>Clone the abcdesktopio/oc.apps repository</li> </ul> <pre><code>git clone https://github.com/abcdesktopio/oc.apps.git\n</code></pre> <ul> <li> <p>Download the Citrix Receiver for Linux .deb package. Go to https://www.citrix.com/downloads/citrix-receiver/linux/receiver-for-linux-latest.html</p> </li> <li> <p>Copy the downloaded file <code>icaclient_13.10.0.20_amd64.deb</code> for example as icaclient_amd64.deb to your local oc.apps directory</p> </li> </ul> <pre><code>cd oc.apps\ncp ~/Download/icaclient_13.10.0.20_amd64.deb icaclient_amd64.deb \n</code></pre> <ul> <li>Run docker build command</li> </ul> <pre><code>docker build --build-arg TAG=dev -t abcdesktopio/citrix.d:dev -f citrix.d .\n</code></pre> <pre><code>Sending build context to Docker daemon  29.13MB\nStep 1/28 : ARG TAG=dev\nStep 2/28 : FROM abcdesktopio/oc.template.gtk.18.04:$TAG\n ---&gt; c66ccd2edc52\nStep 3/28 : COPY icaclient_amd64.deb /tmp/icaclient_amd64.deb\n ---&gt; Using cache\n ---&gt; de6a2bcaa7c0\nStep 4/28 : RUN apt-get install  --no-install-recommends --yes /tmp/icaclient_amd64.deb &amp;&amp; apt-get clean &amp;&amp; rm /tmp/icaclient_amd64.deb\n ---&gt; Using cache\n ---&gt; 87e1ce530e44\nStep 5/28 : ENV BUSER balloon\n ---&gt; Using cache\n ---&gt; e4f474a17688\nStep 6/28 : LABEL oc.icon=\"icaclient.svg\"\n ---&gt; Using cache\n ---&gt; c6b12ecd898c\nStep 7/28 : LABEL oc.icondata=\"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmVyc2lvbj0iMSI+CiA8cmVjdCBzdHlsZT0ib3BhY2l0eTouMiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiB4PSItNTkiIHk9Ii02MCIgcng9IjI4IiByeT0iMjgiIHRyYW5zZm9ybT0ibWF0cml4KDAsLTEsLTEsMCwwLDApIi8+CiA8cmVjdCBzdHlsZT0iZmlsbDojNGY0ZjRmIiB3aWR0aD0iNTYiIGhlaWdodD0iNTYiIHg9Ii01OCIgeT0iLTYwIiByeD0iMjgiIHJ5PSIyOCIgdHJhbnNmb3JtPSJtYXRyaXgoMCwtMSwtMSwwLDAsMCkiLz4KIDxwYXRoIHN0eWxlPSJvcGFjaXR5Oi4yIiBkPSJtMzIgMTFhMiAyIDAgMCAwIC0wLjE5MTQgMC4wMTE3MmMtMTAuOTMzMjI0IDAuMTA0NTM5LTE5LjgwODYgOS4wMzA5Ny0xOS44MDg2IDE5Ljk4ODI4IDAgMTEuMDIyMDA2IDguOTc3OTk0IDIwIDIwIDIwIDEwLjk1NDY3OCAwIDE5Ljg3OTUyNC04Ljg3MTE4IDE5Ljk4ODI4Mi0xOS44MDA3ODJhMiAyIDAgMCAwIDAuMDExNzE4IC0wLjE5OTIxOCAyIDIgMCAwIDAgLTIgLTIgMiAyIDAgMCAwIC0yIDJjMCA4Ljg2MDI0Ni03LjEzOTc1NCAxNi0xNiAxNnMtMTYtNy4xMzk3NTQtMTYtMTYgNy4xMzk3NTQtMTYgMTYtMTZhMiAyIDAgMCAwIDIgLTIgMiAyIDAgMCAwIC0yIC0yem0wIDhhMiAyIDAgMCAwIC0wLjE5MTQgMC4wMDc4Yy02LjUxNTM3NCAwLjEwNDEyNi0xMS44MDg2IDUuNDUzMDUyLTExLjgwODYgMTEuOTkyMiAwIDYuNjAzNzI4IDUuMzk2MjcyIDEyIDEyIDEyIDYuNTM2NDUyIDAgMTEuODc5ODgtNS4yODkxMTIgMTEuOTg4MjgyLTExLjgwMDc4MmEyIDIgMCAwIDAgMC4wMTE3MTggLTAuMTk5MjE4IDIgMiAwIDAgMCAtMiAtMiAyIDIgMCAwIDAgLTIgMmMwIDQuNDQxOTY4LTMuNTU4MDMyIDgtOCA4cy04LTMuNTU4MDMyLTgtOCAzLjU1ODAzMi04IDgtOGEyIDIgMCAwIDAgMiAtMiAyIDIgMCAwIDAgLTIgLTJ6bTAgOGE0IDQgMCAwIDAgLTQgNCA0IDQgMCAwIDAgNCA0IDQgNCAwIDAgMCA0IC00IDQgNCAwIDAgMCAtNCAtNHoiLz4KIDxwYXRoIHN0eWxlPSJmaWxsOiNmZmZmZmYiIGQ9Im0zMiAxMGEyIDIgMCAwIDAgLTAuMTkxNCAwLjAxMTcyYy0xMC45MzMyMjQgMC4xMDQ1MzktMTkuODA4NiA5LjAzMDk3LTE5LjgwODYgMTkuOTg4MjggMCAxMS4wMjIwMDYgOC45Nzc5OTQgMjAgMjAgMjAgMTAuOTU0Njc4IDAgMTkuODc5NTI0LTguODcxMTggMTkuOTg4MjgyLTE5LjgwMDc4MmEyIDIgMCAwIDAgMC4wMTE3MTggLTAuMTk5MjE4IDIgMiAwIDAgMCAtMiAtMiAyIDIgMCAwIDAgLTIgMmMwIDguODYwMjQ2LTcuMTM5NzU0IDE2LTE2IDE2cy0xNi03LjEzOTc1NC0xNi0xNiA3LjEzOTc1NC0xNiAxNi0xNmEyIDIgMCAwIDAgMiAtMiAyIDIgMCAwIDAgLTIgLTJ6bTAgOGEyIDIgMCAwIDAgLTAuMTkxNCAwLjAwNzhjLTYuNTE1Mzc0IDAuMTA0MTI2LTExLjgwODYgNS40NTMwNTItMTEuODA4NiAxMS45OTIyIDAgNi42MDM3MjggNS4zOTYyNzIgMTIgMTIgMTIgNi41MzY0NTIgMCAxMS44Nzk4OC01LjI4OTExMiAxMS45ODgyODItMTEuODAwNzgyYTIgMiAwIDAgMCAwLjAxMTcxOCAtMC4xOTkyMTggMiAyIDAgMCAwIC0yIC0yIDIgMiAwIDAgMCAtMiAyYzAgNC40NDE5NjgtMy41NTgwMzIgOC04IDhzLTgtMy41NTgwMzItOC04IDMuNTU4MDMyLTggOC04YTIgMiAwIDAgMCAyIC0yIDIgMiAwIDAgMCAtMiAtMnptMCA4YTQgNCAwIDAgMCAtNCA0IDQgNCAwIDAgMCA0IDQgNCA0IDAgMCAwIDQgLTQgNCA0IDAgMCAwIC00IC00eiIvPgogPHBhdGggc3R5bGU9Im9wYWNpdHk6LjE7ZmlsbDojZmZmZmZmIiBkPSJtMzIgMmMtMTUuNTEyIDAtMjggMTIuNDg4LTI4IDI4IDAgMC4xMTM0NSAwLjAxMTI4MDUgMC4yMjQxMTMgMC4wMTc1NzgxIDAuMzM1OTM4IDAuMzUxNTQzMi0xNS4yMDE3NTcgMTIuNjkzMTQ5OS0yNy4zMzU5MzggMjcuOTgyNDIxOS0yNy4zMzU5MzhzMjcuNjMwODc5IDEyLjEzNDE4MSAyNy45ODI0MjIgMjcuMzM1OTM4YzAuMDA2Mjk4LTAuMTExODI1IDAuMDE3NTc4LTAuMjIyNDg4IDAuMDE3NTc4LTAuMzM1OTM4IDAtMTUuNTEyLTEyLjQ4OC0yOC0yOC0yOHoiLz4KPC9zdmc+Cg==\"\n ---&gt; Using cache\n ---&gt; cb5821f26574\nStep 8/28 : LABEL oc.keyword=\"ica,citrix,icaclient,\"\n ---&gt; Using cache\n ---&gt; 841fc5293542\nStep 9/28 : LABEL oc.cat=\"office\"\n ---&gt; Using cache\n ---&gt; b02b64fab112\nStep 10/28 : LABEL oc.desktopfile=\"wfica.desktop\"\n ---&gt; Using cache\n ---&gt; d8929c453992\nStep 11/28 : LABEL oc.launch=\"Wfica.Wfica\"\n ---&gt; Using cache\n ---&gt; 3c0001542ee6\nStep 12/28 : LABEL oc.template=\"abcdesktopio/oc.template.gtk.18.04\"\n ---&gt; Using cache\n ---&gt; c48014944a74\nStep 13/28 : ENV ARGS=\"-icaroot /opt/Citrix/ICAClient\"\n ---&gt; Using cache\n ---&gt; d242eb681417\nStep 14/28 : LABEL oc.name=\"citrix\"\n ---&gt; Using cache\n ---&gt; fee77a4b23d6\nStep 15/28 : LABEL oc.displayname=\"citrix-client\"\n ---&gt; Using cache\n ---&gt; 1fb6f9642a9f\nStep 16/28 : LABEL oc.path=\"/opt/Citrix/ICAClient/wfica\"\n ---&gt; Using cache\n ---&gt; 0cba59460d1a\nStep 17/28 : LABEL oc.type=app\n ---&gt; Using cache\n ---&gt; a14be19dc259\nStep 18/28 : LABEL oc.showinview=\"dock\"\n ---&gt; Using cache\n ---&gt; 9ee26ab86b1d\nStep 19/28 : LABEL oc.mimetype=\"application/x-ica;\"\n ---&gt; Using cache\n ---&gt; 5536706365ef\nStep 20/28 : RUN  if [ -d /usr/share/icons ];   then cd /usr/share/icons;    /composer/safelinks.sh; fi\n ---&gt; Using cache\n ---&gt; 49a06d7adf22\nStep 21/28 : RUN  if [ -d /usr/share/pixmaps ]; then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi\n ---&gt; Using cache\n ---&gt; 5090828ce15e\nStep 22/28 : WORKDIR /home/balloon\n ---&gt; Using cache\n ---&gt; ac6821413e1f\nStep 23/28 : USER balloon\n ---&gt; Using cache\n ---&gt; 7cbea5e541e8\nStep 24/28 : ENV APPNAME \"citrix\"\n ---&gt; Using cache\n ---&gt; a6662e5e1ea4\nStep 25/28 : ENV APPBIN \"/opt/Citrix/ICAClient/wfica\"\n ---&gt; Using cache\n ---&gt; 475f164cc974\nStep 26/28 : LABEL oc.args=\"-icaroot /opt/Citrix/ICAClient\"\n ---&gt; Using cache\n ---&gt; b085c5a7c97d\nStep 27/28 : ENV APP \"/opt/Citrix/ICAClient/wfica\"\n ---&gt; Using cache\n ---&gt; 534994e86953\nStep 28/28 : LABEL oc.usedefaultapplication=true\n ---&gt; Using cache\n ---&gt; 5cd6ea7a4228\nSuccessfully built 5cd6ea7a4228\nSuccessfully tagged abcdesktopio/citrix.d:dev\n</code></pre> <ul> <li>The new ica citrix docker image <code>abcdesktopio/citrix.d:dev</code> is ready to run</li> </ul>"},{"location":"common/upload_and_download_files/","title":"Upload and Download files in your desktop","text":""},{"location":"common/upload_and_download_files/#goals","title":"Goals","text":"<ul> <li>Upload file from your local storage to your abcdesktop</li> <li>Download file from your abcdesktop to your local storage</li> </ul>"},{"location":"common/upload_and_download_files/#upload-file-in-your-desktop","title":"Upload file in your desktop","text":"<p>To upload file into your local storage, just use a drag &amp; drop, from your device to you adcdesktop </p> <p>Then, start the filemanager, your new file is located in your home directory</p>"},{"location":"common/upload_and_download_files/#download-file-from-your-desktop","title":"Download file from your desktop","text":"<p>To download file from your abcdesktop to you local storage, just start the file manager.</p>  <p>Choose your file and using the right mouse button, choose the menu option  <code>Download for Desktop</code> as describe :</p>  <p>The file is downloaded by your web browser</p>  <p>The file is located in your <code>Downloads</code> directory</p>  <p>Great, you have uploaded and downloaded files with your abcdesktop, you can now use abcdesktop.io applications to edit all your files.</p>"},{"location":"common/1.0/abcdesktop.bastion/","title":"Setup guide to use abcdesktop.io as bastion service","text":""},{"location":"common/1.0/abcdesktop.bastion/#design","title":"Design","text":"<p>The goal of this setup guide is to install abcdesktio.io as a bastion service, with only one virtual machine</p>"},{"location":"common/1.0/abcdesktop.bastion/#script-and-vagrant-file","title":"script and vagrant file","text":""},{"location":"common/1.0/abcdesktop.bastion/#get-script-and-vagrant-file","title":"get script and vagrant file","text":"<p>To get the installation script and the vagrant file, run the command</p> <pre><code>git clone https://github.com/abcdesktopio/vagrant.git\n</code></pre> <ul> <li>The vagrant file name is <code>Vagrantfile.kubernetes.bastion</code></li> <li>The installation script is <code>abcdesktop_kubernetes_bastion.sh</code></li> </ul>"},{"location":"common/1.0/abcdesktop.bastion/#start-vagrant-file-to-run-the-kmaster-vm","title":"start vagrant file to run the <code>kmaster</code> vm","text":"<p>Run the command to run the vagrant file </p> <pre><code>$ cd vagrant\n$ VAGRANT_VAGRANTFILE=Vagrantfile.kubernetes.bastion vagrant up\n</code></pre> <p>This vagrant file defines a vm <code>kmaster</code> :</p> <pre><code>kmaster.vm.box = \"hashicorp/bionic64\"\nkmaster.vm.hostname = \"kmaster.example.com\"\n# By default, Vagrant uses a netmask of 255.255.255.0\n# config.vm.network :hostonly, \"10.11.12.13\", :netmask =&gt; \"255.255.0.0\"\nkmaster.vm.network \"private_network\", ip: \"172.42.42.100\"\nkmaster.vm.network \"private_network\", ip: \"10.9.1.100\", virtualbox__intnet: true\nkmaster.vm.network \"private_network\", ip: \"192.168.29.100\", virtualbox__intnet: true\nkmaster.vm.network \"forwarded_port\", guest: 30443, host: 30443\nkmaster.vm.provider \"virtualbox\" do |v|\n  v.name = \"kmaster\"\n  v.memory = 4096\n  v.cpus = 4\nend\nkmaster.vm.provision \"shell\", path: \"abcdesktop_kubernetes_bastion.sh\"\n</code></pre> <p>It forward the host tcp port 30443 to guest port 30443 ( mapped as a host port in kubernetes )</p> <p>All networks are defined as <code>private_network</code> to make it simplest as possible.</p>"},{"location":"common/1.0/abcdesktop.bastion/#abcdesktop_kubernetes_bastionsh-description","title":"<code>abcdesktop_kubernetes_bastion.sh</code> description","text":"<p><code>abcdesktop_kubernetes_bastion.sh</code> takes more than eight minutes to install all services, from an ubuntu bionic 64  <code>hashicorp/bionic64</code> : </p> <ul> <li>kubernetes </li> <li>abcdesktop</li> <li>multus-cni</li> <li>multi-networkpolicy </li> </ul> <p>Read step by step the <code>abcdesktop_kubernetes_bastion.sh</code> content to get more details.</p> <p>You can read the vagrant stdout file as example abcdesktop kubernetes bastion install log file </p>"},{"location":"common/1.0/abcdesktop.bastion/#login-to-get-a-ssh-into-the-kmaster-vm","title":"login to get a ssh into the <code>kmaster</code> vm","text":"<pre><code>VAGRANT_VAGRANTFILE=Vagrantfile.kubernetes.bastion vagrant ssh\n</code></pre>  <p>List <code>kube-system</code> pods and <code>abcdesktop</code> pods </p>  <p>To run kubectl commands inside the master virtual machine</p> <pre><code>export KUBECONFIG=/etc/kubernetes/admin.conf \n</code></pre> <pre><code>vagrant@kmaster:~$ kubectl get pods -n kube-system\nNAME                              READY   STATUS    RESTARTS   AGE\ncoredns-64897985d-4d57p           1/1     Running   0          11h\ncoredns-64897985d-qtmkq           1/1     Running   0          11h\netcd-kmaster                      1/1     Running   0          11h\nkube-apiserver-kmaster            1/1     Running   0          11h\nkube-controller-manager-kmaster   1/1     Running   0          11h\nkube-flannel-ds-gskrs             1/1     Running   0          11h\nkube-proxy-c566l                  1/1     Running   0          11h\nkube-scheduler-kmaster            1/1     Running   0          11h\n</code></pre> <pre><code>vagrant@kmaster:~$ kubectl get pods -n abcdesktop\nNAME                            READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-pt2j6           1/1     Running   0          11h\ndaemonset-pyos-zqpf7            1/1     Running   0          11h\nmemcached-od-78578c879-kstcl    1/1     Running   0          11h\nmongodb-od-5c68794bb8-wf6sm     1/1     Running   0          11h\nopenldap-od-558f7959d5-vhbln    1/1     Running   0          11h\nspeedtest-od-7b66cc656b-fh97g   1/1     Running   0          11h\n</code></pre>"},{"location":"common/1.0/abcdesktop.bastion/#login-as-a-user","title":"Login as a user","text":""},{"location":"common/1.0/abcdesktop.bastion/#connect-your-local-abcdesktop","title":"Connect your local abcdesktop","text":"<p>Open your web browser to </p> <pre><code>http://[your-ip-hostname]:30443/\n</code></pre>  <p>Replace <code>[your-ip-hostname]</code> by the host node IP address</p>  <p>You should get the web page </p>"},{"location":"common/1.0/abcdesktop.bastion/#log-in-as","title":"Log in as","text":"<p><code>abcdesktop</code> adds an OpenLDAP server for testing LDAP applications, i.e. unit tests. The ldap server is used to authenticate user. To get more informations about the OpenLDAP server and the account detail, read ldap server</p>    Login Accounts Login Password     Hubert J. Farnsworth professor   Philip J. Fry fry   Hermes Conrad hermes   Turanga Leela leela   Bender Bending Rodr\u00edguez bende    <p>Use the credentials, to login</p> <ul> <li>Login Account: <code>Philip J. Fry</code></li> <li>Login Password: <code>fry</code></li> </ul>"},{"location":"common/1.0/abcdesktop.bastion/#get-the-default-desktop","title":"Get the default desktop","text":"<p>After the login, you should get the default desktop.</p>"},{"location":"common/1.0/abcdesktop.bastion/#run-a-web-shell-process","title":"Run a web shell process","text":"<p>To start a shell, insert <code>webshell</code> as keywords in the search text area :</p>"},{"location":"common/1.0/abcdesktop.bastion/#run-ifconfig-command-to-list-network-interfaces","title":"Run <code>ifconfig</code> command to list network interfaces","text":"<p>In the web shell, run the command</p> <pre><code>$ ifconfig -a\n</code></pre>  <p>This command shows the network interfaces <code>net1</code> and <code>net2</code> with the associated ip address</p>"},{"location":"common/1.0/abcdesktop.bastion/#tag-and-rules","title":"Tag and rules","text":"<ul> <li>Login into your <code>kmaster</code> </li> </ul> <pre><code>VAGRANT_VAGRANTFILE=Vagrantfile.kubernetes.bastion vagrant ssh\n</code></pre> <ul> <li>Become root into your <code>kmaster</code> </li> </ul> <pre><code>vagrant@kmaster:~$ sudo bash\n</code></pre>"},{"location":"common/1.0/abcdesktop.bastion/#config-file-abcdesktopyaml","title":"Config file <code>abcdesktop.yaml</code>","text":"<p>Open the <code>abcdesktop.yaml</code> configuration file, and look at <code>ldapconfig</code></p> <pre><code>    ldapconfig : { 'planet': {  'default'       : True,\n                                'ldap_timeout'  : 15,\n                                'ldap_protocol' : 'ldap',\n                                'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n                                'servers'       : [ 'openldap.abcdesktop.svc.cluster.local' ],\n                                'secure'        : False,\n                                'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' },\n                                'policies': {\n                                    'acls': None,\n                                    'rules' : {\n                                        'rule-ship': { 'conditions' : [ { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',   'expected' : True  } ], 'expected' : True, 'label': 'shipcrew'   },\n                                        'rule-test': { 'conditions' : [ { 'memberOf': 'cn=admin_staff,ou=people,dc=planetexpress,dc=com', 'expected' : True  } ], 'expected' : True, 'label': 'adminstaff' } } } } }\n</code></pre> <ul> <li><code>openldap.abcdesktop.svc.cluster.local</code> is a local ldap server running as a pod</li> </ul>"},{"location":"common/1.0/abcdesktop.bastion/#rules-description","title":"Rules description","text":"<ul> <li> <p><code>'rule-ship': { 'conditions' : [ { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com',   'expected' : True  } ], 'expected' : True, 'label': 'shipcrew'   }</code>  If a user is member of <code>'cn=ship_crew,ou=people,dc=planetexpress,dc=com'</code> then the <code>label</code> tag <code>shipcrew</code> is set to the user's pod </p> </li> <li> <p><code>'rule-admin': { 'conditions' : [ { 'memberOf': 'cn=admin_staff,ou=people,dc=planetexpress,dc=com', 'expected' : True  } ], 'expected' : True, 'label': 'adminstaff' }</code> If a user is member of <code>'cn=admin_staff,ou=people,dc=planetexpress,dc=com'</code> then the <code>label</code> tag <code>adminstaff</code> is set to the user's pod </p> </li> </ul> <p>In the <code>abcdesktop.yaml</code> configuration file, and look at the <code>desktop.policies</code> and the <code>network</code> option</p> <pre><code> desktop.policies: {\n        'rules': {\n            'network': {\n                'shipcrew': {\n                    'annotations' : {\n                        'k8s.v1.cni.cncf.io/networks': '[ {\"name\":\"macvlan-conf-eth3\"}, { \"name\":\"macvlan-conf-eth2\", \"default-route\": [\"10.9.1.100\"] } ]'\n                    }\n                }\n            }\n        },\n        'acls' : {} }\n</code></pre> <p>If a pod as the <code>'shipcrew'</code> tag, then add the network annotations</p> <pre><code>[ \n    {   \"name\": \"macvlan-conf-eth3\"}, \n    {   \"name\": \"macvlan-conf-eth2\", \"default-route\": [\"10.9.1.100\"] }\n]\n</code></pre>"},{"location":"common/1.0/abcdesktop.bastion/#list-pods-and-labels-in-abcdesktop-namespace","title":"List pods and labels in <code>abcdesktop</code> namespace","text":"<p>To list pod in the <code>abcdesktop</code> namespace, run the command</p> <pre><code>export KUBECONFIG=/etc/kubernetes/admin.conf \nkubectl get pods -n abcdesktop \n</code></pre> <pre><code>root@kmaster:~# export KUBECONFIG=/etc/kubernetes/admin.conf \nroot@kmaster:~# kubectl get pods -n abcdesktop\nNAME                                       READY   STATUS    RESTARTS   AGE\ndaemonset-nginx-5dzjc                      1/1     Running   0          151m\ndaemonset-pyos-szs8h                       1/1     Running   0          151m\nfry-02579a7f-a464-4cdb-bb79-5d4d4a844308   3/3     Running   0          86m\nmemcached-od-78578c879-vx26h               1/1     Running   0          151m\nmongodb-od-6568f85897-tgfjb                1/1     Running   0          151m\nopenldap-od-558f7959d5-qz2kg               1/1     Running   0          151m\nspeedtest-od-76d578578d-rl8k8              1/1     Running   0          151m\n</code></pre>"},{"location":"common/1.0/abcdesktop.bastion/#describe-pods-fry","title":"Describe pods fry","text":"<p>Run the command </p> <pre><code>kubectl describe pods YOUR_POD\n</code></pre> <p>Replace YOUR_POD by your pod </p> <pre><code>root@kmaster:~# kubectl describe pods fry-02579a7f-a464-4cdb-bb79-5d4d4a844308 -n abcdesktop\nName:         fry-02579a7f-a464-4cdb-bb79-5d4d4a844308\nNamespace:    abcdesktop\nPriority:     0\nNode:         kmaster/10.0.2.15\nStart Time:   Mon, 31 Jan 2022 16:14:16 +0000\nLabels:       access_provider=planet\n              access_userid=FRY\n              access_username=philip_j__fry\n              broadcast_cookie=f7ee45615acce9c5fbed2607d35471264d6c6c14b5cd5778\n              domain=desktop\n              netpol/ocuser=true\n              pulseaudio_cookie=f7cfdfb7b4227e816f3ad59f9d122fac49674a1a60455951\n              shipcrew=true\n              type=x11server\n              xauthkey=ad9e3675cb184db9b6c9eee4852a94est-od-76d578578d-rl8k8\n</code></pre>  <p>The label <code>shipcrew=true</code> is set</p>  <pre><code>Annotations:  k8s.v1.cni.cncf.io/network-status:\n                [{\n                    \"name\": \"cbr0\",\n                    \"interface\": \"eth0\",\n                    \"ips\": [\n                        \"10.244.0.12\"\n                    ],\n                    \"mac\": \"06:17:a7:0c:24:9b\",\n                    \"default\": true,\n                    \"dns\": {}\n                },{\n                    \"name\": \"abcdesktop/macvlan-conf-eth3\",\n                    \"interface\": \"net1\",\n                    \"ips\": [\n                        \"192.168.29.12\"\n                    ],\n                    \"mac\": \"3a:db:a1:33:53:72\",\n                    \"dns\": {}\n                },{\n                    \"name\": \"abcdesktop/macvlan-conf-eth2\",\n                    \"interface\": \"net2\",\n                    \"ips\": [\n                        \"10.9.1.12\"\n                    ],\n                    \"mac\": \"86:eb:43:fe:db:e7\",\n                    \"dns\": {}\n                }]\n</code></pre>  <p>The <code>Annotations</code> <code>k8s.v1.cni.cncf.io/network-status</code> describes the network interfaces inside the pod.</p>"},{"location":"common/1.0/abcdesktop.bastion/#look-at-the-pre-installed-network-rules","title":"Look at the pre installed network rules","text":"<p>Run the command </p> <pre><code>kubectl get net-attach-def -n abcdesktop\n</code></pre> <pre><code>root@kmaster:~#  kubectl get net-attach-def -n abcdesktop\nNAME                AGE\nmacvlan-conf-eth2   154m\nmacvlan-conf-eth3   154m\n</code></pre> <p>Get more details about <code>macvlan-conf-eth3</code></p> <pre><code>root@kmaster:~# kubectl describe net-attach-def macvlan-conf-eth3 -n abcdesktop\nName:         macvlan-conf-eth3\nNamespace:    abcdesktop\nLabels:       &lt;none&gt;\nAnnotations:  &lt;none&gt;\nAPI Version:  k8s.cni.cncf.io/v1\nKind:         NetworkAttachmentDefinition\nMetadata:\n  Creation Timestamp:  2022-01-31T15:10:38Z\n  Generation:          1\n  Managed Fields:\n    API Version:  k8s.cni.cncf.io/v1\n    Fields Type:  FieldsV1\n    fieldsV1:\n      f:metadata:\n        f:annotations:\n          .:\n          f:kubectl.kubernetes.io/last-applied-configuration:\n      f:spec:\n        .:\n        f:config:\n    Manager:         kubectl-client-side-apply\n    Operation:       Update\n    Time:            2022-01-31T15:10:38Z\n  Resource Version:  1008\n  UID:               a5b0d3a0-52c4-42da-887b-8de73cff2b1c\nSpec:\n  Config:  { \"cniVersion\": \"0.3.0\", \"type\": \"macvlan\", \"master\": \"eth3\", \"mode\": \"bridge\", \"ipam\": { \"type\": \"host-local\", \"subnet\": \"192.168.29.0/24\", \"rangeStart\": \"192.168.29.10\", \"rangeEnd\": \"192.168.29.99\", \"gateway\": \"192.168.29.100\" } }\nEvents:    &lt;none&gt;\n</code></pre>  <p><code>macvlan-conf-eth3</code> is used by the user's pod.</p>"},{"location":"common/1.0/abcdesktop.bastion/#list-multi-policy","title":"List multi-policy","text":"<p>To list multi-policy, run the command </p> <pre><code>kubectl get multi-policy -n abcdesktop\n</code></pre> <pre><code>root@kmaster:~# kubectl get multi-policy -n abcdesktop\nNAME                  AGE\nmnp-permit-shipcrew   3h\n</code></pre> <p>And get description about the policy <code>mnp-permit-shipcrew</code> </p> <pre><code>apiVersion: k8s.cni.cncf.io/v1beta1\nkind: MultiNetworkPolicy\nmetadata:\n  name: mnp-permit-shipcrew\n  namespace: abcdesktop \n  annotations:\n    k8s.v1.cni.cncf.io/policy-for: macvlan-conf-eth3\nspec:\n  podSelector:\n    matchLabels:\n      shipcrew: 'true' \n  policyTypes:\n  - Egress\n  egress:\n  - to:\n    - ipBlock: \n        cidr: 192.168.55.21/32\n    - ipBlock:\n        cidr: 192.168.55.22/32\n    ports:\n      - protocol: TCP\n        port: 22\n</code></pre>  <p>If a pod in the <code>abcdesktop</code> namespace, contains a label <code>shipcrew: 'true'</code> set the <code>iptables</code> to permit egress to host <code>192.168.55.21/32</code> and <code>192.168.55.22/32</code> using protocol <code>TCP</code> destination port <code>22</code>.</p>"},{"location":"common/1.0/abcdesktop.bastion/#dump-the-generated-by-iptables-in-varlibmulti-networkpolicyiptables","title":"dump the generated by iptables in <code>/var/lib/multi-networkpolicy/iptables/</code>","text":"<ul> <li>Login into your <code>kmaster</code> </li> </ul> <pre><code>VAGRANT_VAGRANTFILE=Vagrantfile.kubernetes.bastion vagrant ssh\n</code></pre> <ul> <li>Become root into your <code>kmaster</code> </li> </ul> <pre><code>vagrant@kmaster:~$ sudo bash\n</code></pre> <ul> <li>list the directories <code>/var/lib/multi-networkpolicy/iptables/</code> in <code>kmaster</code></li> </ul> <pre><code>root@kmaster:~# ls /var/lib/multi-networkpolicy/iptables/\nafe82680-77b4-4bac-ad2b-8be9488402fb\n</code></pre> <p>A new <code>afe82680-77b4-4bac-ad2b-8be9488402fb</code> exists</p> <ul> <li>cat the <code>current.iptables</code> file content in the <code>/var/lib/multi-networkpolicy/iptables/ afe82680-77b4-4bac-ad2b-8be9488402fb</code></li> </ul> <pre><code>root@kmaster:~# cat /var/lib/multi-networkpolicy/iptables/afe82680-77b4-4bac-ad2b-8be9488402fb/current.iptables \n# Generated by iptables-save v1.4.21 on Mon Jan 31 16:16:22 2022\n*mangle\n:PREROUTING ACCEPT [441:57462]\n:INPUT ACCEPT [441:57462]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [370:150632]\n:POSTROUTING ACCEPT [367:150476]\nCOMMIT\n# Completed on Mon Jan 31 16:16:22 2022\n# Generated by iptables-save v1.4.21 on Mon Jan 31 16:16:22 2022\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:MULTI-0-EGRESS - [0:0]\n:MULTI-0-EGRESS-0-PORTS - [0:0]\n:MULTI-0-EGRESS-0-TO - [0:0]\n:MULTI-EGRESS - [0:0]\n:MULTI-INGRESS - [0:0]\n-A INPUT -i net2 -j MULTI-INGRESS\n-A INPUT -i net1 -j MULTI-INGRESS\n-A OUTPUT -o net2 -j MULTI-EGRESS\n-A OUTPUT -o net1 -j MULTI-EGRESS\n-A MULTI-0-EGRESS -j MARK --set-xmark 0x0/0x30000\n-A MULTI-0-EGRESS -j MULTI-0-EGRESS-0-PORTS\n-A MULTI-0-EGRESS -j MULTI-0-EGRESS-0-TO\n-A MULTI-0-EGRESS -m mark --mark 0x30000/0x30000 -j RETURN\n-A MULTI-0-EGRESS -j DROP\n-A MULTI-0-EGRESS-0-PORTS -o net1 -p tcp -m tcp --dport 22 -j MARK --set-xmark 0x10000/0x10000\n-A MULTI-0-EGRESS-0-TO -d 192.168.55.21/32 -o net1 -j MARK --set-xmark 0x20000/0x20000\n-A MULTI-0-EGRESS-0-TO -d 192.168.55.22/32 -o net1 -j MARK --set-xmark 0x20000/0x20000\n-A MULTI-EGRESS -o net1 -m comment --comment \"policy:mnp-permit-shipcrew net-attach-def:abcdesktop/macvlan-conf-eth3\" -j MULTI-0-EGRESS\nCOMMIT\n# Completed on Mon Jan 31 16:16:22 2022\n# Generated by iptables-save v1.4.21 on Mon Jan 31 16:16:22 2022\n*nat\n</code></pre>"},{"location":"common/1.0/abcdesktop.bastion/#add-some-applications-to-your-desktop","title":"Add some applications to your desktop","text":"<p>For abcdesktop a desktop application is a container image. To add an application you just need to pull an container image.</p> <ul> <li>Login into your <code>kmaster</code> </li> </ul> <pre><code>VAGRANT_VAGRANTFILE=Vagrantfile.kubernetes.bastion vagrant ssh\n</code></pre> <ul> <li>Become root into your <code>kmaster</code> </li> </ul> <pre><code>vagrant@kmaster:~$ sudo bash\n</code></pre> <ul> <li>list your docker images</li> </ul> <pre><code>root@kmaster:~# docker images\nREPOSITORY                                                  TAG       IMAGE ID       CREATED         SIZE\nabcdesktopio/oc.pyos                                        dev       6bd8b8d33b73   19 hours ago    1.17GB\nrancher/mirrored-flannelcni-flannel                         v0.16.3   8cb5de74f107   3 days ago      59.7MB\nmemcached                                                   latest    fa6cf68061c2   5 days ago      89.1MB\nk8s.gcr.io/kube-apiserver                                   v1.23.3   f40be0088a83   6 days ago      135MB\nk8s.gcr.io/kube-controller-manager                          v1.23.3   b07520cd7ab7   6 days ago      125MB\nk8s.gcr.io/kube-scheduler                                   v1.23.3   99a3486be4f2   6 days ago      53.5MB\nk8s.gcr.io/kube-proxy                                       v1.23.3   9b7cc9982109   6 days ago      112MB\nabcdesktopio/oc.user.18.04                                  latest    52176672cf2e   7 days ago      1.79GB\nabcdesktopio/oc.user.ssh.18.04                              dev       52176672cf2e   7 days ago      1.79GB\nghcr.io/k8snetworkplumbingwg/multi-networkpolicy-iptables   latest    54838d8bbd14   10 days ago     408MB\nrancher/mirrored-flannelcni-flannel-cni-plugin              v1.0.1    ac40ce625740   12 days ago     8.1MB\nabcdesktopio/oc.nginx                                       dev       fe71c8621ef2   12 days ago     506MB\nabcdesktopio/oc.pulseaudio.18.04                            dev       d44997a46969   2 months ago    170MB\nabcdesktopio/oc.pulseaudio.18.04                            latest    d44997a46969   2 months ago    170MB\nk8s.gcr.io/etcd                                             3.5.1-0   25f8c7f3da61   3 months ago    293MB\nghcr.io/k8snetworkplumbingwg/multus-cni                     stable    e6cafb5d5aa1   3 months ago    290MB\nk8s.gcr.io/coredns/coredns                                  v1.8.6    a4ca41631cc7   3 months ago    46.8MB\nabcdesktopio/oc.cupsd.18.04                                 dev       095105a59722   4 months ago    745MB\nabcdesktopio/oc.cupsd.18.04                                 latest    095105a59722   4 months ago    745MB\nk8s.gcr.io/pause                                            3.6       6270bb605e12   5 months ago    683kB\nrroemhild/test-openldap                                     latest    c6b1bec361ca   10 months ago   144MB\nabcdesktopio/oc.mongo                                       latest    802219537d3b   12 months ago   493MB\nabcdesktopio/oc.speedtest                                   dev       298a391cfb5b   3 years ago     355MB\n</code></pre> <ul> <li>Add new application images </li> </ul> <p>To add an application like Firefox, run the <code>docker pull</code> command :</p> <pre><code>root@kmaster:~# docker pull abcdesktopio/firefox.d:dev\n</code></pre> <pre><code>docker pull abcdesktopio/firefox.d:dev\ndev: Pulling from abcdesktopio/firefox.d\n7b1a6ab2e44d: Already exists \n2371f0a6d5ec: Already exists \nb55247ebc792: Already exists \n38b40dedf719: Already exists \na609cdbac5b4: Already exists \nf2e98da86f69: Already exists \n8589cdafb8d3: Already exists \nf110041cad0c: Already exists \n8d2557b365eb: Already exists \n0de73c57e07d: Already exists \n165ea38f2f53: Already exists \n66b43fff8150: Already exists \nccc0386d04e3: Already exists \n26d822b9fccb: Already exists \nd489c5be8f43: Already exists \nc342009660e3: Already exists \ne2006e25f603: Already exists \n612638393a03: Already exists \ndae51e73d8bc: Already exists \n07243e67b561: Pull complete \n2ee8a212fe21: Pull complete \n19e557a0567c: Pull complete \nff417f05521e: Pull complete \n539fd422158e: Pull complete \nef5cf2280d59: Pull complete \n24d2ecc0cc9a: Pull complete \n9dc58ab20296: Pull complete \naba0cc69761b: Pull complete \nDigest: sha256:454657f20f7a09d45dc8ac4f4d3263360480c15f69bece280dd06b8d1647ad7f\nStatus: Downloaded newer image for abcdesktopio/firefox.d:dev\ndocker.io/abcdesktopio/firefox.d:dev\n</code></pre>"},{"location":"common/1.0/abcdesktop.bastion/#reload-the-web-browser-page","title":"Reload the web browser page","text":""},{"location":"common/1.0/abcdesktop.bastion/#connect-your-local-abcdesktop_1","title":"Connect your local abcdesktop","text":"<p>Reload or open your web browser </p> <pre><code>http://[your-ip-hostname]:30443/\n</code></pre>  <p>Firefox is added to your desktop dock. Start Firefox application</p>  <p>No rule has be defined to allow http request from your pod to a web site</p>    <p>All http requests are denied </p>   <p>The firefox application inherits from the pod's the network rules.</p>"},{"location":"common/1.0/abcdesktop.bastion/#troubleshooting","title":"Troubleshooting","text":"<p>If you choose to use VMware instead of VirtualBox hypervisor</p>"},{"location":"common/1.0/abcdesktop.bastion/#notes-about-the-macvlan-driver","title":"Notes about the <code>macvlan</code> driver :","text":"<p>Macvlan allows you to configure sub-interfaces of a parent, physical Ethernet interface, each with its own unique MAC address, and consequently its own IP address. Applications, VMs and containers can then bind to a specific sub-interface to connect directly to the physical network, using their own MAC and IP address.</p>"},{"location":"common/1.0/abcdesktop.bastion/#macvlan-driver-on-vswitch-vmware","title":"<code>macvlan</code> driver on vSwitch VMware","text":"<p>The security policy of a virtual switch includes a MAC address changes option. This option allows virtual machines to receive frames with a Mac Address that is different from the one configured in the VMX.</p> <p>When the Mac address changes option is set to Accept, ESXi accepts requests to change the effective MAC address of a virtual machine to a different address than the initial MAC address.</p>  <p>Set the Mac address changes option is set to Accept</p>"},{"location":"common/1.0/docker_macvlan/","title":"Using docker network for an application","text":""},{"location":"common/1.0/docker_macvlan/#requirements","title":"Requirements","text":""},{"location":"common/1.0/docker_macvlan/#goals","title":"Goals","text":"<ul> <li>Use a dedicated network for an application. For example bind the application Firefox to a dedicated docker network.  This dedicated network can use macvlan, ipvlan or an SRIOV network driver.</li> </ul>"},{"location":"common/1.0/docker_macvlan/#architecture","title":"Architecture","text":"<p>When abcdesktop create a docker container, abcdesktop can set a dedicated network for this container. </p>"},{"location":"common/1.0/docker_macvlan/#create-a-dedicated-network-for-your-application","title":"Create a dedicated network for your application","text":"<p>On your worker nodes :</p> <ul> <li>create a dedicated network interface to bridge the new network interface</li> <li>add the label <code>abcdesktop=true</code> to the network object</li> </ul> <p>You have to choose a nework driver for example </p>    network driver     macvlan   ipvlan   docker-sriov-plugin    <p>Only the name of the network is used by abcdesktop.</p> <p>Create a network with <code>macvlan</code> or <code>ipvlan</code> driver </p> <p>In these two examples :</p> <ul> <li>Subnet is <code>192.168.8.0/24</code> </li> <li>Gateway is <code>192.168.8.254</code> </li> <li>Ip Range is <code>192.168.8.0/27</code></li> </ul>"},{"location":"common/1.0/docker_macvlan/#example-with-macvlan","title":"Example with <code>macvlan</code> :","text":"<p>Create a network abcnetfirefox with the driver macvlan and bridge the network interface eno1 with the vlan 123 </p> <pre><code>docker network create --label type=oc.app -d macvlan --subnet=192.168.8.0/24 --gateway=192.168.8.254 --ip-range=192.168.8.0/27 -o parent=eno1.123 abcnetfirefox\n</code></pre>"},{"location":"common/1.0/docker_macvlan/#example-with-ipvlan-ipvlan_model2","title":"Example with <code>ipvlan</code> ipvlan_mode=l2 :","text":"<p>Create a network abcnetfirefox with the driver ipvlan with ipvlan_mode=l2 option and bridge the network interface eno1 with the vlan 123.</p> <pre><code>docker network create --label type=oc.app -d ipvlan  -o ipvlan_mode=l2 --subnet=192.168.8.0/24 --gateway=192.168.8.254 --ip-range=192.168.8.0/27 -o parent=eno1.123 abcnetfirefox\n</code></pre>"},{"location":"common/1.0/docker_macvlan/#test-your-new-network-macvlan-or-ipvlan","title":"Test your new network (<code>macvlan</code> or <code>ipvlan</code>):","text":"<p>Make sure that's you can reach the default gateway and the dns server for container. In this example, just start a busybox to :</p> <ul> <li><code>ping</code> the default gateway</li> <li><code>nslookup</code> to query www.google.com ip address</li> </ul> <pre><code>export GATEWAY=192.168.8.254\ndocker run --rm --network abcnetfirefox busybox ping $GATEWAY\n# Google\u2019s public DNS server 8.8.8.8 is added\ndocker run --rm --network abcnetfirefox --dns 8.8.8.8 busybox ping www.google.com\n</code></pre>"},{"location":"common/1.0/docker_macvlan/#applications-rules","title":"Applications rules","text":"<p>Update your <code>applist.json</code> file and add a specific rule into the firefox application description </p> <pre><code>git clone https://github.com/abcdesktopio/oc.apps.git\ncd oc.apps\n</code></pre> <p>Specific rules entry example</p> <pre><code>\"rules\": { \"homedir\": { \"default\": true, \"ship\": true }, \n           \"network\": { \"default\": false, \n                        \"internet\": { \n                                    \"name\": \"abcnetfirefox\", \n                                    \"dns\": [ \"8.8.8.8\" ] } } },\n</code></pre> <p>In this example, if the current user token contains the tag label <code>internet</code> when the firefox application use <code>abcnetfirefox</code> and the dns <code>8.8.8.8</code></p>"},{"location":"common/1.0/docker_macvlan/#edit-the-applistjson-file","title":"Edit the <code>applist.json</code> file","text":"<p>Edit the <code>applist.json</code> file, and add rules to the application <code>firefox</code> for example</p> <p>The new firefox dictionary with rules :</p> <pre><code>{\n    \"cat\": \"office\",\n    \"preruncommands\": [ \"RUN DEBIAN_FRONTEND=noninteractive echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | debconf-set-selections\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes ttf-mscorefonts-installer ttf-bitstream-vera ttf-dejavu ttf-xfree86-nonfree &amp;&amp; apt-get clean\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes winbind firefox $(apt-cache search firefox-locale | awk '{print $1 }') &amp;&amp; apt-get clean\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes flashplugin-installer ubuntu-restricted-extras libavc1394-0 &amp;&amp; apt-get clean\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes libasound2-plugins libgail-common libgtk2.0-bin chromium-codecs-ffmpeg-extra gstreamer1.0-libav gstreamer1.0-plugins-ugly gstreamer1.0-vaapi libavcodec-extra &amp;&amp; apt-get clean\",\n                        \"COPY composer/init.d/init.firefox /composer/init.d/init.firefox\",\n                        \"COPY policies.json /usr/lib/firefox/distribution\",\n                        \"COPY /ntlm_auth /usr/bin/ntlm_auth.abcdesktop\",\n                        \"RUN chown root:root /usr/bin/ntlm_auth.desktop &amp;&amp; chmod 111 /usr/bin/ntlm_auth.abcdesktop\",\n                        \"ENV NSS_SDB_USE_CACHE=yes\" ],\n    \"debpackage\": \"\",\n    \"icon\": \"firefox.svg\",\n    \"keyword\": \"firefox,mozilla,web,internet\",\n    \"launch\": \"Navigator.Firefox\",\n    \"name\": \"Firefox\",\n    \"displayname\": \"Firefox\",\n    \"showinview\": \"dock\",\n    \"splash\": \"enable\",\n    \"mem_limit\": \"16gb\",\n    \"oomkilldisable\": true,\n    \"path\": \"/usr/bin/firefox\",\n    \"template\": \"abcdesktopio/oc.template.gtk\",\n    \"mimetype\": \"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;x-scheme-handler/http;x-scheme-handler/https;x-scheme-handler/ftp;video/webm;application/x-xpinstall;\",\n    \"legacyfileextensions\": \"htm;html;xml\",\n    \"fileextensions\": \"htm;html;xml;gif\",\n    \"desktopfile\":\"/usr/share/applications/firefox.desktop\",\n    \"shm_size\": \"2gb\",\n    \"usedefaultapplication\": true,\n    \"rules\": { \"homedir\": { \"default\": true, \"ship\": true }, \n           \"network\": { \"default\": false, \n                        \"internet\": { \n                                    \"name\": \"abcnetfirefox\", \n                                    \"dns\": [ \"8.8.8.8\" ] } } }\n}\n</code></pre> <p>Save your changes, and run <code>make dockerfile</code>, next <code>docker build</code></p> <p>Build and update your new firefox application</p> <pre><code># create the Dockerfile firefox.d \nmake dockerfile\n\n# build the new image\ndocker build -f firefox.d -t firefox.d .\n</code></pre> <p>Check that the <code>oc.rules</code> label in new firefox.d image </p> <pre><code>docker inspect firefox.d \n</code></pre> <p>The <code>oc.rules</code> label is a string json formated</p> <pre><code>\"oc.rules\": \"{\\\"homedir\\\":{\\\"default\\\":true,\\\"ship\\\":true},\\\"network\\\":{\\\"default\\\":false,\\\"internet\\\":{\\\"name\\\":\\\"abcnetfirefox\\\",\\\"dns\\\":[\\\"8.8.8.8\\\"]}}}\"\n</code></pre>"},{"location":"common/1.0/docker_macvlan/#add-tag-the-user-auth","title":"Add tag the user auth","text":"<p>Add a tag <code>internet</code> to the user auth provider</p>"},{"location":"common/1.0/docker_macvlan/#update-authprovider-in-odconfig-file","title":"Update authprovider in <code>od.config</code> file","text":"<p>Update the <code>ldapconfig</code> for planet with the new <code>policies</code> dict</p> <pre><code>  'policies': { 'acls': None, \n              'rules'   : { 'rule-ship': { 'conditions' : [ { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com', 'expected' : True  } ],\n              'expected' : True, \n              'label': 'internet' },\n</code></pre> <p>The complete <code>ldapconfig</code> for planet is </p> <pre><code>ldapconfig : { 'planet': {    'default'       : True,\n                        'ldap_timeout'  : 15,\n                        'ldap_protocol' : 'ldap',\n                        'ldap_basedn'   : 'ou=people,dc=planetexpress,dc=com',\n                        'servers'       : [ '192.168.7.69' ],\n                        'secure'        : False,\n                        'auth_protocol' : { 'ntlm': True, 'cntlm': False, 'kerberos': False, 'citrix': False},\n                        'citrix_all_regions' : 'Hello, {{ domain }}\\\\{{ user }}:{{ password }}',  \n                        'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' },\n\n                        'policies': { 'acls': None, \n             'rules'    : { 'rule-ship': { 'conditions' : [ { 'memberOf': 'cn=ship_crew,ou=people,dc=planetexpress,dc=com', 'expected' : True  } ], 'expected' : True, 'label': 'internet' } \n      } } } }\n</code></pre> <p>Restart your kubernetes pyos pod, to reload new the <code>od.config</code> configuration file.</p>"},{"location":"common/1.0/docker_macvlan/#use-the-philip-j-fry-user-context","title":"Use the <code>Philip J. Fry</code> user context.","text":"<p>Open a web browser, go to the abcdesktop login page.</p>  <p>Login Accounts</p>    Login Password     Philip J. Fry. fry   Hubert J. Farnsworth professor    <p>Note: the user <code>Philip J. Fry</code> is member of <code>cn=ship_crew,ou=people,dc=planetexpress,dc=com</code></p> <p>Note: the user <code>Hubert J. Farnsworth</code> is NOT member of <code>cn=ship_crew,ou=people,dc=planetexpress,dc=com</code></p>  <p>Login as the  <code>Philip J. Fry</code> user account. </p>  <p>During the user  login process, pyos tag the user authentification with the <code>'label': 'internet'</code></p> <p>Start the new application <code>firefox</code>, the docker network for this application use the <code>abcnetfirefox</code> </p>  <p>Run the command</p> <pre><code>docker network inspect abcnetfirefox\n</code></pre> <p>abcdesktop start a new container <code>\"Name\": \"philip-j--fry-firefox-d2c22d9912fc4a489a1224237af9a3e0\"</code> and bind the <code>abcnetfirefox</code> to user container.</p> <pre><code>[\n    {\n        \"Name\": \"abcnetfirefox\",\n        \"Id\": \"69c5ac0996226654635377458c044675114d5feb742a8a56d8a228180829d9cd\",\n        \"Created\": \"2021-02-05T16:24:41.781733948+01:00\",\n        \"Scope\": \"local\",\n        \"Driver\": \"macvlan\",\n        \"EnableIPv6\": false,\n        \"IPAM\": {\n            \"Driver\": \"default\",\n            \"Options\": {},\n            \"Config\": [\n                {\n                    \"Subnet\": \"192.168.8.0/24\",\n                    \"Gateway\": \"192.168.8.254\"\n                }\n            ]\n        },\n        \"Internal\": false,\n        \"Attachable\": false,\n        \"Ingress\": false,\n        \"ConfigFrom\": {\n            \"Network\": \"\"\n        },\n        \"ConfigOnly\": false,\n        \"Containers\": {\n            \"05f88ee41055b209e7599a455705088cf633f6458313508ce867d13b8d39014a\": {\n                \"Name\": \"philip-j--fry-firefox-d2c22d9912fc4a489a1224237af9a3e0\",\n                \"EndpointID\": \"ae0271ed73aa5478ac364444b29342278b82bc710bd4e4eeb64a51d7eeec4d9c\",\n                \"MacAddress\": \"02:42:a1:69:d0:82\",\n                \"IPv4Address\": \"192.168.8.1/24\",\n                \"IPv6Address\": \"\"\n            }\n        },\n        \"Options\": {\n            \"parent\": \"eno1.106\"\n        },\n        \"Labels\": {\n            \"type\": \"oc.app\"\n        }\n    }\n]\n</code></pre> <p>Close the firefox application.</p> <p>Logoff, to remove the user pod <code>Philip J. Fry</code>. </p>"},{"location":"common/1.0/docker_macvlan/#use-the-hubert-j-farnsworth-user-context","title":"Use the <code>`Hubert J. Farnsworth</code> user context.","text":"<p>Login as the  <code>Hubert J. Farnsworth</code> user account. </p>  <p>Note: the user <code>Hubert J. Farnsworth</code> is NOT member of <code>cn=ship_crew,ou=people,dc=planetexpress,dc=com</code></p>   <p>Start the new application <code>firefox</code>, the docker network for this application do NOT use the <code>abcnetfirefox</code> </p> <p>Run the command</p> <pre><code>docker network inspect abcnetfirefox\n</code></pre> <p><code>abcnetfirefox</code> description :</p> <pre><code>docker network inspect abcnetfirefox\n[\n    {\n        \"Name\": \"abcnetfirefox\",\n        \"Id\": \"69c5ac0996226654635377458c044675114d5feb742a8a56d8a228180829d9cd\",\n        \"Created\": \"2021-02-05T16:24:41.781733948+01:00\",\n        \"Scope\": \"local\",\n        \"Driver\": \"macvlan\",\n        \"EnableIPv6\": false,\n        \"IPAM\": {\n            \"Driver\": \"default\",\n            \"Options\": {},\n            \"Config\": [\n                {\n                    \"Subnet\": \"192.168.8.0/24\",\n                    \"Gateway\": \"192.168.8.254\"\n                }\n            ]\n        },\n        \"Internal\": false,\n        \"Attachable\": false,\n        \"Ingress\": false,\n        \"ConfigFrom\": {\n            \"Network\": \"\"\n        },\n        \"ConfigOnly\": false,\n        \"Containers\": {},\n        \"Options\": {\n            \"parent\": \"eno1.106\"\n        },\n        \"Labels\": {\n            \"type\": \"oc.app\"\n        }\n    }\n]\n</code></pre> <p>The new firefox container doesn't use the docker network <code>abcnetfirefox</code>, because the <code>Hubert J. Farnsworth</code> user account is NOT member of <code>cn=ship_crew,ou=people,dc=planetexpress,dc=com</code></p> <p>The network is disabled by default.</p>  <p>Inspect the <code>Hubert J. Farnsworth</code> firefox container</p> <pre><code>        \"NetworkSettings\": {\n            \"Bridge\": \"\",\n            \"SandboxID\": \"\",\n            \"HairpinMode\": false,\n            \"LinkLocalIPv6Address\": \"\",\n            \"LinkLocalIPv6PrefixLen\": 0,\n            \"Ports\": {},\n            \"SandboxKey\": \"\",\n            \"SecondaryIPAddresses\": null,\n            \"SecondaryIPv6Addresses\": null,\n            \"EndpointID\": \"\",\n            \"Gateway\": \"\",\n            \"GlobalIPv6Address\": \"\",\n            \"GlobalIPv6PrefixLen\": 0,\n            \"IPAddress\": \"\",\n            \"IPPrefixLen\": 0,\n            \"IPv6Gateway\": \"\",\n            \"MacAddress\": \"\",\n            \"Networks\": {}\n        }\n</code></pre> <p>The network access is disable for this application</p> <pre><code>\"rules\": { \"homedir\": { \"default\": true, \"ship\": true }, \n           \"network\": { \"default\": false, \n                        \"internet\": { \n                                    \"name\": \"abcnetfirefox\", \n                                    \"dns\": [ \"8.8.8.8\" ] } } }\n</code></pre> <p>In this case, only users with the label tag <code>internet</code>, can bind the network name <code>abcnetfirefox</code>.</p>"},{"location":"common/1.0/docker_macvlan/#enable-network-for-hubert-j-farnsworth","title":"Enable network for <code>Hubert J. Farnsworth</code>","text":"<p>Update the application firefox rules</p> <p>Now it's time to permit network access to </p> <p>Update the applist.json file :</p> <p>Specific rules entry example</p> <pre><code>\"rules\": { \"homedir\": { \"default\": true, \"ship\": true }, \n           \"network\": { \"default\": true, \n                        \"internet\": { \n                                    \"name\": \"abcnetfirefox\", \n                                    \"dns\": [ \"8.8.8.8\" ] } } },\n</code></pre> <p>The new firefox dictionary with network rules set with \"default\": true :</p> <pre><code>{\n    \"cat\": \"office\",\n    \"preruncommands\": [ \"RUN DEBIAN_FRONTEND=noninteractive echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | debconf-set-selections\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes ttf-mscorefonts-installer ttf-bitstream-vera ttf-dejavu ttf-xfree86-nonfree &amp;&amp; apt-get clean\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes winbind firefox $(apt-cache search firefox-locale | awk '{print $1 }') &amp;&amp; apt-get clean\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes flashplugin-installer ubuntu-restricted-extras libavc1394-0 &amp;&amp; apt-get clean\",\n                        \"RUN apt-get update &amp;&amp; apt-get install  --no-install-recommends --yes libasound2-plugins libgail-common libgtk2.0-bin chromium-codecs-ffmpeg-extra gstreamer1.0-libav gstreamer1.0-plugins-ugly gstreamer1.0-vaapi libavcodec-extra &amp;&amp; apt-get clean\",\n                        \"COPY composer/init.d/init.firefox /composer/init.d/init.firefox\",\n                        \"COPY policies.json /usr/lib/firefox/distribution\",\n                        \"COPY /ntlm_auth /usr/bin/ntlm_auth.abcdesktop\",\n                        \"RUN chown root:root /usr/bin/ntlm_auth.desktop &amp;&amp; chmod 111 /usr/bin/ntlm_auth.abcdesktop\",\n                        \"ENV NSS_SDB_USE_CACHE=yes\" ],\n    \"debpackage\": \"\",\n    \"icon\": \"firefox.svg\",\n    \"keyword\": \"firefox,mozilla,web,internet\",\n    \"launch\": \"Navigator.Firefox\",\n    \"name\": \"Firefox\",\n    \"displayname\": \"Firefox\",\n    \"showinview\": \"dock\",\n    \"splash\": \"enable\",\n    \"mem_limit\": \"16gb\",\n    \"oomkilldisable\": true,\n    \"path\": \"/usr/bin/firefox\",\n    \"template\": \"abcdesktopio/oc.template.gtk\",\n    \"mimetype\": \"text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;application/rdf+xml;x-scheme-handler/http;x-scheme-handler/https;x-scheme-handler/ftp;video/webm;application/x-xpinstall;\",\n    \"legacyfileextensions\": \"htm;html;xml\",\n    \"fileextensions\": \"htm;html;xml;gif\",\n    \"desktopfile\":\"/usr/share/applications/firefox.desktop\",\n    \"shm_size\": \"2gb\",\n    \"usedefaultapplication\": true,\n    \"rules\": { \"homedir\": { \"default\": true, \"ship\": true }, \n           \"network\": { \"default\": true, \n                        \"internet\": { \n                                    \"name\": \"abcnetfirefox\", \n                                    \"dns\": [ \"8.8.8.8\" ] } } }\n}\n</code></pre> <p>Save your changes, and run <code>make dockerfile</code>, next <code>docker build</code></p> <p>Build and update your new firefox application</p> <pre><code># create the Dockerfile firefox.d \nmake dockerfile\n\n# build the new image\ndocker build -f firefox.d -t firefox.d .\n</code></pre> <p>Check that the <code>oc.rules</code> label in new firefox.d image </p> <pre><code>docker inspect firefox.d \n</code></pre> <p>The <code>oc.rules</code> label is a string json formated</p> <pre><code> \"oc.rules\": \"{\\\"homedir\\\":{\\\"default\\\":true,\\\"ship\\\":true},\\\"network\\\":{\\\"default\\\":true,\\\"internet\\\":{\\\"name\\\":\\\"abcnetfirefox\\\",\\\"dns\\\":[\\\"8.8.8.8\\\"]}}}\",\n</code></pre> <p>Request the abcdesktop core service to update the application cache data</p>  <p>Replace MY_FQDN by your own hostname </p>  <pre><code>export MY_FQDN=localhost\ncurl http://$MY_FQDN/API/manager/buildapplist \n</code></pre> <p>You do not need to logoff the <code>Hubert J. Farnsworth</code>, just close Firefox application and start it again. The new firefox container use the default network.</p>  <p>Now default user has a network access, and member of <code>cn=ship_crew,ou=people,dc=planetexpress,dc=com</code> use the <code>abcnetfirefox</code> network.</p>"},{"location":"common/1.0/docker_macvlan/#webhook-events-create-and-destroy-application","title":"Webhook events <code>create</code> and <code>destroy</code> application","text":"<p>A rule support a specific bash command to notify external security equipment like firewalls, by sending <code>create</code> and <code>destroy</code> events. </p> <pre><code>\"rules\": {  \"homedir\": { \"default\": false, \"ship\": true }, \n                \"network\": { \"default\": false, \n                    \"ship\": { \"name\": \"abcnetfirefox\", \n                                \"dns\": [ \"8.8.8.8\" ], \n                                \"webhook\": { \n                                    \"create\": \"/usr/bin/curl 'http://firewall.domain.local/update?action=create&amp;key={{ key }}&amp;name={{ name }}&amp;ip={{ container_ip }}'\", \n                                    \"destroy\": \"/usr/bin/curl 'http://firewall.domain.local/update?action=destroy&amp;key={{ key }}&amp;name={{ name }}&amp;ip={{ container_ip }}'\" \n                                } \n                    }\n                }\n}\n</code></pre> <ul> <li>When a new docker container is created, the control plane <code>pyos</code> execute the command  </li> </ul> <pre><code>/usr/bin/curl 'http://firewall.domain.local/update?action=create&amp;key={{ key }}&amp;name={{ name }}&amp;ip={{ container_ip }}\n</code></pre> <ul> <li>When a new docker container is destoyed, the control plane <code>pyos</code> call the url  </li> </ul> <pre><code>/usr/bin/curl 'http://firewall.domain.local/update?action=destroy&amp;key={{ key }}&amp;name={{ name }}&amp;ip={{ container_ip }}'\n</code></pre> <p>Each <code>{{ $label }}</code> is a mustached value.</p>    Label name description example     container_ip container ip addr 192.168.8.130   provider authentification provider name planet   providertype authentification provider type ldap   userid authentification provider user id fry   name username <code>Philip J. Fry</code>   sha_id sha of the container image sha256%3A5c754563b357bfde4a3762728c686fe0001d10e43835b9468d5218e663b844e8   id name of the application image <code>abcdesktopio/firefox-esr.d:dev</code>   launch WM_CLASS of the X11 application Navigator.Firefox   icon icon file name firefox.svg   keyword docker image label keywords firefox mozilla web internet   cat docker image label category office   displayname docker image label displayname Firefox-esr   path binary path of the application /usr/bin/firefox-esr   desktopfile desktop filename  of the application firefox.desktop   executablefilename binary file name of the application \u00a0firefox-esr   locale user current locale settings en_US"},{"location":"common/1.0/docker_macvlan/#events","title":"Events :","text":""},{"location":"common/1.0/docker_macvlan/#create-event","title":"create event:","text":"<p>The control plane <code>pyos</code> replace the mustached url string <code>/usr/bin/curl 'http://firewall.domain.local/update?action=create&amp;name={{ name }}&amp;ip={{ container_ip }}'</code> as <code>/usr/bin/curl 'http://firewall.domain.local/update?action=create&amp;name=Philip%20J.%20Fry&amp;ip=192.168.8.130'</code></p>"},{"location":"common/1.0/docker_macvlan/#destroy-event","title":"destroy event:","text":"<p>The control plane <code>pyos</code> replace the mustached url string  <code>/usr/bin/curl 'http://firewall.domain.local/update?action=destroy&amp;name={{ name }}&amp;ip={{ container_ip }}'</code> as <code>/usr/bin/curl 'http://firewall.domain.local/update?action=destroy&amp;name=Philip%20J.%20Fry&amp;ip=192.168.8.130'</code></p>"},{"location":"common/1.0/docker_macvlan/#desktopwebhook-options-in-odconfig-file","title":"desktop.webhook options in od.config file","text":""},{"location":"common/1.0/docker_macvlan/#url-encoding-parameters","title":"url encoding parameters","text":"<p>To encode url parameters use the option <code>desktop.webhookencodeparams</code>.  Set <code>desktop.webhookencodeparams</code> to <code>True</code> to encode label name. The default value is <code>False</code></p>"},{"location":"common/1.0/docker_macvlan/#additional-dict-datas","title":"additional dict datas","text":"<p>Additional datas can be set using the <code>desktop.webhookdict</code> option in od.config file</p> <pre><code>desktop.webhookdict: { \n        'api_key': 'supersecret', \n        'firewall_manage_ip': '161.105.208.129'  \n}\n</code></pre> <p>The command line </p> <pre><code>/usr/bin/curl 'http://{{ firewall_manage_ip }}/update?action=destroy&amp;key={{ api_key }}&amp;name={{ name }}&amp;ip={{ container_ip }}'\n</code></pre> <p>becomes</p> <pre><code>/usr/bin/curl 'http://161.105.208.129/update?action=destroy&amp;key=supersecret&amp;name={{ name }}&amp;ip={{ container_ip }}'\n</code></pre>"},{"location":"common/1.0/update_frontend_image/","title":"Update and custom front end image","text":""},{"location":"common/1.0/update_frontend_image/#requirements","title":"Requirements","text":""},{"location":"common/1.0/update_frontend_image/#goals","title":"Goals","text":"<ul> <li>Update abcdesktop.io images to use your own.</li> </ul>"},{"location":"common/1.0/update_frontend_image/#build-images","title":"Build images","text":"<p>Build image process from abcdesktopio docker registry to your private registry</p>"},{"location":"common/1.0/update_frontend_image/#update-ocnginx-image","title":"Update oc.nginx image","text":"<p>Goal :</p> <ul> <li>Custom web site colors</li> <li>Change logo</li> <li>Rename the web site name</li> </ul> <p>Only the name of the network is used by abcdesktop.</p>"},{"location":"common/1.0/update_frontend_image/#clone-default-webmodules","title":"Clone default webmodules","text":"<pre><code>git clone https://github.com/abcdesktopio/webModules.git\n</code></pre>"},{"location":"common/1.0/update_frontend_image/#locate-project-and-ui-files","title":"Locate project and ui files","text":""},{"location":"common/1.0/update_frontend_image/#update-uijson-file","title":"Update ui.json file","text":"<p>Update your <code>ui.json</code> file.  <code>ui.json</code> is located in <code>var/webModules/transpile/config</code> directory.</p> <pre><code># cd var/webModules/transpile/config\nvar/webModules/transpile/config# ls -la\ntotal 204\ndrwxrwxr-x   1 root root   4096 Feb  1 15:14 .\ndrwxr-xr-x   1 root root   4096 Feb  1 15:14 ..\n-rw-rw-r--   1 root root     34 Feb  1 15:14 .cache.json\n-rw-rw-r--   1 root root   2215 Feb  1 15:11 modules.json\n-rw-rw-r--   1 root root   1044 Feb  1 15:11 ui.json\n</code></pre> <p><code>ui.json</code> is a json dictionary file</p> <p>The main entry is <code>name</code>, name is the project name:</p>    entry default value example     name abcdesktop.io acmedesktop.io    <pre><code>{\n  \"name\": \"abcdesktop.io\",\n  \"colors\": [\n    {\n      \"name\": \"@primary\",\n      \"value\": \"#474B55\"\n    },\n    {\n      \"name\": \"@secondary\",\n      \"value\": \"#2D2D2D\"\n    },\n    {\n      \"name\": \"@tertiary\",\n      \"value\": \"#6EC6F0\"\n    },\n    {\n      \"name\": \"@svgColor\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@danger\",\n      \"value\": \"#CD3C14\"\n    },\n    {\n      \"name\": \"@success\",\n      \"value\": \"#32C832\"\n    },\n    {\n      \"name\": \"@info\",\n      \"value\": \"#527EDB\"\n    },\n    {\n      \"name\": \"@warning\",\n      \"value\": \"#FFCC00\"\n    },\n    {\n      \"name\": \"@light\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@dark\",\n      \"value\": \"#666666\"\n    },\n    {\n      \"name\": \"@blue\",\n      \"value\": \"#4BB4E6\"\n    },\n    {\n      \"name\": \"@green\",\n      \"value\": \"#50BE87\"\n    },\n    {\n      \"name\": \"@purple\",\n      \"value\": \"#A885D8\"\n    },\n    {\n      \"name\": \"@pink\",\n      \"value\": \"#FFB4E6\"\n    },\n    {\n      \"name\": \"@yellow\",\n      \"value\": \"#FFD200\"\n    }\n  ],\n  \"urlcannotopensession\": \"/identification/site/\"\n}\n</code></pre>"},{"location":"common/1.0/update_frontend_image/#colors-dictionary-entries","title":"Colors dictionary entries","text":"entry default value example     @primary #474B55 #474B55   @secondatry #2D2D2D #2D2D2D   @tertiary #6EC6F0 #6EC6F0"},{"location":"common/1.0/update_frontend_image/#create-a-new-dockerfile-to-build-changes","title":"Create a new <code>Dockerfile</code> to build changes","text":""},{"location":"common/1.0/update_frontend_image/#update-the-uijson-with-your-own-values","title":"Update the ui.json with your own values","text":"<p>Change for example the name to</p> <pre><code>\"name\": \"acmedesktop.io\"\n</code></pre> <p>and the  </p> <pre><code>@tertiary \"value\": \"#00BCD4\"\n</code></pre> <p>Example</p> <pre><code>{\n  \"name\": \"acmedesktop.io\",\n  \"colors\": [\n    {\n      \"name\": \"@primary\",\n      \"value\": \"#474B55\"\n    },\n    {\n      \"name\": \"@secondary\",\n      \"value\": \"#2D2D2D\"\n    },\n    {\n      \"name\": \"@tertiary\",\n      \"value\": \"#00FCD4\"\n    },\n    {\n      \"name\": \"@svgColor\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@danger\",\n      \"value\": \"#CD3C14\"\n    },\n    {\n      \"name\": \"@success\",\n      \"value\": \"#32C832\"\n    },\n    {\n      \"name\": \"@info\",\n      \"value\": \"#527EDB\"\n    },\n    {\n      \"name\": \"@warning\",\n      \"value\": \"#FFCC00\"\n    },\n    {\n      \"name\": \"@light\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@dark\",\n      \"value\": \"#666666\"\n    },\n    {\n      \"name\": \"@blue\",\n      \"value\": \"#4BB4E6\"\n    },\n    {\n      \"name\": \"@green\",\n      \"value\": \"#50BE87\"\n    },\n    {\n      \"name\": \"@purple\",\n      \"value\": \"#A885D8\"\n    },\n    {\n      \"name\": \"@pink\",\n      \"value\": \"#FFB4E6\"\n    },\n    {\n      \"name\": \"@yellow\",\n      \"value\": \"#FFD200\"\n    }\n  ],\n  \"urlcannotopensession\": \"/identification/site/\"\n}\n</code></pre>"},{"location":"common/1.0/update_frontend_image/#write-your-dockerfile","title":"Write your Dockerfile","text":"<pre><code>FROM abcdesktopio/oc.nginx:builder as builder\n\n# copy data files\nCOPY --from=abcdesktopio/oc.nginx:dev var/webModules /var/webModules\n# copy updated file ui.json \nCOPY ui.json /var/webModules/transpile/config/ui.json\n# run makefile \nRUN cd /var/webModules &amp;&amp; make css\n\n\n# --- START Build image ---\nFROM abcdesktopio/oc.nginx\n\n# COPY generated web site from builder container\nCOPY --from=builder var/webModules /var/webModules\n</code></pre>"},{"location":"common/1.0/update_frontend_image/#docker-build","title":"Docker build","text":"<p>Run the docker build command to build the new <code>oc.nginx:acme</code> image</p> <pre><code>docker build -t oc.nginx:acme .\n</code></pre> <pre><code>Sending build context to Docker daemon  258.3MB\nStep 1/6 : FROM abcdesktopio/oc.nginx:builder as builder\n ---&gt; b04ba79c6b97\nStep 2/6 : COPY --from=abcdesktopio/oc.nginx var/webModules /var/webModules\n ---&gt; Using cache\n ---&gt; 3c16ce97b6b5\nStep 3/6 : COPY ui.json /var/webModules/transpile/config/ui.json\n ---&gt; Using cache\n ---&gt; 3c8e48730bb0\nStep 4/6 : RUN cd /var/webModules &amp;&amp; make css\n ---&gt; Running in b9660fb676b2\nBuild css: 1.005s\nTotal duration: 1.007s\nRemoving intermediate container b9660fb676b2\n ---&gt; febdb98ad1aa\nStep 5/6 : FROM abcdesktopio/oc.nginx\n ---&gt; 2b311b600a4e\nStep 6/6 : COPY --from=builder var/webModules /var/webModules\n ---&gt; Using cache\n ---&gt; c9545d07f825\nSuccessfully built c9545d07f825\nSuccessfully tagged oc.nginx:acme\n</code></pre> <p>Run the <code>docker images</code> command to read the new <code>oc.nginx</code> image</p> <pre><code>docker images \n\nREPOSITORY                   TAG       IMAGE ID       CREATED             SIZE\noc.nginx                     acme      4de1755b60d7   About an hour ago   746MB\n</code></pre>"},{"location":"common/1.0/update_frontend_image/#update-the-dockercompose-or-the-abcdesktopyaml-file","title":"Update the dockercompose or the abcdesktop.yaml file","text":"<p>Update the dockercompose or the abcdesktop.yaml file to replace the default <code>abcdesktopio/oc.nginx</code> by the new image <code>oc.nginx:acme</code> name.</p> <pre><code>version: '3'\nservices:\n  pyos:\n    depends_on:\n      - memcached\n      - mongodb\n    image: 'abcdesktopio/oc.pyos'\n    networks:\n      - netback\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n  speedtest:\n    image: 'abcdesktopio/oc.speedtest'\n    networks:\n      - netuser\n  nginx:\n    depends_on:\n      - memcached\n      - pyos\n    image: 'oc.nginx:acme'\n    ports:\n      - '80:80'\n      - '443:443'\n    networks:\n      - netuser\n      - netback\n  memcached:\n    image: memcached\n    networks:\n      - netback\n  mongodb:\n    image: mongo\n    networks:\n      - netback\nnetworks:\n  netuser:\n    driver: bridge\n  netback:\n    internal: true\n</code></pre> <p>The run the docker-compose up, and start you web browser. You can read the new project name at the home page.</p>  <p>We define the new tertiary color as <code>#00FCD4</code> in dict <code>{ \"name\": \"@tertiary\",   \"value\": \"#00FCD4\" }</code></p>  <p>Old tertiary color has been replace by <code>#00FCD4</code>.</p>"},{"location":"common/1.0/userdatapersistence/","title":"User data persistence in release 1.x configuration","text":""},{"location":"common/1.0/userdatapersistence/#requirements","title":"Requirements","text":"<p>Use a Kubernetes <code>abcdesktop</code> instance </p>"},{"location":"common/1.0/userdatapersistence/#goals","title":"Goals","text":"<ul> <li>keep user's data after a logoff </li> </ul>"},{"location":"common/1.0/userdatapersistence/#create-mntabcdesktop-directory","title":"Create <code>/mnt/abcdesktop</code> directory","text":"<p>Create a directory <code>/mnt/abcdesktop</code></p> <pre><code>mkdir -p /mnt/abcdesktop  \n</code></pre> <p>abcdesktop uses a <code>PersistentVolume</code> to store user data.</p>"},{"location":"common/1.0/userdatapersistence/#remove-previous-persistentvolume-and-persistentvolumeclaim","title":"Remove previous PersistentVolume and PersistentVolumeClaim","text":"<pre><code>kubectl delete pvc persistentvolumeclaim-home-directory  -n abcdesktop\nkubectl delete pv  pv-volume-home-directory -n abcdesktop\n</code></pre> <p>You have to delete user's pod too. Make sure that all user's pod have been removed.</p>"},{"location":"common/1.0/userdatapersistence/#create-the-persistentvolume-pv-volume-home-directory","title":"Create the PersistentVolume <code>pv-volume-home-directory</code>","text":"<pre><code>kubectl create -f - &lt;&lt;EOF\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv-volume-home-directory\n  namespace: abcdesktop\n  labels:\n     type: local\nspec:\n  storageClassName: storage-local-abcdesktop\n  capacity:\n     storage: 10Gi\n  volumeMode: Filesystem\n  accessModes:\n  - ReadWriteMany\n  hostPath:\n    path: '/mnt/abcdesktop'\nEOF\n</code></pre> <p>You should read on stdout : </p> <pre><code>persistentvolume/pv-volume-home-directory created\n</code></pre>"},{"location":"common/1.0/userdatapersistence/#create-the-persistentvolumeclaim-persistentvolumeclaim-home-directory","title":"Create the PersistentVolumeClaim <code>persistentvolumeclaim-home-directory</code>","text":"<pre><code>kubectl create -f - &lt;&lt;EOF\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: persistentvolumeclaim-home-directory\n  namespace: abcdesktop\nspec:\n  storageClassName: storage-local-abcdesktop\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 3Gi\nEOF\n</code></pre> <p>You should read on stdout : </p> <pre><code>persistentvolumeclaim/persistentvolumeclaim-home-directory created\n</code></pre>"},{"location":"common/1.0/userdatapersistence/#update-abcdesktopyaml-file","title":"Update <code>abcdesktop.yaml</code> file","text":""},{"location":"common/1.0/userdatapersistence/#change-odconfig-file","title":"Change od.config file","text":"<p>Two options define the user homedirectory :  <code>desktop.homedirectorytype</code> and <code>desktop.persistentvolumeclaim</code></p>"},{"location":"common/1.0/userdatapersistence/#update-desktophomedirectorytype","title":"Update <code>desktop.homedirectorytype</code>","text":"<p>Set the desktop.homedirectorytype to value 'persistentVolumeClaim'</p> <pre><code>desktop.homedirectorytype: 'persistentVolumeClaim'\n</code></pre>"},{"location":"common/1.0/userdatapersistence/#update-desktoppersistentvolumeclaim","title":"Update <code>desktop.persistentvolumeclaim</code>","text":"<p>Set the desktop.persistentvolumeclaim to the name of the <code>persistentVolumeClaim</code> to use. In this example the name of the <code>persistentvolumeclaim</code> is <code>persistentvolumeclaim-home-directory</code></p> <pre><code>desktop.persistentvolumeclaim: 'persistentvolumeclaim-home-directory'\n</code></pre>"},{"location":"common/1.0/userdatapersistence/#update-desktoppod","title":"Update <code>desktop.pod</code>","text":"<p>Add the <code>init</code> entry in <code>desktop.pod</code></p> <pre><code>'init':       {     'image': 'busybox',\n                    'enable': True,\n                    'acl':  { 'permit': [ 'all' ] },\n                    'pullpolicy':  'IfNotPresent',\n                    'command':  [ 'sh', '-c',  'chown 4096:4096 /home/balloon' ] \n    }\n</code></pre> <p>The init entry defines the init container for the user's pod. The command runs by the init container, fixes the owner of the home directory to <code>userid</code> to <code>4096</code> and the <code>groupid</code> to <code>4096</code>.   The init command is <code>chown 4096:4096 /home/balloon /home/balloon/*</code></p> <p>Pulseaudio audio service does not start if the home directory not accessible or not own by the current user.</p> <pre><code>desktop.pod : { \n    'graphical' : { 'image': 'abcdesktopio/oc.user.20.04:dev',\n                    'pullpolicy':  'IfNotPresent',\n                    'enable': True,\n                    'acl':  { 'permit': [ 'all' ] },\n                    'waitportbin' : '/composer/node/wait-port/node_modules/.bin/wait-port',\n                    'resources': { 'requests': { 'memory': \"320Mi\",   'cpu': \"250m\" },  'limits'  : { 'memory': \"1Gi\",    'cpu': \"1000m\" } },\n                    'securityContext': { 'allowPrivilegeEscalation': True, 'runAsUser': 4096 },\n                    'shareProcessNamespace': True,\n                    'secrets_requirement' : [ 'abcdesktop/vnc', 'abcdesktop/kerberos']\n    },\n    'printer' :   { 'image': 'abcdesktopio/oc.cupsd.18.04:dev',\n                    'pullpolicy': 'IfNotPresent',\n                    'enable': True,\n                    'securityContext': { 'runAsUser': 0 },\n                    'resources': { 'requests': { 'memory': \"64Mi\",    'cpu': \"125m\" },  'limits'  : { 'memory': \"512Mi\",  'cpu': \"500m\"  } },\n                    'acl':  { 'permit': [ 'all' ] } \n    },\n    'filer' :     { 'image': 'abcdesktopio/oc.filer:dev',\n                    'pullpolicy':  'IfNotPresent',\n                    'enable': True,\n                    'securityContext': { 'runAsUser': 4096 },\n                    'acl':  { 'permit': [ 'all' ] } \n    },\n    'storage' :   { 'image': 'k8s.gcr.io/pause:3.2',\n                    'pullpolicy':  'IfNotPresent',\n                    'enable': True,\n                    'securityContext': {  'runAsUser': 4096 },\n                    'acl':   { 'permit': [ 'all' ] },\n                    'resources': { 'requests': { 'memory': \"32Mi\",    'cpu': \"100m\" },  'limits'  : { 'memory': \"128Mi\",  'cpu': \"250m\"  } }\n    },\n    'sound':      { 'image': 'abcdesktopio/oc.pulseaudio.22.04:dev',\n                    'pullpolicy': 'IfNotPresent',\n                    'enable': True,\n                    'securityContext': {  'runAsUser': 4096 },\n                    'acl':  { 'permit': [ 'all' ] },\n                    'resources': { 'requests': { 'memory': \"8Mi\",     'cpu': \"50m\"  },  'limits'  : { 'memory': \"64Mi\",   'cpu': \"250m\"  } } \n    },\n    'init':       { 'image': 'busybox',\n                    'enable': True,\n                    'acl':  { 'permit': [ 'all' ] },\n                    'pullpolicy':  'IfNotPresent',\n                    'command':  [ 'sh', '-c',  'chown 4096:4096 /home/balloon' ] \n    }}\n</code></pre>"},{"location":"common/1.0/userdatapersistence/#restart-your-pyos-daemon","title":"Restart your pyos daemon","text":"<p>Restart your pyos daemon, to make sure that the new parameters will be use to start the user container.</p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/","title":"How to create containerised application from scratch for troubleshooting","text":""},{"location":"common/3.0/createcontainerisedapplicationdebug/#requirements","title":"Requirements","text":"<ul> <li><code>envsubst</code> command preinstalled. Common Linux systems have <code>envsubst</code> preinstalled</li> </ul>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#goals","title":"Goals","text":"<ul> <li>Create a new containerised application from scratch using pod volume mapping</li> <li>Start a pod and get a shell inside container as user <code>root</code>. Run xedit application as <code>root</code></li> <li>Start a pod and get a shell inside container as user <code>hermes</code>. Run xedit application as <code>hermes</code></li> </ul>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#create-an-application-using-a-new-container","title":"Create an application using a new container","text":"<p>We are starting a new containerised application from a fresh <code>ubuntu:20.04</code> image and bind the X11 socket to use the pod DISPLAY.</p> <p>We start a new container one as <code>root</code>, and another one as current user <code>hermes</code></p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#start-a-new-abcdesktop-session","title":"Start a new abcdesktop session","text":"<p>Open a web browser and go to abcdesktop service url</p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#login-in-as-hermes","title":"Login in as hermes","text":"<p>In the example we use LDAP authentification.</p>  <p>The <code>login</code> is <code>Hermes Conrad</code>, the password is <code>hermes</code> </p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#get-hermess-pod-variables-name-uid-xauth_key","title":"Get hermes's pod variables: name, uid, XAUTH_KEY","text":"<p>Get a shell to your host. All next command use a host shell.</p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#get-the-hermess-pod-name","title":"Get the hermes's pod <code>name</code>","text":"<p>To read the hermes <code>pod name</code>, <code>MIT-MAGIC-COOKIE-1</code>, and <code>uid</code></p> <pre><code>kubectl get pod -l=access_userid=hermes -o jsonpath='{.items[0].metadata.name}' -n abcdesktop\n</code></pre> <p>We save this value in the <code>pod</code> variable, for next usage</p> <pre><code>POD=$(kubectl get pod -l=access_userid=hermes -o jsonpath='{.items[0].metadata.name}' -n abcdesktop)\necho $POD\n</code></pre> <p>You should read on stdout</p> <pre><code>hermes-da0ca3c8-48ba-4736-85a9-d3fd2c85f009\n</code></pre> <p>We save this value in the <code>$POD</code> for a next usage.</p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#get-the-hermess-xauth_key","title":"Get the hermes's <code>XAUTH_KEY</code>","text":"<p>The release 3.0 need the <code>MIT-MAGIC-COOKIE-1</code> to reach the x11 <code>DISPLAY</code>.</p> <p>Run the command <code>echo $XAUTH_KEY</code> to read the <code>$XAUTH_KEY</code> value inside the hermes's pod</p> <pre><code>export XAUTH_KEY=$(kubectl exec -n abcdesktop -it $POD -- bash -c 'echo $XAUTH_KEY')\n</code></pre> <pre><code>Defaulted container \"x-planet-hermes\" out of: x-planet-hermes, c-planet-hermes, f-planet-hermes, o-planet-hermes, hermes-conrad-xterm-9e2589dc0da0473da8e33d3ab98abedc (ephem), i-planet-hermes (init)\n</code></pre> <p>The <code>XAUTH_KEY</code> variable is exported for a next usage.</p> <pre><code>echo $XAUTH_KEY\n306908f8e4d4768c7595ce5ad53479\n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#get-the-hermess-pod-uid","title":"Get the hermes's pod <code>uid</code>","text":"<pre><code>kubectl get pod -l=access_userid=hermes -o jsonpath='{.items[0].metadata.uid}' -n abcdesktop\n</code></pre> <p>We save this value in the <code>PODUID</code> exported variable, for next usage</p> <pre><code>export PODUID=$(kubectl get pod -l=access_userid=hermes -o jsonpath='{.items[0].metadata.uid}' -n abcdesktop)\n</code></pre> <pre><code>echo $PODUID\nc6d2f8a7-eb7d-4a25-9a9c-9778ca9e35cf\n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#inspect-the-hermess-pod-to-look-for-binding-volume-mapping","title":"Inspect the Hermes's pod to look for <code>Binding</code> volume mapping","text":""},{"location":"common/3.0/createcontainerisedapplicationdebug/#list-files-in-varlibkubeletpodspoduid","title":"List files in <code>/var/lib/kubelet/pods/$PODUID</code>","text":"<p>The default kubelet's pod directory is <code>/var/lib/kubelet/pods/</code>. If you change it during the installation process replace <code>/var/lib/kubelet/pods/</code> by your own directory.</p> <pre><code>ls -la /var/lib/kubelet/pods/$PODUID/volumes/kubernetes.io~empty-dir/x11socket\n</code></pre> <pre><code>ls -la /var/lib/kubelet/pods/$PODUID/volumes/kubernetes.io~empty-dir/x11socket\ntotal 4\ndrwxrwxrwt 2 root root   60 Dec  8 19:43 .\ndrwxr-xr-x 9 root root 4096 Dec  8 19:43 ..\nsrwxrwxrwx 1 1051 2051    0 Dec  8 19:43 X0\n</code></pre> <p><code>X0</code> is a file unix socket, we will bind the <code>X0</code> socket in the next podapp.</p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#get-the-hermess-pod-home-hermes-volume-location","title":"Get the hermes's pod <code>home-hermes</code> volume location","text":"<pre><code>kubectl get pod -l=access_userid=hermes -o jsonpath='{.items[0].spec.volumes[?(@.name==\"home-hermes\")].hostPath.path}' -n abcdesktop\n</code></pre>  <p>Description of this query</p> <ul> <li>items[0] is the first entry of the pod list. </li> <li>spec.volumes is an array</li> <li>read all entries in spec.volumes where the @.name==\"home-hermes\" and return .hostPath.path</li> </ul>  <p>We save this value in the <code>PODHOME</code> exported variable, for next usage</p> <pre><code>export PODHOME=$(kubectl get pod -l=access_userid=hermes -o jsonpath='{.items[0].spec.volumes[?(@.name==\"home-hermes\")].hostPath.path}' -n abcdesktop)\n</code></pre> <p>Check the value with a echo</p> <pre><code>echo $PODHOME\n/tmp/hermes-conrad\n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#start-a-new-container-from-ubuntu2004","title":"Start a new container from <code>ubuntu:20.04</code>","text":"<p>Now we've got the all volumes path and XAUTH_KEY, let's start a new container with mounted volume</p> <ul> <li>to the X11 socket <code>/var/lib/kubelet/pods/$PODUID/volumes/kubernetes.io~empty-dir/x11socket:/tmp/.X11-unix</code></li> <li>to the user <code>homedir</code> <code>$PODHOME:/home/balloon</code></li> </ul>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#create-container-in-the-pod-sandbox-with-config-file","title":"Create container in the pod sandbox with config file","text":"<p>We use <code>envsubst</code> to replace variable content in a template yaml file.</p>  <p>Some systems have gettext with envsubst preinstalled. However, if it is missing, you can install it using a package manager. For macOS you can use homebrew:</p> <p><code>brew install gettext</code></p>  <p>The variables <code>${PODUID}</code>, <code>${PODHOME}</code> and <code>${XAUTH_KEY}</code> are exported.</p>  <p>Make sure to use export, otherwise your variables are considered shell variables and might not be accessible to <code>envsubst</code></p>  <p>Create a file <code>podapp.template.yaml</code> </p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: podapp\n  namespace: abcdesktop\nspec:\n  volumes:\n  - name: x11socket\n    hostPath:\n      # x11 directory location on host ${PODUID}\n      path: /var/lib/kubelet/pods/${PODUID}/volumes/kubernetes.io~empty-dir/x11socket\n      # this field is optional\n      type: Directory\n  - name: home\n    hostPath:\n      # home directory location on host\n      path: ${PODHOME}\n      # this field is optional\n      type: Directory\n  containers:\n  - name: abccontainer\n    image: ubuntu:20.04\n    command: [\"/bin/sleep\"]\n    args: [\"1d\"]\n    volumeMounts:\n    - mountPath: /tmp/.X11-unix\n      name: x11socket\n    - mountPath: /home/hermes\n      name: home\n    env:\n    - name: XAUTH_KEY\n      value: ${XAUTH_KEY}\n</code></pre> <p>Run the <code>envsubst</code> command to replace <code>${PODUID}</code>, <code>${PODHOME}</code> and <code>${XAUTH_KEY}</code></p> <pre><code>envsubst &lt; podapp.template.yaml &gt; podapp.yaml \n</code></pre> <p>Dump the <code>podapp.yaml</code> file content, and check that the volumes are set with the new values.</p> <pre><code># cat podapp.yaml \n</code></pre> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: podapp\n  namespace: abcdesktop\nspec:\n  volumes:\n  - name: x11socket\n    hostPath:\n      # directory location on host\n      path: /var/lib/kubelet/pods/c6d2f8a7-eb7d-4a25-9a9c-9778ca9e35cf/volumes/kubernetes.io~empty-dir/x11socket\n      # this field is optional\n      type: Directory\n  - name: home\n    hostPath:\n      # directory location on host\n      path: /tmp/hermes-conrad\n      # this field is optional\n      type: Directory\n  containers:\n  - name: abccontainer\n    image: ubuntu:20.04\n    command: /bin/sleep 1d\n    volumeMounts:\n    - mountPath: /tmp/.X11-unix\n      name: x11socket\n    - mountPath: /home/hermes\n      name: home\n</code></pre> <p>Create the application pod </p> <pre><code>kubectl apply -f podapp.yaml \npod/podapp created\n</code></pre> <p>Check that your pod <code>podapp</code> is <code>Running</code></p> <pre><code>kubectl get pods podapp  -n abcdesktop\nNAME     READY   STATUS    RESTARTS   AGE\npodapp   1/1     Running   0          32s\n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#get-a-shell-in-podapp","title":"Get a shell in <code>podapp</code>","text":"<p>You get a shell command inside the container.</p> <pre><code>kubectl exec -it podapp  -n abcdesktop -- bash \n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#for-release-30-set-the-mit-magic-cookie-1","title":"for release 3.0 set the MIT-MAGIC-COOKIE-1","text":"<pre><code>apt-get update &amp;&amp; apt-get install -y xauth\n</code></pre> <pre><code>export DISPLAY=:0.0\necho $XAUTH_KEY\nxauth add $DISPLAY MIT-MAGIC-COOKIE-1 $XAUTH_KEY\n</code></pre> <p>You can read on stdout</p> <pre><code>root@podapp:/# export DISPLAY=:0.0\nroot@podapp:/# echo $XAUTH_KEY\n306908f8e4d4768c7595ce5ad53479\nroot@podapp:/# xauth add $DISPLAY MIT-MAGIC-COOKIE-1 $XAUTH_KEY\nxauth:  file /root/.Xauthority does not exist\nroot@podapp:/#\n</code></pre> <p>The file <code>/root/.Xauthority</code> does not exist, it has been created.</p>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#install-your-x11-applications","title":"Install your X11 applications","text":"<p>For example, I choose to install the <code>x11-apps</code> package</p> <p>Replace <code>x11-apps</code> by your own application</p> <pre><code>apt-get install -y x11-apps\n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#start-your-x11-application","title":"Start your X11 application","text":"<p>To start the X11 application, just run it. Your <code>DISPLAY</code> is set to <code>:0.0</code>,  (for release 3.0, you've already added the <code>MIT-MAGIC-COOKIE-1</code>). </p> <p>But remember you a running a container as <code>root</code>, and all commands are running as <code>root</code> inside the container.</p> <p>Start <code>xedit</code> </p> <pre><code>xedit\n</code></pre> <p>Go back to your web browser. </p> <p>A new x11 window <code>xedit</code> should be present on your display</p>  <p><code>xedit</code> doesn't write any error message in the bash container. </p> <p>You've get a shell inside a container to run and start any application.  You can also install and start any others applications.</p> <p>To clean the running pod podapp</p> <pre><code>kubectl delete pods podapp -n abcdesktop \n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#start-a-new-container-from-ubuntu2004-as-hermes","title":"Start a new container from <code>ubuntu:20.04</code> as <code>hermes</code>","text":"<p>To start a new container from <code>ubuntu:20.04</code> as <code>hermes</code>, we have to add the <code>localaccount</code> secret volume to the previous container</p> <p>Read the securityContext from the <code>hermes</code> pod </p> <pre><code>export PODRUNASUSER=$(kubectl get pods -l=access_userid=hermes -o json  -n abcdesktop | jq -r '.items[0].spec.securityContext.runAsUser')\nexport PODRUNASGROUP=$(kubectl get pods -l=access_userid=hermes -o json  -n abcdesktop | jq -r '.items[0].spec.securityContext.runAsGroup')\n</code></pre> <p>Check the <code>uidNumber</code> and the <code>gidNumber</code> values</p> <pre><code>echo PODRUNASUSER:$PODRUNASUSER PODRUNASGROUP:$PODRUNASGROUP\nPODRUNASUSER:1051 PODRUNASGROUP:2051\n</code></pre> <p>Create a file <code>hermespodapp.template.yaml</code> </p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: hermespodapp\n  namespace: abcdesktop\nspec:\n  securityContext:\n    runAsUser: ${PODRUNASUSER}\n    runAsGroup: ${PODRUNASGROUP}\n  volumes:\n  - name: x11socket\n    hostPath:\n      # x11 directory location on host ${PODUID}\n      path: /var/lib/kubelet/pods/${PODUID}/volumes/kubernetes.io~empty-dir/x11socket\n      # this field is optional\n      type: Directory\n  - name: home\n    hostPath:\n      # home directory location on host\n      path: ${PODHOME}\n      # this field is optional\n      type: Directory\n  - name: localaccount\n    hostPath:\n      # localaccount directory location on host\n      path: /var/lib/kubelet/pods/${PODUID}/volumes/kubernetes.io~secret/auth-localaccount-hermes\n      # this field is optional\n      type: Directory\n  containers:\n  - name: hermescontainer\n    image: ubuntu:20.04\n    command: [\"/bin/sleep\"]\n    args: [\"1d\"]\n    volumeMounts:\n    - mountPath: /tmp/.X11-unix\n      name: x11socket\n    - mountPath: /home/hermes\n      name: home\n    - mountPath: /var/secrets/abcdesktop/localaccount\n      name: localaccount\n    env:\n    - name: XAUTH_KEY\n      value: ${XAUTH_KEY}\n</code></pre> <p>Create your hermespodapp.yaml file from the previous template</p> <pre><code>envsubst &lt; hermespodapp.template.yaml &gt; hermespodapp.yaml \n</code></pre> <p>Look at your <code>hermespodapp.yaml</code></p> <pre><code>cat hermespodapp.yaml \n</code></pre> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: hermespodapp\n  namespace: abcdesktop\nspec:\n  securityContext:\n    runAsUser: 1051\n    runAsGroup: 2051\n  volumes:\n  - name: x11socket\n    hostPath:\n      # x11 directory location on host c6d2f8a7-eb7d-4a25-9a9c-9778ca9e35cf\n      path: /var/lib/kubelet/pods/c6d2f8a7-eb7d-4a25-9a9c-9778ca9e35cf/volumes/kubernetes.io~empty-dir/x11socket\n      # this field is optional\n      type: Directory\n  - name: home\n    hostPath:\n      # home directory location on host\n      path: /tmp/hermes-conrad\n      # this field is optional\n      type: Directory\n  - name: localaccount\n    hostPath:\n      # localaccount directory location on host\n      path: /var/lib/kubelet/pods/c6d2f8a7-eb7d-4a25-9a9c-9778ca9e35cf/volumes/kubernetes.io~secret/auth-localaccount-hermes\n      # this field is optional\n      type: Directory\n  containers:\n  - name: hermescontainer\n    image: ubuntu:20.04\n    command: [\"/bin/sleep\"]\n    args: [\"1d\"]\n    volumeMounts:\n    - mountPath: /tmp/.X11-unix\n      name: x11socket\n    - mountPath: /home/hermes\n      name: home\n    - mountPath: /var/secrets/abcdesktop/localaccount\n      name: localaccount\n    env:\n    - name: XAUTH_KEY\n      value: 306908f8e4d4768c7595ce5ad53479\n</code></pre> <p>Create the <code>hermespodapp</code></p> <pre><code>kubectl apply -f hermespodapp.yaml \npod/hermespodapp created\n</code></pre> <p>To install the x11 application package, we need a root access to the pod/hermespodapp. We use <code>runc</code> to get a rooted shell. </p> <p>Read the <code>containerID</code> of the pod <code>hermespodapp</code></p> <pre><code>CONTAINER=$(kubectl -n abcdesktop  get pod hermespodapp -o jsonpath=\"{.status.containerStatuses[].containerID}\" |sed 's/.*\\/\\///')\n</code></pre> <p>Get the shell with <code>runc</code> command</p> <pre><code>runc --root /run/containerd/runc/k8s.io/ exec -t -u 0 $CONTAINER bash\ngroups: cannot find name for group ID 2051\nroot@hermespodapp:/# \n</code></pre> <p>This is correct <code>group ID 2051</code> does not exit. Let's patch your file system with <code>hermes</code> credentials </p> <ul> <li>/etc/passwd</li> <li>/etc/group</li> <li>/etc/shadow</li> <li>/etc/gshadow</li> </ul> <pre><code>rm -f /etc/passwd &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/passwd /etc/passwd\nrm -f /etc/group &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/group  /etc/group\nrm -f /etc/shadow &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/shadow /etc/shadow\nrm -f /etc/gshadow &amp;&amp; ln -s /var/secrets/abcdesktop/localaccount/gshadow /etc/gshadow\n</code></pre> <p>Now your files are updated. You can exit, and reopen a bash to your container </p> <pre><code>root@hermespodapp:/# exit\n</code></pre> <pre><code># runc --root /run/containerd/runc/k8s.io/ exec -t -u 0 $CONTAINER bash\nroot@hermespodapp:/# \n</code></pre> <p>The error message does not appear anymore.</p> <p>Install your X11 applications as root</p> <pre><code>apt-get update &amp;&amp; apt-get install -y x11-apps\n</code></pre> <p>Quit the root session</p> <pre><code>exit\n</code></pre>"},{"location":"common/3.0/createcontainerisedapplicationdebug/#start-your-x11-application-as-hermes","title":"Start your X11 application as <code>hermes</code>","text":"<p>Start a new session to the pod <code>hermespodapp</code></p> <pre><code>kubectl -n abcdesktop exec -it hermespodapp -- bash \n</code></pre> <p>You get a shell prompt as as <code>hermes</code>. Check the <code>hermes</code> homedirectory and id number</p> <pre><code>hermes@hermespodapp:/$\nhermes@hermespodapp:/$ cd\nhermes@hermespodapp:~$ pwd\n/home/hermes\nhermes@hermespodapp:~$ id \nuid=1051(hermes) gid=2051(hermes) groups=2051(hermes)\n</code></pre> <p>Export the var <code>DISPLAY</code> and start the edit application. You don't need to create the <code>.Xauthority</code> file. <code>/home/hermes</code> is already mounted as a volume.</p> <pre><code>hermes@hermespodapp:~$ export DISPLAY=:0.0\nhermes@hermespodapp:~$ xedit &amp;\n[1] 699\n</code></pre> <p>This process is running as <code>hermes</code> :</p> <pre><code>hermes@hermespodapp:~$ ps -ef\nUID          PID    PPID  C STIME TTY          TIME CMD\nhermes         1       0  0 15:57 ?        00:00:00 /bin/sleep 1d\nhermes       690       0  0 16:47 pts/0    00:00:00 bash\nhermes       699     690  0 16:48 pts/0    00:00:00 xedit\nhermes       700     690  0 16:49 pts/0    00:00:00 ps -ef\n</code></pre> <p>Go back to your web browser. </p> <p>A new x11 window <code>xedit</code> should be present on your display </p>   <p>The name of the edit window is the name of your pod <code>(hermespodapp)</code>.</p>  <p>To clean the running pod hermespodapp</p> <pre><code>kubectl delete -f hermespodapp.yaml \n</code></pre> <p>You have created a pod to run an X11 application as a user in LDAP Directory.  You get a root shell inside the pod, to patch, update or install other applications.</p>"},{"location":"common/3.0/mount_nfs_tag/","title":"Define rules to mount a nfs volume inside user pod","text":"<p>Only supported in abcdesktop release 3.0</p>  <p>An nfs volume allows an existing NFS (Network File System) share to be mounted into a Pod. NFS volume can be pre-populated with data, and can be shared between pods. NFS can be mounted by multiple writers simultaneously.</p>  <p>You must have your own NFS server running with the share exported before you can use it.</p>"},{"location":"common/3.0/mount_nfs_tag/#update-the-odconfig-file","title":"Update the <code>od.config</code> file","text":"<p>Update the <code>od.config</code> to add </p> <ul> <li>a label to user</li> <li>add a desktop rules to match the label</li> </ul>"},{"location":"common/3.0/mount_nfs_tag/#add-a-label-in-the-auth-provider","title":"Add a label in the <code>auth provider</code>","text":"<p>In this example, we add a label <code>nfsuser</code> as a condition to mount nfs resource</p> <p>In the auth provider add a <code>dummy</code> condition or a  <code>memberOf</code> condition. All types of conditions are supported, the goal is only to get a label.</p> <p>Update the <code>od.config</code> file and look for the default <code>ldapconfig</code> dictionnary</p>"},{"location":"common/3.0/mount_nfs_tag/#add-a-dummy-condition","title":"Add a dummy condition","text":"<pre><code>ldapconfig : { \n  'planet': {  \n    'default'       : True,\n    'ldap_timeout'  : 15,\n    'ldap_basedn'   : 'dc=planetexpress,dc=com',\n    'users_ou'      : 'ou=people,dc=planetexpress,dc=com',\n    'servers'       : [ 'ldap://openldap.abcdesktop.svc.cluster.local:30389' ],\n    'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' },\n    'policies': { \n       'acls': None, \n       'rules' : { \n          'rule-dummy': { \n             'conditions' : [ { 'boolean': True, 'expected' : True  } ],\n             'expected' : True,\n             'label': 'nfsuser' } } } } } }\n</code></pre>"},{"location":"common/3.0/mount_nfs_tag/#or-add-a-memberof-condition","title":"Or Add a <code>memberOf</code> condition","text":"<pre><code>ldapconfig : { \n  'planet': {  \n    'default'       : True,\n    'ldap_timeout'  : 15,\n    'ldap_basedn'   : 'dc=planetexpress,dc=com',\n    'users_ou'      : 'ou=people,dc=planetexpress,dc=com',\n    'servers'       : [ 'ldap://openldap.abcdesktop.svc.cluster.local:30389' ],\n    'serviceaccount': { 'login': 'cn=admin,dc=planetexpress,dc=com', 'password': 'GoodNewsEveryone' },\n    'policies': { \n       'acls': None, \n       'rules' : { \n          'rule-nfsuser':  { \n              'conditions' : [ { 'memberOf': 'cn=admin_staff,ou=people,dc=planetexpress,dc=com',   'expected' : True  } ],\n              'expected' : True, \n              'label': 'nfsuser' } } } } }\n</code></pre>"},{"location":"common/3.0/mount_nfs_tag/#add-a-rule-in-the-desktoppolicies","title":"Add a <code>rule</code> in the <code>desktop.policies</code>","text":"<p>In this example, we define entries :</p> <ul> <li><code>nfsserver</code> is <code>192.168.7.101</code> (can also be a FQDH)</li> <li><code>path</code> is <code>/volume1/isostore</code></li> <li><code>mountPath</code> is <code>/mnt/iso</code></li> </ul> <p>The mount command become like:</p> <pre><code>mount -t nfs 192.168.7.101:/volume1/isostore /mnt/iso\n</code></pre> <p>Update the <code>desktop.policies</code> dictionnary and add a new key <code>rules</code>. In the new <code>rules</code> define a new entry <code>nfsuser</code>. </p>  <p>The name of the entry MUST match a user label tag, else the mount point is not created. </p>  <p>In this example the label is defined as <code>nfsuser</code>, but you can set differents values.  Then set nfs descriptions as you can read in kubernetes nfs volume </p> <pre><code>desktop.policies: {  \n'acls' : {},\n'rules': { \n  'volumes': { \n    'nfsuser': {\n      'type': 'nfs', \n      'name': 'isostore', \n      'server': '192.168.7.101',\n      'path': '/volume1/isostore',\n      'mountPath': '/mnt/iso',\n      'readOnly': True } } } } \n</code></pre>"},{"location":"common/3.0/mount_nfs_tag/#apply-the-new-odconfig-file","title":"Apply the new <code>od.config</code> file","text":"<p>Save your local changes in <code>od.config</code>, and update the new configmap <code>abcdesktop-config</code></p> <pre><code>kubectl delete configmap abcdesktop-config -n abcdesktop\nkubectl create --from-file=od.config -n abcdesktop\n</code></pre>"},{"location":"common/3.0/mount_nfs_tag/#restart-pyos-daemonset","title":"Restart <code>pyos daemonset</code>","text":"<p>Restart pyos daemonset</p> <pre><code>kubectl rollout restart daemonset daemonset-pyos -n abcdesktop\n</code></pre>"},{"location":"common/3.0/mount_nfs_tag/#create-a-new-desktop-for-hermes-conrad-and-list-nfs-files","title":"Create a new desktop for <code>Hermes Conrad</code> and list nfs files","text":"<p>Open the url <code>http://localhost:30443</code>, in your web browser, to start a simple abcdesktop.io pod. </p> <pre><code>http://localhost:30443\n</code></pre> <ul> <li>Login with a user <code>Hermes Conrad</code> for example. <code>Hermes Conrad</code> is member of <code>admin_staff</code>. </li> </ul>  <ul> <li>Check that the label <code>nfsuser</code> is listed</li> </ul>  <ul> <li>Run a web shell to list the <code>/mnt/iso</code> directory content</li> </ul>  <p>You can define many rules from LDAP groups. To get more informations about rules, read the authentification rules section</p>"},{"location":"common/3.0/multiplegroupsfeature/","title":"The multiple groups features for RFC 2307 support","text":"<p>Let talk about a common features with multiple groups and user <code>securityContext</code> on pods</p>"},{"location":"common/3.0/multiplegroupsfeature/#context","title":"context","text":"<ul> <li>Use ldap auth like in sample config <code>ou=people,dc=planetexpress,dc=com</code></li> <li>Use groups <code>gidNumber</code> and <code>uidNumber</code></li> <li>Use filesystem access right</li> </ul>"},{"location":"common/3.0/multiplegroupsfeature/#goal","title":"Goal","text":"<ul> <li>Use the kubernetes supplemental groups support</li> <li>Define accounts in ldap directory service to get <code>supplementalGroups</code> support</li> </ul>"},{"location":"common/3.0/multiplegroupsfeature/#check-the-kubernetes-supplementalgroups-support","title":"Check the <code>kubernetes</code> <code>supplementalGroups</code> support","text":"<p>Let's create a yaml file to define pod with <code>securityContext</code> and <code>supplementalGroups</code></p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-context-supplementalgroups-demo\nspec:\n  securityContext:\n    runAsUser: 1000\n    runAsGroup: 3000\n    supplementalGroups: [2000,4000,5000,6000]\n  volumes:\n  - name: sec-ctx-vol\n    emptyDir: {}\n  containers:\n  - name: sec-ctx-demo\n    image: busybox:1.28\n    command: [ \"sh\", \"-c\", \"sleep 1h\" ]\n    volumeMounts:\n    - name: sec-ctx-vol\n      mountPath: /data/demo\n    securityContext:\n      allowPrivilegeEscalation: false\n</code></pre> <p>Create the pod <code>security-context-supplementalgroups-demo</code></p> <pre><code>$ kubectl create -f https://raw.githubusercontent.com/abcdesktopio/conf/main/kubernetes/security-context-supplementalgroups-demo.yaml\n</code></pre> <p>The pod is created</p> <pre><code>pod/security-context-supplementalgroups-demo created\n</code></pre> <p>Test the <code>id</code> command, you get the list <code>uid=1000</code> <code>gid=3000</code> <code>groups=2000,4000,5000,6000</code></p> <pre><code>$ kubectl exec -it pod/security-context-supplementalgroups-demo -- id\nuid=1000 gid=3000 groups=2000,4000,5000,6000\n</code></pre> <p>Run the group command inside the pod </p> <pre><code>$ kubectl exec -it pod/security-context-supplementalgroups-demo -- groups\n</code></pre> <p>The result <code>exit</code> with <code>code 1</code>. The groups do not exist in <code>/etc/group</code></p> <pre><code> 3000groups: unknown ID 3000\n 2000groups: unknown ID 2000\n 4000groups: unknown ID 4000\n 5000groups: unknown ID 5000\n 6000groups: unknown ID 6000\n command terminated with exit code 1\n</code></pre> <p>This is what you want to do with abcdesktop, the id numbers are replaced by strings. The <code>uid</code>, <code>gid</code> and <code>supplementalgroups</code> are read from <code>posixAccount</code> and <code>posixGroup</code> in the directory service. </p>"},{"location":"common/3.0/multiplegroupsfeature/#read-specsecuritycontext-from-a-pod","title":"Read <code>.spec.securityContext</code> from a pod","text":"<p>kubectl command  to read <code>.spec.securityContext</code></p> <pre><code>kubectl get pod/security-context-supplementalgroups-demo -o json | jq '.spec.securityContext' \n</code></pre> <p>You read as output</p> <pre><code>{\n  \"runAsGroup\": 3000,\n  \"runAsUser\": 1000,\n  \"supplementalGroups\": [\n    2000,\n    4000,\n    5000,\n    6000\n  ]\n}\n</code></pre>"},{"location":"common/3.0/multiplegroupsfeature/#accounts-description","title":"Accounts description","text":"<ul> <li>defined a user in the LDAP series</li> </ul>  <p>The complete ldif file can be downloaded at the end of this page.</p>  <p>The ldif set :</p> <ul> <li>organizationalUnit <code>people</code>: <code>ou=people,dc=planetexpress,dc=com</code></li> <li>organizationalUnit <code>groups</code>: <code>ou=groups,dc=planetexpress,dc=com</code></li> </ul> <p>Create a posixAccount : <code>cn=hermes,ou=people,dc=planetexpress,dc=com</code> - gidNumber: <code>1036</code> - uid: <code>hermes</code> - uidNumber: <code>1035</code></p> <p>Create a posixGroup for <code>hermes</code> : <code>cn=hermes,ou=groups,dc=planetexpress,dc=com</code></p> <ul> <li>objectClass: <code>posixGroup</code></li> <li>objectClass: <code>top</code></li> <li>cn: <code>hermes</code></li> <li>gidNumber: <code>1036</code></li> </ul> <p>Create a posixGroup : <code>cn=accountant,ou=groups,dc=planetexpress,dc=com</code></p> <ul> <li>cn: <code>accountant</code></li> <li>gidNumber: <code>18430</code></li> <li>memberUid: <code>hermes</code></li> </ul> <p>Create a posixGroup <code>cn=humans,ou=groups,dc=planetexpress,dc=com</code></p> <ul> <li>gidNumber: <code>20467</code></li> <li>memberUid: <code>fry</code></li> <li>memberUid: <code>hermes</code></li> </ul>"},{"location":"common/3.0/multiplegroupsfeature/#login-to-abcdesktop","title":"Login to abcdesktop","text":"<p>Login to abcdesktop as <code>Hermes Conrad</code> account</p> <p>Inside the user pod, the unix group file contains : </p> <pre><code>cat /etc/group\n</code></pre> <pre><code>hermes:x:1036:\nhumans:x:20467:hermes,fry\naccountant:x:18430:hermes\n</code></pre>  <p>This is correct.</p>  <p>The user's pod is defined with a <code>securityContext</code></p> <p>In this example you can replace <code>hermes-d1411d93-8922-4c33-81d7-3c085f381a27</code> by your own pod's name</p> <pre><code>kubectl get pods hermes-d1411d93-8922-4c33-81d7-3c085f381a27 -n abcdesktop -o json| jq '.spec.securityContext'  \n</code></pre> <p>You can read on stdout</p> <pre><code>{\n  \"runAsGroup\": 1036,\n  \"runAsUser\": 1035,\n  \"supplementalGroups\": [\n    20467,\n    18430\n  ]\n}\n</code></pre>  <p>This is correct. <code>supplementalGroups</code> defines the others groups from LDAP for DN:<code>cn=hermes,ou=groups,dc=planetexpress,dc=com</code></p>  <p>Inside the user pod run the <code>id</code> command</p>  <pre><code>hermes:~$ id\nuid=1035(hermes) gid=1036(hermes) groups=1036(hermes),18430(accountant),20467(humans)\nhermes:~$ groups\nhermes accountant humans\nhermes:~$\n</code></pre>  <p>This is correct.</p>"},{"location":"common/3.0/multiplegroupsfeature/#create-new-file-on-host","title":"Create new file on host","text":"<p>The default home directory in <code>od.config</code> is a volume <code>hostPath</code> set to <code>/tmp</code></p> <pre><code>desktop.homedirectorytype: 'hostPath' \ndesktop.hostPathRoot: '/tmp'\n</code></pre> <p>On your host server, get a shell with as root account, create a file <code>humansfile</code>  with restricted access to member of <code>humans</code> group.</p>  <pre><code>cd /mnt/hermes-conrad\necho 'hello' &gt; humansfile\nchown 0:20467 humansfile\nchmod 070 humansfile \n</code></pre> <p>Check the owner and group of the new file <code>humansfile</code></p> <pre><code>ls -la humansfile\n----rwx--- 1 root 20467 6 nov.  23 17:16 humansfile\n</code></pre> <p>Check inside the user pod check that <code>hermes</code> account can write data in the new file <code>humansfile</code>.</p>  <p>This is correct <code>hermes</code> is member of <code>humans</code> group.</p>   <pre><code>hermes:~$ ls -la humansfile \n=======\n- memberUid: `hermes`\n\nInside the user pod, the unix group file contains : \n\n```bash\ncat /etc/group\n</code></pre> <pre><code>hermes:x:1036:\nhumans:x:20467:hermes,fry\naccountant:x:18430:hermes\n</code></pre>  <p>This is correct.</p>  <p>The user's pod is defined with a <code>securityContext</code></p> <pre><code>'securityContext': {\n  'runAsUser': 1035,\n  'runAsGroup': 1036,\n  'supplementalGroups': [20467, 18430] \n}\n</code></pre>  <p>This is correct. <code>supplementalGroups</code> defines the others groups from LDAP</p>  <p>Inside the user pod run the <code>id</code> command</p>  <pre><code>hermes:~$ id\nuid=1035(hermes) gid=1036(hermes) groups=1036(hermes),18430(accountant),20467(humans)\nhermes:~$ groups\nhermes accountant humans\nhermes:~$\n</code></pre>  <p>This is correct.</p>"},{"location":"common/3.0/multiplegroupsfeature/#create-new-file-on-host_1","title":"Create new file on host","text":"<p>The default home directory in <code>od.config</code> is a volume <code>hostPath</code> set to <code>/tmp</code></p> <pre><code>desktop.homedirectorytype: 'hostPath' \ndesktop.hostPathRoot: '/tmp'\n</code></pre> <p>On your host server, using a root account, create a file <code>humansfile</code>  with restricted access to member of <code>humans</code> group.</p>  <pre><code>cd /mnt/hermes-conrad\necho 'hello' &gt; humansfile\nchown 0:20467 humansfile\nchmod 070 humansfile \n</code></pre> <p>Check the owner and group</p> <pre><code>ls -la humansfile\n----rwx--- 1 root 20467 6 nov.  23 17:16 humansfile\n</code></pre> <p>Check inside the user pod check that <code>hermes</code> account can to write data in file <code>humansfile</code>, because <code>hermes</code> is member of <code>humans</code> group.</p>  <pre><code>hermes:~$ ls -la humansfile \n&gt;&gt;&gt;&gt;&gt;&gt;&gt; 612b52bcffb502a9d934c0cbba40a43d553fc731\n----rwx--- 1 root humans 6 Nov 23 16:16 humansfile\nhermes:~$ echo 'hello from hermes' &gt;&gt; humansfile \nhermes:~$ more humansfile \nhello\nhello from hermes\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\nhermes:~$ \n</code></pre>  <p>This is correct.</p>  <p>We describe a common features with multiple groups and user <code>securityContext</code> on pods and abcdesktop support multiple groups with posixGroup define in RFC2307. </p>"},{"location":"common/3.0/multiplegroupsfeature/#ldap-ldif-dump","title":"LDAP ldif dump","text":"<p>To get more details about the ldif and ldap datas, you can download the ldif file planetexpress.</p> <pre><code>version: 1\n=======\nhermes:~$ \n</code></pre>  <p>This is correct.</p>  <p>We describe a common features with multiple groups and user <code>securityContext</code> on pods and abcdesktop support multiple groups with posixGroup define in RFC2307. </p>"},{"location":"common/3.0/multiplegroupsfeature/#ldif-dump","title":"ldif dump","text":"<p>To get more details about the ldif and ldap datas, you can download the ldif file planetexpress.</p> <pre><code>version: 1\n&gt;&gt;&gt;&gt;&gt;&gt;&gt; 612b52bcffb502a9d934c0cbba40a43d553fc731\n\ndn: dc=planetexpress,dc=com\nobjectClass: dcObject\nobjectClass: organization\nobjectClass: top\ndc: planetexpress\no: Planet Express, Inc.\n\ndn: ou=people,dc=planetexpress,dc=com\nobjectClass: organizationalUnit\nobjectClass: top\nou: people\ndescription: Planet Express crew\n\ndn: cn=Hermes Conrad,ou=people,dc=planetexpress,dc=com\nobjectClass: inetOrgPerson\nobjectClass: organizationalPerson\nobjectClass: person\nobjectClass: posixAccount\nobjectClass: top\ncn: Hermes Conrad\ngidNumber: 1036\nhomeDirectory: /home/hermes\nsn: Conrad\nuid: hermes\nuidNumber: 1035\ndescription: Human\nemployeeType: Accountant\nemployeeType: Bureaucrat\ngivenName: Hermes\nmail: hermes@planetexpress.com\nou: Office Management\n\ndn: ou=groups,dc=planetexpress,dc=com\nobjectClass: organizationalUnit\nobjectClass: top\nou: groups\n\ndn: cn=fry,ou=groups,dc=planetexpress,dc=com\nobjectClass: posixGroup\nobjectClass: top\ncn: fry\ngidNumber: 1025\nmemberUid: fry\n\ndn: cn=humans,ou=groups,dc=planetexpress,dc=com\nobjectClass: posixGroup\nobjectClass: top\ncn: humans\ngidNumber: 20467\nmemberUid: fry\nmemberUid: hermes\n\ndn: cn=hermes,ou=groups,dc=planetexpress,dc=com\nobjectClass: posixGroup\nobjectClass: top\ncn: hermes\ngidNumber: 1036\n\ndn: cn=accountant,ou=groups,dc=planetexpress,dc=com\nobjectClass: posixGroup\nobjectClass: top\ncn: accountant\ngidNumber: 18430\nmemberUid: hermes\n</code></pre>"},{"location":"common/3.0/update_frontend_image/","title":"Update and custom frontend web page","text":""},{"location":"common/3.0/update_frontend_image/#requirements","title":"Requirements","text":"<ul> <li><code>ctr</code> and <code>docker</code> package installed </li> </ul>"},{"location":"common/3.0/update_frontend_image/#goals","title":"Goals","text":"<ul> <li>Update abcdesktop default frontend web page to use your own.</li> <li>Create new image for abcdesktop oc.nginx daemonset</li> </ul>"},{"location":"common/3.0/update_frontend_image/#update-ocnginx-image","title":"Update oc.nginx image","text":"<ul> <li>Change logo and website name</li> <li>Rename the project name</li> </ul>"},{"location":"common/3.0/update_frontend_image/#clone-default-webmodules","title":"Clone default <code>webmodules</code>","text":"<pre><code>~$ mkdir build\n~$ cd build/\n~/build$ git clone https://github.com/abcdesktopio/webModules.git\nCloning into 'webModules'...\nremote: Enumerating objects: 4971, done.\nremote: Counting objects: 100% (1443/1443), done.\nremote: Compressing objects: 100% (638/638), done.\nremote: Total 4971 (delta 900), reused 1324 (delta 794), pack-reused 3528\nReceiving objects: 100% (4971/4971), 5.87 MiB | 7.64 MiB/s, done.\nResolving deltas: 100% (2701/2701), done.\n~/build$\n</code></pre>"},{"location":"common/3.0/update_frontend_image/#locate-project-and-ui-files","title":"Locate project and ui files","text":""},{"location":"common/3.0/update_frontend_image/#update-uijson-file","title":"Update ui.json file","text":"<p>Update your <code>ui.json</code> file.  <code>ui.json</code> is located in <code>webModules/transpile/config</code> directory.</p> <pre><code># cd webModules/transpile/config\ntotal 24\ndrwxr-xr-x   5 deva  wheel   160 Dec  7 15:17 .\ndrwxr-xr-x  11 deva  wheel   352 Dec  7 15:17 ..\n-rw-r--r--   1 deva  wheel    34 Dec  7 15:17 .cache.json\n-rw-r--r--   1 deva  wheel  1532 Dec  7 15:17 modules.json\n-rw-r--r--   1 deva  wheel  1480 Dec  7 15:17 ui.json\n</code></pre> <p><code>ui.json</code> is a json dictionary file</p> <p>The main entres are :</p> <ul> <li><code>name</code>, name is the name of your project.</li> <li><code>projectNameSplitedHTML</code>, is the animated <code>span</code> name of your project.</li> </ul>    entry default value example     name abcdesktop.io acmedesktop.io   projectNameSplitedHTML <code>&lt;span id='projectNameSplitedStagea'&gt;a&lt;/span&gt;&lt;span id='projectNameSplitedStageb'&gt;b&lt;/span&gt;&lt;span id='projectNameSplitedStagec'&gt;c&lt;/span&gt;&lt;span id='projectNameSplitedStaged'&gt;desktop&lt;/span&gt;</code> <code>&lt;span id='projectNameSplitedStagea'&gt;A&lt;/span&gt;&lt;span id='projectNameSplitedStageb'&gt;c&lt;/span&gt;&lt;span id='projectNameSplitedStagec'&gt;me&lt;/span&gt;&lt;span id='projectNameSplitedStaged'&gt;desktop&lt;/span&gt;</code>    <pre><code>{\n  \"name\": \"abcdesktop.io\",\n  \"projectNameSplitedHTML\": \"&lt;span id='projectNameSplitedStagea'&gt;a&lt;/span&gt;&lt;span id='projectNameSplitedStageb'&gt;b&lt;/span&gt;&lt;span id='projectNameSplitedStagec'&gt;c&lt;/span&gt;&lt;span id='projectNameSplitedStaged'&gt;desktop&lt;/span&gt;\",\n  \"colors\": [\n    {\n      \"name\": \"@primary\",\n      \"value\": \"#474B55\"\n    },\n    {\n      \"name\": \"@secondary\",\n      \"value\": \"#2D2D2D\"\n    },\n    {\n      \"name\": \"@tertiary\",\n      \"value\": \"#6EC6F0\"\n    },\n    {\n      \"name\": \"@quaternary\",\n      \"value\": \"#1E1E1E\"\n    },\n    {\n      \"name\": \"@svgColor\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@danger\",\n      \"value\": \"#CD3C14\"\n    },\n    {\n      \"name\": \"@success\",\n      \"value\": \"#32C832\"\n    },\n    {\n      \"name\": \"@info\",\n      \"value\": \"#527EDB\"\n    },\n    {\n      \"name\": \"@warning\",\n      \"value\": \"#FFCC00\"\n    },\n    {\n      \"name\": \"@light\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@dark\",\n      \"value\": \"#666666\"\n    },\n    {\n      \"name\": \"@blue\",\n      \"value\": \"#4BB4E6\"\n    },\n    {\n      \"name\": \"@green\",\n      \"value\": \"#50BE87\"\n    },\n    {\n      \"name\": \"@purple\",\n      \"value\": \"#A885D8\"\n    },\n    {\n      \"name\": \"@pink\",\n      \"value\": \"#FFB4E6\"\n    },\n    {\n      \"name\": \"@yellow\",\n      \"value\": \"#FFD200\"\n    }\n  ],\n  \"urlcannotopensession\": \"/identification/site/\",\n  \"urlusermanual\":  \"https://www.abcdesktop.io/\",\n  \"urlusersupport\": \"https://www.abcdesktop.io/\",\n  \"urlopensourceproject\": \"https://www.abcdesktop.io/\"\n}\n</code></pre>"},{"location":"common/3.0/update_frontend_image/#update-the-uijson-with-your-own-values","title":"Update the ui.json with your own values","text":"<p>Change for example the <code>name</code> of the project, and <code>projectNameSplitedHTML</code> to</p> <pre><code>  \"name\": \"acmedesktop.io\",\n  \"projectNameSplitedHTML\": \"&lt;span id='projectNameSplitedStagea'&gt;A&lt;/span&gt;&lt;span id='projectNameSplitedStageb'&gt;c&lt;/span&gt;&lt;span id='projectNameSplitedStagec'&gt;me&lt;/span&gt;&lt;span id='projectNameSplitedStaged'&gt;desktop&lt;/span&gt;\",\n</code></pre> <p>Example</p> <pre><code>{\n  \"name\": \"acmedesktop.io\",\n  \"projectNameSplitedHTML\": \"&lt;span id='projectNameSplitedStagea'&gt;A&lt;/span&gt;&lt;span id='projectNameSplitedStageb'&gt;c&lt;/span&gt;&lt;span id='projectNameSplitedStagec'&gt;me&lt;/span&gt;&lt;span id='projectNameSplitedStaged'&gt;desktop&lt;/span&gt;\",\n   \"colors\": [\n    {\n      \"name\": \"@primary\",\n      \"value\": \"#474B55\"\n    },\n    {\n      \"name\": \"@secondary\",\n      \"value\": \"#2D2D2D\"\n    },\n    {\n      \"name\": \"@tertiary\",\n      \"value\": \"#6EC6F0\"\n    },\n    {\n      \"name\": \"@quaternary\",\n      \"value\": \"#1E1E1E\"\n    },\n    {\n      \"name\": \"@svgColor\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@danger\",\n      \"value\": \"#CD3C14\"\n    },\n    {\n      \"name\": \"@success\",\n      \"value\": \"#32C832\"\n    },\n    {\n      \"name\": \"@info\",\n      \"value\": \"#527EDB\"\n    },\n    {\n      \"name\": \"@warning\",\n      \"value\": \"#FFCC00\"\n    },\n    {\n      \"name\": \"@light\",\n      \"value\": \"#FFFFFF\"\n    },\n    {\n      \"name\": \"@dark\",\n      \"value\": \"#666666\"\n    },\n    {\n      \"name\": \"@blue\",\n      \"value\": \"#4BB4E6\"\n    },\n    {\n      \"name\": \"@green\",\n      \"value\": \"#50BE87\"\n    },\n    {\n      \"name\": \"@purple\",\n      \"value\": \"#A885D8\"\n    },\n    {\n      \"name\": \"@pink\",\n      \"value\": \"#FFB4E6\"\n    },\n    {\n      \"name\": \"@yellow\",\n      \"value\": \"#FFD200\"\n    }\n  ],\n  \"urlcannotopensession\": \"/identification/site/\",\n  \"urlusermanual\":  \"https://www.abcdesktop.io/\",\n  \"urlusersupport\": \"https://www.abcdesktop.io/\",\n  \"urlopensourceproject\": \"https://www.abcdesktop.io/\"\n}\n</code></pre>"},{"location":"common/3.0/update_frontend_image/#create-a-new-dockerfile-to-build-changes","title":"Create a new <code>Dockerfile</code> to build changes","text":""},{"location":"common/3.0/update_frontend_image/#copy-uijson-file-to-your-build-directory","title":"Copy ui.json file to your build directory","text":"<pre><code>$ cp ui.json ~/build\n</code></pre>"},{"location":"common/3.0/update_frontend_image/#write-your-dockerfile-to-build-the-new-image","title":"Write your <code>Dockerfile</code> to build the new image","text":"<p>Dockerfile </p> <pre><code>FROM abcdesktopio/oc.nginx:builder as builder\n\n# copy data files\nCOPY --from=abcdesktopio/oc.nginx:3.0 var/webModules /var/webModules\n# copy updated file ui.json \nCOPY ui.json /var/webModules/transpile/config/\n# run makefile \nRUN cd /var/webModules &amp;&amp; make prod\n\n# --- START Build image ---\nFROM abcdesktopio/oc.nginx:3.0\n\n# COPY generated web site from builder container\nCOPY --from=builder var/webModules /var/webModules\nRUN cat /var/webModules/index.html\n\nLABEL name=\"frontend acmedesktop base image\" \\\n      maintainer=\"acmedesktop\" \\\n      version=\"3.0\"\n\n# end of nginx update\n</code></pre>"},{"location":"common/3.0/update_frontend_image/#docker-build","title":"Docker build","text":"<p>Run the docker build command to build the new <code>oc.nginx:acme</code> image</p> <pre><code>docker build -t oc.nginx:acme .\n</code></pre> <pre><code># docker build -t oc.nginx:acme .\nSending build context to Docker daemon  21.88MB\nStep 1/8 : FROM abcdesktopio/oc.nginx:builder as builder\nbuilder: Pulling from abcdesktopio/oc.nginx\neaead16dc43b: Pull complete \n2b469c68b643: Pull complete \n5cee1fa1576f: Pull complete \n359c5b0dcf0a: Pull complete \nDigest: sha256:b9b2c232a885405df39e146d7ac02f3da034a5addc78c00faca59e2d8934ec5b\nStatus: Downloaded newer image for abcdesktopio/oc.nginx:builder\n ---&gt; ef7e71c277b9\nStep 2/8 : COPY --from=abcdesktopio/oc.nginx:3.0 var/webModules /var/webModules\n3.0: Pulling from abcdesktopio/oc.nginx\neaead16dc43b: Already exists \nd78e49ae48aa: Pull complete \n5a1b3cde12da: Pull complete \nd46852e47788: Pull complete \n301ba448a167: Pull complete \ne352a410ea9e: Pull complete \n6478c15f8c14: Pull complete \n52697000c467: Pull complete \n4f346a00bc16: Pull complete \n9d4bc434c5bb: Pull complete \nDigest: sha256:d8692b633b221654899d8dbe7987330f878364d7288ec5628f7aa47152ce4ea6\nStatus: Downloaded newer image for abcdesktopio/oc.nginx:3.0\n\n ---&gt; c5a084901830\nStep 3/8 : COPY ui.json /var/webModules/transpile/config/\n ---&gt; cbb23fb8634e\nStep 4/8 : RUN cd /var/webModules &amp;&amp; make prod\n ---&gt; Running in 976ee31ac5db\nfatal: not a git repository: /var/webModules/../../.git/modules/var/webModules\nfatal: not a git repository: /var/webModules/../../.git/modules/var/webModules\nfatal: not a git repository: /var/webModules/../../.git/modules/var/webModules\ncreate html page /var/webModules/demo.html\ncreate html page /var/webModules/index.session.mustache.html\ncreate html page /var/webModules/app.html\ncreate html page /var/webModules/app.session.mustache.html\ncreate html page /var/webModules/index.html\ncreate html page /var/webModules/description.html\nApply userInterface conf: 1.355s\nTransform and copy js files:\nBuild svg: 2.034s\nBuild css: 2.041s\n[...]\nTotal duration copy and transform: 10.430s\nWriting /var/webModules/app.js\nWriting /var/webModules/index.html: 0.975ms\nWriting /var/webModules/app.html: 0.855ms\nWriting /var/webModules/index.session.mustache.html: 0.781ms\nBuild app.js file: 11.362s\nremove out dir base /var/webModules/build: 9.129ms\nTotal duration: 12.752s\nRemoving intermediate container 976ee31ac5db\n ---&gt; 784902ce50c1\nStep 5/8 : FROM abcdesktopio/oc.nginx:3.0\n ---&gt; c77f6c5ca8a1\nStep 6/8 : COPY --from=builder var/webModules /var/webModules\n ---&gt; 68474a5ee2d5\nStep 7/8 : RUN cat /var/webModules/index.html\n ---&gt; Running in ddb958078b50\n [...]\nRemoving intermediate container ddb958078b50\n ---&gt; f02e3c57ec7e\nStep 8/8 : LABEL name=\"frontend acmedesktop base image\"       maintainer=\"acmedesktop\"       version=\"3.0\"\n ---&gt; Running in da5363dcf434\nRemoving intermediate container da5363dcf434\n ---&gt; b5449d85393f\nSuccessfully built b5449d85393f\nSuccessfully tagged oc.nginx:acme\n</code></pre> <p>Run the <code>docker images</code> command to read the new <code>oc.nginx</code> image</p> <pre><code>docker images \n\nREPOSITORY              TAG       IMAGE ID       CREATED         SIZE\noc.nginx                acme      b5449d85393f   2 minutes ago   685MB\n</code></pre>"},{"location":"common/3.0/update_frontend_image/#save-the-container-image-to-a-file","title":"Save the container image to a file","text":"<pre><code>docker image save oc.nginx:acme -o oc.nginx.acme\n</code></pre>"},{"location":"common/3.0/update_frontend_image/#import-the-file-ocnginxacme-in-k8sio-namespace-for-containerd","title":"Import the file <code>oc.nginx.acme</code> in <code>k8s.io</code> namespace for <code>containerd</code>","text":"<p>The <code>oc.nginx.acme</code> not is listed in the <code>k8s.io</code> namespace.</p> <p>Run the <code>ctr</code> command line to import <code>oc.nginx.acme</code> </p> <pre><code>ctr -n k8s.io images import oc.nginx.acme \nunpacking docker.io/library/oc.nginx:acme (sha256:5c3debc775894d079fa61be7f8217be0ecc7b2e7c47f0318bc1c94921c278e14)...done\n</code></pre> <p>Check that your new image is listed</p> <pre><code>ctr -n k8s.io images ls |grep oc.nginx:acme\ndocker.io/library/oc.nginx:acme                                                                                                  application/vnd.docker.distribution.manifest.v2+json      sha256:5c3debc775894d079fa61be7f8217be0ecc7b2e7c47f0318bc1c94921c278e14 384.9 MiB linux/amd64                                                                                                                        io.cri-containerd.image=managed \n</code></pre>"},{"location":"common/3.0/update_frontend_image/#update-abcdesktopyaml-file","title":"Update abcdesktop.yaml` file","text":"<p>Update your own <code>abcdesktop.yaml</code> file to replace the default image <code>abcdesktopio/oc.nginx:3.0</code> by the new container image <code>oc.nginx:acme</code> name.</p> <pre><code> containers:\n      - name: nginx\n        imagePullPolicy: Always\n        image: abcdesktopio/oc.nginx:3.0\n</code></pre> <p>Replace :</p> <ul> <li><code>imagePullPolicy: Always</code> by <code>imagePullPolicy: Never</code></li> <li><code>image: abcdesktopio/oc.nginx:3.0</code> by <code>image: oc.nginx:acme</code></li> </ul> <pre><code> containers:\n      - name: nginx\n        imagePullPolicy: Never\n        image: oc.nginx:acme\n</code></pre> <p>Apply the new <code>abcdesktop.yaml</code> file</p> <pre><code>kubectl apply -f abcdesktop.yaml \n</code></pre> <p>The <code>daemonset.apps/daemonset-nginx</code> is <code>configured</code></p> <pre><code>clusterrole.rbac.authorization.k8s.io/pyos-role unchanged\nclusterrolebinding.rbac.authorization.k8s.io/pyos-rbac unchanged\nserviceaccount/pyos-serviceaccount unchanged\nstorageclass.storage.k8s.io/storage-local-abcdesktop unchanged\nconfigmap/nginx-config unchanged\ndeployment.apps/memcached-od unchanged\nsecret/mongodb-secret configured\ndeployment.apps/mongodb-od unchanged\ndaemonset.apps/daemonset-nginx configured\ndeployment.apps/speedtest-od unchanged\ndaemonset.apps/daemonset-pyos configured\nendpoints/desktop unchanged\nservice/desktop unchanged\nservice/memcached unchanged\nservice/mongodb unchanged\nservice/speedtest unchanged\nservice/nginx unchanged\nservice/pyos unchanged\ndeployment.apps/openldap-od unchanged\nservice/openldap unchanged\n</code></pre> <pre><code>kubectl rollout restart daemonset/daemonset-nginx -n abcdesktop\n</code></pre> <p>Start you web browser. You can read the new project name at the home page.</p>  <p>The new login animation paints <code>acme</code>desktop</p>  <p>You have updated the html web page for abcdesktop release 3.0</p>"},{"location":"core/memcached/","title":"Memcached","text":"<p>The memcached container comes from the public docker registry. This service is attend to the netback network. </p> <p>memcached store pods and containers message during the create process.</p>"},{"location":"core/memcached/#create-desktop","title":"create desktop","text":""},{"location":"core/memcached/#create-desktop-message","title":"create desktop message","text":"<p>Messages stored into memcache </p>    status user message     OK 'Looking for your desktop'   OK 'Looking for your desktop done'   OK 'Building desktop'   OK 'Starting network services, it will take a while...'   OK 'Network services started.'   OK 'Starting desktop graphical service %ds / %d' % (nCount,nCountMax)   OK 'Starting desktop spawner service %ds / %d' % (nCount,nCountMax)   OK 'Desktop services are ready after %d s'   Error 'createDesktop error - myOrchestrator.createDesktop %s'"},{"location":"core/mongodb/","title":"Mongodb","text":"<p>Mongodb is an open-source document database that provides high performance, high availability, and automatic scaling.</p> <p>The mongodb container comes from the public docker registry. This service is attend to the netback network.</p>"},{"location":"core/mongodb/#collections","title":"Collections","text":"<p>abcdesktop.io uses the colections mongodb to store </p> <ul> <li>webrtc call history </li> <li>login history </li> <li>dock web state</li> </ul>"},{"location":"core/mongodb/#dock-state","title":"dock state","text":"<ul> <li>The dock state is stored as an array of application name.</li> <li>The dock state is stored when the user changes it (for exemple add or remove an application inside the dock zone ).</li> <li>The collection's name is the userid. The key's name is 'dock'</li> </ul> <pre><code>[ \n    \"keyboard\",\n    \"frontendjs.filemanager\",\n    \"Mail.Thunderbird\",\n    \"libreoffice.libreoffice-calc\",\n    \"libreoffice.libreoffice-writer\",\n    \"Navigator.Firefox\",\n    \"gimp.Gimp\",\n    \"gnome-terminal.Gnome-terminal\"\n]\n</code></pre>"},{"location":"core/mongodb/#loginhistory","title":"loginHistory","text":"<ul> <li>Login History is an object collection.</li> <li>One collection is created for each user. </li> <li>The collection's name is the userid.</li> <li>The javascript code can only read and NEVER write data to the loginHistory collection.</li> </ul> <p>The object's format is :</p> <pre><code>{\n \"picture\":\"https://scontent.xx.fbcdn.net/v/t1.0-1/p480x480/1452008_10202217750222019_1258804247_n.jpg?oh=a96b2290e63e1e81525ede1a5b073853&amp;oe=59184A75\",\n \"sub\":\"10208942501856324\",\n \"ipaddr\":\"181.125.208.3, 10.255.0.3\",\n \"provider\":\"facebook\",\n \"date\":\"2017-01-12 11:19:57.946554\",\n \"useragent\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.75 Safari/537.36\",\n \"_id\":\"5877665d0790160b0d59efd0\",\n \"name\":\"Alexandre Devely\"}\n</code></pre> <ul> <li>_id : is the mongodb id</li> <li>sub : is the userid</li> <li>ipaddr : is the client ip address</li> <li>provider : authenticated provider </li> <li>date : date formated </li> <li>useragent : user browser description</li> <li>name : the user name  </li> </ul>"},{"location":"core/mongodb/#method","title":"method","text":"<p>The method getCollection, is a ligth way to get a collection on the fron-end side. </p> <p>For exemple this method is use by whoami.js to obtain the login's history using the key 'loginHistory'.</p> <pre><code> getCollection('loginHistory', function(msg) {\n            if (msg.status === 200) {\n                var history = msg.result;\n                loginHistory = history;\n                buildHtmlTable(history);\n            }\n        })\n</code></pre>"},{"location":"core/nginx/","title":"Nginx oc.nginx","text":"<p>Nginx is used as a reverse proxy server for HTTP, HTTPS protocols, as well as a load balancer, HTTP cache, and a web server (origin server). </p>"},{"location":"core/nginx/#nginx-routing","title":"Nginx routing","text":""},{"location":"core/nginx/#nginx-configuration","title":"Nginx Configuration","text":"<ul> <li>Read the nginx nginx.conf configuration file</li> <li>Read the nginx default web site configuration file</li> <li>Read the route.conf configuration file, use to route HTTP request </li> <li>Read the proxy.conf configuration file, use to proxy HTTP request </li> </ul>"},{"location":"core/nginx/#web-site","title":"web site","text":"<p>The static files (html, css, js) are stored in the local /var/webModules directory.</p>"},{"location":"core/nginx/#main-reverse-proxy","title":"main reverse proxy","text":"<ul> <li>moauth|fauth|gauth|oauth|autologin|API|status are routed to od.py <code>http://$my_proxy:$api_service_tcp_port;</code></li> <li>/spawner is routed to nodejs spawner service <code>http://$target:$spawner_service_tcp_port;</code></li> <li>/websockify is routed to websocket <code>http://$target:$ws_tcp_bridge_tcp_port/;</code></li> <li>/u8_1_11025 is routed to pulseaudio sound service <code>http://$target:$pulseaudio_http_port/listen/source/u8_1_11025.monitor;</code></li> <li>/filer is routed to nodejs filer service http://$target:8080 </li> <li>/broadcast is routed to nodejs broadcast service <code>http://$target:$broadcast_tcp_port;</code></li> </ul>"},{"location":"core/nginx/#lua-scripts","title":"LUA scripts","text":"<p>The /etc/nginx/get.targetmap.lua read the <code>jwt_token</code> and return the ip address or the pod's fqdn, using the <code>jwt_desktop_signing_public_key</code> and the <code>jwt_desktop_payload_private_key</code></p> <p>It uses a targetmap (dict) as first cache level.</p> <pre><code>lua_shared_dict targetmap 1m;\n</code></pre> <p>Read the lua script get.targetmap.lua to get details jwt token data and payload encryption.</p>"},{"location":"core/ocuser/","title":"The POD User","text":"<p>  </p> <p>After the login process, if no associated pod is all ready running, a new user pod is started. This pod starts at least a container with the graphical image.</p>"},{"location":"core/ocuser/#inside-the-pod-user","title":"Inside the POD User","text":"<p>The pod user runs by default a container with the graphical image : the oc.user.18.04.</p> <p>A pod can also runs sound container image, and a printer container. These options are defined in the od.config configuration file [ section <code>desktop.soundimage</code> and <code>desktop.printerimage</code>].</p>"},{"location":"core/ocuser/#processes-running-inside-the-user-container","title":"Processes running inside the user container","text":"<p>All processes are running as the user named <code>balloon</code>, because none of theme need to run as <code>root</code>.</p> <p>The userid and the guid are <code>4096</code>. </p>"},{"location":"core/ocuser/#supervisord","title":"Supervisord","text":"<p>Supervisor is a client/server system that allows its users to monitor and control a number of processes on UNIX-like operating systems. All process running inside the user container, are started by supervisord. </p> <pre><code>/usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf\n</code></pre> <p>Supervisor is the parent of all running process</p> <pre><code>docker-entrypoi---supervisord-+-Xvnc\n                              |-node---10*[{node}]\n                              |-4*[nodejs---10*[{nodejs}]]\n                              |-nodejs---6*[{nodejs}]\n                              |-nodejs-+-bash---pstree\n                              |        `-11*[{nodejs}]\n                              |-openbox\n                              `-xsettingsd\n</code></pre>"},{"location":"core/ocuser/#tigervnc-xvnc","title":"TigerVNC Xvnc","text":"<p>TigerVNC is a high-performance, platform-neutral implementation of <code>VNC</code> (<code>Virtual Network Computing</code>), a client/server application that allows users to launch and interact with graphical applications on remote machines. TigerVNC provides the levels of performance necessary to run 3D and video applications, and it attempts to maintain a common look and feel and re-use components, where possible, across the various platforms that it supports. TigerVNC also provides extensions for advanced authentication methods and TLS encryption.</p> <p>Starts parameters </p> <pre><code>command=Xvnc :0 -geometry 3840x2160 -SendPrimary=0 -depth 24 -rfbunixpath /tmp/.x11vnc -pn -rfbauth /composer/run/.vnc/passwd```\n</code></pre> <p>The default DISPLAY is :0.  <code>Xvnc</code> listen on unix socket file <code>/tmp/.x11vnc</code>. </p>"},{"location":"core/ocuser/#openbox","title":"Openbox","text":"<p>Openbox is the window manager, it supports extensive standards support.</p> <p>Openbox is patched with few line to send <code>SIG_USR1</code> and <code>SIG_USR2</code> messages to internal spawner service.  This patch is only required to send message (Create/Close) to the abcdesktop.io web front.</p> <p>This patch add notification when X11/window change :</p> <p>The notify patch send signals SIGUSR1 and SIGUSR2 to a process (pid)</p> <pre><code>#define SIG_MANAGED_WINDOW   SIGUSR1\n#define SIG_UNMANAGED_WINDOW SIGUSR2\n</code></pre> <ul> <li>SIGUSR1: when a new window is created</li> <li>SIGUSR2: when a window is closed</li> </ul> <p>Openbox is started by supervisord using the command :</p> <pre><code>command=/usr/bin/openbox --sm-disable --config-file /etc/X11/openbox/rc.xml --startup /composer/openbox/autostart.sh\n</code></pre>"},{"location":"core/ocuser/#ws-tcp-bridge","title":"ws-tcp-bridge","text":"<p>ws-tcp-bridge A websocket to tcp proxy server, using nodejs which bridges websockets and tcp servers in either direction.</p> <p>ws-tcp-bridge is started by supervisord using the command :</p> <pre><code>/composer/node/ws-tcp-bridge/ws-tcp-bridge --method=ws2tcp --lport 6081 --rhost=unix:/tmp/.x11vnc\n</code></pre>"},{"location":"core/ocuser/#spawner-servicejs","title":"Spawner-service.js","text":"<p>spawner-service.js is a daemon written in nodejs, this daemon listen for messages on the tcp port 8001. spawner-service offers methods to interact with the container and the X11 server : </p> <ul> <li>launch: start a new application inside the container [ use for builtin applications ]</li> <li>filesearch: search file by keywords</li> <li>activate: activate a window</li> <li>raise: raise a window</li> <li>minimize: minimize a window</li> <li>close: close a window</li> <li>getwindowslist: get window list</li> <li>activatewindow: activate a window</li> <li>closewindow</li> <li>minimizewindow</li> <li>raisewindow</li> <li>info: get container information </li> <li>clipboardsync: Sync primary clipboard to gtk default clipboard</li> <li>getbroadcastwindowslist: broadcast the window list to all connected users</li> <li>getappforfile: get the application key for a filename </li> <li>getmimeforfile: get the mime type for a filename</li> <li>echo: return an echo string</li> </ul> <p>spawner-service.js is started by supervisord using the command :</p> <pre><code>command=nodejs /composer/node/spawner-service/spawner-service.js\n</code></pre>"},{"location":"core/ocuser/#printer-servicejs","title":"Printer-service.js","text":"<p>Printer-service.js waits for a file in /home/balloon/.printer-queue directory. Printer-service.js use broadcastevent to notify the web browser to download new files to print.  Printer-service.js is started by supervisord using the command :</p> <pre><code>command=nodejs /composer/node/printer-service/printer-service.js\n</code></pre>"},{"location":"core/ocuser/#broadcast-servicejs","title":"Broadcast-service.js","text":"<p>Broadcast-service.js allows to broadcast messages between all user sharing the same session.</p> <p>Broadcast-service.js is started by supervisord using the command :</p> <pre><code>command=nodejs /composer/node/broadcast-service/broadcast-service.js\n</code></pre>"},{"location":"core/ocuser/#file-servicejs","title":"File-service.js","text":"<p>File-service.js is a upload/download service to tranfert files between the browser and the user home directory. File-service.js supports the HTTP method POST to uploadFile and GET to respond data file. File-service.js is used for printer-service.js to download PDF printed files. File-service.js use the tcp port 8080.</p> <pre><code>http.createServer(function(req, res) {\n  if (req.method === 'POST') {\n    uploadFile( req, res );\n  } \n  else if (req.method === 'GET') {\n        respondFile( req, res );\n  }\n}).listen(8080, function() {\n  console.log('Listening for requests');\n});\n</code></pre> <p>File-service.js is started by supervisord using the command :</p> <pre><code>command=nodejs /composer/node/file-service/file-service.js\n</code></pre>"},{"location":"core/ocuser/#pulseaudio","title":"Pulseaudio","text":"<p>PulseAudio is a sound system for POSIX, and is a proxy for sound applications. It allows you to do advanced operations on your sound data as it passes between applications. Pulseaudio is use as server to forward sound between X11 applications and the user browser. It supports also virtual local sound. </p> <p>file etc/pulse/default.pa</p> <pre><code>load-module module-native-protocol-unix\nload-module module-always-sink\nload-module module-native-protocol-tcp\n</code></pre> <p>Pulseaudio is started by supervisord using the command :</p> <pre><code>command=/usr/bin/pulseaudio\n</code></pre>"},{"location":"core/ocuser/#xsettingsd","title":"Xsettingsd","text":"<p>Xsettingsd is a daemon that implements the XSETTINGS specification. Xsettingsd is use to run GTK+ applications, to configure things such as themes, font antialiasing/hinting, and UI sound effects without we using the GNOME desktop environment. Xsettingsd set the default GTK theme and color pallette:</p> <pre><code>Net/ThemeName \"Numix-Flatstudio\"\nNet/IconThemeName \"Numix-Light\"\nGtk/ColorPalette \"black:white:gray50:red:purple:blue:light blue:green:yellow:orange:lavender:brown:goldenrod4:dodger blue:pink:light green:gray10:gray30:gray75:gray90\"\n</code></pre> <p>Xsettingsd is started by supervisord using the command.</p> <pre><code>command=/usr/bin/xsettingsd -c /home/balloon/.xsettings\n</code></pre>"},{"location":"core/ocuser/#build-the-user-container-image","title":"Build the user container image","text":"<p>The image oc.user.XX.YY is based from the oc.software.XX.YY  witch came from oc.ubuntu.XX.YY. For example : * The image oc.user.18.04 is based from the oc.software.18.04 witch came from oc.ubuntu.18.04. * The image oc.user.20.04 is based from the oc.software.20.04 witch came from oc.ubuntu.20.04. * The image oc.user.21.04 is based from the oc.software.21.04 witch came from oc.ubuntu.21.04.</p> <pre><code>+-------------------+\n| oc.user.18.04     |       (abcdesktop.io custom software component)\n+---------+---------+\n          |\n+---------+---------+\n| oc.software.18.04 |       (abcdesktop.io ubuntu software component)\n+---------+---------+\n          |\n+---------+---------+\n| oc.ubuntu.18.04   |       (abcdesktop.io ubuntu service)\n+-------------------+\n          |\n+---------+---------+\n|   ubuntu:18.04    |   (official ubuntu images from dockerhub)\n+-------------------+\n</code></pre> <p>To build the image oc.user container from scratch, you need to build there 3 images. Build oc.ubuntu.18.04 first, next oc.software.18.04, and finish by oc.user.18.04. This is done by the Makefile command.</p> <pre><code>docker build -t oc.ubuntu.18.04 -f oc.ubuntu.18.04 .\ndocker build -t oc.software.18.04 -f oc.software.18.04 .\ndocker build -t oc.user.18.04   -f oc.user.18.04 .\n</code></pre> <p>To do it automaticly, clone composer/dockerbuild and run the Makefile</p> <pre><code>git clone https://github.com/abcdesktopio/oc.user.git \nmake\n</code></pre>"},{"location":"core/ocuser/#dockerfile-ocubuntuxxyy","title":"Dockerfile oc.ubuntu.XX.YY.","text":"<p>oc.ubuntu.XX.YY is a Dockerfile, it starts 'FROM ubuntu:XX.YY' and  installs core services and libs:</p> <ul> <li>nodejs: use by services</li> <li>tiger VNC: X11 server </li> <li>supervisor: service manager</li> <li>xsettingsd: for X11 params</li> <li>pulseaudio: fo sound </li> <li>openbox: the windows manager</li> <li>cups and cups-pdf: for printing support</li> </ul>"},{"location":"core/ocuser/#dockerfile-ocsoftwarexxyy","title":"Dockerfile oc.software.XX.YY","text":"<p>oc.software.XX.YY is a Dockerfile, it starts 'FROM oc.ubuntu.XX.YY' and installs software components:</p> <ul> <li>gnome-terminal</li> <li>xclip</li> </ul>"},{"location":"core/ocuser/#dockerfile-ocuserxxyy","title":"Dockerfile oc.user.XX.YY","text":"<p>oc.user.XX.YY is a Dockerfile, it starts 'FROM oc.software.XX.YY' and installs user software components:</p>"},{"location":"core/ocuser/#install-nodejs-dev","title":"Install nodejs dev","text":"<pre><code># Add nodejs service\nRUN cd /composer/node/broadcast-service &amp;&amp; npm install  \nRUN cd /composer/node/file-service      &amp;&amp; npm install\nRUN cd /composer/node/printer-service   &amp;&amp; npm install\nRUN cd /composer/node/spawner-service   &amp;&amp; npm install  \\\nRUN cd /composer/node/spawner-service/node_modules/geoip-lite &amp;&amp; npm run-script updatedb\nRUN cd /composer/node/angular-filemanager-nodejs-bridge &amp;&amp; npm install \nRUN cd /composer/node/livesound-service &amp;&amp; npm install\n</code></pre>"},{"location":"core/ocuser/#create-the-balloon-user","title":"Create the balloon user","text":"<pre><code>RUN groupadd --gid 4096 $BUSER\nRUN useradd --create-home --shell /bin/bash --uid 4096 -g $BUSER --groups lpadmin,sudo $BUSER\n</code></pre>"},{"location":"core/ocuser/#change-default-permission-to-run-cupsd","title":"Change default permission to run cupsd","text":"<pre><code># change acces right for printer support\nRUN addgroup $BUSER lpadmin\nRUN mkdir /var/run/cups \nRUN     chown -R $BUSER:$BUSER /var/spool/cups            &amp;&amp; \\\n        chown -R $BUSER:$BUSER /var/spool/cups-pdf      &amp;&amp; \\\n        chown -R $BUSER:$BUSER /var/log/cups                &amp;&amp; \\\n        chown -R $BUSER:$BUSER /var/cache/cups          &amp;&amp; \\\n        chown -R $BUSER:$BUSER /etc/cups/printers.conf  &amp;&amp; \\\n        chown -R $BUSER:$BUSER /var/run/cups/\n</code></pre>"},{"location":"core/ocuser/#set-the-exposed-tcp-port","title":"Set the exposed tcp port","text":"<p>Datas to these tcp ports are routed by nginx</p> <pre><code>PULSEAUDIO_HTTP_PORT                4714\nWS_TCP_BRIDGE_SERVICE_TCP_PORT      6081\nRESERVED_FOR_NEXT_VERSION           29780\nXTERM_TCP_PORT                      29781\nFILE_SERVICE_TCP_PORT               29783\nBROADCAST_SERVICE_TCP_PORT          29784\nRESERVED FOR CUPSD                  29785\nSPAWNER_SERVICE_TCP_PORT            29786\n</code></pre>"},{"location":"core/pyos/","title":"pyos","text":"<p>oc.pyos is the application server for abcdesktop.io. oc.pyos is the abcdesktop control plane that configures and shuts down user desktops. This repository oc.pyos is the container of pyos. os.py is python script based on cherrypy framework and listen tcp port 8000. os.py daemon waits for json request from the javascript web client scripts, and implements methods : </p> <ul> <li>'login' : Request a login session, create a new user container if it does not exist.         </li> <li>'getkeyinfo' : Return the public key from a provider        </li> <li>'logout'  : logout the container</li> <li>'logs' : return logs from a started container</li> <li>'getapplist' : return all avalaible applications</li> <li>'install' : [ deprecated ] install a package</li> <li>'share' : send a auth token to the email to share the desktop </li> <li>'support' : send a support request</li> <li>'restart' : retart the user container           </li> <li>'ocrun' : start a application             </li> <li>'ocstop' : stop the container</li> <li>'whoami' : return a JSON object whoami         </li> <li>'set' : set a key value </li> <li>'get' : get value from a key  </li> <li>'setcollection' : add value to a collection</li> <li>'getcollection' : get all values from a collection</li> </ul>"},{"location":"core/speedtest/","title":"SpeedTest","text":"<p>The speedtest container comes from the public docker registry. </p>"},{"location":"core/speedtest/#libretest-speedtest","title":"LibreTest SpeedTest","text":"<p>LibreSpeed/SpeedTest is a very lightweight Speedtest implemented in Javascript, using XMLHttpRequest and Web Workers.  LibreSpeed/SpeedTest works with no Flash, no Java, no Websocket.</p>"},{"location":"services/file-service/","title":"File service v1.0.0","text":""},{"location":"services/file-service/#file-service","title":"File service v1.0.0","text":"<p>Scroll down for code samples, example requests and responses. Select a language for code samples from the tabs above or the mobile navigation menu.</p>  <p>A sample API</p> <p>Base URLs:</p> <ul> <li>/</li> </ul>"},{"location":"services/file-service/#file-service-default","title":"Default","text":""},{"location":"services/file-service/#get__","title":"get__","text":"<p><code>GET /</code></p> <p>Get file from the home directory</p>  <p>Example responses</p> <p>403 Response</p>"},{"location":"services/file-service/#get__-responses","title":"Responses","text":"Status Meaning Description Schema     403 Forbidden none Inline   404 Not Found none Inline   500 Internal Server Error none Inline"},{"location":"services/file-service/#get__-responseschema","title":"Response Schema","text":"<p>Status Code 403</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 404</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 500</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data any false none none     This operation does not require authentication"},{"location":"services/file-service/#post__","title":"post__","text":"<p><code>POST /</code></p> <p>Upload a file at a given path</p>  <p>Body parameter</p> <p>Example responses</p> <p>200 Response</p>"},{"location":"services/file-service/#post__-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   403 Forbidden none Inline   500 Internal Server Error none Inline"},{"location":"services/file-service/#post__-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 403</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 500</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none     This operation does not require authentication"},{"location":"services/file-service/#delete__","title":"delete__","text":"<p><code>DELETE /</code></p> <p>Remove a given file wich is present in home directory</p>  <p>Body parameter</p>  <pre><code>{\n  \"myFilename\": \"string\"\n}\n</code></pre>"},{"location":"services/file-service/#delete__-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb myFilename body string true none     <p>Example responses</p> <p>200 Response</p>"},{"location":"services/file-service/#delete__-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   400 Bad Request none Inline   403 Forbidden none Inline   404 Not Found none Inline   500 Internal Server Error none Inline"},{"location":"services/file-service/#delete__-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 400</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 403</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 404</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 500</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data strin false none none     This operation does not require authentication"},{"location":"services/file-service/#get__directory_list","title":"get__directory_list","text":"<p><code>GET /directory/list</code></p> <p>List files in a given directory</p>"},{"location":"services/file-service/#get__directory_list-parameters","title":"Parameters","text":"Name In Type Required Description     directoryName query string true none"},{"location":"services/file-service/#get__directory_list-responses","title":"Responses","text":"Status Meaning Description Schema     default Default Default response None     This operation does not require authentication"},{"location":"services/spawner-service/","title":"Spawner service v1.0.0","text":""},{"location":"services/spawner-service/#spawner-service","title":"Spawner service v1.0.0","text":"<p>Scroll down for code samples, example requests and responses. Select a language for code samples from the tabs above or the mobile navigation menu.</p>  <p>A sample API</p> <p>Base URLs:</p> <ul> <li>/</li> </ul>"},{"location":"services/spawner-service/#spawner-service-default","title":"Default","text":""},{"location":"services/spawner-service/#get__version","title":"get__version","text":"<p><code>GET /version</code></p> <p>Get User container version</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"date\": null,\n  \"commit\": \"string\",\n  \"version\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#get__version-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   404 Not Found none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#get__version-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb date Date false none none   \u00bb commit string false none none   \u00bb version string false none none    <p>Status Code 404</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none     This operation does not require authentication"},{"location":"services/spawner-service/#post__launch","title":"post__launch","text":"<p><code>POST /launch</code></p> <p>Used to run builtin application process</p>  <p>Body parameter</p>  <pre><code>{\n  \"command\": \"string\",\n  \"args\": [\n    \"string\"\n  ]\n}\n</code></pre>"},{"location":"services/spawner-service/#post__launch-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb command body string true none   \u00bb args body [string] false none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": {}\n}\n</code></pre>"},{"location":"services/spawner-service/#post__launch-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none launch   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__setaudioquality","title":"post__setAudioQuality","text":"<p><code>POST /setAudioQuality</code></p> <p>Set the audio quality</p>  <p>Body parameter</p>  <pre><code>{\n  \"sink\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setaudioquality-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb sink body string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": {}\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setaudioquality-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none processResult   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__playaudiosample","title":"post__playAudioSample","text":"<p><code>POST /playAudioSample</code></p> <p>Play a sample audio</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": {}\n}\n</code></pre>"},{"location":"services/spawner-service/#post__playaudiosample-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none processResult   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#put__configurepulse","title":"put__configurePulse","text":"<p><code>PUT /configurePulse</code></p> <p>Configure pulse audio for Janus</p>  <p>Body parameter</p>  <pre><code>{\n  \"destinationIp\": \"string\",\n  \"port\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#put__configurepulse-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb destinationIp body string true none   \u00bb port body string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#put__configurepulse-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__broadcastwindowslist","title":"post__broadcastwindowslist","text":"<p><code>POST /broadcastwindowslist</code></p> <p>Emit a broadcast with window list as data</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__broadcastwindowslist-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__clipboardsync","title":"post__clipboardsync","text":"<p><code>POST /clipboardsync</code></p> <p>Synchronize X11 and gtk clipboard</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__clipboardsync-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__setdesktop","title":"post__setDesktop","text":"<p><code>POST /setDesktop</code></p> <p>Store a data as json file in desktop</p>  <p>Body parameter</p>  <pre><code>{\n  \"key\": \"string\",\n  \"value\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setdesktop-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb key body string true none   \u00bb value body string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setdesktop-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#get__getdesktop","title":"get__getDesktop","text":"<p><code>GET /getDesktop</code></p> <p>Get a data stored as json file</p>"},{"location":"services/spawner-service/#get__getdesktop-parameters","title":"Parameters","text":"Name In Type Required Description     key query string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": {}\n}\n</code></pre>"},{"location":"services/spawner-service/#get__getdesktop-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#get__getdesktop-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data object false none none     This operation does not require authentication"},{"location":"services/spawner-service/#get__getmimeforfile","title":"get__getmimeforfile","text":"<p><code>GET /getmimeforfile</code></p> <p>Get a mime for a given filename</p>"},{"location":"services/spawner-service/#get__getmimeforfile-parameters","title":"Parameters","text":"Name In Type Required Description     filename query string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"data\": {}\n}\n</code></pre>"},{"location":"services/spawner-service/#get__getmimeforfile-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none MIME   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#get__filesearch","title":"get__filesearch","text":"<p><code>GET /filesearch</code></p> <p>Used for list files by dock</p>"},{"location":"services/spawner-service/#get__filesearch-parameters","title":"Parameters","text":"Name In Type Required Description     maxfile query integer false none   keywords query string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": [\n    {\n      \"file\": \"string\",\n      \"mime\": \"string\"\n    }\n  ]\n}\n</code></pre>"},{"location":"services/spawner-service/#get__filesearch-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#get__filesearch-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data [object] false none none   \u00bb\u00bb file string false none none   \u00bb\u00bb mime string false none none     This operation does not require authentication"},{"location":"services/spawner-service/#post__generatedesktopfiles","title":"post__generateDesktopFiles","text":"<p><code>POST /generateDesktopFiles</code></p> <p>Build desktop files to run containerized applications</p>  <p>Body parameter</p>  <pre><code>{\n  \"list\": [\n    {\n      \"mimetype\": \"string\",\n      \"path\": \"string\",\n      \"executablefilename\": \"string\",\n      \"icon\": \"string\",\n      \"name\": \"string\",\n      \"launch\": \"string\"\n    }\n  ]\n}\n</code></pre>"},{"location":"services/spawner-service/#post__generatedesktopfiles-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb list body [object] true none   \u00bb\u00bb mimetype body string false none   \u00bb\u00bb path body string false none   \u00bb\u00bb executablefilename body string false none   \u00bb\u00bb icon body string false none   \u00bb\u00bb name body string false none   \u00bb\u00bb launch body string false none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__generatedesktopfiles-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#get__getappforfile","title":"get__getappforfile","text":"<p><code>GET /getappforfile</code></p> <p>Allow to get the app necessary</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": [\n    {\n      \"command\": \"string\",\n      \"args\": \"string\"\n    }\n  ]\n}\n</code></pre>"},{"location":"services/spawner-service/#get__getappforfile-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none AppForFile   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#get__about","title":"get__about","text":"<p><code>GET /about</code></p> <p>Get system informations</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"hostname\": \"string\",\n  \"ipaddr\": \"string\",\n  \"plateform\": \"string\",\n  \"arch\": \"string\",\n  \"release\": \"string\",\n  \"cpu\": \"string\",\n  \"clientipaddr\": \"string\",\n  \"country\": \"string\",\n  \"language\": \"string\",\n  \"build\": \"string\",\n  \"POD_NAMESPACE\": \"string\",\n  \"POD_NAME\": \"string\",\n  \"NODE_NAME\": \"string\",\n  \"POD_IP\": \"string\",\n  \"KUBERNETES_SERVICE_HOST\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#get__about-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#get__about-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb hostname string false none none   \u00bb ipaddr string false none none   \u00bb plateform string false none none   \u00bb arch string false none none   \u00bb release string false none none   \u00bb cpu string false none none   \u00bb clientipaddr string false none none   \u00bb country string false none none   \u00bb language string false none none   \u00bb build string false none none   \u00bb POD_NAMESPACE string false none none   \u00bb POD_NAME string false none none   \u00bb NODE_NAME string false none none   \u00bb POD_IP string false none none   \u00bb KUBERNETES_SERVICE_HOST string false none none     This operation does not require authentication"},{"location":"services/spawner-service/#get__getsettings","title":"get__getSettings","text":"<p><code>GET /getSettings</code></p> <p>Get configuration for settings window</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": [\n    {\n      \"tab\": \"string\",\n      \"enabled\": true\n    }\n  ]\n}\n</code></pre>"},{"location":"services/spawner-service/#get__getsettings-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#get__getsettings-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data [any] false none none   \u00bb\u00bb tab string false none none   \u00bb\u00bb enabled boolean false none none     This operation does not require authentication"},{"location":"services/spawner-service/#post__setbackgroundcolor","title":"post__setBackgroundColor","text":"<p><code>POST /setBackgroundColor</code></p> <p>Change the background color</p>  <p>Body parameter</p>  <pre><code>{\n  \"color\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setbackgroundcolor-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb color body string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setbackgroundcolor-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__setbackgroundimage","title":"post__setBackgroundImage","text":"<p><code>POST /setBackgroundImage</code></p> <p>Set the background image</p>  <p>Body parameter</p>  <pre><code>{\n  \"imgName\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setbackgroundimage-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb imgName body string true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": {\n    \"color\": \"string\",\n    \"subData\": {\n      \"code\": 0,\n      \"data\": \"string\"\n    }\n  }\n}\n</code></pre>"},{"location":"services/spawner-service/#post__setbackgroundimage-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   404 Not Found none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#post__setbackgroundimage-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data object false none none   \u00bb\u00bb color string false none none   \u00bb\u00bb subData Success false none All operations completed with success   \u00bb\u00bb\u00bb code integer false none none   \u00bb\u00bb\u00bb data string false none none    <p>Status Code 404</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none     This operation does not require authentication"},{"location":"services/spawner-service/#post__setdefaultimage","title":"post__setDefaultImage","text":"<p><code>POST /setDefaultImage</code></p> <p>Set the default image as background</p>  <p>Example responses</p> <p>200 Response</p>"},{"location":"services/spawner-service/#post__setdefaultimage-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   404 Not Found none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#post__setdefaultimage-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none    <p>Status Code 404</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data string false none none     This operation does not require authentication"},{"location":"services/spawner-service/#get__getwindowslist","title":"get__getwindowslist","text":"<p><code>GET /getwindowslist</code></p> <p>Get window list</p>  <p>Example responses</p> <p>200 Response</p>"},{"location":"services/spawner-service/#get__getwindowslist-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Inline   500 Internal Server Error none InternalError"},{"location":"services/spawner-service/#get__getwindowslist-responseschema","title":"Response Schema","text":"<p>Status Code 200</p>    Name Type Required Restrictions Description     \u00bb code integer false none none   \u00bb data [any] false none none   \u00bb\u00bb id integer false none none   \u00bb\u00bb pid integer false none none   \u00bb\u00bb wm_class string false none none   \u00bb\u00bb title string false none none   \u00bb\u00bb machine_name string false none none     This operation does not require authentication"},{"location":"services/spawner-service/#post__activatewindows","title":"post__activatewindows","text":"<p><code>POST /activatewindows</code></p> <p>Activate windows</p>  <p>Body parameter</p>  <pre><code>{\n  \"windowsid\": [\n    0\n  ]\n}\n</code></pre>"},{"location":"services/spawner-service/#post__activatewindows-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb windowsid body [integer] true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__activatewindows-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__closewindows","title":"post__closewindows","text":"<p><code>POST /closewindows</code></p> <p>Close windows</p>  <p>Body parameter</p>  <pre><code>{\n  \"windowsid\": [\n    0\n  ]\n}\n</code></pre>"},{"location":"services/spawner-service/#post__closewindows-parameters","title":"Parameters","text":"Name In Type Required Description     body body object false none   \u00bb windowsid body [integer] true none     <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__closewindows-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#post__placeallwindows","title":"post__placeAllWindows","text":"<p><code>POST /placeAllWindows</code></p> <p>Place and resize all windows</p>  <p>Example responses</p> <p>200 Response</p>  <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n</code></pre>"},{"location":"services/spawner-service/#post__placeallwindows-responses","title":"Responses","text":"Status Meaning Description Schema     200 OK none Success   500 Internal Server Error none InternalError     This operation does not require authentication"},{"location":"services/spawner-service/#schemas","title":"Schemas","text":""},{"location":"services/spawner-service/#tocS_InternalError","title":"InternalError","text":"<p>   </p> <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n\n</code></pre>"},{"location":"services/spawner-service/#properties","title":"Properties","text":"Name Type Required Restrictions Description     code integer false none none   data string false none none"},{"location":"services/spawner-service/#tocS_Success","title":"Success","text":"<p>   </p> <pre><code>{\n  \"code\": 0,\n  \"data\": \"string\"\n}\n\n</code></pre> <p>All operations completed with success</p>"},{"location":"services/spawner-service/#properties_1","title":"Properties","text":"Name Type Required Restrictions Description     code integer false none none   data string false none none"},{"location":"services/spawner-service/#tocS_processResult","title":"processResult","text":"<p>   </p> <pre><code>{\n  \"code\": 0,\n  \"data\": {}\n}\n\n</code></pre>"},{"location":"services/spawner-service/#properties_2","title":"Properties","text":"Name Type Required Restrictions Description     code integer false none none   data object false none none"},{"location":"services/spawner-service/#tocS_launch","title":"launch","text":"<p>   </p> <pre><code>{\n  \"code\": 0,\n  \"data\": {}\n}\n\n</code></pre>"},{"location":"services/spawner-service/#properties_3","title":"Properties","text":"Name Type Required Restrictions Description     code integer false none none   data object false none none"},{"location":"services/spawner-service/#tocS_MIME","title":"MIME","text":"<p>   </p> <pre><code>{\n  \"data\": {}\n}\n\n</code></pre>"},{"location":"services/spawner-service/#properties_4","title":"Properties","text":"Name Type Required Restrictions Description     data object false none none"},{"location":"services/spawner-service/#tocS_AppForFile","title":"AppForFile","text":"<p>   </p> <pre><code>{\n  \"code\": 0,\n  \"data\": [\n    {\n      \"command\": \"string\",\n      \"args\": \"string\"\n    }\n  ]\n}\n\n</code></pre>"},{"location":"services/spawner-service/#properties_5","title":"Properties","text":"Name Type Required Restrictions Description     code integer false none none   data [object] false none none   \u00bb command string false none none   \u00bb args string false none none"},{"location":"setup/kubernetes_flexvolume/","title":"CIFS Flexvolume Plugin for Kubernetes","text":"<p>Driver for CIFS (SMB, Samba, Windows Share) network filesystems as Kubernetes volumes.</p> <p>abcdesktop team is not the authors of the CIFS Flexvolume Plugin for kubernetes. This file is an update from the original source file https://raw.githubusercontent.com/fstab/cifs/. The original source code is https://github.com/fstab/cifs The author is Fabian St\u00e4ber. The update is part for abcdesktop.io</p> <p>This article is just an update from Fabian St\u00e4ber work.</p>"},{"location":"setup/kubernetes_flexvolume/#background","title":"Background","text":"<p>Docker containers running in Kubernetes have an ephemeral file system: Once a container is terminated, all files are gone. In order to store persistent data in Kubernetes, you need to mount a Persistent Volume into your container. Kubernetes has built-in support for network filesystems found in the most common cloud providers, like Amazon's EBS, Microsoft's Azure disk, etc. However, some cloud hosting services, like the Hetzner cloud, provide network storage using the CIFS (SMB, Samba, Windows Share) protocol, which is not natively supported in Kubernetes.</p> <p>Fortunately, Kubernetes provides Flexvolume, which is a plugin mechanism enabling users to write their own drivers. There are a few flexvolume drivers for CIFS out there, but for different reasons none of them seemed to work for me. So Fabian St\u00e4ber wrote this driver.</p>"},{"location":"setup/kubernetes_flexvolume/#installing","title":"Installing","text":"<p>The flexvolume plugin is a single shell script named cifs. This shell script must be available on the Kubernetes master and on each of the Kubernetes nodes. By default, Kubernetes searches for third party volume plugins in <code>/usr/libexec/kubernetes/kubelet-plugins/volume/exec/</code>. </p> <p>The plugin directory can be configured with the kubelet's <code>--volume-plugin-dir</code> parameter, run <code>ps aux | grep kubelet</code> to learn the location of the plugin directory on your system (see [#1][9]). The <code>cifs</code> script must be located in a subdirectory named <code>abcdesktop~cifs/</code>. The directory name <code>abcdesktop~cifs/</code> will be mapped to the Flexvolume driver name <code>abcdesktop/cifs</code>.</p> <p>On the Kubernetes master and on each Kubernetes node run the following commands:</p> <pre><code>VOLUME_PLUGIN_DIR=\"/usr/libexec/kubernetes/kubelet-plugins/volume/exec\"\nmkdir -p \"$VOLUME_PLUGIN_DIR/abcdesktop~cifs\"\ncd \"$VOLUME_PLUGIN_DIR/abcdesktop~cifs\"\ncurl -L -O https://raw.githubusercontent.com/abcdesktop/cifs/main/cifs\nchmod 755 cifs\n</code></pre> <p>The <code>cifs</code> script requires a few executables to be available on each host system:</p> <ul> <li><code>mount.cifs</code>, on Ubuntu this is in the cifs-utils package.</li> <li><code>jq</code>, on Ubuntu this is in the jq package.</li> <li><code>mountpoint</code>, on Ubuntu this is in the util-linux package.</li> <li><code>base64</code>, on Ubuntu this is in the coreutils package.</li> </ul> <pre><code>apt-get install cifs-utils jq util-linux coreutils\n\n</code></pre> <p>To check if the installation was successful, run the following command:</p> <pre><code>VOLUME_PLUGIN_DIR=\"/usr/libexec/kubernetes/kubelet-plugins/volume/exec\"\n$VOLUME_PLUGIN_DIR/abcdestkop~cifs/cifs init\n\n</code></pre> <p>It should output a JSON string containing <code>\"status\": \"Success\"</code>. This command is also run by Kubernetes itself when the cifs plugin is detected on the file system.</p>"},{"location":"setup/kubernetes_flexvolume/#update-your-odconfig-file","title":"Update your od.config file","text":"<p>In this example, we use a Microsoft Active Directory as a LDAP Server.</p>  <p>CIFS is supported with kubernetes configuration, CIFS is not supported in docker non-cluster mode</p>  <p>Add a new policy to add a label <code>TAG</code> during the user's authentification process.</p> <pre><code>\n# Add an explicit authmanagers\nauthmanagers: { \n    'explicit': {\n        'show_domains': True,\n        'default_domain': 'AD',\n        'providers': {\n          'AD': { \n            'config_ref': 'adconfig', \n            'enabled': True\n           }\n        }\n    }\n}\n\n\n# add the configuration reference for adconfig\nadconfig : { 'AD': {   'default'       : True, \n                       'ldap_timeout'  : 15,\n                       'ldap_protocol' : 'ldap',\n                       'ldap_basedn'   : 'DC=ad,DC=domain,DC=local',\n                       'ldap_fqdn'     : '_ldap._tcp.ad.domain.local',\n                       'domain'        : 'AD',\n                       'domain_fqdn'   : 'AD.DOMAIN.LOCAL',\n                       'servers'       : [ '192.168.7.12' ],\n                       'kerberos_realm': 'AD.DOMAIN.LOCAL',\n                       'policies'      : { 'acls': None,\n                                           'rules' : { 'rule-domainuser' : {\n                                                  'conditions' : [ { 'primarygroupid': '513', 'expected' : True  } ],\n                                                  'expected'   : True,\n                                                  'label'      : 'domainuser' } \n} } } } } } }\n\n</code></pre> <p>In this example :</p> <ul> <li>To verify that a user is member of <code>DOMAIN USER</code> group, we check that the user's <code>primaryGroupID</code> is equal to <code>513</code></li> <li>If the <code>primaryGroupID</code> is equal to <code>513</code> the authentification process add the label <code>domainuser</code></li> </ul> <p>Then in the same od.config file, add rules to the desktop object to match this label <code>domainuser</code></p> <pre><code>desktop.policies: { 'rules': { 'volumes': { 'domainuser':  { 'type': 'cifs', 'name': 'homedirectory', 'volumename': 'homedir' } } },\n                        'acls' : {} }\n\n</code></pre> <p>In this example :</p> <ul> <li>If the user's label is equal <code>domainuser</code>, then the user attribut <code>homeDir</code> is mounted to the <code>homeDirectory</code> by the CIFS flexvolume plugin.</li> </ul>"},{"location":"setup/kubernetes_flexvolume/#testing","title":"Testing","text":""},{"location":"setup/kubernetes_flexvolume/#apply-new-configuration-file","title":"Apply new configuration file","text":"<pre><code>kubectl apply -f abcdesktop.yml\n</code></pre> <p>Open you abcdesktop website and fill the authentation form with your  Microsoft Active Direcotry Service or Samba server credentials.</p>  <p>Run authentification on the Microsoft Active Direcotry Service or on your Samba server</p> <p>Start the File Manager application. In this example, the <code>homeDir</code> is set to <code>U:</code>, the mount entry become the letter <code>U</code>.</p>  <p>Click on the <code>homeDir</code> to read the CIFS ressource data. In this example, the shared ressource <code>//192.168.7.101/alex</code> contains a file ```NAS-file.ods'</p>"},{"location":"setup/kubernetes_flexvolume/#troubleshooting","title":"Troubleshooting","text":"<p>Logs files are stored in host directory <code>/var/log/abcdesktop/cifs</code> </p> <pre><code># ls -la /var/log/abcdesktop/cifs\ntotal 36\ndrwxr-xr-x 2 root root 4096 janv. 28 16:39 .\ndrwxr-xr-x 3 root root 4096 d\u00e9c.   1 12:00 ..\n-rw-r--r-- 1 root root  288 janv. 28 16:39 alex.log\n-rw-r--r-- 1 root root  832 janv. 28 16:39 cifs.log\n-rw-r--r-- 1 root root 1264 d\u00e9c.   1 14:25 error.alex.json\n-rw-r--r-- 1 root root  834 d\u00e9c.   1 14:25 error.alex.log\n-rw-r--r-- 1 root root   50 janv. 28 16:39 mount.counter\n-rw-r--r-- 1 root root   44 d\u00e9c.  22 12:20 umount.counter\n</code></pre> <p>Check the file sAMAccountName.log, cifs.log</p> <p>If there is an error, look at the <code>error.$sAMAccountName.json</code> and  <code>error.$sAMAccountName.log</code></p> <p>Example </p> <pre><code>-rw-r--r-- 1 root root 1264 d\u00e9c.   1 14:25 error.alex.json\n-rw-r--r-- 1 root root  834 d\u00e9c.   1 14:25 error.alex.log\n</code></pre> <p>Run mount command </p> <p><code>mount</code></p> <p>In this example :</p> <ul> <li><code>192.168.7.101</code> is the IP Address of the NAS server</li> <li><code>//192.168.7.101/alex</code> is the shared ressource</li> <li><code>alex</code> is the sAMAccountName</li> </ul> <pre><code># mount | grep 192.168.7.101\n//192.168.7.101/alex on /var/lib/kubelet/pods/b7530cc0-6903-458a-a133-d8a8450e3af4/volumes/abcdesktop~cifs/flexvol-cifs-homedir-alex type cifs (rw,relatime,vers=1.0,cache=strict,username=alex,uid=4096,forceuid,gid=4096,forcegid,addr=192.168.7.101,soft,unix,posixpaths,serverino,mapposix,acl,rsize=1048576,wsize=1048576,bsize=1048576,echo_interval=60,actimeo=1)\n</code></pre> <p>Check that the kubernetes secrets exist </p> <pre><code>kubectl get secrets -n abcdesktop\nNAME                                  TYPE                                  DATA   AGE\nabcdesktopjwtdesktoppayload           Opaque                                2      65d\nabcdesktopjwtdesktopsigning           Opaque                                2      65d\nabcdesktopjwtusersigning              Opaque                                2      65d\nauth-cifs-alex-flexvol-cifs-homedir   abcdesktop/cifs                       4      10m\nauth-ldif-alex                        abcdesktop/ldif                       11     10m\n</code></pre>"},{"location":"setup/kubernetes_networkpolicies/","title":"Setup Network policy","text":""},{"location":"setup/kubernetes_networkpolicies/#network-policy-group","title":"Network Policy group","text":"<p>File need to be written</p>"}]}